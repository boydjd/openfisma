============================================================================
    OpenFISMA INSTALLATION INSTRUCTIONS
============================================================================

1.0 Software Pre-Requisites
----------------------------------------------------------------------------

You must have the following software installed before proceeding with
the installation of OpenFISMA.

* Apache 2 or greater
* PHP 5.2.0 or greator
* MySQL 5 or greator
* MySQL module for php5

2.0 OpenFISMA Setup
----------------------------------------------------------------------------

Create a directory for OpenFISMA
 $ mkdir /opt/openfisma

Change into the new directory
 $ cd /opt/openfisma

Download the latest copy of OpenFISMA
 $ wget http://downloads.sourceforge.net/openfisma/openfisma-x.x.x.tgz

Unzip the files you just downloaded
 $ tar -xvf openfisma-x.x.x.tgz

You should now have a directory structure which looks like the following
  > application - folder that holds OpenFISMA application 
  > public      - public folder or document root for webserver
  > library     - third party modules used by OpenFISMA
  > data        - holds log files and other data created by OpenFISMA

Next you will need to tell Apache where the public directory of OpenFISMA
resides. Apache configuration is different on almost all flavors of unix
but the configuration file below should only require minimal changes to 
get you up and running. You will need to customize the server name to 
the appropriate name and validate that the path for the error logs is 
correct. 

# Virtual Host for serving SSL access to OpenFISMA
NameVirtualHost *:80

<VirtualHost *:80>
   # EDIT THIS ENTRY!
   # Hostname and port that the server uses to identify itself
   # ServerName fully-qualified-domain-name[:port]
   ServerName openfisma.example.gov

   # Instructs apache to remove Trace and Track messages from the
   # header response.
   RewriteEngine on
   RewriteCond %{REQUEST_METHOD} ^TRAC(E|K)
   RewriteRule .* - [F]
   TraceEnable off

   # Sets the Document Root for apache to serve files
   DocumentRoot "/opt/openfisma/public"

   # Sets the permissions on the document root directory
   <Directory "/opt/openfisma/public">
     <LimitExcept GET POST>
        deny from all
     </LimitExcept>
    Order allow,deny
    allow from all

    # Instructs Apache to (1) not list directory contents, (2) not follow 
    # symbolic links, (3) disables server side includes, and (4) disables
    # content negotiation
    Options -Indexes -FollowSymLinks -Includes -Multiviews

    # Allow Options to be specified in .htaccess files which override
    # any settings defined here.
    AllowOverride Options

    </Directory>
    
    # sets the name of the file to which the server will log any errors it encounters
    ErrorLog /var/log/apache2/openfisma-error.log
    # sets the name of the file to which the server will log information to
    CustomLog /var/log/apache2/openfisma-access.log common

    <IfModule mod_php5.c>
        # Disables allow_url_fopen
        php_admin_flag allow_url_fopen Off
        # Disables allow_url_include
        php_admin_flag allow_url_include Off
        # Enable PHP stealth mode
        php_admin_flag expose_php Off
    </IfModule>
    
</VirtualHost>
  

The following files and directories need to be writeable for the 
installation script to run. 

    /application/config/install.conf
    /public/evidence
    /public/temp
    /data

To accomplish this we will run the following commands.

   $ chmod 777 /opt/openfisma/application/config/install.conf
   $ chmod 777 /opt/openfisma/public/evidence
   $ chmod 777 /opt/openfisma/public/temp
   $ chmod 777 -R /opt/openfisma/data
  
If all has gone well, you will be able to run the installation script
from your browser at http://<server_name>/. Follow the wizard through
the installation steps. During the installation the wizard creates
the /opt/openfisma/apps/config/install.conf file. If the install.conf
contents are deleted, the wizard will run through the installation process
again.  

Once the wizard has completed you may log in with the username
"root" and password "0p3nfism@", please note the 0 is a zero. This
password should be changed immediately after logging in.

2.1 Email Notification Setting
----------------------------------------------------------------------------

To enable the capability of automated email notification, it's necessary to 
create a cronjob to the cronjob/FismaNotify.php. For example:
# run the bell every 5 minutes
5 0 * * *  /where/openfisma/installed/cronjob/FismaNotify.php >> /tmp/out 2>&1

or the cronjob should be 
5 0 * * *  php /where/cronjob/FismaNotify.php >> /tmp/out 2>&1

Note: the frequency of the cronjob determind the possible shortest interval 
between every consequent notifying action. It's not effective if any user 
set the customized notification interval shorter than it.

3.0 Security Hardening
----------------------------------------------------------------------------

After the installation you will want to remove the ability to run the
installation wizard and protect the install.conf file. This can be done
by deleting the InstallController.php file and changing the permissions
for the install.conf file.

  $ rm /opt/openfisma/apps/controller/InstallController.php
  $ chmod 755 /opt/openfisma/apps/config/install.conf
