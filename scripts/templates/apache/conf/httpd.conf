##
# ServerTokens
# This configuration setting aids in hiding the web server software. We 
# do not want to give away any more information about our web server 
# than is absolutely necessary. We will only give out the minimum server token 
# information. Minimal information is given by the Prod setting.
ServerTokens Prod

##
# ServerRoot
# The ServerRoot is the directory or filesystem where the server 
# resides. Any relative path names for directories such as conf/ or log/ will be 
# considered as sub-directories of this main directory.
ServerRoot "/etc/httpd"

##
# PidFile
# The PidFile directive sets the file to which the server records the 
# process id of the daemon. If the filename is not absolute then it is 
# assumed to be relative to the ServerRoot.
PidFile run/httpd.pid

##
# Timeout
# One way of attacking systems on the Internet is to try to prevent the 
# target system from operating correctly by overloading it. This is 
# called a 'denial of service' attack. One method of doing this is to open 
# multiple connections to a server and never close them. The more 
# connections the server has open at once, the more resources are tied 
# up holding details of those connection, which can lead to increased load 
# and eventually to the server running out of resources. The Timeout 
# directive tells the server how long to wait to receive a GET request, 
# the amount of time between receipt of TCP packets on a POST or PUT 
# request, or the amount of time between ACKs on transmissions of TCP 
# packets in responses. In order to prevent a denial of service attack 
# from shutting down our web server, we need to change the default 
# setting of 300 (which is 5 minutes) to 60 (which is 1 minute). You 
# may even adjust this setting to be lower than 60.
Timeout 60

##
# KeepAlive
# In order to make our web server more efficient, and therefore more 
# resistant to DoS attacks, we want to allow TCP KeepAlives. This 
# setting will allow for multiple HTTP requests to be serviced across one 
# connection. Without this setting, a new Apache server would have to be 
# spawned for every subsequent HTTP request for gifs, etc...
KeepAlive On

##
# KeepAliveTimeout
# This directive will limit the time the Apache web server will wait for 
# a KeepAlive request to be completed. Setting KeepAliveTimeout to a high 
# value may cause performance problems in heavily loaded servers. The 
# higher the timeout, the more server processes will be kept occupied 
# waiting on connections with idle clients. If this number is set too 
# high, then a DoS attack could be more successful.
KeepAliveTimeout 15

##
# StartServers
# This will increase the initial number of Apache server instances that 
# are created upon startup. This number is increased slightly from the 
# default setting of 5 servers. This will aid in deterring DoS attacks. 
# The StartServers directive identifies how many child processes the 
# Apache server should initially start. Increasing this value from the 
# default of 5 increases performance, but care should be taken because 
# these idle processes do take up resources. Setting it too high can waste 
# system resources. Only after running stress testing applications 
# against your Apache installation can your accurately gauge how many 
# httpd processes you might need to spawn upon startup. The recommended in 
# initial setting for this directive is 10.
StartServers       5

##
# MinSpareServers
# This directive will also aid in deterring a DoS attack by constantly 
# making sure that there are a sufficient number of Apache web server 
# instances ready to accept requests. The MinSpareServers specifies the 
# minimum number of idle child processes that should exist. Setting this 
# value too high can waste system resources. The recommended setting for 
# this directive is 10.
MinSpareServers    5

##
# MaxSpareServers
# This directive will also aid in deterring a DoS attack by constantly 
# making sure that there are a sufficient number of Apache web server 
# instances ready to accept requests. It is possible that as child 
# processes go idle an increasing amount of system resources will be 
# dedicated unnecessarily. The MaxSpareServers keeps this within 
# reasonable limits by eliminating excess idle child processes. The 
# recommended setting for this directive is 20.
MaxSpareServers   5

##
# MaxClients
# The MaxClients directive sets the limit on the number of simultaneous 
# requests that can be supported; not more than this number of child 
# server processes will be created. The default entry for the MaxClients 
# directive is 150. The max setting we can set without editing the 
# Apache source code is 256.
MaxClients       256

########################################################
# Minimal list of modules required for Apache to Operate
########################################################

##
# Module: mime_module
# This module is used to associate various bits of "meta information" 
# with files by their filename extensions. This information relates the 
# filename of the document to it's mime-type, language, character set 
# and encoding. This information is sent to the browser, and participates in 
# content negotiation, so the user's preferences are respected when 
# choosing one of several possible files to serve.
LoadModule mime_module modules/mod_mime.so

##
# Module: dir_module
# Provides for "trailing slash" redirects and serving directory index 
# files. A "trailing slash" redirect is issued when the server receives 
# a request for a URL http://servername/foo/dirname where dirname is a 
# directory. Directories require a trailing slash, so mod_dir issues a 
# redirect to http://servername/foo/dirname/.
LoadModule dir_module modules/mod_dir.so

##
# Module: log_config_module
# This module provides for flexible logging of client requests. Logs are 
# written in a customizable format, and may be written directly to a 
# file, or to an external program. Conditional logging is provided so that 
# individual requests may be included or excluded from the logs based on 
# characteristics of the request.
LoadModule log_config_module modules/mod_log_config.so

##
# Module: access_module
# The directives provided by mod_access are used in <Directory>, 
# <Files>, and <Location> sections as well as .htaccess  files to 
# control access to particular parts of the server. Access can be controlled based 
# on the client hostname, IP address, or other characteristics of the 
# client request, as captured in environment variables. The Allow and 
# Deny directives are used to specify which clients are or are not allowed 
# access to the server, while the Order  directive sets the default 
# access state, and configures how the Allow and Deny directives interact with 
# each other.
LoadModule access_module modules/mod_access.so

# allows you to set environment variables according to whether different 
# aspects of the request match regular expressions you specify. These 
# environment variables can be used by other parts of the server to make 
# decisions about actions to be taken.
LoadModule setenvif_module modules/mod_setenvif.so

################################################
# Recommended List of Apache Modules to Load
###############################################

##
# Module: mime_magic
# This module determines the MIME type of files in the same way the Unix 
# file(1) command works: it looks at the first few bytes of the file. It 
# is intended as a "second line of defense" for cases that mod_mime 
# can't resolve. This module is derived from a free version of the 
# file(1) command for Unix, which uses "magic numbers" and other hints from a file's contents 
# to figure out what the contents are. This module is active only if the 
# magic file is specified by the MimeMagicFile directive.
LoadModule mime_magic_module modules/mod_mime_magic.so

##
# Module: alias_module
# The directives contained in this module allow for manipulation and 
# control of URLs as requests arrive at the server. The Alias and 
# ScriptAlias directives are used to map between URLs and filesystem 
# paths. This allows for content which is not directly under the 
# DocumentRoot served as part of the web document tree. The ScriptAlias 
# directive has the additional effect of marking the target directory as 
# containing only CGI scripts.
LoadModule alias_module modules/mod_alias.so

##
# This module provides a rule-based rewriting engine to rewrite
# requested URLs on the fly
LoadModule rewrite_module modules/mod_rewrite.so

##
# This module creates dynamically configured virtual hosts, by allowing
# the IP address and/or the Host: header of the HTTP request to be used
# as part of the pathname to determine what files to serve. This allows
# for easy use of a huge number of virtual hosts with similar 
# configurations.
LoadModule vhost_alias_module modules/mod_vhost_alias.so

##
# Loads all files ending with .conf
Include conf.d/*.conf

##
# The User directive establishes who is the owner of the children 
# processes spawned by the main Apache service. Do not run your Apache 
# web server as root. Since the well-known port of httpd is 80 and since 
# only root can bind to ports below 1024, the main Apache listening 
# process must be owned by root. However, it would be very dangerous if 
# any CGI child process also ran as root because if they were 
# compromised the attacker would have full root access to the system. 
# The User directive restricts the privileges that can be obtained if the child process is 
# compromised. In following with the set up preparation that has already 
# been done, the recommended setting for this directive is webserv.
User apache

##
# The Group directive provides similar functionality to the User 
# directive. That is it is another means of restricting the privilege 
# level that the child processes can run in. For instance, if the Group 
# directive is set to wheel and a CGI script was compromised, the 
# attacker would gain root-level privilege. We created a new group called 
# webser which should ONLY have the webserv user as a member. This 
# will prevent any undesired Group permissions to be associated with the 
# webserv account.
Group apache

##
# The ServerAdmin directive is the email address for the sites web 
# administrator. The security vulnerabilities associated with publicly 
# displaying an actual user's email address may seem trivial, however, 
# do not underestimate the security implications. Specifying a user's 
# local email address - such as - "Jdoe@webserver.com" reveals that 
# user's local OS account name. Using an e-mail alias such as "SysAdmin@companyx.com" 
# instead of "RealName@companyx.com," reduces the likelihood of a 
# successful e-mail spoofing attack.
ServerAdmin webmaster@endeavorsystems.com

UseCanonicalName Off

<Directory />
    Options None
    AllowOverride None
    deny from all
</Directory>

DirectoryIndex index.html index.htm

AccessFileName .htaccess

<Files ~ "^\.ht">
    Order allow,deny
    Deny from all
</Files>

TypesConfig /etc/mime.types

DefaultType text/plain

MIMEMagicFile conf/magic

##
# The HostnameLookups directive tells Apache to do a DNS query to verify 
# the hostname of a requesting clientÂ’s IP address. This information is 
# then passed to any Access Control Lists or CGI programs and then 
# finally  logged in the appropriate line of either the access_log or 
# error_log files. This feature is useful when checking log files for notorious 
# domain names. You should investigate further if you are receiving 
# numerous connections from sites such as: www.samspade.org and 
# www.netcraft.com. These sites are normally used to conduct remote 
# reconnaissance against web sites.

HostnameLookups On

ErrorLog /var/log/httpd/error_log
LogLevel notice
LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Accept}i\" \"%{Referer}i\" \"%{User-Agent}i\"" combined
CustomLog /var/log/httpd/access_log combined

##
# In order to protect which web server software we are using, we should 
# not disclose this information in any of our system generated Error 
# pages. The ServerSignature directive instructs Apache to append 
# certain footer information to the bottom of error pages.

ServerSignature Off

AddDefaultCharset UTF-8
