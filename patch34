Index: application/models/SecurityControlEnhancement.php
===================================================================
--- application/models/SecurityControlEnhancement.php	(revision 0)
+++ application/models/SecurityControlEnhancement.php	(revision 0)
@@ -0,0 +1,16 @@
+<?php
+
+/**
+ * SecurityControlEnhancement
+ * 
+ * This class has been auto-generated by the Doctrine ORM Framework
+ * 
+ * @package    ##PACKAGE##
+ * @subpackage ##SUBPACKAGE##
+ * @author     ##NAME## <##EMAIL##>
+ * @version    SVN: $Id: Builder.php 6401 2009-09-24 16:12:04Z guilhermeblanco $
+ */
+class SecurityControlEnhancement extends BaseSecurityControlEnhancement
+{
+
+}
\ No newline at end of file
Index: application/models/SecurityControlCatalog.php
===================================================================
--- application/models/SecurityControlCatalog.php	(revision 0)
+++ application/models/SecurityControlCatalog.php	(revision 0)
@@ -0,0 +1,16 @@
+<?php
+
+/**
+ * SecurityControlCatalog
+ * 
+ * This class has been auto-generated by the Doctrine ORM Framework
+ * 
+ * @package    ##PACKAGE##
+ * @subpackage ##SUBPACKAGE##
+ * @author     ##NAME## <##EMAIL##>
+ * @version    SVN: $Id: Builder.php 6401 2009-09-24 16:12:04Z guilhermeblanco $
+ */
+class SecurityControlCatalog extends BaseSecurityControlCatalog
+{
+
+}
\ No newline at end of file
Index: application/form/finding.form
===================================================================
--- application/form/finding.form	(revision 3558)
+++ application/form/finding.form	(working copy)
@@ -31,22 +31,29 @@
 elements.description.type = "textarea"
 elements.description.options.validators.mce.validator = "MceNotEmpty"
 elements.description.options.label = "Enter Description of Finding"
-elements.description.options.cols = "70%"
-elements.description.options.rows = "7"
+elements.description.options.cols = "100"
+elements.description.options.rows = "8"
 elements.description.options.required = true
 displayGroups.finding.elements.description = "description"
 
 elements.recommendation.type = "textarea"
 elements.recommendation.options.validators.mce.validator = "MceNotEmpty"
 elements.recommendation.options.label = "Recommendation"
-elements.recommendation.options.cols = "70%"
-elements.recommendation.options.rows = "7"
+elements.recommendation.options.cols = "100"
+elements.recommendation.options.rows = "8"
 elements.recommendation.options.required = true
 displayGroups.finding.elements.recommendation = "recommendation"
 
-elements.securityControlId.type = "select"
-elements.securityControlId.options.label = "Security Control"
-displayGroups.finding.elements.securityControlId = "securityControlId"
+elements.securityControlAutocomplete.type = "Form_AutoComplete"
+elements.securityControlAutocomplete.options.label = "Security Control"
+elements.securityControlAutocomplete.options.attribs.resultsList = "controls"
+elements.securityControlAutocomplete.options.attribs.fields = "name"
+elements.securityControlAutocomplete.options.attribs.xhr = "/security-control-catalog/autocomplete/format/json"
+elements.securityControlAutocomplete.options.attribs.hiddenField = "securityControlId"
+elements.securityControlAutocomplete.options.attribs.queryPrepend = "/keyword/"
+elements.securityControlAutocomplete.options.attribs.containerId = "securityControlAutocompleteContainer"
+elements.securityControlAutocomplete.options.tooltip = "<p>This is an autocomplete field. Start typing the name of the control or related keywords, and a list will pop up with matching controls. You must select a control from that list.</p>"
+displayGroups.finding.elements.securityControlAutocomplete = "securityControlAutocomplete"
 
 elements.threatLevel.type = "select"
 elements.threatLevel.options.label = "Threat Level"
@@ -57,8 +64,8 @@
 
 elements.threat.type = "textarea"
 elements.threat.options.label = "Threat Description"
-elements.threat.options.cols = "70%"
-elements.threat.options.rows = "7"
+elements.threat.options.cols = "100"
+elements.threat.options.rows = "8"
 displayGroups.finding.elements.threat = "threat"
 
 elements.orgSystemId.type = "select"
Index: application/form/asset.form
===================================================================
--- application/form/asset.form	(revision 3558)
+++ application/form/asset.form	(working copy)
@@ -35,10 +35,6 @@
 elements.product.options.attribs.containerId = "product_ac_container"
 displayGroups.assetInfo.elements.product = "product"
 
-elements.productId.type = "hidden"
-elements.productId.label = null
-elements.productId.options.hideLabel = true;
-
 elements.orgSystemId.type = "select"
 elements.orgSystemId.options.label = "System"
 elements.orgSystemId.options.style = "width:250px"
Index: application/form/security_control_catalog_toolbar.form
===================================================================
--- application/form/security_control_catalog_toolbar.form	(revision 0)
+++ application/form/security_control_catalog_toolbar.form	(revision 0)
@@ -0,0 +1,22 @@
+; This form is displayed in the toolbar section of the security catalog controller.
+;
+; Author    Mark E. Haase <mhaase@endeavorsystems.com
+; Copyright (c) Endeavor Systems, Inc. 2008 (http://www.endeavorsystems.com)
+; License   http://www.openfisma.org/mw/index.php?title=License
+; Version   $Id:$
+
+[security_control_catalog_toolbar]
+
+method=GET
+action=/security-control-catalog/list
+
+elements.id.type = "select"
+elements.id.options.label = "Catalog"
+; Options are added by the controller after the form is loaded
+elements.id.options.value = "0"
+
+elements.keyword.type = "text"
+elements.keyword.options.label = "Keywords"
+
+elements.search.type = "Form_Button_Submit"
+elements.search.options.label = "Search"
Index: application/form/finding_spreadsheet_download.form
===================================================================
--- application/form/finding_spreadsheet_download.form	(revision 0)
+++ application/form/finding_spreadsheet_download.form	(revision 0)
@@ -0,0 +1,22 @@
+; This is the form for uploading a scan result
+;
+; Author    Mark E. Haase <mhaase@endeavorsystems.com
+; Copyright (c) Endeavor Systems, Inc. 2009 (http://www.endeavorsystems.com)
+; License   http://openfisma.org/content/license
+; Version   $Id$
+
+[finding_spreadsheet_download]
+
+method=GET
+action=/finding/template
+
+elements.catalogId.type = "select"
+elements.catalogId.options.label = "Security Control Catalog"
+elements.catalogId.options.required = true
+elements.catalogId.options.tooltip = "<p> Each template file is generated for a particular security control catalog, such as NIST SP 800-53 Rev. 3. The template file will only contain the security controls that are pertinent to the catalog that you select.</p>"
+; The options for this selected are populated by the controller
+displayGroups.spreadsheetDownload.elements.catalogId = "catalogId"
+
+elements.download.type = "Form_Button_Submit"
+elements.download.options.label = "Download Template"
+displayGroups.spreadsheetDownload.elements.download = "download"
Index: application/form/finding_security_control.form
===================================================================
--- application/form/finding_security_control.form	(revision 0)
+++ application/form/finding_security_control.form	(revision 0)
@@ -0,0 +1,24 @@
+; This is the form for finding.
+;
+; This form should be loaded through FormManager::loadForm() in order to recieve
+; the proper decorators, filters, etc.
+;
+; Author    Ryan Yang <ryan@users.sourceforge.net>
+; Copyright (c) Endeavor Systems, Inc. 2008 (http://www.endeavorsystems.com)
+; License   http://www.openfisma.org/mw/index.php?title=License
+; Version   $Id$
+
+[finding_security_control]
+method = "post"
+
+elements.securityControlAutocomplete.type = "Form_AutoComplete"
+elements.securityControlAutocomplete.options.label = "Security Control Search:"
+elements.securityControlAutocomplete.options.attribs.resultsList = "controls"
+elements.securityControlAutocomplete.options.attribs.fields = "name"
+elements.securityControlAutocomplete.options.attribs.xhr = "/security-control-catalog/autocomplete/format/json"
+elements.securityControlAutocomplete.options.attribs.hiddenField = "finding[securityControlId]"
+elements.securityControlAutocomplete.options.attribs.queryPrepend = "/keyword/"
+elements.securityControlAutocomplete.options.attribs.containerId = "securityControlAutocompleteContainer"
+elements.securityControlAutocomplete.options.attribs.callback = "Fisma.Finding.handleSecurityControlSelection"
+elements.securityControlAutocomplete.options.tooltip = "<p>This is an autocomplete field. Start typing the name of the control or related keywords, and a list will pop up with matching controls. You must select a control from that list.</p>"
+displayGroups.finding.elements.securityControlAutocomplete = "securityControlAutocomplete"
Index: application/form/finding_spreadsheet_upload.form
===================================================================
--- application/form/finding_spreadsheet_upload.form	(revision 0)
+++ application/form/finding_spreadsheet_upload.form	(revision 0)
@@ -0,0 +1,21 @@
+; This is the form for uploading a finding spreadsheet template
+;
+; Author    Mark E. Haase <mhaase@endeavorsystems.com
+; Copyright (c) Endeavor Systems, Inc. 2009 (http://www.endeavorsystems.com)
+; License   http://openfisma.org/content/license
+; Version   $Id$
+
+[finding_spreadsheet_upload]
+
+method = POST
+action = /finding/upload-spreadsheet
+enctype = multipart/form-data
+
+elements.excelFile.type = "file"
+elements.excelFile.options.label = "Excel Spreadsheet"
+elements.excelFile.options.required = true
+displayGroups.spreadsheetUpload.elements.excelFile = "excelFile"
+
+elements.upload.type = "Form_Button_Submit"
+elements.upload.options.label = "Upload Spreadsheet"
+displayGroups.spreadsheetUpload.elements.submit = "upload"
Index: application/form/security_control_catalog_admin.form
===================================================================
--- application/form/security_control_catalog_admin.form	(revision 0)
+++ application/form/security_control_catalog_admin.form	(revision 0)
@@ -0,0 +1,22 @@
+; This form contains administrative options for the security catalog controller
+;
+; Author    Mark E. Haase <mhaase@endeavorsystems.com
+; Copyright (c) Endeavor Systems, Inc. 2008 (http://www.endeavorsystems.com)
+; License   http://www.openfisma.org/mw/index.php?title=License
+; Version   $Id:$
+
+[security_control_catalog_admin]
+
+method=POST
+action=/security-control-catalog-admin/save
+
+elements.defaultCatalog.type = "select"
+elements.defaultCatalog.options.label = "Default Control Catalog"
+elements.defaultCatalog.options.required = true
+elements.defaultCatalog.options.tooltip = "<p>The catalog selected here will be the default catalog displayed throughout the system whenever a security control selection is displayed. This is also the catalog which will be exported with the spreadsheet template for uploading findings.</p>"
+; The select options will be added dynamically by the controller
+displayGroups.general.elements.defaultCatalog = "defaultCatalog"
+
+elements.save.type = "Form_Button_Submit"
+elements.save.options.label = "Save"
+displayGroups.general.elements.save = "save"
Index: application/controllers/SecurityControlCatalogChartController.php
===================================================================
--- application/controllers/SecurityControlCatalogChartController.php	(revision 0)
+++ application/controllers/SecurityControlCatalogChartController.php	(revision 0)
@@ -0,0 +1,63 @@
+<?php
+/**
+ * Copyright (c) 2010 Endeavor Systems, Inc.
+ *
+ * This file is part of OpenFISMA.
+ *
+ * OpenFISMA is free software: you can redistribute it and/or modify it under the terms of the GNU General Public 
+ * License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later
+ * version.
+ *
+ * OpenFISMA is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied 
+ * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more 
+ * details.
+ *
+ * You should have received a copy of the GNU General Public License along with OpenFISMA.  If not, see 
+ * {@link http://www.gnu.org/licenses/}.
+ */
+
+/**
+ * Generate charts for the security control catalog
+ * 
+ * @author     Mark E. Haase
+ * @copyright  (c) Endeavor Systems, Inc. 2009 {@link http://www.endeavorsystems.com}
+ * @license    http://www.openfisma.org/content/license GPLv3
+ * @package    Controllers
+ * @version    $Id$
+ */
+class SecurityControlCatalogChartController extends SecurityControlCatalogBaseController
+{
+    /**
+     * Set contexts for this controller's actions
+     */
+    public function init()
+    {
+        parent::init();
+        
+        $this->_helper->fismaContextSwitch()
+                      ->setActionContext('control-deficiencies', 'xml')
+                      ->initContext();
+    }
+
+    /**
+     * Renders a bar chart that shows the number of open findings against each security control code.
+     */
+    public function controlDeficienciesAction()
+    {
+        $userOrganizations = $this->_me->getOrganizationsByPrivilege('organization', 'read')
+                             ->toKeyValueArray('id', 'id');
+        
+        $deficienciesQuery = Doctrine_Query::create()
+                             ->select('COUNT(*) AS count, sc.code')
+                             ->from('SecurityControl sc')
+                             ->innerJoin('sc.Findings f')
+                             ->innerJoin('f.ResponsibleOrganization o')
+                             ->andWhere('f.status <> ?', 'CLOSED')
+                             ->whereIn('o.id', $userOrganizations)
+                             ->groupBy('sc.code')
+                             ->orderBy('sc.code')
+                             ->setHydrationMode(Doctrine::HYDRATE_SCALAR);
+
+        $this->view->deficiencies = $deficienciesQuery->execute();
+    }
+}
Index: application/controllers/IncidentController.php
===================================================================
--- application/controllers/IncidentController.php	(revision 3558)
+++ application/controllers/IncidentController.php	(working copy)
@@ -764,14 +764,20 @@
         $incident = Doctrine::getTable('Incident')->find($incidentId);
 
         $this->_assertCurrentUserCanUpdateIncident($incidentId);
-
-        $userId = $this->getRequest()->getParam('userId');
+        
         $type = $this->getRequest()->getParam('type');
-
+        
         if (!in_array($type, array('actor', 'observer'))) {
             throw new Fisma_Zend_Exception("Invalid incident user type: '$type'");
         }
 
+        // The user ID is passed as observerId or actorId depending on which type is being submitted
+        if ('actor' == $type) {
+            $userId = $this->getRequest()->getParam('actorId');
+        } else {
+            $userId = $this->getRequest()->getParam('observerId');
+        }
+
         /*
          * User ID is supplied by an autocomplete. If the user did not use autocomplete, then check to see if the
          * username can be looked up.
Index: application/controllers/RemediationController.php
===================================================================
--- application/controllers/RemediationController.php	(revision 3558)
+++ application/controllers/RemediationController.php	(working copy)
@@ -1436,6 +1436,33 @@
     {
         $this->_viewFinding();
         $this->_helper->layout->setLayout('ajax');
+        
+        $form = Fisma_Zend_Form_Manager::loadForm('finding_security_control');
+
+        // Set up the available and default values for the form
+        $form->getElement('securityControlAutocomplete')->setValue($this->view->finding->securityControlId);
+        
+        $form->setDefaults($this->getRequest()->getParams());
+
+        // Don't want any form markup (since this is being embedded into an existing form), just the form elements
+        $form->setDecorators(
+            array(
+                'FormElements',
+                array('HtmlTag', array('tag' => 'span'))
+            )
+        );
+            
+        $form->setElementDecorators(array('RenderSelf', 'Label'), 'securityControlAutocomplete');
+
+        $this->view->form = $form;
+        
+        $this->view->securityControlSearchButton = new Fisma_Yui_Form_Button(
+            'securityControlSearchButton',
+            array(
+                'label' => 'Edit Security Control Mapping',
+                'onClickFunction' => 'Fisma.Finding.showSecurityControlSearch'
+            )
+        );
     }
     
     /** 
Index: application/controllers/SecurityControlCatalogController.php
===================================================================
--- application/controllers/SecurityControlCatalogController.php	(revision 0)
+++ application/controllers/SecurityControlCatalogController.php	(revision 0)
@@ -0,0 +1,220 @@
+<?php
+/**
+ * Copyright (c) 2010 Endeavor Systems, Inc.
+ *
+ * This file is part of OpenFISMA.
+ *
+ * OpenFISMA is free software: you can redistribute it and/or modify it under the terms of the GNU General Public 
+ * License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later
+ * version.
+ *
+ * OpenFISMA is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied 
+ * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more 
+ * details.
+ *
+ * You should have received a copy of the GNU General Public License along with OpenFISMA.  If not, see 
+ * {@link http://www.gnu.org/licenses/}.
+ */
+
+/**
+ * Search and view the various security control catalogs
+ * 
+ * @author     Mark E. Haase
+ * @copyright  (c) Endeavor Systems, Inc. 2009 {@link http://www.endeavorsystems.com}
+ * @license    http://www.openfisma.org/content/license GPLv3
+ * @package    Controllers
+ * @version    $Id$
+ */
+class SecurityControlCatalogController extends SecurityControlCatalogBaseController
+{
+    /**
+     * Set up context switch
+     */
+    public function init()
+    {
+        $this->_helper->fismaContextSwitch()
+                      ->addActionContext('autocomplete', 'json')
+                      ->addActionContext('search', 'json')
+                      ->initContext();
+    }
+    
+    /**
+     * Set up header and footer
+     */
+    public function preDispatch()
+    {
+        if (!$this->_hasParam('format')) {
+            $this->_helper->actionStack('header', 'panel');
+        }
+    }
+    
+    /**
+     * View information for a particular control
+     */
+    public function viewAction()
+    {
+        $securityControlId = $this->getRequest()->getParam('id');
+        
+        $securityControl = Doctrine::getTable('SecurityControl')->find($securityControlId);
+        
+        if (!$securityControl) {
+            throw new Fisma_Zend_Exception("No security control with id ($securityControlId) found.");
+        }
+        
+        $this->view->securityControl = $securityControl;
+    }
+    /**
+     * List all controls for the specified catalog
+     */
+    public function listAction()
+    {
+        $defaultCatalogId = Fisma::configuration()->getConfig('default_security_control_catalog_id');
+
+        $catalogId = (int)$this->getRequest()->getParam('id', $defaultCatalogId);
+        
+        // Look up the catalog and get its name
+        $catalog = Doctrine::getTable('SecurityControlCatalog')->find($catalogId);
+        
+        if (!$catalog) {
+            throw new Fisma_Zend_Exception("Invalid catalog ID ($catalogId)");
+        }
+        
+        $this->view->catalogName = $catalog->name;
+        
+        // Set up the base data URL, which includes the keyword parameter if it was specified
+        $keyword = $this->getRequest()->getParam('keyword');
+        
+        $dataUrl = "/security-control-catalog/search/id/$catalogId/format/json";
+        
+        if (!empty($keyword)) {
+            $dataUrl .= "/keyword/$keyword";
+        }
+        
+        // Create a YUI data table to display the controls
+        $controlTable = new Fisma_Yui_DataTable_Remote();
+        
+        $controlTable->addColumn(new Fisma_Yui_DataTable_Column('Code', true, null, 'sc_code'))
+                     ->addColumn(new Fisma_Yui_DataTable_Column('Name', true, null, 'sc_name'))
+                     ->addColumn(new Fisma_Yui_DataTable_Column('Class', true, null, 'sc_class'))
+                     ->addColumn(new Fisma_Yui_DataTable_Column('Family', true, null, 'sc_family'))
+                     ->addColumn(new Fisma_Yui_DataTable_Column('Priority', true, null, 'sc_priorityCode'))
+                     ->setResultVariable('controls')
+                     ->setDataUrl($dataUrl)
+                     ->setInitialSortColumn('sc_code')
+                     ->setSortAscending(true)
+                     ->setRowCount(10)
+                     ->setClickEventBaseUrl('/security-control-catalog/view/id/')
+                     ->setClickEventVariableName('sc_id');
+        
+        $this->view->controlTable = $controlTable;
+        
+        $this->view->toolbarForm = $this->_getToolbarForm();
+    }
+    
+    /**
+     * A helper action for autocomplete text boxes
+     */
+    public function autocompleteAction()
+    {
+        $keyword = $this->getRequest()->getParam('keyword');
+        
+        $controlQuery = Doctrine_Query::create()
+                        ->from('SecurityControl sc')
+                        ->innerJoin('sc.Catalog c')
+                        ->select("sc.id,
+                                  CONCAT(sc.code, ' ', sc.name, ' [', c.name, ']') AS name")
+                        ->where('sc.code LIKE ?', "$keyword%")
+                        ->orderBy("sc.code")
+                        ->setHydrationMode(Doctrine::HYDRATE_ARRAY);
+
+        $this->view->controls = $controlQuery->execute();
+    }
+    
+    /**
+     * Render a single control as a table
+     * 
+     * This view can also be invoked as a partial, so it can be embedded into other views or fetched with an XHR.
+     */
+    public function singleControlAction()
+    {
+        $this->_helper->layout->disableLayout(true);
+        
+        // Clear the action stack
+        $stack = Zend_Controller_Front::getInstance()->getPlugin('Zend_Controller_Plugin_ActionStack');
+
+        while ($stack->popStack()) {
+            ;
+        }
+                
+        $securityControlId = $this->getRequest()->getParam('id');
+        
+        $this->view->securityControl = Doctrine::getTable('SecurityControl')->find($securityControlId);
+    }
+    
+    /**
+     * Search the specified control catalog and return all matching controls in JSON context
+     */
+    public function searchAction()
+    {
+        // Read parameters and set defaults
+        $defaultCatalogId = Fisma::configuration()->getConfig('default_security_control_catalog_id');
+        
+        $request = $this->getRequest();
+        $catalogId = $request->getParam('id', $defaultCatalogId); 
+        $sortField = $request->getParam('sort', 'sc_code');
+        $sortDir = $request->getParam('dir', 'asc');
+        $startRow = $request->getParam('start', 0);
+        $maxRows = $request->getParam('count', 10);
+        $keyword = $request->getParam('keyword');
+
+        // Convert sort field from doctrine scalar naming convention to object notation (eg. sc_code to sc.code)
+        $sortField = str_replace('_', '.', $sortField);
+                
+        // Get a list of all the controls in this catalog
+        $controlQuery = Doctrine_Query::create()
+                        ->from('SecurityControl sc')
+                        ->select('sc.id,
+                                  sc.code, 
+                                  sc.name,
+                                  sc.class, 
+                                  sc.family, 
+                                  sc.priorityCode')
+                        ->where('securityControlCatalogId = ?', array($catalogId))
+                        ->orderBy("$sortField $sortDir")
+                        ->limit($maxRows)
+                        ->offset($startRow)
+                        ->setHydrationMode(Doctrine::HYDRATE_SCALAR);
+
+        // If a keyword is specified, augment the query with it
+        if (!empty($keyword)) {
+            
+            /*
+             * Because of the way Lucene handles special characters, and the fact that searching for hyphenated control 
+             * names is a common use case, we add special logic to handle queries for a specific control name
+             */
+            $matches = array();
+            if (preg_match('/\w\w\-\d\d/', $keyword, $matches)) {
+                
+                $controlQuery->andWhere('sc.code LIKE ?', $matches[0]);
+            } else {
+                $index = new Fisma_Index('SecurityControl');
+
+                $matchedIds = $index->findIds($keyword);
+
+                if (count($matchedIds) == 0) {
+                    /*
+                     * Doctrine "helpfully" strips out your IN clause if the array is empty, so if there are no hits
+                     * in the Lucene index, we need to add an impossible condition to the query.
+                     */
+                    $controlQuery->andWhere('1 = 2');
+                } else {
+                    $controlQuery->andWhereIn('sc.id', $matchedIds);                    
+                }
+            }
+        }
+
+        $controls = $controlQuery->execute();
+
+        $this->view->controls = $controls;
+    }
+}
Index: application/controllers/SecurityControlCatalogAdminController.php
===================================================================
--- application/controllers/SecurityControlCatalogAdminController.php	(revision 0)
+++ application/controllers/SecurityControlCatalogAdminController.php	(revision 0)
@@ -0,0 +1,81 @@
+<?php
+/**
+ * Copyright (c) 2010 Endeavor Systems, Inc.
+ *
+ * This file is part of OpenFISMA.
+ *
+ * OpenFISMA is free software: you can redistribute it and/or modify it under the terms of the GNU General Public 
+ * License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later
+ * version.
+ *
+ * OpenFISMA is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied 
+ * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more 
+ * details.
+ *
+ * You should have received a copy of the GNU General Public License along with OpenFISMA.  If not, see 
+ * {@link http://www.gnu.org/licenses/}.
+ */
+
+/**
+ * Administration for the security control catalog controller
+ * 
+ * @author     Mark E. Haase
+ * @copyright  (c) Endeavor Systems, Inc. 2009 {@link http://www.endeavorsystems.com}
+ * @license    http://www.openfisma.org/content/license GPLv3
+ * @package    Controllers
+ * @subpackage SUBPACKAGE
+ * @version    $Id$
+ */
+class SecurityControlCatalogAdminController extends SecurityControlCatalogBaseController
+{
+    /**
+     * Check ACL and setup header/footer
+     */
+    public function preDispatch()
+    {
+        $this->_acl->requireArea('system_inventory_admin');
+
+        if (!$this->_hasParam('format')) {
+            $this->_helper->actionStack('header', 'panel');
+        }
+    }
+
+    /**
+     * Display administrative configuration options
+     */
+    public function indexAction()
+    {
+        $form = Fisma_Zend_Form_Manager::loadForm('security_control_catalog_admin');
+        
+        Fisma_Zend_Form_Manager::prepareForm($form);
+        
+        $currentSetting = Fisma::configuration()->getConfig('default_security_control_catalog_id');
+        
+        $form->getElement('defaultCatalog')
+             ->addMultiOptions($this->_getCatalogs())
+             ->setValue($currentSetting);
+        
+        $this->view->form = $form;
+    }
+    
+    /**
+     * Persist any changes to the administration section and redirect back to the admin action
+     */
+    public function saveAction()
+    {
+        $newDefaultCatalogId = (int)$this->getRequest()->getParam('defaultCatalog');
+        
+        // Validate that the supplied ID actually exists
+        $newDefaultCatalog = Doctrine::getTable('SecurityControlCatalog')->find($newDefaultCatalogId);
+        
+        if ($newDefaultCatalog) {
+            Fisma::configuration()->setConfig('default_security_control_catalog_id', $newDefaultCatalogId);
+            
+            $this->view->priorityMessenger('Configuration saved.', 'notice');
+        } else {
+            $this->view->priorityMessenger("Invalid catalog id ($newDefaultCatalogId)", 'warning');
+        }
+        
+        $this->_redirect('/security-control-catalog-admin/index');
+    }
+}
Index: application/controllers/FindingDashboardController.php
===================================================================
--- application/controllers/FindingDashboardController.php	(revision 0)
+++ application/controllers/FindingDashboardController.php	(revision 0)
@@ -0,0 +1,50 @@
+<?php
+/**
+ * Copyright (c) 2010 Endeavor Systems, Inc.
+ *
+ * This file is part of OpenFISMA.
+ *
+ * OpenFISMA is free software: you can redistribute it and/or modify it under the terms of the GNU General Public 
+ * License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later
+ * version.
+ *
+ * OpenFISMA is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied 
+ * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more 
+ * details.
+ *
+ * You should have received a copy of the GNU General Public License along with OpenFISMA.  If not, see 
+ * {@link http://www.gnu.org/licenses/}.
+ */
+
+/**
+ * Dashboard for findings
+ * 
+ * @author     Mark E. Haase
+ * @copyright  (c) Endeavor Systems, Inc. 2009 {@link http://www.endeavorsystems.com}
+ * @license    http://www.openfisma.org/content/license GPLv3
+ * @package    Controllers
+ * @version    $Id$
+ */
+class FindingDashboardController extends SecurityController
+{
+    /**
+     * Set up headers/footers
+     */
+    public function preDispatch()
+    {
+        $this->_acl->requireArea('finding');
+
+        if (!$this->_hasParam('format')) {
+            $this->_helper->actionStack('header', 'panel');
+        }
+    }
+
+    public function indexAction()
+    {
+        $this->view->controlDeficienciesChart = new Fisma_Chart(
+            '/security-control-catalog-chart/control-deficiencies/format/xml', 
+            700, 
+            300
+        );
+    }
+}
Index: application/controllers/SecurityControlCatalogBaseController.php
===================================================================
--- application/controllers/SecurityControlCatalogBaseController.php	(revision 0)
+++ application/controllers/SecurityControlCatalogBaseController.php	(revision 0)
@@ -0,0 +1,80 @@
+<?php
+/**
+ * Copyright (c) 2010 Endeavor Systems, Inc.
+ *
+ * This file is part of OpenFISMA.
+ *
+ * OpenFISMA is free software: you can redistribute it and/or modify it under the terms of the GNU General Public 
+ * License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later
+ * version.
+ *
+ * OpenFISMA is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied 
+ * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more 
+ * details.
+ *
+ * You should have received a copy of the GNU General Public License along with OpenFISMA.  If not, see 
+ * {@link http://www.gnu.org/licenses/}.
+ */
+
+/**
+ * A base controller for the security control catalogs
+ * 
+ * @author     Mark E. Haase
+ * @copyright  (c) Endeavor Systems, Inc. 2009 {@link http://www.endeavorsystems.com}
+ * @license    http://www.openfisma.org/content/license GPLv3
+ * @package    Controllers
+ * @subpackage SUBPACKAGE
+ * @version    $Id$
+ */
+class SecurityControlCatalogBaseController extends SecurityController
+{
+    /**
+     * A helper function to create the objects required to render the toolbar partial
+     * 
+     * @return Zend_Form
+     */
+    protected function _getToolbarForm()
+    {
+        $form = Fisma_Zend_Form_Manager::loadForm('security_control_catalog_toolbar');
+
+        // Set up the available and default values for the form
+        $form->getElement('id')
+             ->addMultiOptions($this->_getCatalogs())
+             ->setValue(Fisma::configuration()->getConfig('default_security_control_catalog_id'));
+        
+        $form->setDefaults($this->getRequest()->getParams());
+
+        // These are standard decorators
+        $form->setDecorators(
+            array(
+                'FormElements',
+                array('HtmlTag', array('tag' => 'span')),
+                'Form'
+            )
+        );
+            
+        // View helper and label decorators on all elements except the search button
+        $form->setElementDecorators(array('ViewHelper', 'Label'));
+        $form->getElement('search')->removeDecorator('Label');
+        
+        return $form;
+    }
+    
+    /**
+     * Get an array of catalogs by id and name, in a format that is compatible with 
+     * Zend_Form_Element_Select#addMultiOptions()
+     * 
+     * @return array
+     */
+    protected function _getCatalogs()
+    {
+        // Get data for the select element. Columns are aliased as 'key' and 'value' for addMultiOptions().
+        $catalogQuery = Doctrine_Query::create()
+                        ->select('id AS key, name AS value')
+                        ->from('SecurityControlCatalog')
+                        ->orderBy('name')
+                        ->setHydrationMode(Doctrine::HYDRATE_ARRAY);
+
+        return $catalogQuery->execute();
+    }
+}
Index: application/controllers/ConfigController.php
===================================================================
--- application/controllers/ConfigController.php	(revision 3558)
+++ application/controllers/ConfigController.php	(working copy)
@@ -151,12 +151,11 @@
         }
 
         $dataTable = new Fisma_Yui_DataTable_Local();
-
-        $dataTable->setData($ldapList);
             
-        $dataTable->addColumn(new Fisma_Yui_DataTable_Column('Connection', false, 'YAHOO.widget.DataTable.formatText'));
-        $dataTable->addColumn(new Fisma_Yui_DataTable_Column('Edit', false, 'Fisma.TableFormat.editControl'));
-        $dataTable->addColumn(new Fisma_Yui_DataTable_Column('Delete', false, 'Fisma.TableFormat.deleteControl'));
+        $dataTable->addColumn(new Fisma_Yui_DataTable_Column('Connection', false, 'YAHOO.widget.DataTable.formatText'))
+                  ->addColumn(new Fisma_Yui_DataTable_Column('Edit', false, 'Fisma.TableFormat.editControl'))
+                  ->addColumn(new Fisma_Yui_DataTable_Column('Delete', false, 'Fisma.TableFormat.deleteControl'))
+                  ->setData($ldapList);
 
         $this->view->dataTable = $dataTable;
     }
Index: application/controllers/FindingController.php
===================================================================
--- application/controllers/FindingController.php	(revision 3558)
+++ application/controllers/FindingController.php	(working copy)
@@ -65,14 +65,7 @@
         foreach ($sources as $source) {
             $form->getElement('sourceId')->addMultiOptions(array($source['id'] => html_entity_decode($source['name'])));
         }
-    
-        $securityControls = Doctrine::getTable('SecurityControl')->findAll()->toArray();
-        $form->getElement('securityControlId')->addMultiOptions(array(0 => '--select--'));
-        foreach ($securityControls as $securityControl) {
-            $form->getElement('securityControlId')
-                 ->addMultiOptions(array($securityControl['id'] => $securityControl['code']));
-        }
-        
+            
         $systems = $this->_me->getOrganizationsByPrivilege('finding', 'create');
         $selectArray = $this->view->treeToSelect($systems, 'nickname');
         $form->getElement('orgSystemId')->addMultiOptions($selectArray);
@@ -161,14 +154,40 @@
     {
         $this->_acl->requirePrivilegeForClass('inject', 'Finding');
 
-        /** @todo convert this to a Zend_Form */
-        // If the form isn't submitted, then there is no work to do
-        if (!isset($_POST['uploadExcelSubmit'])) {
-            return;
-        }
+        // Set up the form for downloading template files
+        $downloadForm = Fisma_Zend_Form_Manager::loadForm('finding_spreadsheet_download');
         
-        // If the form is submitted, then the file object should contain an array
+        Fisma_Zend_Form_Manager::prepareForm($downloadForm);
+
+        $catalogQuery = Doctrine_Query::create()
+                        ->select('id AS key, name AS value')
+                        ->from('SecurityControlCatalog')
+                        ->orderBy('name')
+                        ->setHydrationMode(Doctrine::HYDRATE_ARRAY);
+
+        $catalogs = $catalogQuery->execute();
+
+        $downloadForm->getElement('catalogId')
+                     ->setMultiOptions($catalogs)
+                     ->setValue(Fisma::configuration()->getConfig('default_security_control_catalog_id'));
+        
+        $this->view->downloadForm = $downloadForm;
+        
+        // Set up the form for uploading files
+        $uploadForm = Fisma_Zend_Form_Manager::loadForm('finding_spreadsheet_upload');
+        
+        Fisma_Zend_Form_Manager::prepareForm($uploadForm);
+        
+        $this->view->uploadForm = $uploadForm;
+    }
+
+    /**
+     * Handle upload of a spreadsheet template file
+     */
+    public function uploadSpreadsheetAction()
+    {
         $file = $_FILES['excelFile'];
+        
         if (!is_array($file)) {
             $this->view->priorityMessenger("The file upload failed.", 'warning');
             return;
@@ -182,13 +201,17 @@
                 
                 // get upload path
                 $path = Fisma::getPath('data') . '/uploads/spreadsheet/';
+                
                 // get original file name
                 $originalName = pathinfo($file['name'], PATHINFO_FILENAME);
+                
                 // get current time and set to a format like '_2009-05-04_11_22_02'
                 $ts = time();
                 $dateTime = date('_Y-m-d_H_i_s', $ts);
+                
                 // define new file name
                 $newName = str_replace($originalName, $originalName . $dateTime, $file['name']);
+                
                 // organize upload data
                 $upload = new Upload();
                 $upload->userId = $this->_me->id;
@@ -198,6 +221,7 @@
                 $injectExcel = new Fisma_Inject_Excel();
 
                 $rowsProcessed = $injectExcel->inject($file['tmp_name'], $upload->id);
+                
                 // upload file after the file parsed
                 move_uploaded_file($file['tmp_name'], $path . $newName);
                 
@@ -206,12 +230,13 @@
                 $type  = 'notice';
             } catch (Fisma_Zend_Exception_InvalidFileFormat $e) {
                 Doctrine_Manager::connection()->rollback();
-                $error = "The file cannot be processed due to an error.<br>{$e->getMessage()}";
+                $error = "The file cannot be processed due to an error: {$e->getMessage()}";
                 $type  = 'warning';
             }
             $this->view->priorityMessenger($error, $type);
         }
-        $this->render();
+        
+        $this->_redirect('/panel/finding/sub/injection');
     }
 
     /** 
@@ -282,7 +307,23 @@
                     defined.");
             }
             
-            $securityControls = Doctrine::getTable('SecurityControl')->findAll()->toArray();
+            $securityControlCatalogId = $this->getRequest()->getParam('catalogId');
+            $this->view->securityControlCatalogId = $securityControlCatalogId;
+
+            $securityControlCatalog = Doctrine::getTable('SecurityControlCatalog')->find($securityControlCatalogId);
+            
+            if (!$securityControlCatalog) {
+                throw new Fisma_Zend_Exception("No security control exists with id ($securityControlCatalogId)");
+            } else {
+                $this->view->securityControlCatalogName = $securityControlCatalog->name;
+            }
+            
+            $securityControlQuery = Doctrine_Query::create()
+                                    ->from('SecurityControl')
+                                    ->where('securityControlCatalogId = ?', array($securityControlCatalogId));
+            
+            $securityControls = $securityControlQuery->execute();
+            
             $this->view->securityControls = array();
             foreach ($securityControls as $securityControl) {
                 $this->view->securityControls[$securityControl['id']] = $securityControl['code'];
Index: application/doctrine/schema/SecurityControlCatalog.yml
===================================================================
--- application/doctrine/schema/SecurityControlCatalog.yml	(revision 0)
+++ application/doctrine/schema/SecurityControlCatalog.yml	(revision 0)
@@ -0,0 +1,9 @@
+SecurityControlCatalog:
+    listeners: [IndexListener]
+
+    columns:
+        name: 
+            type: string
+            fixed: true
+            extra:
+                searchIndex: unstored
Index: application/doctrine/schema/SecurityControl.yml
===================================================================
--- application/doctrine/schema/SecurityControl.yml	(revision 3558)
+++ application/doctrine/schema/SecurityControl.yml	(working copy)
@@ -1,5 +1,5 @@
 SecurityControl:
-    listeners: [IndexListener]
+    listeners: [XssListener, IndexListener]
 
     columns:
         code: 
@@ -8,38 +8,55 @@
             comment: The control number, e.g. AC-05
             extra:
                 searchIndex: unstored
+        name:
+            type: string(255)
+            comment: Name of the control
+            extra:
+                searchIndex: unstored
         class:
             type: enum
             values: [MANAGEMENT, OPERATIONAL, TECHNICAL]
             extra:
                 searchIndex: keyword
-        subclass: 
-            type: string(255)
-            extra:
-                searchIndex: unstored
         family: 
             type: string(255)
             extra:
                 searchIndex: unstored
+                
         control: 
             type: string
             extra:
                 searchIndex: unstored
-        guidance: 
+                purify: html
+        supplementalGuidance: 
             type: string
             extra:
                 searchIndex: unstored
+                purify: html
+        externalReferences:
+            type: string
+            extra:
+                searchIndex: unstored
+                purify: html
+        priorityCode:
+            type: enum
+            values: [P0, P1, P2, P3]
+            extra:
+                searchIndex: keyword
         controlLevel:
             type: enum
             values: [NONE, LOW, MODERATE, HIGH]
             extra:
                 searchIndex: keyword
                 searchAlias: level
-        enhancements: 
-            type: string
-            extra:
-                searchIndex: unstored
-        supplement: 
-            type: string
-            extra:
-                searchIndex: unstored
+                
+        securityControlCatalogId:
+            type: integer
+            comment: Foreign key to the catalog which this control belongs to
+
+    relations:
+        Catalog:
+            class: SecurityControlCatalog
+            local: securityControlCatalogId
+            foreign: id
+            foreignAlias: Controls
Index: application/doctrine/schema/SecurityControlEnhancement.yml
===================================================================
--- application/doctrine/schema/SecurityControlEnhancement.yml	(revision 0)
+++ application/doctrine/schema/SecurityControlEnhancement.yml	(revision 0)
@@ -0,0 +1,23 @@
+SecurityControlEnhancement:
+    listeners: [XssListener]
+
+    columns:
+        level:
+            type: enum
+            values: [LOW, MODERATE, HIGH]
+            comment: Indicates the lowest baseline that includes this enhancement.
+        description:
+            type: string
+            extra:
+                purify: html
+                
+        securityControlId:
+            type: integer
+            comment: Foreign key
+    
+    relations:
+        Control:
+            class: SecurityControl
+            local: securityControlId
+            foreign: id
+            foreignAlias: Enhancements
Index: application/doctrine/data/fixtures/MigrationVersion.yml
===================================================================
--- application/doctrine/data/fixtures/MigrationVersion.yml	(revision 3558)
+++ application/doctrine/data/fixtures/MigrationVersion.yml	(working copy)
@@ -1,3 +1,3 @@
 MigrationVersion:
     currentSchemaVersion:
-        version: 57
+        version: 60
Index: application/doctrine/data/fixtures/SecurityControlCatalog.yml
===================================================================
--- application/doctrine/data/fixtures/SecurityControlCatalog.yml	(revision 0)
+++ application/doctrine/data/fixtures/SecurityControlCatalog.yml	(revision 0)
@@ -0,0 +1,12 @@
+# All new catalogs should be appended. None should be inserted in the middle, as the configuration fixure relies
+# on these catalogs having predictable primary keys. See Configuration.yml:175-178.
+
+SecurityControlCatalog:
+    800_53_Rev_0:
+        name: NIST SP 800-53 Rev. 0
+    800_53_Rev_1:
+        name: NIST SP 800-53 Rev. 1
+    800_53_Rev_2:
+        name: NIST SP 800-53 Rev. 2
+    800_53_Rev_3:
+        name: NIST SP 800-53 Rev. 3
Index: application/doctrine/data/fixtures/Configuration.yml
===================================================================
--- application/doctrine/data/fixtures/Configuration.yml	(revision 3558)
+++ application/doctrine/data/fixtures/Configuration.yml	(working copy)
@@ -171,3 +171,8 @@
     yui_version:
         name: yui_version
         value: 2.8.0r4
+
+    default_security_control_catalog_id:
+        name: default_security_control_catalog_id
+        value: 4 # Default value points to NIST SP 800-53 Rev3
+        description: The ID of the default security control catalog which is used when the user doesn't explicitly specify a security control catalog.
Index: application/doctrine/data/fixtures/SecurityControl.yml
===================================================================
--- application/doctrine/data/fixtures/SecurityControl.yml	(revision 3558)
+++ application/doctrine/data/fixtures/SecurityControl.yml	(working copy)
@@ -1,1881 +1,215 @@
+#Can this be split into 4 separate files? Would help with migration.
 SecurityControl:
-    AC-01:
+    Rev0_AC_01:
         code: AC-01
+        name: Access Control Policy And Procedures
         class: TECHNICAL
-        subclass: Access Control Policy and Procedures 
         family: Access Control
-        control: The organization develops, disseminates, and periodically reviews/updates: (i) a formal, documented, access control policy that addresses purpose, scope, roles, responsibilities, management commitment, coordination among organizational entities, and compliance; and (ii) formal, documented procedures to facilitate the implementation of the access control policy and associated access controls.
-        guidance: The access control policy and procedures are consistent with applicable laws, Executive Orders, directives, policies, regulations, standards, and guidance. The access control policy can be included as part of the general information security policy for the organization. Access control procedures can be developed for the security program in general, and for a particular information system, when required. NIST Special Publication 800-12 provides guidance on security policies and procedures.
+        control: >
+            The organization develops, disseminates, and periodically reviews/updates: <ol><li>aformal, documented,
+            access control policy that addresses purpose, scope, roles, responsibilities, and compliance; and</li><li>
+            formal, documented procedures to facilitate the implementation of the access control policy and associated
+            access controls.</li></ol>
+        supplementalGuidance: >
+            The access control policy and procedures are consistent with applicable federal laws, directives, policies, 
+            regulations, standards, and guidance. The access control policy can be included as part of the general 
+            information security policy for the organization. Access control procedures can be developed for the 
+            security program in general, and for a particular information system, when required. NIST Special 
+            Publication 800-12 provides guidance on security policies and procedures.
         controlLevel: LOW
-        enhancements: None
-        supplement: None
+        Catalog: 800_53_Rev_0
 
-    AC-02:
+    Rev0_AC_02:
         code: AC-02
+        name: Account Management
         class: TECHNICAL
-        subclass: Account Management 
         family: Access Control
-        control: The organization manages information system accounts, including establishing, activating, modifying, reviewing, disabling, and removing accounts. The organization reviews information system accounts [Assignment: organization-defined frequency, at least annually].
-        guidance: Account management includes the identification of account types (i.e., individual, group, and system), establishment of conditions for group membership, and assignment of associated authorizations. The organization identifies authorized  of the information system and specifies access rights/privileges. The organization grants access to the information system based on: (i) a valid need-to-know/need-to-share that is determined by assigned official duties and satisfying all personnel security criteria; and (ii) intended system usage. The organization requires proper identification for requests to establish information system accounts and approves all such requests. The organization specifically authorizes and monitors the use of guest/anonymous accounts and removes, disables, or otherwise secures unnecessary accounts. Account managers are notified when information system users are terminated or transferred and associated accounts are removed, disabled, or otherwise secured. Account managers are also notified when users' information system usage or need-to-know/need-to-share changes.
+        control: >
+            The organization manages information system accounts, including establishing, activating, modifying,
+            reviewing, disabling, and removing accounts. The organization reviews information system accounts
+            [<em>Assignment: organization-defined frequency, at least annually</em>].
+        supplementalGuidance: >
+            Account management includes the identification of account types (i.e., individual, group, and system), 
+            establishment of conditions for group membership, and assignment of associated authorizations. The 
+            organization identifies authorized users of the information system and specifies access rights/privileges. 
+            The organization grants access to the information system based on: <ol><li>a valid need-to-know that is 
+            determined by assigned official duties and satisfying all personnel security criteria; and</li><li>intended 
+            system usage.</li></ol> The organization requires proper identification for requests to establish 
+            information system accounts and approves all such requests. The organization specifically authorizes and 
+            monitors the use of guest/anonymous accounts and removes, disables, or otherwise secures unnecessary 
+            accounts. The organization ensures that account managers are notified when information system users are 
+            terminated or transferred and associated accounts are removed, disabled, or otherwise secured. Account 
+            managers are also notified when users information system usage or need-to-know changes.
         controlLevel: LOW
-        enhancements: (1)\nThe organization employs automated mechanisms to support the management of information system accounts.\n(2)\nThe information system automatically terminates temporary and emergency accounts after [Assignment: organization-defined time period for each type of account].\n(3)\nThe information system automatically disables inactive accounts after [Assignment: organization-defined time period].\n(4)\nThe organization employs automated mechanisms to audit account creation, modification, disabling, and termination actions and to notify, as required, appropriate individuals.
-        supplement: Medium: (1) (2) (3) (4)High: (1) (2) (3) (4)
+        Catalog: 800_53_Rev_0
+        
+    # Rest of Rev 0 controls go here
+    # ...
 
-    AC-03:
-        code: AC-03
+    Rev1_AC_01:
+        code: AC-01
+        name: Access Control Policy And Procedures
         class: TECHNICAL
-        subclass: Access Enforcement 
         family: Access Control
-        control: The information system enforces assigned authorizations for controlling access to the system in accordance with applicable policy.
-        guidance: Access control policies (e.g., identity-based policies, role-based policies, rule-based policies) and associated access enforcement mechanisms (e.g., access control lists, access control matrices, cryptography) are employed by organizations to control access between users (or processes acting on behalf of users) and objects (e.g., devices, files, records, processes, programs, domains) in the information system. In addition to controlling access at the information system level, access enforcement mechanisms are employed at the application level, when necessary, to provide increased information security for the organization. Consideration is given to the implementation of a controlled, audited, and manual override of automated mechanisms in the event of emergencies or other serious events. If encryption of stored information is employed as an access enforcement mechanism, the cryptography used is FIPS 140-2 (as amended) compliant. Related security control: SC-13.
+        control: >
+            The organization develops, disseminates, and periodically reviews/updates: 
+            <ol><li>a formal, documented, access control policy that addresses purpose, scope, roles, responsibilities,
+            management commitment, coordination among organizational entities, and compliance; and</li><li>formal,
+            documented procedures to facilitate the implementation of the access control policy and associated access
+            controls.</li></ol>
+        supplementalGuidance: >
+            The access control policy and procedures are consistent with applicable laws, Executive Orders, directives,
+            policies, regulations, standards, and guidance. The access control policy can be included as part of the
+            general information security policy for the organization. Access control procedures can be developed for
+            the security program in general, and for a particular information system, when required. NIST Special
+            Publication 800-12 provides guidance on security policies and procedures.
         controlLevel: LOW
-        enhancements: (1)\nThe information system restricts access to privileged functions (deployed in hardware, software, and firmware) and security-relevant information to explicitly authorized personnel.\nEnhancement Supplemental Guidance: Explicitly authorized personnel include, for example, security administrators, system and network administrators, and other privileged users. Privileged users are individuals who have access to system control, monitoring, or administration functions (e.g., system administrators, information system security officers, maintainers, system programmers). 
-        supplement: Medium: (1) High: (1) 
+        Catalog: 800_53_Rev_1
 
-    AC-04:
-        code: AC-04
+    Rev1_AC_02:
+        code: AC-02
+        name: Account Management
         class: TECHNICAL
-        subclass: Information Flow Enforcement 
         family: Access Control
-        control: The information system enforces assigned authorizations for controlling the flow of information within the system and between interconnected systems in accordance with applicable policy.
-        guidance: Information flow control regulates where information is allowed to travel within an information system and between information systems (as opposed to who is allowed to access the information) and without explicit regard to subsequent accesses to that information. A few, of many, generalized examples of possible restrictions that are better expressed as flow control than access control are: keeping export controlled information from being transmitted in the clear to the Internet, blocking outside traffic that claims to be from within the organization, and not passing any web requests to the Internet that are not from the internal web proxy. Information flow control policies and enforcement mechanisms are commonly employed by organizations to control the flow of information between designated sources and destinations (e.g., networks, individuals, devices) within information systems and between interconnected systems. Flow control is based on the characteristics of the information and/or the information path. Specific examples of flow control enforcement can be found in boundary protection devices (e.g., proxies, gateways, guards, encrypted tunnels, firewalls, and routers) that employ rule sets or establish configuration settings that restrict information system services or provide a packet filtering capability. Related security control: SC-7.
-        controlLevel: MODERATE
-        enhancements: (1)\nThe information system implements information flow control enforcement using explicit labels on information, source, and destination objects as a basis for flow control decisions.\nEnhancement Supplemental Guidance: Information flow control enforcement using explicit labels is used, for example, to control the release of certain types of information.\n(2)\nThe information system implements information flow control enforcement using protected processing domains (e.g., domain type-enforcement) as a basis for flow control decisions.\n(3)\nThe information system implements information flow control enforcement using dynamic security policy mechanisms as a basis for flow control decisions.
-        supplement: None 
-
-    AC-05:
-        code: AC-05
-        class: TECHNICAL
-        subclass: Separation of Duties 
-        family: Access Control
-        control: The information system enforces separation of duties through assigned access authorizations.
-        guidance: The organization establishes appropriate divisions of responsibility and separates duties as needed to eliminate conflicts of interest in the responsibilities and duties of individuals. There is access control software on the information system that prevents users from having all of the necessary authority or information access to perform fraudulent activity without collusion. Examples of separation of duties include: (i) mission functions and distinct information system support functions are divided among different individuals/roles; (ii) different individuals perform information system support functions (e.g., system management, systems programming, quality assurance/testing, configuration management, and network security); and (iii) security personnel who administer access control functions do not administer audit functions.
-        controlLevel: MODERATE
-        enhancements: None
-        supplement: None
-
-    AC-06:
-        code: AC-06
-        class: TECHNICAL
-        subclass: Least Privilege 
-        family: Access Control
-        control: The information system enforces the most restrictive set of rights/privileges or accesses needed by users (or processes acting on behalf of users) for the performance of specified tasks.
-        guidance: The organization employs the concept of least privilege for specific duties and information systems (including specific ports, protocols, and services) in accordance with risk assessments as necessary to adequately mitigate risk to organizational operations, organizational assets, and individuals.
-        controlLevel: MODERATE
-        enhancements: None
-        supplement: None
-
-    AC-07:
-        code: AC-07
-        class: TECHNICAL
-        subclass: Unsuccessful Login Attempts 
-        family: Access Control
-        control: The information system enforces a limit of [Assignment: organization-defined number] consecutive invalid access attempts by a user during a [Assignment: organization-defined time period] time period. The information system automatically [Selection: locks the account/node for an [Assignment: organization-defined time period], delays next login prompt according to [Assignment: organization-defined delay algorithm.]] when the maximum number of unsuccessful attempts is exceeded.
-        guidance: Due to the potential for denial of service, automatic lockouts initiated by the information system are usually temporary and automatically release after a predetermined time period established by the organization.
+        control: >
+            The organization manages information system accounts, including establishing, activating, modifying,
+            reviewing, disabling, and removing accounts. The organization reviews information system accounts
+            [<em>Assignment: organization-defined frequency, at least annually</em>].
+        supplementalGuidance: >
+            Account management includes the identification of account types (i.e., individual, group, and system),
+            establishment of conditions for group membership, and assignment of associated authorizations. The
+            organization identifies authorized users of the information system and specifies access rights/privileges.
+            The organization grants access to the information system based on: <ol><li>a valid
+            need-to-know/need-to-share that is determined by assigned official duties and satisfying all personnel
+            security criteria; and</li><li>intended system usage.</ol> The organization requires proper identification
+            for requests to establish information system accounts and approves all such requests. The organization
+            specifically authorizes and monitors the use of guest/anonymous accounts and removes, disables, or otherwise
+            secures unnecessary accounts. Account managers are notified when information system users are terminated or
+            transferred and associated accounts are removed, disabled, or otherwise secured. Account managers are also
+            notified when users information system usage or need-to-know/need-to-share changes.
         controlLevel: LOW
-        enhancements: (1)\nThe information system automatically locks the account/node until released by an administrator when the maximum number of unsuccessful attempts is exceeded.
-        supplement: None 
+        Catalog: 800_53_Rev_1
+        
+    # Rest of Rev 1 controls go here
+    # ...
 
-    AC-08:
-        code: AC-08
+    Rev2_AC_01:
+        code: AC-01
+        name: Access Control Policy And Procedures
         class: TECHNICAL
-        subclass: System Use Notification 
         family: Access Control
-        control: The information system displays an approved, system use notification message before granting system access informing potential users: (i) that the user is accessing a U.S. Government information system; (ii) that system usage may be monitored, recorded, and subject to audit; (iii) that unauthorized use of the system is prohibited and subject to criminal and civil penalties; and (iv) that use of the system indicates consent to monitoring and recording. The system use notification message provides appropriate privacy and security notices (based on associated privacy and security policies or summaries) and remains on the screen until the user takes explicit actions to log on to the information system.
-        guidance: Privacy and security policies are consistent with applicable laws, Executive Orders, directives, policies, regulations, standards, and guidance. System use notification messages can be implemented in the form of warning banners displayed when individuals log in to the information system. For publicly accessible systems: (i) the system use information is available and when appropriate, is displayed before granting access; (ii) any references to monitoring, recording, or auditing are in keeping with privacy accommodations for such systems that generally prohibit those activities; and (iii) the notice given to public users of the information system includes a description of the authorized uses of the system.
+        control: >
+            The organization develops, disseminates, and periodically reviews/updates: 
+            <ol><li>a formal, documented, access control policy that addresses purpose, scope, roles, responsibilities,
+            management commitment, coordination among organizational entities, and compliance; and</li><li>formal,
+            documented procedures to facilitate the implementation of the access control policy and associated access
+            controls.</li></ol>
+        supplementalGuidance: >
+            The access control policy and procedures are consistent with applicable laws, Executive Orders, directives,
+            policies, regulations, standards, and guidance. The access control policy can be included as part of the
+            general information security policy for the organization. Access control procedures can be developed for
+            the security program in general, and for a particular information system, when required. NIST Special
+            Publication 800-12 provides guidance on security policies and procedures.
         controlLevel: LOW
-        enhancements: None
-        supplement: None
+        Catalog: 800_53_Rev_2
 
-    AC-09:
-        code: AC-09
+    Rev2_AC_02:
+        code: AC-02
+        name: Account Management
         class: TECHNICAL
-        subclass: Previous Logon Notification 
         family: Access Control
-        control: The information system notifies the user, upon successful logon, of the date and time of the last logon, and the number of unsuccessful logon attempts since the last successful logon.
-        guidance: None
-        controlLevel: NONE
-        enhancements: None
-        supplement: None 
-
-    AC-10:
-        code: AC-10
-        class: TECHNICAL
-        subclass: Concurrent Session Control 
-        family: Access Control
-        control: The information system limits the number of concurrent sessions for any user to [Assignment: organization-defined number of sessions].
-        guidance: None
-        controlLevel: HIGH
-        enhancements: None
-        supplement: None 
-
-    AC-11:
-        code: AC-11
-        class: TECHNICAL
-        subclass: Session Lock 
-        family: Access Control
-        control: The information system prevents further access to the system by initiating a session lock after [Assignment: organization-defined time period] of inactivity, and the session lock remains in effect until the user reestablishes access using appropriate identification and authentication procedures.
-        guidance: out of the information system. Organization-defined time periods of inactivity comply with federal policy; for example, in accordance with OMB Memorandum 06-16, the organization-defined time period is no greater than thirty minutes for remote access and portable devices.
-        controlLevel: MODERATE
-        enhancements: None
-        supplement: None 
-
-    AC-12:
-        code: AC-12
-        class: TECHNICAL
-        subclass: Session Termination 
-        family: Access Control
-        control: The information system automatically terminates a remote session after [Assignment: organization-defined time period] of inactivity.
-        guidance: A remote session is initiated whenever an organizational information system is accessed by a user (or an information system) communicating through an external, non-organization-controlled network (e.g., the Internet).
-        controlLevel: MODERATE
-        enhancements: (1)\nAutomatic session termination applies to local and remote sessions.
-        supplement: High: (1) 
-
-    AC-13:
-        code: AC-13
-        class: TECHNICAL
-        subclass: Supervision and Review-Access Control 
-        family: Access Control
-        control: The organization supervises and reviews the activities of users with respect to the enforcement and usage of information system access controls.
-        guidance: The organization reviews audit records (e.g., user activity logs) for inappropriate activities in accordance with organizational procedures. The organization investigates any unusual information system-related activities and periodically reviews changes to access authorizations. The organization reviews more frequently the activities of users with significant information system roles and responsibilities. The extent of the audit record reviews is based on the FIPS 199 impact level of the information system. For example, for low-impact systems, it is not intended that security logs be reviewed frequently for every workstation, but rather at central points such as a web proxy or email servers and when specific circumstances warrant review of other audit records. NIST Special Publication 800-92 provides guidance on computer security log management.
+        control: >
+            The organization manages information system accounts, including establishing, activating, modifying,
+            reviewing, disabling, and removing accounts. The organization reviews information system accounts
+            [<em>Assignment: organization-defined frequency, at least annually</em>].
+        supplementalGuidance: >
+            Account management includes the identification of account types (i.e., individual, group, and system),
+            establishment of conditions for group membership, and assignment of associated authorizations. The
+            organization identifies authorized users of the information system and specifies access rights/privileges.
+            The organization grants access to the information system based on: <ol><li>a valid
+            need-to-know/need-to-share that is determined by assigned official duties and satisfying all personnel
+            security criteria; and</li><li>intended system usage.</ol> The organization requires proper identification
+            for requests to establish information system accounts and approves all such requests. The organization
+            specifically authorizes and monitors the use of guest/anonymous accounts and removes, disables, or otherwise
+            secures unnecessary accounts. Account managers are notified when information system users are terminated or
+            transferred and associated accounts are removed, disabled, or otherwise secured. Account managers are also
+            notified when users information system usage or need-to-know/need-to-share changes.
         controlLevel: LOW
-        enhancements: (1)\nThe organization employs automated mechanisms to facilitate the review of user activities. 
-        supplement: Medium: (1) High: (1) 
+        Catalog: 800_53_Rev_2
+        
+    # Rest of Rev 2 controls go here
+    # ...
 
-    AC-14:
-        code: AC-14
+    Rev3_AC_01:
+        code: AC-01
+        name: Access Control Policy And Procedures
         class: TECHNICAL
-        subclass: Permitted Actions without Identification or Authentication
         family: Access Control
-        control: The organization identifies and documents specific user actions that can be performed on the information system without identification or authentication.
-        guidance: The organization allows limited user activity without identification and authentication for public websites or other publicly available information systems (e.g., individuals accessing a federal information system at http://www.firstgov.gov). Related security control: IA-2.
+        control: >
+            The organization develops, disseminates, and reviews/updates [<em>Assignment:organization-defined
+            frequency</em>]: <ol><li>A formal, documented access control policy that addresses purpose, scope, roles,
+            responsibilities, management commitment, coordination among organizational entities, and compliance;
+            and</li><li>Formal, documented procedures to facilitate the implementation of the access control policy and
+            associated access controls.</li></ol>
+        supplementalGuidance: >
+            This control is intended to produce the policy and procedures that are required for the effective
+            implementation of selected security controls and control enhancements in the access control family. The
+            policy and procedures are consistent with applicable federal laws, Executive Orders, directives, policies,
+            regulations, standards, and guidance. Existing organizational policies and procedures may make the need for 
+            additional specific policies and procedures unnecessary. The access control policy can be included as part 
+            of the general information security policy for the organization. Access control procedures can be developed 
+            for the security program in general and for a particular information system, when required. The 
+            organizational risk management strategy is a key factor in the development of the access control policy. 
+            Related control: PM-9.
+        externalReferences: >
+            NIST Special Publications 800-12, 800-100.
+        priorityCode: P1
         controlLevel: LOW
-        enhancements: (1)\nThe organization permits actions to be performed without identification and authentication only to the extent necessary to accomplish mission objectives.
-        supplement: Medium: (1) High: (1) 
+        Catalog: 800_53_Rev_3
 
-    AC-15:
-        code: AC-15
+    Rev3_AC_02:
+        code: AC-02
+        name: Account Management
         class: TECHNICAL
-        subclass: Automated Marking 
         family: Access Control
-        control: The information system marks output using standard naming conventions to identify any special dissemination, handling, or distribution instructions.
-        guidance: Automated marking refers to markings employed on external media (e.g., hardcopy documents output from the information system). The markings used in external marking are distinguished from the labels used on internal data structures described in AC-16.
-        controlLevel: HIGH
-        enhancements: None
-        supplement: None 
-
-    AC-16:
-        code: AC-16
-        class: TECHNICAL
-        subclass: Automated Labeling 
-        family: Access Control
-        control: The information system appropriately labels information in storage, in process, and in transmission.
-        guidance: Automated labeling refers to labels employed on internal data structures (e.g., records, files) within the information system. Information labeling is accomplished in accordance with: (i) access control requirements; (ii) special dissemination, handling, or distribution instructions; or (iii) as otherwise required to enforce information system security policy.
-        controlLevel: NONE
-        enhancements: None
-        supplement: None 
-
-    AC-17:
-        code: AC-17
-        class: TECHNICAL
-        subclass: Remote Access 
-        family: Access Control
-        control: The organization authorizes, monitors, and controls all methods of remote access to the information system.
-        guidance: Remote access is any access to an organizational information system by a user (or an information system) communicating through an external, non-organization-controlled network (e.g., the Internet). Examples of remote access methods include dial-up, broadband, and wireless. Remote access controls are applicable to information systems other than public web servers or systems specifically designed for public access. The organization restricts access achieved through dial-up connections (e.g., limiting dial-up access based upon source of request) or protects against unauthorized connections or subversion of authorized connections (e.g., using virtual private network technology). NIST Special Publication 800-63 provides guidance on remote electronic authentication. If the federal Personal Identity Verification (PIV) credential is used as an identification token where cryptographic token-based access control is employed, the access control system conforms to the requirements of FIPS 201 and NIST Special Publications 800-73 and 800-78. NIST Special Publication 800-77 provides guidance on IPsec-based virtual private networks. Related security control: IA-2.
+        control: >
+            The organization manages information system accounts, including:
+            <ol>
+            <li>Identifying account types (i.e., individual, group, system, application, guest/anonymous, and 
+            temporary);</li>
+            <li>Establishing conditions for group membership; </li>
+            <li>Identifying authorized users of the information system and specifying access privileges; </li>
+            <li>Requiring appropriate approvals for requests to establish accounts; </li>
+            <li>Establishing, activating, modifying, disabling, and removing accounts; </li>
+            <li>Specifically authorizing and monitoring the use of guest/anonymous and temporary accounts;</li>
+            <li>Notifying account managers when temporary accounts are no longer required and when information system 
+            users are terminated, transferred, or information system usage or need-to- know/need-to-share changes;</li>
+            <li>Deactivating:
+                <ol>
+                <li>temporary accounts that are no longer required; and</li>
+                <li>accounts of terminated or transferred users;</li>
+                </ol>
+            </li>
+            <li>Granting access to the system based on:
+                <ol>
+                <li>a valid access authorization;</li>
+                <li>intended system usage; and</li>
+                <li>other attributes as required by the organization or associated missions/business functions; </li>
+                </ol>
+            </li>
+            <li>Reviewing accounts [<em>Assignment: organization-defined frequency</em>].</li>
+            </ol>
+        supplementalGuidance: >
+            The identification of authorized users of the information system and the specification of access privileges 
+            is consistent with the requirements in other security controls in the security plan. Users requiring 
+            administrative privileges on information system accounts receive additional scrutiny by organizational 
+            officials responsible for approving such accounts and privileged access. Related controls: AC-3, AC-4, AC-5, 
+            AC-6, AC-10, AC-17, AC-19, AC-20, AU-9, IA-4, IA-5, CM-5, CM-6, MA-3, MA-4, MA-5, SA-7, SC-13, SI-9.
+        externalReferences: >
+            None.
+        priorityCode: P1
         controlLevel: LOW
-        enhancements: (1)\nThe organization employs automated mechanisms to facilitate the monitoring and control of remote access methods.\n(2)\nThe organization uses cryptography to protect the confidentiality and integrity of remote access sessions.\n(3)\nThe organization controls all remote accesses through a limited number of managed access control points.\n(4)\nThe organization permits remote access for privileged functions only for compelling operational needs and documents the rationale for such access in the security plan for the information system.
-        supplement: Medium: (1) (2) (3) (4)High: (1) (2) (3) (4) 
+        Catalog: 800_53_Rev_3
 
-    AC-18:
-        code: AC-18
-        class: TECHNICAL
-        subclass: Wireless Access Restrictions 
-        family: Access Control
-        control: The organization: (i) establishes usage restrictions and implementation guidance for wireless technologies; and (ii) authorizes, monitors, controls wireless access to the information system.
-        guidance: NIST Special Publications 800-48 and 800-97 provide guidance on wireless network security. NIST Special Publication 800-94 provides guidance on wireless intrusion detection and prevention.
-        controlLevel: LOW
-        enhancements: (1)\nThe organization uses authentication and encryption to protect wireless access to the information system.\n(2)\nThe organization scans for unauthorized wireless access points [Assignment: organization-defined frequency] and takes appropriate action if such an access points are discovered.\nEnhancement Supplemental Guidance: Organizations conduct a thorough scan for unauthorized wireless access points in facilities containing high-impact information systems. The scan is not limited to only those areas within the facility containing the high-impact information systems.
-        supplement: Medium: (1) High: (1) (2) 
-
-    AC-19:
-        code: AC-19
-        class: TECHNICAL
-        subclass: Access Control for Portable and Mobile Devices 
-        family: Access Control
-        control: The organization: (i) establishes usage restrictions and implementation guidance for organization-controlled portable and mobile devices; and (ii) authorizes, monitors, and controls device access to organizational information systems.
-        guidance: Portable and mobile devices (e.g., notebook computers, personal digital assistants, cellular telephones, and other computing and communications devices with network connectivity and the capability of periodically operating in different physical locations) are only allowed access to organizational information systems in accordance with organizational security policies and procedures. Security policies and procedures include device identification and authentication, implementation of mandatory protective software (e.g., malicious code detection, firewall), configuration management, scanning devices for malicious code, updating virus protection software, scanning for critical software updates and patches, conducting primary operating system (and possibly other resident software) integrity checks, and disabling unnecessary hardware (e.g., wireless, infrared). Protecting information residing on portable and mobile devices (e.g., employing cryptographic mechanisms to provide confidentiality and integrity protections during storage and while in transit when outside of controlled areas) is covered in the media protection family. Related security controls: MP-4, MP-5.
-        controlLevel: MODERATE
-        enhancements: None
-        supplement: None 
-
-    AC-20:
-        code: AC-20
-        class: TECHNICAL
-        subclass: Use of External Information Systems 
-        family: Access Control
-        control: The organization establishes terms and conditions for authorized individuals to: (i) access the information system from an external information system; and (ii) process, store, and/or transmit organization-controlled information using an external information system.
-        guidance: External information systems are information systems or components of information systems that are outside of the accreditation boundary established by the organization and for which the organization typically has no direct control over the application of required security controls or the assessment of security control effectiveness. External information systems include, but are not limited to, personally owned information systems (e.g., computers, cellular telephones, or personal digital assistants); privately owned computing and communications devices resident in commercial or public facilities (e.g., hotels, convention centers, or airports); information systems owned or controlled by nonfederal governmental organizations; and federal information systems that are not owned by, operated by, or under the direct control of the organization.\nAuthorized individuals include organizational personnel, contractors, or any other individuals with authorized access to the organizational information system. This control does not apply to the use of external information systems to access organizational information systems and information that are intended for public access (e.g., individuals accessing federal information through public interfaces to organizational information systems). The organization establishes terms and conditions for the use of external information systems in accordance with organizational security policies and procedures. The terms and conditions address as a minimum; (i) the types of applications that can be accessed on the organizational information system from the external information system; and (ii) the maximum FIPS 199 security category of information that can be processed, stored, and transmitted on the external information system.
-        controlLevel: LOW
-        enhancements: (1)\nThe organization prohibits authorized individuals from using an external information system to access the information system or to process, store, or transmit organization-controlled information except in situations where the organization: (i) can verify the employment of required security controls on the external system as specified in the organization's information security policy and system security plan; or (ii) has approved information system connection or processing agreements with the organizational entity hosting the external information system.
-        supplement: Medium: (1) High: (1) 
-
-    AT-01:
-        code: AT-01
-        class: OPERATIONAL
-        subclass: Security Awareness and Training Policy and Procedures 
-        family: Awareness and Training
-        control: The organization develops, disseminates, and periodically reviews/updates: (i) a formal, documented, security awareness and training policy that addresses purpose, scope, roles, responsibilities, management commitment, coordination among organizational entities, and compliance; and (ii) formal, documented procedures to facilitate the implementation of the security awareness and training policy and associated security awareness and training controls.
-        guidance: The security awareness and training policy and procedures are consistent with applicable laws, Executive Orders, directives, policies, regulations, standards, and guidance. The security awareness and training policy can be included as part of the general information security policy for the organization. Security awareness and training procedures can be developed for the security program in general, and for a particular information system, when required. NIST Special Publications 800-16 and 800-50 provide guidance on security awareness and training. NIST Special Publication 800-12 provides guidance on security policies and procedures.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    AT-02:
-        code: AT-02
-        class: OPERATIONAL
-        subclass: Security Awareness 
-        family: Awareness and Training
-        control: The organization provides basic security awareness training to all information system users (including managers and senior executives) before authorizing access to the system, when required by system changes, and [Assignment: organization-defined frequency, at least annually] thereafter.
-        guidance: The organization determines the appropriate content of security awareness training based on the specific requirements of the organization and the information systems to which personnel have authorized access. The organization's security awareness program is consistent with the requirements contained in C.F.R. Part 5 Subpart C (5 C.F.R 930.301) and with the guidance in NIST Special Publication 800-50.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    AT-03:
-        code: AT-03
-        class: OPERATIONAL
-        subclass: Security Training 
-        family: Awareness and Training
-        control: The organization identifies personnel that have significant information system security roles and responsibilities during the system development life cycle, documents those roles and responsibilities, and provides appropriate information system security training: (i) before authorizing access to the system or performing assigned duties; (ii) when required by system changes; and (iii) [Assignment: organization-defined frequency] thereafter.
-        guidance: The organization determines the appropriate content of security training based on the specific requirements of the organization and the information systems to which personnel have authorized access. In addition, the organization provides system managers, system and network administrators, and other personnel having access to system-level software, adequate technical training to perform their assigned duties. The organization's security training program is consistent with the requirements contained in C.F.R. Part 5 Subpart C (5 C.F.R 930.301) and with the guidance in NIST Special Publication 800-50.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    AT-04:
-        code: AT-04
-        class: OPERATIONAL
-        subclass: Security Training Records 
-        family: Awareness and Training
-        control: The organization documents and monitors individual information system security training activities including basic security awareness training and specific information system security training.
-        guidance: None
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    AT-05:
-        code: AT-05
-        class: OPERATIONAL
-        subclass: Contacts with Security Groups and Associations 
-        family: Awareness and Training
-        control: The organization establishes and maintains contacts with special interest groups, specialized forums, professional associations, news groups, and/or peer groups of security professionals in similar organizations to stay up to date with the latest recommended security practices, techniques, and technologies and to share the latest security-related information including threats, vulnerabilities, and incidents.
-        guidance: To facilitate ongoing security education and training for organizational personnel in an environment of rapid technology changes and dynamic threats, the organization establishes and institutionalizes contacts with selected groups and associations within the security community. The groups and associations selected are in keeping with the organization's mission requirements. Information sharing activities regarding threats, vulnerabilities, and incidents related to information systems are consistent with applicable laws, Executive Orders, directives, policies, regulations, standards, and guidance.
-        controlLevel: NONE
-        enhancements: None
-        supplement: None 
-
-    AU-01:
-        code: AU-01
-        class: TECHNICAL
-        subclass: Audit and Accountability Policy and Procedures 
-        family: Audit and Accountability
-        control: The organization develops, disseminates, and periodically reviews/updates: (i) a formal, documented, audit and accountability policy that addresses purpose, scope, roles, responsibilities, management commitment, coordination among organizational entities, and compliance; and (ii) formal, documented procedures to facilitate the implementation of the audit and accountability policy and associated audit and accountability controls.
-        guidance: The audit and accountability policy and procedures are consistent with applicable laws, Executive Orders, directives, policies, regulations, standards, and guidance. The audit and accountability policy can be included as part of the general information security policy for the organization. Audit and accountability procedures can be developed for the security program in general, and for a particular information system, when required. NIST Special Publication 800-12 provides guidance on security policies and procedures.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    AU-02:
-        code: AU-02
-        class: TECHNICAL
-        subclass: Auditable Events 
-        family: Audit and Accountability
-        control: The information system generates audit records for the following events: [Assignment: organization-defined auditable events].
-        guidance: The purpose of this control is to identify important events which need to be audited as significant and relevant to the security of the information system. The organization specifies which information system components carry out auditing activities. Auditing activity can affect information system performance. Therefore, the organization decides, based upon a risk assessment, which events require auditing on a continuous basis and which events require auditing in response to specific situations. Audit records can be generated at various levels of abstraction, including at the packet level as information traverses the network. Selecting the right level of abstraction for audit record generation is a critical aspect of an audit capability and can facilitate the identification of root causes to problems. Additionally, the security audit function is coordinated with the network health and status monitoring function to enhance the mutual support between the two functions by the selection of information to be recorded by each function. The checklists and configuration guides at http://csrc.nist.gov/pcig/cig.html provide recommended lists of auditable events. The organization defines auditable events that are adequate to support after-the-fact investigations of security incidents. NIST Special Publication 800-92 provides guidance on computer security log management.
-        controlLevel: LOW
-        enhancements: (1)\nThe information system provides the capability to compile audit records from multiple components throughout the system into a systemwide (logical or physical), time-correlated audit trail.\n(2)\nThe information system provides the capability to manage the selection of events to be audited by individual components of the system.\n(3)\nThe organization periodically reviews and updates the list of organization-defined auditable events.
-        supplement: Medium: (3) High: (1) (2) (3) 
-
-    AU-03:
-        code: AU-03
-        class: TECHNICAL
-        subclass: Content of Audit Records 
-        family: Audit and Accountability
-        control: The information system produces audit records that contain sufficient information to establish what events occurred, the sources of the events, and the outcomes of the events.
-        guidance: Audit record content includes, for most audit records: (i) date and time of the event; (ii) the component of the information system (e.g., software component, hardware component) where the event occurred; (iii) type of event; (iv) user/subject identity; and (v) the outcome (success or failure) of the event. NIST Special Publication 800-92 provides guidance on computer security log management.
-        controlLevel: LOW
-        enhancements: (1)\nThe information system provides the capability to include additional, more detailed information in the audit records for audit events identified by type, location, or subject.\n(2)\nThe information system provides the capability to centrally manage the content of audit records generated by individual components throughout the system.
-        supplement: Medium: (1) High: (1) (2) 
-
-    AU-04:
-        code: AU-04
-        class: TECHNICAL
-        subclass: Audit Storage Capacity 
-        family: Audit and Accountability
-        control: The organization allocates sufficient audit record storage capacity and configures auditing to reduce the likelihood of such capacity being exceeded.
-        guidance: The organization provides sufficient audit storage capacity, taking into account the auditing to be performed and the online audit processing requirements. Related security controls: AU-2, AU-5, AU-6, AU-7, SI-4.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    AU-05:
-        code: AU-05
-        class: TECHNICAL
-        subclass: Response to Audit Processing Failures 
-        family: Audit and Accountability
-        control: The information system alerts appropriate organizational officials in the event of an audit processing failure and takes the following additional actions: [Assignment: organization-defined actions to be taken (e.g., shut down information system, overwrite oldest audit records, stop generating audit records)].
-        guidance: Supplemental Guidance: Audit processing failures include, for example, software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded. Related security control: AU-4.
-        controlLevel: LOW
-        enhancements: (1)\nThe information system provides a warning when allocated audit record storage volume reaches [Assignment: organization-defined percentage of maximum audit record storage capacity].\n(2)\nThe information system provides a real-time alert when the following audit failure events occur: [Assignment: organization-defined audit failure events requiring real-time alerts].
-        supplement: High: (1) (2) 
-
-    AU-06:
-        code: AU-06
-        class: TECHNICAL
-        subclass: Audit Monitoring, Analysis, and Reporting 
-        family: Audit and Accountability
-        control: The organization regularly reviews/analyzes information system audit records for indications of inappropriate or unusual activity, investigates suspicious activity or suspected violations, reports findings to appropriate officials, and takes necessary actions.
-        guidance: Organizations increase the level of audit monitoring and analysis activity within the information system whenever there is an indication of increased risk to organizational operations, organizational assets, or individuals based on law enforcement information, intelligence information, or other credible sources of information.
-        controlLevel: MODERATE
-        enhancements: (1)\nThe organization employs automated mechanisms to integrate audit monitoring, analysis, and reporting into an overall process for investigation and response to suspicious activities.\n(2)\nThe organization employs automated mechanisms to alert security personnel of the following inappropriate or unusual activities with security implications: [Assignment: organization-defined list of inappropriate or unusual activities that are to result in alerts].
-        supplement: Medium: (2) High: (1) (2) 
-
-    AU-07:
-        code: AU-07
-        class: TECHNICAL
-        subclass: Audit Reduction and Report Generation 
-        family: Audit and Accountability
-        control: The information system provides an audit reduction and report generation capability.
-        guidance: Audit reduction, review, and reporting tools support after-the-fact investigations of security incidents without altering original audit records.
-        controlLevel: MODERATE
-        enhancements: (1)\nThe information system provides the capability to automatically process audit records for events of interest based upon selectable, event criteria.
-        supplement: Medium: (1) High: (1) 
-
-    AU-08:
-        code: AU-08
-        class: TECHNICAL
-        subclass: Time Stamps 
-        family: Audit and Accountability
-        control: The information system provides time stamps for use in audit record generation.
-        guidance: Time stamps (including date and time) of audit records are generated using internal system clocks.
-        controlLevel: LOW
-        enhancements: (1)\nThe organization synchronizes internal information system clocks [Assignment: organization-defined frequency].
-        supplement: Medium: (1) High: (1) 
-
-    AU-09:
-        code: AU-09
-        class: TECHNICAL
-        subclass: Protection of Audit Information 
-        family: Audit and Accountability
-        control: The information system protects audit information and audit tools from unauthorized access, modification, and deletion.
-        guidance: Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.
-        controlLevel: LOW
-        enhancements: (1)\nThe information system produces audit records on hardware-enforced, write-once media.
-        supplement: None 
-
-    AU-10:
-        code: AU-10
-        class: TECHNICAL
-        subclass: Non-repudiation 
-        family: Audit and Accountability
-        control: The information system provides the capability to determine whether a given individual took a particular action.
-        guidance: Examples of particular actions taken by individuals include creating information, sending a message, approving information (e.g., indicating concurrence or signing a contract), and receiving a message. Non-repudiation protects against later false claims by an individual of not having taken a specific action. Non-repudiation protects individuals against later claims by an author of not having authored a particular document, a sender of not having transmitted a message, a receiver of not having received a message, or a signatory of not having signed a document. Non-repudiation services can be used to determine if information originated from an individual, or if an individual took specific actions (e.g., sending an email, signing a contract, approving a procurement request) or received specific information. Non-repudiation services are obtained by employing various techniques or mechanisms (e.g., digital signatures, digital message receipts, time stamps).
-        controlLevel: NONE
-        enhancements: None
-        supplement: None 
-
-    AU-11:
-        code: AU-11
-        class: TECHNICAL
-        subclass: Audit Record Retention 
-        family: Audit and Accountability
-        control: The organization retains audit records for [Assignment: organization-defined time period] to provide support for after-the-fact investigations of security incidents and to meet regulatory and organizational information retention requirements.
-        guidance: The organization retains audit records until it is determined that they are no longer needed for administrative, legal, audit, or other operational purposes. This includes, for example, retention and availability of audit records relative to Freedom of Information Act (FOIA) requests, subpoena, and law enforcement actions. Standard categorizations of audit records relative to such types of actions and standard response processes for each type of action are developed and disseminated. NIST Special Publication 800-61 provides guidance on computer security incident handling and audit record retention.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    CA-01:
-        code: CA-01
-        class: MANAGEMENT
-        subclass: Certification, Accreditation, and Security Assessment Policies and Procedures
-        family: Certification, Accreditation, and Security Assessments
-        control: The organization develops, disseminates, and periodically reviews/updates: (i) formal, documented, security assessment and certification and accreditation policies that address purpose, scope, roles, responsibilities, management commitment, coordination among organizational entities, and compliance; and (ii) formal, documented procedures to facilitate the implementation of the security assessment and certification and accreditation policies and associated assessment, certification, and accreditation controls.
-        guidance: The security assessment and certification and accreditation policies and procedures are consistent with applicable laws, Executive Orders, directives, policies, regulations, standards, and guidance. The security assessment and certification and accreditation policies can be included as part of the general information security policy for the organization. Security assessment and certification and accreditation procedures can be developed for the security program in general, and for a particular information system, when required. The organization defines what constitutes a significant change to the information system to achieve consistent security reaccreditations. NIST Special Publication 800-53A provides guidance on security control assessments. NIST Special Publication 800-37 provides guidance on security certification and accreditation. NIST Special Publication 800-12 provides guidance on security policies and procedures.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    CA-02:
-        code: CA-02
-        class: MANAGEMENT
-        subclass: Security Assessments 
-        family: Certification, Accreditation, and Security Assessments
-        control: The organization conducts an assessment of the security controls in the information system [Assignment: organization-defined frequency, at least annually] to determine the extent to which the controls are implemented correctly, operating as intended, and producing the desired outcome with respect to meeting the security requirements for the system.
-        guidance: This control is intended to support the FISMA requirement that the management, operational, and technical controls in each information system contained in the inventory of major information systems be assessed with a frequency depending on risk, but no less than annually. The FISMA requirement for (at least) annual security control assessments should not be interpreted by organizations as adding additional assessment requirements to those requirements already in place in the security certification and accreditation process. To satisfy the annual FISMA assessment requirement, organizations can draw upon the security control assessment results from any of the following sources, including but not limited to: (i) security certifications conducted as part of an information system accreditation or reaccreditation process (see CA-4); (ii) continuous monitoring activities (see CA-7); or (iii) testing and evaluation of the information system as part of the ongoing system development life cycle process (provided that the testing and evaluation results are current and relevant to the determination of security control effectiveness). Existing security assessment results are reused to the extent that they are still valid and are supplemented with additional assessments as needed. Reuse of assessment information is critical in achieving a broad-based, cost-effective, and fully integrated security program capable of producing the needed evidence to determine the actual security status of the information system.   OMB does not require an annual assessment of all security controls employed in an organizational information system. In accordance with OMB policy, organizations must annually assess a subset of the security controls based on: (i) the FIPS 199 security categorization of the information system; (ii) the specific security controls selected and employed by the organization to protect the information system; and (iii) the level of assurance (or confidence) that the organization must have in determining the effectiveness of the security controls in the information system. It is expected that the organization will assess all of the security controls in the information system during the three-year accreditation cycle. The organization can use the current year's assessment results obtained during security certification to meet the annual FISMA assessment requirement (see CA-4). NIST Special Publication 800-53A provides guidance on security control assessments to include reuse of existing assessment results. Related security controls: CA-4, CA-6, CA-7, SA-11.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    CA-03:
-        code: CA-03
-        class: MANAGEMENT
-        subclass: Information System Connections 
-        family: Certification, Accreditation, and Security Assessments
-        control: The organization authorizes all connections from the information system to other information systems outside of the accreditation boundary through the use of system connection agreements and monitors/controls the system connections on an ongoing basis.
-        guidance: Since FIPS 199 security categorizations apply to individual information systems, the organization carefully considers the risks that may be introduced when systems are connected to other information systems with different security requirements and security controls, both within the organization and external to the organization. Risk considerations also include information systems sharing the same networks. NIST Special Publication 800-47 provides guidance on connecting information systems. Related security controls: SC-7, SA-9.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    CA-04:
-        code: CA-04
-        class: MANAGEMENT
-        subclass: Security Certification 
-        family: Certification, Accreditation, and Security Assessments
-        control: The organization conducts an assessment of the security controls in the information system to determine the extent to which the controls are implemented correctly, operating as intended, and producing the desired outcome with respect to meeting the security requirements for the system.
-        guidance: A security certification is conducted by the organization in support of the OMB Circular A-130, Appendix III requirement for accrediting the information system. The security certification is a key factor in all security accreditation (i.e., authorization) decisions and is integrated into and spans the system development life cycle. The organization assesses all security controls in an information system during the initial security accreditation. Subsequent to the initial accreditation and in accordance with OMB policy, the organization assesses a subset of the controls annually during continuous monitoring (see CA-7). The organization can use the current year's assessment results obtained during security certification to meet the annual FISMA assessment requirement (see CA-2). NIST Special Publication 800-53A provides guidance on security control assessments. NIST Special Publication 800-37 provides guidance on security certification and accreditation. Related security controls: CA-2, CA-6, SA-11.
-        controlLevel: LOW
-        enhancements: (1)\nThe organization employs an independent certification agent or certification team to conduct an assessment of the security controls in the information system.\nEnhancement Supplemental Guidance: An independent certification agent or certification team is any individual or group capable of conducting an impartial assessment of an organizational information system. Impartiality implies that the assessors are free from any perceived or actual conflicts of interest with respect to the developmental, operational, and/or management chain of command associated with the information system or to the determination of security control effectiveness. Independent security certification services can be obtained from other elements within the organization or can be contracted to a public or private sector entity outside of the organization. Contracted certification services are considered independent if the information system owner is not directly involved in the contracting process or cannot unduly influence the independence of the certification agent or certification team conducting the assessment of the security controls in the information system. The authorizing official decides on the required level of certifier independence based on the criticality and sensitivity of the information system and the ultimate risk to organizational operations and organizational assets, and to individuals. The authorizing official determines if the level of certifier independence is sufficient to provide confidence that the assessment results produced are sound and can be used to make a credible, risk-based decision. In special situations, for example when the organization that owns the information system is small or the organizational structure requires that the assessment of the security controls be accomplished by individuals that are in the developmental, operational, and/or management chain of the system owner or authorizing official, independence in the certification process can be achieved by ensuring the assessment results are carefully reviewed and analyzed by an independent team of experts to validate the completeness, consistency, and veracity of the results. The authorizing official should consult with the Office of the Inspector General, the senior agency information security officer, and the chief information officer to fully discuss the implications of any decisions on certifier independence in the types of special circumstances described above.
-        supplement: Medium: (1) High: (1) 
-
-    CA-05:
-        code: CA-05
-        class: MANAGEMENT
-        subclass: Plan of Action and Milestones 
-        family: Certification, Accreditation, and Security Assessments
-        control: The organization develops and updates [Assignment: organization-defined frequency], a plan of action and milestones for the information system that documents the organization's planned, implemented, and evaluated remedial actions to correct deficiencies noted during the assessment of the security controls and to reduce or eliminate known vulnerabilities in the system.
-        guidance: The plan of action and milestones is a key document in the security accreditation package developed for the authorizing official and is subject to federal reporting requirements established by OMB. The plan of action and milestones updates are based on the findings from security control assessments, security impact analyses, and continuous monitoring activities. OMB FISMA reporting guidance contains instructions regarding organizational plans of action and milestones. NIST Special Publication 800-37 provides guidance on the security certification and accreditation of information systems. NIST Special Publication 800-30 provides guidance on risk mitigation.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    CA-06:
-        code: CA-06
-        class: MANAGEMENT
-        subclass: Security Accreditation 
-        family: Certification, Accreditation, and Security Assessments
-        control: The organization authorizes (i.e., accredits) the information system for processing before operations and updates the authorization [Assignment: organization-defined frequency, at least every three years] or when there is a significant change to the system. A senior organizational official signs and approves the security accreditation.
-        guidance: OMB Circular A-130, Appendix III, establishes policy for security accreditations of federal information systems. The organization assesses the security controls employed within the information system before and in support of the security accreditation. Security assessments conducted in support of security accreditations are called security certifications. The security accreditation of an information system is not a static process. Through the employment of a comprehensive continuous monitoring process (the fourth and final phase of the certification and accreditation process), the critical information contained in the accreditation package (i.e., the system security plan, the security assessment report, and the plan of action and milestones) is updated on an ongoing basis providing the authorizing official and the information system owner with an up-to-date status of the security state of the information system. To reduce the administrative burden of the three-year reaccreditation process, the authorizing official uses the results of the ongoing continuous monitoring process to the maximum extent possible as the basis for rendering a reaccreditation decision. NIST Special Publication 800-37 provides guidance on the security certification and accreditation of information systems. Related security controls: CA-2, CA-4, CA-7.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    CA-07:
-        code: CA-07
-        class: MANAGEMENT
-        subclass: Continuous Monitoring 
-        family: Certification, Accreditation, and Security Assessments
-        control: The organization monitors the security controls in the information system on an ongoing basis.
-        guidance: Continuous monitoring activities include configuration management and control of information system components, security impact analyses of changes to the system, ongoing assessment of security controls, and status reporting. The organization assesses all security controls in an information system during the initial security accreditation. Subsequent to the initial accreditation and in accordance with OMB policy, the organization assesses a subset of the controls annually during continuous monitoring. The selection of an appropriate subset of security controls is based on: (i) the FIPS 199 security categorization of the information system; (ii) the specific security controls selected and employed by the organization to protect the information system; and (iii) the level of assurance (or grounds for confidence) that the organization must have in determining the effectiveness of the security controls in the information system. The organization establishes the selection criteria and subsequently selects a subset of the security controls employed within the information system for assessment. The organization also establishes the schedule for control monitoring to ensure adequate coverage is achieved. Those security controls that are volatile or critical to protecting the information system are assessed at least annually. All other controls are assessed at least once during the information system's three-year accreditation cycle. The organization can use the current year's assessment results obtained during continuous monitoring to meet the annual FISMA assessment requirement (see CA-2).\nThis control is closely related to and mutually supportive of the activities required in monitoring configuration changes to the information system. An effective continuous monitoring program results in ongoing updates to the information system security plan, the security assessment report, and the plan of action and milestones'the three principle documents in the security accreditation package. A rigorous and well executed continuous monitoring process significantly reduces the level of effort required for the reaccreditation of the information system. NIST Special Publication 800-37 provides guidance on the continuous monitoring process. NIST Special Publication 800-53A provides guidance on the assessment of security controls. Related security controls: CA-2, CA-4, CA-5, CA-6, CM-4.
-        controlLevel: LOW
-        enhancements: (1)\nThe organization employs an independent certification agent or certification team to monitor the security controls in the information system on an ongoing basis.\nEnhancement Supplemental Guidance: The organization can extend and maximize the value of the ongoing assessment of security controls during the continuous monitoring process by requiring an independent certification agent or team to assess all of the security controls during the information system's three-year accreditation cycle. Related security controls: CA-2, CA-4, CA-5, CA-6, CM-4.','None
-        supplement: None 
-
-    CM-01:
-        code: CM-01
-        class: OPERATIONAL
-        subclass: Configuration Management Policy and Procedures 
-        family: Configuration Management
-        control: The organization develops, disseminates, and periodically reviews/updates: (i) a formal, documented, configuration management policy that addresses purpose, scope, roles, responsibilities, management commitment, coordination among organizational entities, and compliance; and (ii) formal, documented procedures to facilitate the implementation of the configuration management policy and associated configuration management controls.
-        guidance: The configuration management policy and procedures are consistent with applicable laws, Executive Orders, directives, policies, regulations, standards, and guidance. The configuration management policy can be included as part of the general information security policy for the organization. Configuration management procedures can be developed for the security program in general, and for a particular information system, when required. NIST Special Publication 800-12 provides guidance on security policies and procedures.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    CM-02:
-        code: CM-02
-        class: OPERATIONAL
-        subclass: Baseline Configuration 
-        family: Configuration Management
-        control: The organization develops, documents, and maintains a current baseline configuration of the information system.
-        guidance: This control establishes a baseline configuration for the information system. The baseline configuration provides information about a particular component's makeup (e.g., the standard software load for a workstation or notebook computer including updated patch information) and the component's logical placement within the information system architecture. The baseline configuration also provides the organization with a well-defined and documented specification to which the information system is built and deviations, if required, are documented in support of mission needs/objectives. The baseline configuration of the information system is consistent with the Federal Enterprise Architecture. Related security controls: CM-6, CM-8.
-        controlLevel: LOW
-        enhancements: (1)\nThe organization updates the baseline configuration of the information system as an integral part of information system component installations.\n(2)\nThe organization employs automated mechanisms to maintain an up-to-date, complete, accurate, and readily available baseline configuration of the information system.
-        supplement: Medium: (1) High: (1) (2) 
-
-    CM-03:
-        code: CM-03
-        class: OPERATIONAL
-        subclass: Configuration Change Control 
-        family: Configuration Management
-        control: The organization authorizes, documents, and controls changes to the information system.
-        guidance: The organization manages configuration changes to the information system using an organizationally approved process (e.g., a chartered Configuration Control Board). Configuration change control involves the systematic proposal, justification, implementation, test/evaluation, review, and disposition of changes to the information system, including upgrades and modifications. Configuration change control includes changes to the configuration settings for information technology products (e.g., operating systems, firewalls, routers). The organization includes emergency changes in the configuration change control process, including changes resulting from the remediation of flaws. The approvals to implement a change to the information system include successful results from the security analysis of the change. The organization audits activities associated with configuration changes to the information system. Related security controls: CM-4, CM-6, SI-2.
-        controlLevel: MODERATE
-        enhancements: (1)\nThe organization employs automated mechanisms to: (i) document proposed changes to the information system; (ii) notify appropriate approval authorities; (iii) highlight approvals that have not been received in a timely manner; (iv) inhibit change until necessary approvals are received; and (v) document completed changes to the information system.
-        supplement: High: (1) 
-
-    CM-04:
-        code: CM-04
-        class: OPERATIONAL
-        subclass: Monitoring Configuration Changes 
-        family: Configuration Management
-        control: The organization monitors changes to the information system conducting security impact analyses to determine the effects of the changes.
-        guidance: Prior to change implementation, and as part of the change approval process, the organization analyzes changes to the information system for potential security impacts. After the information system is changed (including upgrades and modifications), the organization checks the security features to verify that the features are still functioning properly. The organization audits activities associated with configuration changes to the information system. Monitoring configuration changes and conducting security impact analyses are important elements with regard to the ongoing assessment of security controls in the information system. Related security control: CA-7.
-        controlLevel: MODERATE
-        enhancements: None
-        supplement: None 
-
-    CM-05:
-        code: CM-05
-        class: OPERATIONAL
-        subclass: Access Restrictions for Change 
-        family: Configuration Management
-        control: The organization: (i) approves individual access privileges and enforces physical and logical access restrictions associated with changes to the information system; and (ii) generates, retains, and reviews records reflecting all such changes.
-        guidance: Planned or unplanned changes to the hardware, software, and/or firmware components of the information system can have significant effects on the overall security of the system. Accordingly, only qualified and authorized individuals obtain access to information system components for purposes of initiating changes, including upgrades, and modifications.
-        controlLevel: MODERATE
-        enhancements: (1)\nThe organization employs automated mechanisms to enforce access restrictions and support auditing of the enforcement actions.
-        supplement: High: (1) 
-
-    CM-06:
-        code: CM-06
-        class: OPERATIONAL
-        subclass: Configuration Settings 
-        family: Configuration Management
-        control: The organization: (i) establishes mandatory configuration settings for information technology products employed within the information system; (ii) configures the security settings of information technology products to the most restrictive mode consistent with operational requirements; (iii) documents the configuration settings; and (iv) enforces the configuration settings in all components of the information system.
-        guidance: Configuration settings are the configurable parameters of the information technology products that compose the information system. Organizations monitor and control changes to the configuration settings in accordance with organizational policies and procedures. OMB FISMA reporting instructions provide guidance on configuration requirements for federal information systems. NIST Special Publication 800-70 provides guidance on producing and using configuration settings for information technology products employed in organizational information systems. Related security controls: CM-2, CM-3, SI-4.
-        controlLevel: LOW
-        enhancements: (1)\nThe organization employs automated mechanisms to centrally manage, apply, and verify configuration settings.
-        supplement: High: (1) 
-
-    CM-07:
-        code: CM-07
-        class: OPERATIONAL
-        subclass: Least Functionality 
-        family: Configuration Management
-        control: The organization configures the information system to provide only essential capabilities and specifically prohibits and/or restricts the use of the following functions, ports, protocols, and/or services: [Assignment: organization-defined list of prohibited and/or restricted functions, ports, protocols, and/or services].
-        guidance: Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions). Additionally, it is sometimes convenient to provide multiple services from a single component of an information system, but doing so increases risk over limiting the services provided by any one component. Where feasible, the organization limits component functionality to a single function per device (e.g., email server or web server, not both). The functions and services provided by information systems, or individual components of information systems, are carefully reviewed to determine which functions and services are candidates for elimination (e.g., Voice Over Internet Protocol, Instant Messaging, File Transfer Protocol, Hyper Text Transfer Protocol, file sharing).
-        controlLevel: MODERATE
-        enhancements: (1)\nThe organization reviews the information system [Assignment: organization-defined frequency], to identify and eliminate unnecessary functions, ports, protocols, and/or services.
-        supplement: High: (1) 
-
-    CM-08:
-        code: CM-08
-        class: OPERATIONAL
-        subclass: Information System Component Inventory 
-        family: Configuration Management
-        control: The organization develops, documents, and maintains a current inventory of the components of the information system and relevant ownership information.
-        guidance: The organization determines the appropriate level of granularity for the information system components included in the inventory that are subject to management control (i.e., tracking, and reporting). The inventory of information system components includes any information determined to be necessary by the organization to achieve effective property accountability (e.g., manufacturer, model number, serial number, software license information, system/component owner). The component inventory is consistent with the accreditation boundary of the information system. Related security controls: CM-2, CM-6.
-        controlLevel: LOW
-        enhancements: (1)\nThe organization updates the inventory of information system components as an integral part of component installations.\n(2)\nThe organization employs automated mechanisms to help maintain an up-to-date, complete, accurate, and readily available inventory of information system components.
-        supplement: Medium: (1) High: (1) (2) 
-
-    CP-01:
-        code: CP-01
-        class: OPERATIONAL
-        subclass: Contingency Planning Policy and Procedures 
-        family: Contingency Planning
-        control: The organization develops, disseminates, and periodically reviews/updates: (i) a formal, documented, contingency planning policy that addresses purpose, scope, roles, responsibilities, management commitment, coordination among organizational entities, and compliance; and (ii) formal, documented procedures to facilitate the implementation of the contingency planning policy and associated contingency planning controls.
-        guidance: The contingency planning policy and procedures are consistent with applicable laws, Executive Orders, directives, policies, regulations, standards, and guidance. The contingency planning policy can be included as part of the general information security policy for the organization. Contingency planning procedures can be developed for the security program in general, and for a particular information system, when required. NIST Special Publication 800-34 provides guidance on contingency planning. NIST Special Publication 800-12 provides guidance on security policies and procedures.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    CP-02:
-        code: CP-02
-        class: OPERATIONAL
-        subclass: Contingency Plan 
-        family: Contingency Planning
-        control: The organization develops and implements a contingency plan for the information system addressing contingency roles, responsibilities, assigned individuals with contact information, and activities associated with restoring the system after a disruption or failure. Designated officials within the organization review and approve the contingency plan and distribute copies of the plan to key contingency personnel.
-        guidance: None
-        controlLevel: LOW
-        enhancements: (1)\nThe organization coordinates contingency plan development with organizational elements responsible for related plans.\nEnhancement Supplemental Guidance: Examples of related plans include Business Continuity Plan, Disaster Recovery Plan, Continuity of Operations Plan, Business Recovery Plan, Incident Response Plan, and Emergency Action Plan.\n(2)\nThe organization conducts capacity planning so that necessary capacity for information processing, telecommunications, and environmental support exists during crisis situations.
-        supplement: Medium: (1) High: (1) (2) 
-
-    CP-03:
-        code: CP-03
-        class: OPERATIONAL
-        subclass: Contingency Training 
-        family: Contingency Planning
-        control: The organization trains personnel in their contingency roles and responsibilities with respect to the information system and provides refresher training [Assignment: organization-defined frequency, at least annually].
-        guidance: None
-        controlLevel: MODERATE
-        enhancements: (1)\nThe organization incorporates simulated events into contingency training to facilitate effective response by personnel in crisis situations.\n(2)\nThe organization employs automated mechanisms to provide a more thorough and realistic training environment.
-        supplement: High: (1) 
-
-    CP-04:
-        code: CP-04
-        class: OPERATIONAL
-        subclass: Contingency Plan Testing and Exercises 
-        family: Contingency Planning
-        control: The organization: (i) tests and/or exercises the contingency plan for the information system [Assignment: organization-defined frequency, at least annually] using [Assignment: organization-defined tests and/or exercises] to determine the plan's effectiveness and the organization's readiness to execute the plan; and (ii) reviews the contingency plan test/exercise results and initiates corrective actions.
-        guidance: There are several methods for testing and/or exercising contingency plans to identify potential weaknesses (e.g., full-scale contingency plan testing, functional/tabletop exercises). The depth and rigor of contingency plan testing and/or exercises increases with the FIPS 199 impact level of the information system. Contingency plan testing and/or exercises also include a determination of the effects on organizational operations and assets (e.g., reduction in mission capability) and individuals arising due to contingency operations in accordance with the plan. NIST Special Publication 800-84 provides guidance on test, training, and exercise programs for information technology plans and capabilities.
-        controlLevel: LOW
-        enhancements: (1)\nThe organization coordinates contingency plan testing and/or exercises with organizational elements responsible for related plans.\nEnhancement Supplemental Guidance: Examples of related plans include Business Continuity Plan, Disaster Recovery Plan, Continuity of Operations Plan, Business Recovery Plan, Incident Response Plan, and Emergency Action Plan.\n(2)\nThe organization tests/exercises the contingency plan at the alternate processing site to familiarize contingency personnel with the facility and available resources and to evaluate the site's capabilities to support contingency operations.\n(3)\nThe organization employs automated mechanisms to more thoroughly and effectively test/exercise the contingency plan by providing more complete coverage of contingency issues, selecting more realistic test/exercise scenarios and environments, and more effectively stressing the information system and supported missions.
-        supplement: Medium: (1) High: (1) (2) 
-
-    CP-05:
-        code: CP-05
-        class: OPERATIONAL
-        subclass: Contingency Plan Update 
-        family: Contingency Planning
-        control: The organization reviews the contingency plan for the information system [Assignment: organization-defined frequency, at least annually] and revises the plan to address system/organizational changes or problems encountered during plan implementation, execution, or testing.
-        guidance: Organizational changes include changes in mission, functions, or business processes supported by the information system. The organization communicates changes to appropriate organizational elements responsible for related plans (e.g., Business Continuity Plan, Disaster Recovery Plan, Continuity of Operations Plan, Business Recovery Plan, Incident Response Plan, Emergency Action Plan).
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    CP-06:
-        code: CP-06
-        class: OPERATIONAL
-        subclass: Alternate Storage Site 
-        family: Contingency Planning
-        control: The organization identifies an alternate storage site and initiates necessary agreements to permit the storage of information system backup information.
-        guidance: The frequency of information system backups and the transfer rate of backup information to the alternate storage site (if so designated) are consistent with the organization's recovery time objectives and recovery point objectives.
-        controlLevel: MODERATE
-        enhancements: (1)\nThe organization identifies an alternate storage site that is geographically separated from the primary storage site so as not to be susceptible to the same hazards.\n(2)\nThe organization configures the alternate storage site to facilitate timely and effective recovery operations.\n(3)\nThe organization identifies potential accessibility problems to the alternate storage site in the event of an area-wide disruption or disaster and outlines explicit mitigation actions.
-        supplement: Medium: (1)(3) High: (1)(2)(3) 
-
-    CP-07:
-        code: CP-07
-        class: OPERATIONAL
-        subclass: Alternate Processing Site 
-        family: Contingency Planning
-        control: The organization identifies an alternate processing site and initiates necessary agreements to permit the resumption of information system operations for critical mission/business functions within [Assignment: organization-defined time period] when the primary processing capabilities are unavailable.
-        guidance: Equipment and supplies required to resume operations within the organization-defined time period are either available at the alternate site or contracts are in place to support delivery to the site. Timeframes to resume information system operations are consistent with organization-established recovery time objectives.
-        controlLevel: MODERATE
-        enhancements: (1)\nThe organization identifies an alternate processing site that is geographically separated from the primary processing site so as not to be susceptible to the same hazards.\n(2)\nThe organization identifies potential accessibility problems to the alternate processing site in the event of an area-wide disruption or disaster and outlines explicit mitigation actions.\n(3)\nThe organization develops alternate processing site agreements that contain priority-of-service provisions in accordance with the organization's availability requirements.\n(4)\nThe organization fully configures the alternate processing site so that it is ready to be used as the operational site supporting a minimum required operational capability.
-        supplement: Medium: (1)(2)(3) High: (1)(2)(3)(4) 
-
-    CP-08:
-        code: CP-08
-        class: OPERATIONAL
-        subclass: Telecommunications Services 
-        family: Contingency Planning
-        control: The organization identifies primary and alternate telecommunications services to support the information system and initiates necessary agreements to permit the resumption of system operations for critical mission/business functions within [Assignment: organization-defined time period] when the primary telecommunications capabilities are unavailable.
-        guidance: In the event that the primary and/or alternate telecommunications services are provided by a common carrier, the organization requests Telecommunications Service Priority (TSP) for all telecommunications services used for national security emergency preparedness (see http://tsp.ncs.gov for a full explanation of the TSP program).
-        controlLevel: MODERATE
-        enhancements: (1)\nThe organization develops primary and alternate telecommunications service agreements that contain priority-of-service provisions in accordance with the organization's availability requirements.\n(2)\nThe organization obtains alternate telecommunications services that do not share a single point of failure with primary telecommunications services.\n(3)\nThe organization obtains alternate telecommunications service providers that are sufficiently separated from primary service providers so as not to be susceptible to the same hazards.\n(4)\nThe organization requires primary and alternate telecommunications service providers to have adequate contingency plans.
-        supplement: Medium: (1)(2) High: (1)(2)(3)(4) 
-
-    CP-09:
-        code: CP-09
-        class: OPERATIONAL
-        subclass: Information System Backup 
-        family: Contingency Planning
-        control: The organization conducts backups of user-level and system-level information (including system state information) contained in the information system [Assignment: organization-defined frequency] and protects backup information at the storage location.
-        guidance: The frequency of information system backups and the transfer rate of backup information to alternate storage sites (if so designated) are consistent with the organization's recovery time objectives and recovery point objectives. While integrity and availability are the primary concerns for system backup information, protecting backup information from unauthorized disclosure is also an important consideration depending on the type of information residing on the backup media and the FIPS 199 impact level. An organizational assessment of risk guides the use of encryption for backup information. The protection of system backup information while in transit is beyond the scope of this control. Related security controls: MP-4, MP-5.
-        controlLevel: LOW
-        enhancements: (1)\nThe organization tests backup information [Assignment: organization-defined frequency] to verify media reliability and information integrity.\n(2)\nThe organization selectively uses backup information in the restoration of information system functions as part of contingency plan testing.\n(3)\nThe organization stores backup copies of the operating system and other critical information system software in a separate facility or in a fire-rated container that is not collocated with the operational software.\n(4)\nThe organization protects system backup information from unauthorized modification.\nEnhancement Supplemental Guidance: The organization employs appropriate mechanisms (e.g., digital signatures, cryptographic hashes) to protect the integrity of information system backups. Protecting the confidentiality of system backup information is beyond the scope of this control. Related security controls: MP-4, MP-5.
-        supplement: Medium: (1)(4) High: (1)(2)(3)(4) 
-
-    CP-10:
-        code: CP-10
-        class: OPERATIONAL
-        subclass: Information System Recovery and Reconstitution 
-        family: Contingency Planning
-        control: The organization employs mechanisms with supporting procedures to allow the information system to be recovered and reconstituted to a known secure state after a disruption or failure.
-        guidance: Information system recovery and reconstitution to a known secure state means that all system parameters (either default or organization-established) are set to secure values, security-critical patches are reinstalled, security-related configuration settings are reestablished, system documentation and operating procedures are available, application and system software is reinstalled and configured with secure settings, information from the most recent, known secure backups is loaded, and the system is fully tested.
-        controlLevel: LOW
-        enhancements: (1)\nThe organization includes a full recovery and reconstitution of the information system as part of contingency plan testing.
-        supplement: High: (1) 
-
-    IA-01:
-        code: IA-01
-        class: TECHNICAL
-        subclass: Identification and Authentication Policy and Procedures 
-        family: Identification and Authentication
-        control: The organization develops, disseminates, and periodically reviews/updates: (i) a formal, documented, identification and authentication policy that addresses purpose, scope, roles, responsibilities, management commitment, coordination among organizational entities, and compliance; and (ii) formal, documented procedures to facilitate the implementation of the identification and authentication policy and associated identification and authentication controls.
-        guidance: The identification and authentication policy and procedures are consistent with: (i) FIPS 201 and Special Publications 800-73, 800-76, and 800-78; and (ii) other applicable laws, Executive Orders, directives, policies, regulations, standards, and guidance. The identification and authentication policy can be included as part of the general information security policy for the organization. Identification and authentication procedures can be developed for the security program in general, and for a particular information system, when required. NIST Special Publication 800-12 provides guidance on security policies and procedures. NIST Special Publication 800-63 provides guidance on remote electronic authentication.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    IA-02:
-        code: IA-02
-        class: TECHNICAL
-        subclass: User Identification and Authentication 
-        family: Identification and Authentication
-        control: The information system uniquely identifies and authenticates users (or processes acting on behalf of users).
-        guidance: Users are uniquely identified and authenticated for all accesses other than those accesses explicitly identified and documented by the organization in accordance security control AC-14. Authentication of user identities is accomplished through the use of passwords, tokens, biometrics, or in the case of multifactor authentication, some combination thereof. NIST Special Publication 800-63 provides guidance on remote electronic authentication including strength of authentication mechanisms. For purposes of this control, the guidance provided in Special Publication 800-63 is applied to both local and remote access to information systems. Remote access is any access to an organizational information system by a user (or an information system) communicating through an external, non-organization-controlled network (e.g., the Internet). Local access is any access to an organizational information system by a user (or an information system) communicating through an internal organization-controlled network (e.g., local area network) or directly to a device without the use of a network. Unless a more stringent control enhancement is specified, authentication for both local and remote information system access is NIST Special Publication 800-63 level 1 compliant. FIPS 201 and Special Publications 800-73, 800-76, and 800-78 specify a personal identity verification (PIV) credential for use in the unique identification and authentication of federal employees and contractors. In addition to identifying and authenticating users at the information system level (i.e., at system logon), identification and authentication mechanisms are employed at the application level, when necessary, to provide increased information security for the organization.\nIn accordance with OMB policy and E-Authentication E-Government initiative, authentication of public users accessing federal information systems may also be required to protect nonpublic or privacy-related information. The e-authentication risk assessment conducted in accordance with OMB Memorandum 04-04 is used in determining the NIST Special Publication 800-63 compliance requirements for such accesses with regard to the IA-2 control and its enhancements. Scalability, practicality, and security issues are simultaneously considered in balancing the need to ensure ease of use for public access to such information and information systems with the need to protect organizational operations, organizational assets, and individuals. Related security controls: AC-14, AC-17.
-        controlLevel: LOW
-        enhancements: (1)\nThe information system employs multifactor authentication for remote system access that is NIST Special Publication 800-63 [Selection: organization-defined level 3, level 3 using a hardware authentication device, or level 4] compliant.\n(2)\nThe information system employs multifactor authentication for local system access that is NIST Special Publication 800-63 [Selection: organization-defined level 3 or level 4] compliant.\n(3)\nThe information system employs multifactor authentication for remote system access that is NIST Special Publication 800-63 level 4 compliant.
-        supplement: Medium: (1) High: (2)(3) 
-
-    IA-03:
-        code: IA-03
-        class: TECHNICAL
-        subclass: Device Identification and Authentication 
-        family: Identification and Authentication
-        control: The information system identifies and authenticates specific devices before establishing a connection.
-        guidance: The information system typically uses either shared known information (e.g., Media Access Control (MAC) or Transmission Control Protocol/Internet Protocol (TCP/IP) addresses) or an organizational authentication solution (e.g., IEEE 802.1x and Extensible Authentication Protocol (EAP) or a Radius server with EAP-Transport Layer Security (TLS) authentication) to identify and authenticate devices on local and/or wide area networks. The required strength of the device authentication mechanism is determined by the FIPS 199 security categorization of the information system with higher impact levels requiring stronger authentication.
-        controlLevel: MODERATE
-        enhancements: None
-        supplement: None 
-
-    IA-04:
-        code: IA-04
-        class: TECHNICAL
-        subclass: Identifier Management 
-        family: Identification and Authentication
-        control: The organization manages user identifiers by: (i) uniquely identifying each user; (ii) verifying the identity of each user; (iii) receiving authorization to issue a user identifier from an appropriate organization official; (iv) issuing the user identifier to the intended party; (v) disabling the user identifier after [Assignment: organization-defined time period] of inactivity; and (vi) archiving user identifiers.
-        guidance: Identifier management is not applicable to shared information system accounts (e.g., guest and anonymous accounts). FIPS 201 and Special Publications 800-73, 800-76, and 800-78 specify a personal identity verification (PIV) credential for use in the unique identification and authentication of federal employees and contractors.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    IA-05:
-        code: IA-05
-        class: TECHNICAL
-        subclass: Authenticator Management 
-        family: Identification and Authentication
-        control: The organization manages information system authenticators by: (i) defining initial authenticator content; (ii) establishing administrative procedures for initial authenticator distribution, for lost/compromised, or damaged authenticators, and for revoking authenticators; (iii) changing default authenticators upon information system installation; and (iv) changing/refreshing authenticators periodically.
-        guidance: Information system authenticators include, for example, tokens, PKI certificates, biometrics, passwords, and key cards. Users take reasonable measures to safeguard authenticators including maintaining possession of their individual authenticators, not loaning or sharing authenticators with others, and reporting lost or compromised authenticators immediately. For password-based authentication, the information system: (i) protects passwords from unauthorized disclosure and modification when stored and transmitted; (ii) prohibits passwords from being displayed when entered; (iii) enforces password minimum and maximum lifetime restrictions; and (iv) prohibits password reuse for a specified number of generations. For PKI-based authentication, the information system: (i) validates certificates by constructing a certification path to an accepted trust anchor; (ii) establishes user control of the corresponding private key; and (iii) maps the authenticated identity to the user account. In accordance with OMB policy and related E-authentication initiatives, authentication of public users accessing federal information systems (and associated authenticator management) may also be required to protect nonpublic or privacy-related information. FIPS 201 and Special Publications 800-73, 800-76, and 800-78 specify a personal identity verification (PIV) credential for use in the unique identification and authentication of federal employees and contractors. NIST Special Publication 800-63 provides guidance on remote electronic authentication.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    IA-06:
-        code: IA-06
-        class: TECHNICAL
-        subclass: Authenticator Feedback 
-        family: Identification and Authentication
-        control: The information system obscures feedback of authentication information during the authentication process to protect the information from possible exploitation/use by unauthorized individuals.
-        guidance: The feedback from the information system does not provide information that would allow an unauthorized user to compromise the authentication mechanism. Displaying asterisks when a user types in a password is an example of obscuring feedback of authentication information.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    IA-07:
-        code: IA-07
-        class: TECHNICAL
-        subclass: Cryptographic Module Authentication 
-        family: Identification and Authentication
-        control: The information system employs authentication methods that meet the requirements of applicable laws, Executive Orders, directives, policies, regulations, standards, and guidance for authentication to a cryptographic module.
-        guidance: The applicable federal standard for authentication to a cryptographic module is FIPS 140-2 (as amended). Validation certificates issued by the NIST Cryptographic Module Validation Program (including FIPS 140-1, FIPS 140-2, and future amendments) remain in effect, and the modules remain available for continued use and purchase until a validation certificate is specifically revoked. Additional information on the use of validated cryptography is available at http://csrc.nist.gov/cryptval.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    IR-01:
-        code: IR-01
-        class: OPERATIONAL
-        subclass: Incident Response Policy and Procedures 
-        family: Incident Response
-        control: The organization develops, disseminates, and periodically reviews/updates: (i) a formal, documented, incident response policy that addresses purpose, scope, roles, responsibilities, management commitment, coordination among organizational entities, and compliance; and (ii) formal, documented procedures to facilitate the implementation of the incident response policy and associated incident response controls.
-        guidance: The incident response policy and procedures are consistent with applicable laws, Executive Orders, directives, policies, regulations, standards, and guidance. The incident response policy can be included as part of the general information security policy for the organization. Incident response procedures can be developed for the security program in general, and for a particular information system, when required. NIST Special Publication 800-12 provides guidance on security policies and procedures. NIST Special Publication 800-61 provides guidance on incident handling and reporting. NIST Special Publication 800-83 provides guidance on malware incident handling and prevention.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    IR-02:
-        code: IR-02
-        class: OPERATIONAL
-        subclass: Incident Response Training 
-        family: Incident Response
-        control: The organization trains personnel in their incident response roles and responsibilities with respect to the information system and provides refresher training [Assignment: organization-defined frequency, at least annually].
-        guidance: None
-        controlLevel: MODERATE
-        enhancements: (1)\nThe organization incorporates simulated events into incident response training to facilitate effective response by personnel in crisis situations.\n(2)\nThe organization employs automated mechanisms to provide a more thorough and realistic training environment.
-        supplement: High: (1) 
-
-    IR-03:
-        code: IR-03
-        class: OPERATIONAL
-        subclass: Incident Response Testing and Exercises 
-        family: Incident Response
-        control: The organization tests and/or exercises the incident response capability for the information system [Assignment: organization-defined frequency, at least annually] using [Assignment: organization-defined tests and/or exercises] to determine the incident response effectiveness and documents the results.
-        guidance: NIST Special Publication 800-84 provides guidance on test, training, and exercise programs for information technology plans and capabilities.
-        controlLevel: MODERATE
-        enhancements: (1)\nThe organization employs automated mechanisms to more thoroughly and effectively test/exercise the incident response capability.\nEnhancement Supplemental Guidance: Automated mechanisms can provide the ability to more thoroughly and effectively test or exercise the capability by providing more complete coverage of incident response issues, selecting more realistic test/exercise scenarios and environments, and more effectively stressing the response capability.
-        supplement: High: (1) 
-
-    IR-04:
-        code: IR-04
-        class: OPERATIONAL
-        subclass: Incident Handling 
-        family: Incident Response
-        control: The organization implements an incident handling capability for security incidents that includes preparation, detection and analysis, containment, eradication, and recovery.
-        guidance: Incident-related information can be obtained from a variety of sources including, but not limited to, audit monitoring, network monitoring, physical access monitoring, and user/administrator reports. The organization incorporates the lessons learned from ongoing incident handling activities into the incident response procedures and implements the procedures accordingly. Related security controls: AU-6, PE-6.
-        controlLevel: LOW
-        enhancements: (1)\nThe organization employs automated mechanisms to support the incident handling process.
-        supplement: Medium: (1) High: (1) 
-
-    IR-05:
-        code: IR-05
-        class: OPERATIONAL
-        subclass: Incident Monitoring 
-        family: Incident Response
-        control: The organization tracks and documents information system security incidents on an ongoing basis.
-        guidance: None
-        controlLevel: MODERATE
-        enhancements: (1)\nThe organization employs automated mechanisms to assist in the tracking of security incidents and in the collection and analysis of incident information.
-        supplement: High: (1) 
-
-    IR-06:
-        code: IR-06
-        class: OPERATIONAL
-        subclass: Incident Reporting 
-        family: Incident Response
-        control: The organization promptly reports incident information to appropriate authorities.
-        guidance: The types of incident information reported, the content and timeliness of the reports, and the list of designated reporting authorities or organizations are consistent with applicable laws, Executive Orders, directives, policies, regulations, standards, and guidance. Organizational officials report cyber security incidents to the United States Computer Emergency Readiness Team (US-CERT) at http://www.us-cert.gov within the specified timeframe designated in the US-CERT Concept of Operations for Federal Cyber Security Incident Handling. In addition to incident information, weaknesses and vulnerabilities in the information system are reported to appropriate organizational officials in a timely manner to prevent security incidents. NIST Special Publication 800-61 provides guidance on incident reporting.
-        controlLevel: LOW
-        enhancements: (1)\nThe organization employs automated mechanisms to assist in the reporting of security incidents.
-        supplement: Medium: (1) High: (1) 
-
-    IR-07:
-        code: IR-07
-        class: OPERATIONAL
-        subclass: Incident Response Assistance 
-        family: Incident Response
-        control: The organization provides an incident response support resource that offers advice and assistance to users of the information system for the handling and reporting of security incidents. The support resource is an integral part of the organization's incident response capability.
-        guidance: Possible implementations of incident response support resources in an organization include a help desk or an assistance group and access to forensics services, when required.
-        controlLevel: LOW
-        enhancements: (1)\nThe organization employs automated mechanisms to increase the availability of incident response-related information and support.
-        supplement: Medium: (1) High: (1) 
-
-    MA-01:
-        code: MA-01
-        class: OPERATIONAL
-        subclass: System Maintenance Policy and Procedures 
-        family: Maintenance
-        control: The organization develops, disseminates, and periodically reviews/updates: (i) a formal, documented, information system maintenance policy that addresses purpose, scope, roles, responsibilities, management commitment, coordination among organizational entities, and compliance; and (ii) formal, documented procedures to facilitate the implementation of the information system maintenance policy and associated system maintenance controls.
-        guidance: The information system maintenance policy and procedures are consistent with applicable laws, Executive Orders, directives, policies, regulations, standards, and guidance. The information system maintenance policy can be included as part of the general information security policy for the organization. System maintenance procedures can be developed for the security program in general, and for a particular information system, when required. NIST Special Publication 800-12 provides guidance on security policies and procedures.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    MA-02:
-        code: MA-02
-        class: OPERATIONAL
-        subclass: Controlled Maintenance 
-        family: Maintenance
-        control: The organization schedules, performs, documents, and reviews records of routine preventative and regular maintenance (including repairs) on the components of the information system in accordance with manufacturer or vendor specifications and/or organizational requirements.
-        guidance: All maintenance activities to include routine, scheduled maintenance and repairs are controlled; whether performed on site or remotely and whether the equipment is serviced on site or removed to another location. Organizational officials approve the removal of the information system or information system components from the facility when repairs are necessary. If the information system or component of the system requires off-site repair, the organization removes all information from associated media using approved procedures. After maintenance is performed on the information system, the organization checks all potentially impacted security controls to verify that the controls are still functioning properly.
-        controlLevel: LOW
-        enhancements: (1)\nThe organization maintains maintenance records for the information system that include: (i) the date and time of maintenance; (ii) name of the individual performing the maintenance; (iii) name of escort, if necessary; (iv) a description of the maintenance performed; and (v) a list of equipment removed or replaced (including identification numbers, if applicable).\n(2)\nThe organization employs automated mechanisms to schedule and conduct maintenance as required, and to create up-to date, accurate, complete, and available records of all maintenance actions, both needed and completed.
-        supplement: Medium: (1) High: (1)(2) 
-
-    MA-03:
-        code: MA-03
-        class: OPERATIONAL
-        subclass: Maintenance Tools 
-        family: Maintenance
-        control: The organization approves, controls, and monitors the use of information system maintenance tools and maintains the tools on an ongoing basis.
-        guidance: The intent of this control is to address hardware and software brought into the information system specifically for diagnostic/repair actions (e.g., a hardware or software packet sniffer that is introduced for the purpose of a particular maintenance activity). Hardware and/or software components that may support information system maintenance, yet are a part of the system (e.g., the software implementing \"ping,\" \"ls,\" \"ipconfig,\" or the hardware and software implementing the monitoring port of an Ethernet switch) are not covered by this control.
-        controlLevel: MODERATE
-        enhancements: (1)\nThe organization inspects all maintenance tools carried into a facility by maintenance personnel for obvious improper modifications.\nEnhancement Supplemental Guidance: Maintenance tools include, for example, diagnostic and test equipment used to conduct maintenance on the information system.\n(2)\nThe organization checks all media containing diagnostic and test programs for malicious code before the media are used in the information system.\n(3)\nThe organization checks all maintenance equipment with the capability of retaining information so that no organizational information is written on the equipment or the equipment is appropriately sanitized before release; if the equipment cannot be sanitized, the equipment remains within the facility or is destroyed, unless an appropriate organization official explicitly authorizes an exception.\n(4)\nThe organization employs automated mechanisms to restrict the use of maintenance tools to authorized personnel only.
-        supplement: High: (1)(2)(3) 
-
-    MA-04:
-        code: MA-04
-        class: OPERATIONAL
-        subclass: Remote Maintenance 
-        family: Maintenance
-        control: The organization authorizes, monitors, and controls any remotely executed maintenance and diagnostic activities, if employed.
-        guidance: Remote maintenance and diagnostic activities are conducted by individuals communicating through an external, non-organization-controlled network (e.g., the Internet). The use of remote maintenance and diagnostic tools is consistent with organizational policy and documented in the security plan for the information system. The organization maintains records for all remote maintenance and diagnostic activities. Other techniques and/or controls to consider for improving the security of remote maintenance include: (i) encryption and decryption of communications; (ii) strong identification and authentication techniques, such as Level 3 or 4 tokens as described in NIST Special Publication 800-63; and (iii) remote disconnect verification. When remote maintenance is completed, the organization (or information system in certain cases) terminates all sessions and remote connections invoked in the performance of that activity. If password-based authentication is used to accomplish remote maintenance, the organization changes the passwords following each remote maintenance service. NIST Special Publication 800-88 provides guidance on media sanitization. The National Security Agency provides a listing of approved media sanitization products at http://www.nsa.gov/ia/government/mdg.cfm. Related security controls: IA-2, MP-6.
-        controlLevel: LOW
-        enhancements: (1)\nThe organization audits all remote maintenance and diagnostic sessions and appropriate organizational personnel review the maintenance records of the remote sessions.\n(2)\nThe organization addresses the installation and use of remote maintenance and diagnostic links in the security plan for the information system.\n(3)\nThe organization does not allow remote maintenance or diagnostic services to be performed by a provider that does not implement for its own information system, a level of security at least as high as that implemented on the system being serviced, unless the component being serviced is removed from the information system and sanitized (with regard to organizational information) before the service begins and also sanitized (with regard to potentially malicious software) after the service is performed and before being reconnected to the information system.
-        supplement: Medium: (1)(2) High: (1)(2)(3) 
-
-    MA-05:
-        code: MA-05
-        class: OPERATIONAL
-        subclass: Maintenance Personnel 
-        family: Maintenance
-        control: The organization allows only authorized personnel to perform maintenance on the information system.
-        guidance: Maintenance personnel (whether performing maintenance locally or remotely) have appropriate access authorizations to the information system when maintenance activities allow access to organizational information or could result in a future compromise of confidentiality, integrity, or availability. When maintenance personnel do not have needed access authorizations, organizational personnel with appropriate access authorizations supervise maintenance personnel during the performance of maintenance activities on the information system.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    MA-06:
-        code: MA-06
-        class: OPERATIONAL
-        subclass: Timely Maintenance 
-        family: Maintenance
-        control: The organization obtains maintenance support and spare parts for [Assignment: organization-defined list of key information system components] within [Assignment: organization-defined time period] of failure.
-        guidance: None
-        controlLevel: MODERATE
-        enhancements: None
-        supplement: None 
-
-    MP-01:
-        code: MP-01
-        class: OPERATIONAL
-        subclass: Media Protection Policy and Procedures 
-        family: Media Protection
-        control: The organization develops, disseminates, and periodically reviews/updates: (i) a formal, documented, media protection policy that addresses purpose, scope, roles, responsibilities, management commitment, coordination among organizational entities, and compliance; and (ii) formal, documented procedures to facilitate the implementation of the media protection policy and associated media protection controls.
-        guidance: The media protection policy and procedures are consistent with applicable laws, Executive Orders, directives, policies, regulations, standards, and guidance. The media protection policy can be included as part of the general information security policy for the organization. Media protection procedures can be developed for the security program in general, and for a particular information system, when required. NIST Special Publication 800-12 provides guidance on security policies and procedures.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    MP-02:
-        code: MP-02
-        class: OPERATIONAL
-        subclass: Media Access 
-        family: Media Protection
-        control: The organization restricts access to information system media to authorized individuals.
-        guidance: Information system media includes both digital media (e.g., diskettes, magnetic tapes, external/removable hard drives, flash/thumb drives, compact disks, digital video disks) and non-digital media (e.g., paper, microfilm). This control also applies to portable and mobile computing and communications devices with information storage capability (e.g., notebook computers, personal digital assistants, cellular telephones).  An organizational assessment of risk guides the selection of media and associated information contained on that media requiring restricted access. Organizations document in policy and procedures, the media requiring restricted access, individuals authorized to access the media, and the specific measures taken to restrict access. The rigor with which this control is applied is commensurate with the FIPS 199 security categorization of the information contained on the media. For example, fewer protection measures are needed for media containing information determined by the organization to be in the public domain, to be publicly releasable, or to have limited or no adverse impact on the organization or individuals if accessed by other than authorized personnel. In these situations, it is assumed that the physical access controls where the media resides provide adequate protection.
-        controlLevel: LOW
-        enhancements: (1)\nThe organization employs automated mechanisms to restrict access to media storage areas and to audit access attempts and access granted.\nEnhancement Supplemental Guidance: This control enhancement is primarily applicable to designated media storage areas within an organization where a significant volume of media is stored and is not intended to apply to every location where some media is stored (e.g., in individual offices).
-        supplement: Medium: (1) High: (1) 
-
-    MP-03:
-        code: MP-03
-        class: OPERATIONAL
-        subclass: Media Labeling 
-        family: Media Protection
-        control: The organization: (i) affixes external labels to removable information system media and information system output indicating the distribution limitations, handling caveats and applicable security markings (if any) of the information; and (ii) exempts [Assignment: organization-defined list of media types or hardware components] from labeling so long as they remain within [Assignment: organization-defined protected environment].
-        guidance: An organizational assessment of risk guides the selection of media requiring labeling. Organizations document in policy and procedures, the media requiring labeling and the specific measures taken to afford such protection. The rigor with which this control is applied is commensurate with the FIPS 199 security categorization of the information contained on the media. For example, labeling is not required for media containing information determined by the organization to be in the public domain or to be publicly releasable.
-        controlLevel: HIGH
-        enhancements: None
-        supplement: None 
-
-    MP-04:
-        code: MP-04
-        class: OPERATIONAL
-        subclass: Media Storage 
-        family: Media Protection
-        control: The organization physically controls and securely stores information system media within controlled areas.
-        guidance: Information system media includes both digital media (e.g., diskettes, magnetic tapes, external/removable hard drives, flash/thumb drives, compact disks, digital video disks) and non-digital media (e.g., paper, microfilm). A controlled area is any area or space for which the organization has confidence that the physical and procedural protections provided are sufficient to meet the requirements established for protecting the information and/or information system. This control applies to portable and mobile computing and communications devices with information storage capability (e.g., notebook computers, personal digital assistants, cellular telephones). Telephone systems are also considered information systems and may have the capability to store information on internal media (e.g., on voicemail systems). Since telephone systems do not have, in most cases, the identification, authentication, and access control mechanisms typically employed in other information systems, organizational personnel exercise extreme caution in the types of information stored on telephone voicemail systems.\nAn organizational assessment of risk guides the selection of media and associated information contained on that media requiring physical protection. Organizations document in policy and procedures, the media requiring physical protection and the specific measures taken to afford such protection. The rigor with which this control is applied is commensurate with the FIPS 199 security categorization of the information contained on the media. For example, fewer protection measures are needed for media containing information determined by the organization to be in the public domain, to be publicly releasable, or to have limited or no adverse impact on the organization or individuals if accessed by other than authorized personnel. In these situations, it is assumed that the physical access controls to the facility where the media resides provide adequate protection. The organization protects information system media identified by the organization until the media are destroyed or sanitized using approved equipment, techniques, and procedures.\nAs part of a defense-in-depth protection strategy, the organization considers routinely encrypting information at rest on selected secondary storage devices. FIPS 199 security categorization guides the selection of appropriate candidates for secondary storage encryption. The organization implements effective cryptographic key management in support of secondary storage encryption and provides protections to maintain the availability of the information in the event of the loss of cryptographic keys by users. NIST Special Publications 800-56 and 800-57 provide guidance on cryptographic key establishment and cryptographic key management. Related security controls: CP-9, RA-2.
-        controlLevel: MODERATE
-        enhancements: None
-        supplement: None 
-
-    MP-05:
-        code: MP-05
-        class: OPERATIONAL
-        subclass: Media Transport 
-        family: Media Protection
-        control: The organization protects and controls information system media during transport outside of controlled areas and restricts the activities associated with transport of such media to authorized personnel.
-        guidance: Information system media includes both digital media (e.g., diskettes, tapes, removable hard drives, flash/thumb drives, compact disks, digital video disks) and non-digital media (e.g., paper, microfilm). A controlled area is any area or space for which the organization has confidence that the physical and procedural protections provided are sufficient to meet the requirements established for protecting the information and/or information system. This control also applies to portable and mobile computing and communications devices with information storage capability (e.g., notebook computers, personal digital assistants, cellular telephones) that are transported outside of controlled areas. Telephone systems are also considered information systems and may have the capability to store information on internal media (e.g., on voicemail systems). Since telephone systems do not have, in most cases, the identification, authentication, and access control mechanisms typically employed in other information systems, organizational personnel exercise extreme caution in the types of information stored on telephone voicemail systems that are transported outside of controlled areas. An organizational assessment of risk guides the selection of media and associated information contained on that media requiring protection during transport. Organizations document in policy and procedures, the media requiring protection during transport and the specific measures taken to protect such transported media. The rigor with which this control is applied is commensurate with the FIPS 199 security categorization of the information contained on the media. An organizational assessment of risk also guides the selection and use of appropriate storage containers for transporting non-digital media. Authorized transport and courier personnel may include individuals from outside the organization (e.g., U.S. Postal Service or a commercial transport or delivery service).
-        controlLevel: MODERATE
-        enhancements: (1)\nThe organization protects digital and non-digital media during transport outside of controlled areas using [Assignment: organization-defined security measures, e.g., locked container, cryptography].\nEnhancement Supplemental Guidance: Physical and technical security measures for the protection of digital and non-digital media are approved by the organization, commensurate with the FIPS 199 security categorization of the information residing on the media, and consistent with applicable laws, Executive Orders, directives, policies, regulations, standards, and guidance. Cryptographic mechanisms can provide confidentiality and/or integrity protections depending upon the mechanisms used.\n(2)\nThe organization documents, where appropriate, activities associated with the transport of information system media using [Assignment: organization-defined system of records].\nEnhancement Supplemental Guidance: Organizations establish documentation requirements for activities associated with the transport of information system media in accordance with the organizational assessment of risk.\n(3)\nThe organization employs an identified custodian at all times to transport information system media.\nEnhancement Supplemental Guidance: Organizations establish documentation requirements for activities associated with the transport of information system media in accordance with the organizational assessment of risk.
-        supplement: Medium: (1)(2) High: (1)(2)(3) 
-
-    MP-06:
-        code: MP-06
-        class: OPERATIONAL
-        subclass: Media Sanitization and Disposal 
-        family: Media Protection
-        control: The organization sanitizes information system media, both digital and non-digital, prior to disposal or release for reuse.
-        guidance: Sanitization is the process used to remove information from information system media such that there is reasonable assurance, in proportion to the confidentiality of the information, that the information cannot be retrieved or reconstructed. Sanitization techniques, including clearing, purging, and destroying media information, prevent the disclosure of organizational information to unauthorized individuals when such media is reused or disposed. The organization uses its discretion on sanitization techniques and procedures for media containing information deemed to be in the public domain or publicly releasable, or deemed to have no adverse impact on the organization or individuals if released for reuse or disposed. NIST Special Publication 800-88 provides guidance on media sanitization. The National Security Agency also provides media sanitization guidance and maintains a listing of approved sanitization products at http://www.nsa.gov/ia/government/mdg.cfm.
-        controlLevel: LOW
-        enhancements: (1)\nThe organization tracks, documents, and verifies media sanitization and disposal actions.\n(2)\nThe organization periodically tests sanitization equipment and procedures to verify correct performance.
-        supplement: High: (1)(2) 
-
-    PE-01:
-        code: PE-01
-        class: OPERATIONAL
-        subclass: Physical and Environmental Protection Policy and Procedures 
-        family: Physical and Environmental Protection
-        control: The organization develops, disseminates, and periodically reviews/updates: (i) a formal, documented, physical and environmental protection policy that addresses purpose, scope, roles, responsibilities, management commitment, coordination among organizational entities, and compliance; and (ii) formal, documented procedures to facilitate the implementation of the physical and environmental protection policy and associated physical and environmental protection controls.
-        guidance: The physical and environmental protection policy and procedures are consistent with applicable laws, Executive Orders, directives, policies, regulations, standards, and guidance. The physical and environmental protection policy can be included as part of the general information security policy for the organization. Physical and environmental protection procedures can be developed for the security program in general, and for a particular information system, when required. NIST Special Publication 800-12 provides guidance on security policies and procedures.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    PE-02:
-        code: PE-02
-        class: OPERATIONAL
-        subclass: Physical Access Authorizations 
-        family: Physical and Environmental Protection
-        control: The organization develops and keeps current a list of personnel with authorized access to the facility where the information system resides (except for those areas within the facility officially designated as publicly accessible) and issues appropriate authorization credentials. Designated officials within the organization review and approve the access list and authorization credentials [Assignment: organization-defined frequency, at least annually].
-        guidance: Appropriate authorization credentials include, for example, badges, identification cards, and smart cards. The organization promptly removes from the access list personnel no longer requiring access to the facility where the information system resides.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    PE-03:
-        code: PE-03
-        class: OPERATIONAL
-        subclass: Physical Access Control 
-        family: Physical and Environmental Protection
-        control: The organization controls all physical access points (including designated entry/exit points) to the facility where the information system resides (except for those areas within the facility officially designated as publicly accessible) and verifies individual access authorizations before granting access to the facility. The organization controls access to areas officially designated as publicly accessible, as appropriate, in accordance with the organization's assessment of risk.
-        guidance: The organization uses physical access devices (e.g., keys, locks, combinations, card readers) and/or guards to control entry to facilities containing information systems. The organization secures keys, combinations, and other access devices and inventories those devices regularly. The organization changes combinations and keys: (i) periodically; and (ii) when keys are lost, combinations are compromised, or individuals are transferred or terminated. Workstations and associated peripherals connected to (and part of) an organizational information system may be located in areas designated as publicly accessible with access to such devices being appropriately controlled. Where federal Personal Identity Verification (PIV) credential is used as an identification token and token-based access control is employed, the access control system conforms to the requirements of FIPS 201 and NIST Special Publication 800-73. If the token-based access control function employs cryptographic verification, the access control system conforms to the requirements of NIST Special Publication 800-78. If the token-based access control function employs biometric verification, the access control system conforms to the requirements of NIST Special Publication 800-76.
-        controlLevel: LOW
-        enhancements: (1)\nThe organization controls physical access to the information system independent of the physical access controls for the facility.\nEnhancement Supplemental Guidance: This control enhancement, in general, applies to server rooms, communications centers, or any other areas within a facility containing large concentrations of information system components or components with a higher impact level than that of the majority of the facility. The intent is to provide an additional layer of physical security for those areas where the organization may be more vulnerable due to the concentration of information system components or the impact level of the components. The control enhancement is not intended to apply to workstations or peripheral devices that are typically dispersed throughout the facility and used routinely by organizational personnel.
-        supplement: High: (1) 
-
-    PE-04:
-        code: PE-04
-        class: OPERATIONAL
-        subclass: Access Control for Transmission Medium 
-        family: Physical and Environmental Protection
-        control: The organization controls physical access to information system distribution and transmission lines within organizational facilities.
-        guidance: Physical protections applied to information system distribution and transmission lines help prevent accidental damage, disruption, and physical tampering. Additionally, physical protections are necessary to help prevent eavesdropping or in transit modification of unencrypted transmissions. Protective measures to control physical access to information system distribution and transmission lines include: (i) locked wiring closets; (ii) disconnected or locked spare jacks; and/or (iii) protection of cabling by conduit or cable trays.
-        controlLevel: HIGH
-        enhancements: None
-        supplement: None 
-
-    PE-05:
-        code: PE-05
-        class: OPERATIONAL
-        subclass: Access Control for Display Medium 
-        family: Physical and Environmental Protection
-        control: The organization controls physical access to information system devices that display information to prevent unauthorized individuals from observing the display output.
-        guidance: None
-        controlLevel: MODERATE
-        enhancements: None
-        supplement: None 
-
-    PE-06:
-        code: PE-06
-        class: OPERATIONAL
-        subclass: Monitoring Physical Access 
-        family: Physical and Environmental Protection
-        control: The organization monitors physical access to the information system to detect and respond to physical security incidents.
-        guidance: The organization reviews physical access logs periodically and investigates apparent security violations or suspicious physical access activities. Response to detected physical security incidents is part of the organization's incident response capability.
-        controlLevel: LOW
-        enhancements: (1)\nThe organization monitors real-time physical intrusion alarms and surveillance equipment.\n(2)\nThe organization employs automated mechanisms to recognize potential intrusions and initiate appropriate response actions.
-        supplement: Medium: (1) High: (1)(2) 
-
-    PE-07:
-        code: PE-07
-        class: OPERATIONAL
-        subclass: Visitor Control 
-        family: Physical and Environmental Protection
-        control: The organization controls physical access to the information system by authenticating visitors before authorizing access to the facility where the information system resides other than areas designated as publicly accessible.
-        guidance: Government contractors and others with permanent authorization credentials are not considered visitors. Personal Identity Verification (PIV) credentials for federal employees and contractors conform to FIPS 201, and the issuing organizations for the PIV credentials are accredited in accordance with the provisions of NIST Special Publication 800-79.
-        controlLevel: LOW
-        enhancements: (1)\nThe organization escorts visitors and monitors visitor activity, when required.
-        supplement: Medium: (1) High: (1) 
-
-    PE-08:
-        code: PE-08
-        class: OPERATIONAL
-        subclass: Access Records 
-        family: Physical and Environmental Protection
-        control: The organization maintains visitor access records to the facility where the information system resides (except for those areas within the facility officially designated as publicly accessible) that includes: (i) name and organization of the person visiting; (ii) signature of the visitor; (iii) form of identification; (iv) date of access; (v) time of entry and departure; (vi) purpose of visit; and (vii) name and organization of person visited. Designated officials within the organization review the visitor access records [Assignment: organization-defined frequency].
-        guidance: None
-        controlLevel: LOW
-        enhancements: (1)\nThe organization employs automated mechanisms to facilitate the maintenance and review of access records.\n(2)\nThe organization maintains a record of all physical access, both visitor and authorized individuals.
-        supplement: High: (1)(2) 
-
-    PE-09:
-        code: PE-09
-        class: OPERATIONAL
-        subclass: Power Equipment and Power Cabling 
-        family: Physical and Environmental Protection
-        control: The organization protects power equipment and power cabling for the information system from damage and destruction.
-        guidance: None
-        controlLevel: MODERATE
-        enhancements: (1)\nThe organization employs redundant and parallel power cabling paths.
-        supplement: None 
-
-    PE-10:
-        code: PE-10
-        class: OPERATIONAL
-        subclass: Emergency Shutoff 
-        family: Physical and Environmental Protection
-        control: The organization provides, for specific locations within a facility containing concentrations of information system resources, the capability of shutting off power to any information system component that may be malfunctioning or threatened without endangering personnel by requiring them to approach the equipment.
-        guidance: Facilities containing concentrations of information system resources may include, for example, data centers, server rooms, and mainframe rooms.
-        controlLevel: MODERATE
-        enhancements: (1)\nThe organization protects the emergency power-off capability from accidental or unauthorized activation.
-        supplement: High: (1) 
-
-    PE-11:
-        code: PE-11
-        class: OPERATIONAL
-        subclass: Emergency Power 
-        family: Physical and Environmental Protection
-        control: The organization provides a short-term uninterruptible power supply to facilitate an orderly shutdown of the information system in the event of a primary power source loss.
-        guidance: None
-        controlLevel: MODERATE
-        enhancements: (1)\nThe organization provides a long-term alternate power supply for the information system that is capable of maintaining minimally required operational capability in the event of an extended loss of the primary power source.\n(2)\nThe organization provides a long-term alternate power supply for the information system that is self-contained and not reliant on external power generation.
-        supplement: High: (1)
-
-    PE-12:
-        code: PE-12
-        class: OPERATIONAL
-        subclass: Emergency Lighting 
-        family: Physical and Environmental Protection
-        control: The organization employs and maintains automatic emergency lighting that activates in the event of a power outage or disruption and that covers emergency exits and evacuation routes.
-        guidance: None
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    PE-13:
-        code: PE-13
-        class: OPERATIONAL
-        subclass: Fire Protection 
-        family: Physical and Environmental Protection
-        control: The organization employs and maintains fire suppression and detection devices/systems that can be activated in the event of a fire.
-        guidance: Fire suppression and detection devices/systems include, but are not limited to, sprinkler systems, handheld fire extinguishers, fixed fire hoses, and smoke detectors.
-        controlLevel: LOW
-        enhancements: (1)\nThe organization employs fire detection devices/systems that activate automatically and notify the organization and emergency responders in the event of a fire.\n(2)\nThe organization employs fire suppression devices/systems that provide automatic notification of any activation to the organization and emergency responders.\n(3)\nThe organization employs an automatic fire suppression capability in facilities that are not staffed on a continuous basis.
-        supplement: Medium: (1)(2)(3) High: (1)(2)(3) 
-
-    PE-14:
-        code: PE-14
-        class: OPERATIONAL
-        subclass: Temperature and Humidity Controls 
-        family: Physical and Environmental Protection
-        control: The organization regularly maintains, within acceptable levels, and monitors the temperature and humidity within the facility where the information system resides.
-        guidance: None
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    PE-15:
-        code: PE-15
-        class: OPERATIONAL
-        subclass: Water Damage Protection 
-        family: Physical and Environmental Protection
-        control: The organization protects the information system from water damage resulting from broken plumbing lines or other sources of water leakage by providing master shutoff valves that are accessible, working properly, and known to key personnel.
-        guidance: None
-        controlLevel: LOW
-        enhancements: (1)\nThe organization employs mechanisms that, without the need for manual intervention, protect the information system from water damage in the event of a significant water leak.
-        supplement: High: (1)
-
-    PE-16:
-        code: PE-16
-        class: OPERATIONAL
-        subclass: Delivery and Removal 
-        family: Physical and Environmental Protection
-        control: The organization authorizes and controls information system-related items entering and exiting the facility and maintains appropriate records of those items.
-        guidance: The organization controls delivery areas and, if possible, isolates the areas from the information system and media libraries to avoid unauthorized physical access.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    PE-17:
-        code: PE-17
-        class: OPERATIONAL
-        subclass: Alternate Work Site 
-        family: Physical and Environmental Protection
-        control: The organization employs appropriate management, operational, and technical information system security controls at alternate work sites.
-        guidance: The organization provides a means for employees to communicate with information system security staff in case of security problems. NIST Special Publication 800-46 provides guidance on security in telecommuting and broadband communications.
-        controlLevel: MODERATE
-        enhancements: None
-        supplement: None 
-
-    PE-18:
-        code: PE-18
-        class: OPERATIONAL
-        subclass: Location of Information System Components 
-        family: Physical and Environmental Protection
-        control: The organization positions information system components within the facility to minimize potential damage from physical and environmental hazards and to minimize the opportunity for unauthorized access.
-        guidance: Physical and environmental hazards include, for example, flooding, fire, tornados, earthquakes, hurricanes, acts of terrorism, vandalism, electrical interference, and electromagnetic radiation. Whenever possible, the organization also considers the location or site of the facility with regard to physical and environmental hazards.
-        controlLevel: MODERATE
-        enhancements: (1)\nThe organization plans the location or site of the facility where the information system resides with regard to physical and environmental hazards and for existing facilities, considers the physical and environmental hazards in its risk mitigation strategy.
-        supplement: High: (1)
-
-    PE-19:
-        code: PE-19
-        class: OPERATIONAL
-        subclass: Information Leakage 
-        family: Physical and Environmental Protection
-        control: The organization protects the information system from information leakage due to electromagnetic signals emanations.
-        guidance: The FIPS 199 security categorization (for confidentiality) of the information system and organizational security policy guides the application of safeguards and countermeasures employed to protect the information system against information leakage due to electromagnetic signals emanations.
-        controlLevel: NONE
-        enhancements: None
-        supplement: None 
-
-    PL-01:
-        code: PL-01
-        class: MANAGEMENT
-        subclass: Security Planning Policy and Procedures 
-        family: Planning
-        control: The organization develops, disseminates, and periodically reviews/updates: (i) a formal, documented, security planning policy that addresses purpose, scope, roles, responsibilities, management commitment, coordination among organizational entities, and compliance; and (ii) formal, documented procedures to facilitate the implementation of the security planning policy and associated security planning controls.
-        guidance: The security planning policy and procedures are consistent with applicable laws, Executive Orders, directives, policies, regulations, standards, and guidance. The security planning policy addresses the overall policy requirements for confidentiality, integrity, and availability and can be included as part of the general information security policy for the organization. Security planning procedures can be developed for the security program in general, and for a particular information system, when required. NIST Special Publication 800-18 provides guidance on security planning. NIST Special Publication 800-12 provides guidance on security policies and procedures.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    PL-02:
-        code: PL-02
-        class: MANAGEMENT
-        subclass: System Security Plan 
-        family: Planning
-        control: The organization develops and implements a security plan for the information system that provides an overview of the security requirements for the system and a description of the security controls in place or planned for meeting those requirements. Designated officials within the organization review and approve the plan.
-        guidance: The security plan is aligned with the organization's information system architecture and information security architecture. NIST Special Publication 800-18 provides guidance on security planning.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    PL-03:
-        code: PL-03
-        class: MANAGEMENT
-        subclass: System Security Plan Update 
-        family: Planning
-        control: The organization reviews the security plan for the information system [Assignment: organization-defined frequency, at least annually] and revises the plan to address system/organizational changes or problems identified during plan implementation or security control assessments.
-        guidance: Significant changes are defined in advance by the organization and identified in the configuration management process. NIST Special Publication 800-18 provides guidance on security plan updates.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    PL-04:
-        code: PL-04
-        class: MANAGEMENT
-        subclass: Rules of Behavior 
-        family: Planning
-        control: The organization establishes and makes readily available to all information system users, a set of rules that describes their responsibilities and expected behavior with regard to information and information system usage. The organization receives signed acknowledgment from users indicating that they have read, understand, and agree to abide by the rules of behavior, before authorizing access to the information system and its resident information.
-        guidance: Electronic signatures are acceptable for use in acknowledging rules of behavior unless specifically prohibited by organizational policy. NIST Special Publication 800-18 provides guidance on preparing rules of behavior.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    PL-05:
-        code: PL-05
-        class: MANAGEMENT
-        subclass: Privacy Impact Assessment 
-        family: Planning
-        control: The organization conducts a privacy impact assessment on the information system in accordance with OMB policy.
-        guidance: OMB Memorandum 03-22 provides guidance for implementing the privacy provisions of the E-Government Act of 2002.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    PL-06:
-        code: PL-06
-        class: MANAGEMENT
-        subclass: Security-Related Activity Planning 
-        family: Planning
-        control: The organization plans and coordinates security-related activities affecting the information system before conducting such activities in order to reduce the impact on organizational operations (i.e., mission, functions, image, and reputation), organizational assets, and individuals.
-        guidance: Routine security-related activities include, but are not limited to, security assessments, audits, system hardware and software maintenance, security certifications, and testing/exercises. Organizational advance planning and coordination includes both emergency and non-emergency (i.e., routine) situations.
-        controlLevel: MODERATE
-        enhancements: None
-        supplement: None 
-
-    PS-01:
-        code: PS-01
-        class: OPERATIONAL
-        subclass: Personnel Security Policy and Procedures 
-        family: Personnel Security
-        control: The organization develops, disseminates, and periodically reviews/updates: (i) a formal, documented, personnel security policy that addresses purpose, scope, roles, responsibilities, management commitment, coordination among organizational entities, and compliance; and (ii) formal, documented procedures to facilitate the implementation of the personnel security policy and associated personnel security controls.
-        guidance: The personnel security policy and procedures are consistent with applicable laws, Executive Orders, directives, policies, regulations, standards, and guidance. The personnel security policy can be included as part of the general information security policy for the organization. Personnel security procedures can be developed for the security program in general, and for a particular information system, when required. NIST Special Publication 800-12 provides guidance on security policies and procedures.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    PS-02:
-        code: PS-02
-        class: OPERATIONAL
-        subclass: Position Categorization 
-        family: Personnel Security
-        control: The organization assigns a risk designation to all positions and establishes screening criteria for individuals filling those positions. The organization reviews and revises position risk designations [Assignment: organization-defined frequency].
-        guidance: Position risk designations are consistent with 5 CFR 731.106(a) and Office of Personnel Management policy and guidance.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    PS-03:
-        code: PS-03
-        class: OPERATIONAL
-        subclass: Personnel Screening 
-        family: Personnel Security
-        control: The organization screens individuals requiring access to organizational information and information systems before authorizing access.
-        guidance: Screening is consistent with: (i) 5 CFR 731.106; (ii) Office of Personnel Management policy, regulations, and guidance; (iii) organizational policy, regulations, and guidance; (iv) FIPS 201 and Special Publications 800-73, 800-76, and 800-78; and (v) the criteria established for the risk designation of the assigned position.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    PS-04:
-        code: PS-04
-        class: OPERATIONAL
-        subclass: Personnel Termination 
-        family: Personnel Security
-        control: The organization, upon termination of individual employment, terminates information system access, conducts exit interviews, retrieves all organizational information system-related property, and provides appropriate personnel with access to official records created by the terminated employee that are stored on organizational information systems.
-        guidance: Information system-related property includes, for example, keys, identification cards, and building passes. Timely execution of this control is particularly essential for employees or contractors terminated for cause.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    PS-05:
-        code: PS-05
-        class: OPERATIONAL
-        subclass: Personnel Transfer 
-        family: Personnel Security
-        control: The organization reviews information systems/facilities access authorizations when personnel are reassigned or transferred to other positions within the organization and initiates appropriate actions.
-        guidance: Appropriate actions that may be required include: (i) returning old and issuing new keys, identification cards, building passes; (ii) closing old accounts and establishing new accounts; (iii) changing system access authorizations; and (iv) providing for access to official records created or controlled by the employee at the old work location and in the old accounts.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    PS-06:
-        code: PS-06
-        class: OPERATIONAL
-        subclass: Access Agreements 
-        family: Personnel Security
-        control: The organization completes appropriate signed access agreements for individuals requiring access to organizational information and information systems before authorizing access and reviews/updates the agreements [Assignment: organization-defined frequency].
-        guidance: Access agreements include, for example, nondisclosure agreements, acceptable use agreements, rules of behavior, and conflict-of-interest agreements. Electronic signatures are acceptable for use in acknowledging access agreements unless specifically prohibited by organizational policy.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    PS-07:
-        code: PS-07
-        class: OPERATIONAL
-        subclass: Third-Party Personnel Security 
-        family: Personnel Security
-        control: The organization establishes personnel security requirements including security roles and responsibilities for third-party providers and monitors provider compliance.
-        guidance: Third-party providers include, for example, service bureaus, contractors, and other organizations providing information system development, information technology services, outsourced applications, and network and security management. The organization explicitly includes personnel security requirements in acquisition-related documents. NIST Special Publication 800-35 provides guidance on information technology security services.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    PS-08:
-        code: PS-08
-        class: OPERATIONAL
-        subclass: Personnel Sanctions 
-        family: Personnel Security
-        control: The organization employs a formal sanctions process for personnel failing to comply with established information security policies and procedures.
-        guidance: The sanctions process is consistent with applicable laws, Executive Orders, directives, policies, regulations, standards, and guidance. The sanctions process can be included as part of the general personnel policies and procedures for the organization.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    RA-01:
-        code: RA-01
-        class: MANAGEMENT
-        subclass: Risk Assessment Policy and Procedures 
-        family: Risk Assessment
-        control: The organization develops, disseminates, and periodically reviews/updates: (i) a formal, documented risk assessment policy that addresses purpose, scope, roles, responsibilities, management commitment, coordination among organizational entities, and compliance; and (ii) formal, documented procedures to facilitate the implementation of the risk assessment policy and associated risk assessment controls.
-        guidance: The risk assessment policy and procedures are consistent with applicable laws, Executive Orders, directives, policies, regulations, standards, and guidance. The risk assessment policy can be included as part of the general information security policy for the organization. Risk assessment procedures can be developed for the security program in general, and for a particular information system, when required. NIST Special Publications 800-30 provides guidance on the assessment of risk. NIST Special Publication 800-12 provides guidance on security policies and procedures.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    RA-02:
-        code: RA-02
-        class: MANAGEMENT
-        subclass: Security Categorization 
-        family: Risk Assessment
-        control: The organization categorizes the information system and the information processed, stored, or transmitted by the system in accordance with applicable laws, Executive Orders, directives, policies, regulations, standards, and guidance and documents the results (including supporting rationale) in the system security plan. Designated senior-level officials within the organization review and approve the security categorizations.
-        guidance: The applicable federal standard for security categorization of nonnational security information and information systems is FIPS 199. The organization conducts FIPS 199 security categorizations as an organization-wide activity with the involvement of the chief information officer, senior agency information security officer, information system owners, and information owners. The organization also considers potential impacts to other organizations and, in accordance with the USA PATRIOT Act of 2001 and Homeland Security Presidential Directives, potential national-level impacts in categorizing the information system. As part of a defense-in-depth protection strategy, the organization considers partitioning higher-impact information systems into separate physical domains (or environments) and restricting or prohibiting network access in accordance with an organizational assessment of risk. NIST Special Publication 800-60 provides guidance on determining the security categories of the information types resident on the information system. Related security controls: MP-4, SC-7.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    RA-03:
-        code: RA-03
-        class: MANAGEMENT
-        subclass: Risk Assessment 
-        family: Risk Assessment
-        control: The organization conducts assessments of the risk and magnitude of harm that could result from the unauthorized access, use, disclosure, disruption, modification, or destruction of information and information systems that support the operations and assets of the agency (including information and information systems managed/operated by external parties).
-        guidance: Risk assessments take into account vulnerabilities, threat sources, and security controls planned or in place to determine the resulting level of residual risk posed to organizational operations, organizational assets, or individuals based on the operation of the information system. The organization also considers potential impacts to other organizations and, in accordance with the USA PATRIOT Act and Homeland Security Presidential Directives, potential national-level impacts in categorizing the information system. Risk assessments also take into account risk posed to organizational operations, organizational assets, or individuals from external parties (e.g., service providers, contractors operating information systems on behalf of the organization, individuals accessing organizational information systems, outsourcing entities). In accordance with OMB policy and related E-authentication initiatives, authentication of public users accessing federal information systems may also be required to protect nonpublic or privacy-related information. As such, organizational assessments of risk also address public access to federal information systems. The General Services Administration provides tools supporting that portion of the risk assessment dealing with public access to federal information systems. NIST Special Publication 800-30 provides guidance on conducting risk assessments including threat, vulnerability, and impact assessments.
-        controlLevel: 
-        enhancements: None
-        supplement: None 
-
-    RA-04:
-        code: RA-04
-        class: MANAGEMENT
-        subclass: Risk Assessment Update 
-        family: Risk Assessment
-        control: The organization updates the risk assessment [Assignment: organization-defined frequency] or whenever there are significant changes to the information system, the facilities where the system resides, or other conditions that may impact the security or accreditation status of the system.
-        guidance: The organization develops and documents specific criteria for what is considered significant change to the information system. NIST Special Publication 800-30 provides guidance on conducting risk assessment updates.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    RA-05:
-        code: RA-05
-        class: MANAGEMENT
-        subclass: Vulnerability Scanning 
-        family: Risk Assessment
-        control: The organization scans for vulnerabilities in the information system [Assignment: organization-defined frequency] or when significant new vulnerabilities potentially affecting the system are identified and reported.
-        guidance: Vulnerability scanning is conducted using appropriate scanning tools and techniques. The organization trains selected personnel in the use and maintenance of vulnerability scanning tools and techniques. Vulnerability scans are scheduled and/or random in accordance with organizational policy and assessment of risk. The information obtained from the vulnerability scanning process is freely shared with appropriate personnel throughout the organization to help eliminate similar vulnerabilities in other information systems. Vulnerability analysis for custom software and applications may require additional, more specialized approaches (e.g., vulnerability scanning tools for applications, source code reviews, static analysis of source code). NIST Special Publication 800-42 provides guidance on network security testing. NIST Special Publication 800-40 (Version 2) provides guidance on patch and vulnerability management.
-        controlLevel: MODERATE
-        enhancements: (1)\nThe organization employs vulnerability scanning tools that include the capability to readily update the list of information system vulnerabilities scanned.\n(2)\nThe organization updates the list of information system vulnerabilities scanned [Assignment: organization-defined frequency] or when significant new vulnerabilities are identified and reported.\n(3)\nThe organization employs vulnerability scanning procedures that can demonstrate the breadth and depth of scan coverage, including vulnerabilities checked and information system components scanned.
-        supplement: High: (1)(2)
-
-    SA-01:
-        code: SA-01
-        class: MANAGEMENT
-        subclass: System and Services Acquisition Policy and Procedures 
-        family: System and Services Acquisition
-        control: The organization develops, disseminates, and periodically reviews/updates: (i) a formal, documented, system and services acquisition policy that includes information security considerations and that addresses purpose, scope, roles, responsibilities, management commitment, coordination among organizational entities, and compliance; and (ii) formal, documented procedures to facilitate the implementation of the system and services acquisition policy and associated system and services acquisition controls.
-        guidance: The system and services acquisition policy and procedures are consistent with applicable laws, Executive Orders, directives, policies, regulations, standards, and guidance. The system and services acquisition policy can be included as part of the general information security policy for the organization. System and services acquisition procedures can be developed for the security program in general, and for a particular information system, when required. NIST Special Publication 800-12 provides guidance on security policies and procedures.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    SA-02:
-        code: SA-02
-        class: MANAGEMENT
-        subclass: Allocation of Resources 
-        family: System and Services Acquisition
-        control: The organization determines, documents, and allocates as part of its capital planning and investment control process, the resources required to adequately protect the information system.
-        guidance: The organization includes the determination of security requirements for the information system in mission/business case planning and establishes a discrete line item for information system security in the organization's programming and budgeting documentation. NIST Special Publication 800-65 provides guidance on integrating security into the capital planning and investment control process.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    SA-03:
-        code: SA-03
-        class: MANAGEMENT
-        subclass: Life Cycle Support 
-        family: System and Services Acquisition
-        control: The organization manages the information system using a system development life cycle methodology that includes information security considerations.
-        guidance: NIST Special Publication 800-64 provides guidance on security considerations in the system development life cycle.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    SA-04:
-        code: SA-04
-        class: MANAGEMENT
-        subclass: Acquisitions 
-        family: System and Services Acquisition
-        control: The organization includes security requirements and/or security specifications, either explicitly or by reference, in information system acquisition contracts based on an assessment of risk and in accordance with applicable laws, Executive Orders, directives, policies, regulations, and standards.
-        guidance: Solicitation Documents\nThe solicitation documents (e.g., Requests for Proposals) for information systems and services include, either explicitly or by reference, security requirements that describe: (i) required security capabilities (security needs and, as necessary, specific security controls and other specific FISMA requirements); (ii) required design and development processes; (iii) required test and evaluation procedures; and (iv) required documentation. The requirements in the solicitation documents permit updating security controls as new threats/vulnerabilities are identified and as new technologies are implemented. NIST Special Publication 800-36 provides guidance on the selection of information security products. NIST Special Publication 800-35 provides guidance on information technology security services. NIST Special Publication 800-64 provides guidance on security considerations in the system development life cycle.\nInformation System Documentation\nThe solicitation documents include requirements for appropriate information system documentation. The documentation addresses user and systems administrator guidance and information regarding the implementation of the security controls in the information system. The level of detail required in the documentation is based on the FIPS 199 security category for the information system.\nUse of Tested, Evaluated, and Validated Products\nNIST Special Publication 800-23 provides guidance on the acquisition and use of tested/evaluated information technology products.\nConfiguration Settings and Implementation Guidance\nThe information system required documentation includes security configuration settings and security implementation guidance. OMB FISMA reporting instructions provide guidance on configuration requirements for federal information systems. NIST Special Publication 800-70 provides guidance on configuration settings for information technology products.
-        controlLevel: LOW
-        enhancements: (1)\nThe organization requires in solicitation documents that appropriate documentation be provided describing the functional properties of the security controls employed within the information system with sufficient detail to permit analysis and testing of the controls.\n(2)\nThe organization requires in solicitation documents that appropriate documentation be provided describing the design and implementation details of the security controls employed within the information system with sufficient detail to permit analysis and testing of the controls (including functional interfaces among control components).
-        supplement: Medium: (1) High: (1)
-
-    SA-05:
-        code: SA-05
-        class: MANAGEMENT
-        subclass: Information System Documentation 
-        family: System and Services Acquisition
-        control: The organization obtains, protects as required, and makes available to authorized personnel, adequate documentation for the information system.
-        guidance: Documentation includes administrator and user guides with information on: (i) configuring, installing, and operating the information system; and (ii) effectively using the system's security features. When adequate information system documentation is either unavailable or non existent (e.g., due to the age of the system or lack of support from the vendor/manufacturer), the organization documents attempts to obtain such documentation and provides compensating security controls, if needed.
-        controlLevel: LOW
-        enhancements: (1)\nThe organization includes, in addition to administrator and user guides, documentation, if available from the vendor/manufacturer, describing the functional properties of the security controls employed within the information system with sufficient detail to permit analysis and testing of the controls.\n(2)\nThe organization includes, in addition to administrator and user guides, documentation, if available from the vendor/manufacturer, describing the design and implementation details of the security controls employed within the information system with sufficient detail to permit analysis and testing of the controls (including functional interfaces among control components).
-        supplement: Medium: (1) High: (1)(2)
-
-    SA-06:
-        code: SA-06
-        class: MANAGEMENT
-        subclass: Software Usage Restrictions 
-        family: System and Services Acquisition
-        control: The organization complies with software usage restrictions.
-        guidance: Software and associated documentation are used in accordance with contract agreements and copyright laws. For software and associated documentation protected by quantity licenses, the organization employs tracking systems to control copying and distribution. The organization controls and documents the use of publicly accessible peer-to-peer file sharing technology to ensure that this capability is not used for the unauthorized distribution, display, performance, or reproduction of copyrighted work.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    SA-07:
-        code: SA-07
-        class: MANAGEMENT
-        subclass: User Installed Software 
-        family: System and Services Acquisition
-        control: The organization enforces explicit rules governing the installation of software by users.
-        guidance: If provided the necessary privileges, users have the ability to install software. The organization identifies what types of software installations are permitted (e.g., updates and security patches to existing software) and what types of installations are prohibited (e.g., software that is free only for personal, not government use, and software whose pedigree with regard to being potentially malicious is unknown or suspect).
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    SA-08:
-        code: SA-08
-        class: MANAGEMENT
-        subclass: Security Engineering Principles 
-        family: System and Services Acquisition
-        control: The organization designs and implements the information system using security engineering principles.
-        guidance: NIST Special Publication 800-27 provides guidance on engineering principles for information system security. The application of security engineering principles is primarily targeted at new development information systems or systems undergoing major upgrades and is integrated into the system development life cycle. For legacy information systems, the organization applies security engineering principles to system upgrades and modifications, to the extent feasible, given the current state of the hardware, software, and firmware components within the system.
-        controlLevel: MODERATE
-        enhancements: None
-        supplement: None 
-
-    SA-09:
-        code: SA-09
-        class: MANAGEMENT
-        subclass: External Information System Services 
-        family: System and Services Acquisition
-        control: The organization: (i) requires that providers of external information system services employ adequate security controls in accordance with applicable laws, Executive Orders, directives, policies, regulations, standards, guidance, and established service-level agreements; and (ii) monitors security control compliance.
-        guidance: An external information system service is a service that is implemented outside of the accreditation boundary of the organizational information system (i.e., a service that is used by, but not a part of, the organizational information system). Relationships with external service providers are established in a variety of ways, for example, through joint ventures, business partnerships, outsourcing arrangements (i.e., through contracts, interagency agreements, lines of business arrangements), licensing agreements, and/or supply chain exchanges. Ultimately, the responsibility for adequately mitigating risks to the organization's operations and assets, and to individuals, arising from the use of external information system services remains with the authorizing official. Authorizing officials must require that an appropriate chain of trust be established with external service providers when dealing with the many issues associated with information system security. For services external to the organization, a chain of trust requires that the organization establish and retain a level of confidence that each participating service provider in the potentially complex consumer-provider relationship provides adequate protection for the services rendered to the organization. Where a sufficient level of trust cannot be established in the external services and/or service providers, the organization employs compensating security controls or accepts the greater degree of risk to its operations and assets, or to individuals. The external information system services documentation includes government, service provider, and end user security roles and responsibilities, and any service-level agreements. Service-level agreements define the expectations of performance for each required security control, describe measurable outcomes, and identify remedies and response requirements for any identified instance of non-compliance. NIST Special Publication 800-35 provides guidance on information technology security services. NIST Special Publication 800-64 provides guidance on the security considerations in the system development life cycle.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    SA-10:
-        code: SA-10
-        class: MANAGEMENT
-        subclass: Developer Configuration Management 
-        family: System and Services Acquisition
-        control: The organization requires that information system developers create and implement a configuration management plan that controls changes to the system during development, tracks security flaws, requires authorization of changes, and provides documentation of the plan and its implementation.
-        guidance: This control also applies to the development actions associated with information system changes.
-        controlLevel: HIGH
-        enhancements: None
-        supplement: None 
-
-    SA-11:
-        code: SA-11
-        class: MANAGEMENT
-        subclass: Developer Security Testing 
-        family: System and Services Acquisition
-        control: The organization requires that information system developers create a security test and evaluation plan, implement the plan, and document the results.
-        guidance: Developmental security test results are used to the greatest extent feasible after verification of the results and recognizing that these results are impacted whenever there have been security relevant modifications to the information system subsequent to developer testing. Test results may be used in support of the security certification and accreditation process for the delivered information system. Related security controls: CA-2, CA-4.
-        controlLevel: MODERATE
-        enhancements: None
-        supplement: None 
-
-    SC-01:
-        code: SC-01
-        class: TECHNICAL
-        subclass: System and Communications Protection Policy and Procedures 
-        family: System and Communications Protection
-        control: The organization develops, disseminates, and periodically reviews/updates: (i) a formal, documented, system and communications protection policy that addresses purpose, scope, roles, responsibilities, management commitment, coordination among organizational entities, and compliance; and (ii) formal, documented procedures to facilitate the implementation of the system and communications protection policy and associated system and communications protection controls.
-        guidance: The system and communications protection policy and procedures are consistent with applicable laws, Executive Orders, directives, policies, regulations, standards, and guidance. The system and communications protection policy can be included as part of the general information security policy for the organization. System and communications protection procedures can be developed for the security program in general, and for a particular information system, when required. NIST Special Publication 800-12 provides guidance on security policies and procedures.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    SC-02:
-        code: SC-02
-        class: TECHNICAL
-        subclass: Application Partitioning 
-        family: System and Communications Protection
-        control: The information system separates user functionality (including user interface services) from information system management functionality.
-        guidance: The information system physically or logically separates user interface services (e.g., public web pages) from information storage and management services (e.g., database management). Separation may be accomplished through the use of different computers, different central processing units, different instances of the operating system, different network addresses, combinations of these methods, or other methods as appropriate.
-        controlLevel: MODERATE
-        enhancements: None
-        supplement: None 
-
-    SC-03:
-        code: SC-03
-        class: TECHNICAL
-        subclass: Security Function Isolation 
-        family: System and Communications Protection
-        control: The information system isolates security functions from nonsecurity functions.
-        guidance: The information system isolates security functions from nonsecurity functions by means of partitions, domains, etc., including control of access to and integrity of, the hardware, software, and firmware that perform those security functions. The information system maintains a separate execution domain (e.g., address space) for each executing process.
-        controlLevel: HIGH
-        enhancements: (1)\nThe information system employs underlying hardware separation mechanisms to facilitate security function isolation.\n(2)\nThe information system isolates critical security functions (i.e., functions enforcing access and information flow control) from both nonsecurity functions and from other security functions.\n(3)\nThe information system minimizes the number of nonsecurity functions included within the isolation boundary containing security functions.\n(4)\nThe information system security functions are implemented as largely independent modules that avoid unnecessary interactions between modules.\n(5)\nThe information system security functions are implemented as a layered structure minimizing interactions between layers of the design and avoiding any dependence by lower layers on the functionality or correctness of higher layers.
-        supplement: None 
-
-    SC-04:
-        code: SC-04
-        class: TECHNICAL
-        subclass: Information Remnance 
-        family: System and Communications Protection
-        control: The information system prevents unauthorized and unintended information transfer via shared system resources.
-        guidance: Control of information system remnance, sometimes referred to as object reuse, or data remnance, prevents information, including encrypted representations of information, produced by the actions of a prior user/role (or the actions of a process acting on behalf of a prior user/role) from being available to any current user/role (or current process) that obtains access to a shared system resource (e.g., registers, main memory, secondary storage) after that resource has been released back to the information system.
-        controlLevel: MODERATE
-        enhancements: None
-        supplement: None 
-
-    SC-05:
-        code: SC-05
-        class: TECHNICAL
-        subclass: Denial of Service Protection 
-        family: System and Communications Protection
-        control: The information system protects against or limits the effects of the following types of denial of service attacks: [Assignment: organization-defined list of types of denial of service attacks or reference to source for current list].
-        guidance: A variety of technologies exist to limit, or in some cases, eliminate the effects of denial of service attacks. For example, boundary protection devices can filter certain types of packets to protect devices on an organization's internal network from being directly affected by denial of service attacks. Information systems that are publicly accessible can be protected by employing increased capacity and bandwidth combined with service redundancy.
-        controlLevel: LOW
-        enhancements: (1)\nThe information system restricts the ability of users to launch denial of service attacks against other information systems or networks.\n(2)\nThe information system manages excess capacity, bandwidth, or other redundancy to limit the effects of information flooding types of denial of service attacks.
-        supplement: None 
-
-    SC-06:
-        code: SC-06
-        class: TECHNICAL
-        subclass: Resource Priority 
-        family: System and Communications Protection
-        control: The information system limits the use of resources by priority.
-        guidance: Priority protection helps prevent a lower-priority process from delaying or interfering with the information system servicing any higher-priority process.
-        controlLevel: NONE
-        enhancements: None
-        supplement: None 
-
-    SC-07:
-        code: SC-07
-        class: TECHNICAL
-        subclass: Boundary Protection 
-        family: System and Communications Protection
-        control: The information system monitors and controls communications at the external boundary of the information system and at key internal boundaries within the system.
-        guidance: Any connections to the Internet, or other external networks or information systems, occur through managed interfaces consisting of appropriate boundary protection devices (e.g., proxies, gateways, routers, firewalls, guards, encrypted tunnels) arranged in an effective architecture (e.g., routers protecting firewalls and application gateways residing on a protected subnetwork commonly referred to as a demilitarized zone or DMZ). Information system boundary protections at any designated alternate processing sites provide the same levels of protection as that of the primary site.        As part of a defense-in-depth protection strategy, the organization considers partitioning higher-impact information systems into separate physical domains (or environments) and applying the concepts of managed interfaces described above to restrict or prohibit network access in accordance with an organizational assessment of risk. FIPS 199 security categorization guides the selection of appropriate candidates for domain partitioning.        The organization carefully considers the intrinsically shared nature of commercial telecommunications services in the implementation of security controls associated with the use of such services. Commercial telecommunications services are commonly based on network components and consolidated management systems shared by all attached commercial customers, and may include third party provided access lines and other service elements. Consequently, such interconnecting transmission services may represent sources of increased risk despite contract security provisions. Therefore, when this situation occurs, the organization either implements appropriate compensating security controls or explicitly accepts the additional risk. NIST Special Publication 800-77 provides guidance on virtual private networks. Related security controls: MP-4, RA-2.
-        controlLevel: LOW
-        enhancements: (1)\nThe organization physically allocates publicly accessible information system components to separate subnetworks with separate, physical network interfaces.\nEnhancement Supplemental Guidance: Publicly accessible information system components include, for example, public web servers.\n(2)\nThe organization prevents public access into the organization's internal networks except as appropriately mediated.\n(3)\nThe organization limits the number of access points to the information system to allow for better monitoring of inbound and outbound network traffic.\n(4)\nThe organization implements a managed interface (boundary protection devices in an effective security architecture) with any external telecommunication service, implementing controls appropriate to the required protection of the confidentiality and integrity of the information being transmitted.\n(5)\nThe information system denies network traffic by default and allows network traffic by exception (i.e., deny all, permit by exception).\n(6)\nThe organization prevents the unauthorized release of information outside of the information system boundary or any unauthorized communication through the information system boundary when there is an operational failure of the boundary protection mechanisms.
-        supplement: Medium: (1)(2)(3)(4)(5) High: (1)(2)(3)(4)(5)(6) 
-
-    SC-08:
-        code: SC-08
-        class: TECHNICAL
-        subclass: Transmission Integrity 
-        family: System and Communications Protection
-        control: The information system protects the integrity of transmitted information.
-        guidance: If the organization is relying on a commercial service provider for transmission services as a commodity item rather than a fully dedicated service, it may be more difficult to obtain the necessary assurances regarding the implementation of needed security controls for transmission integrity. When it is infeasible or impractical to obtain the necessary security controls and assurances of control effectiveness through appropriate contracting vehicles, the organization either implements appropriate compensating security controls or explicitly accepts the additional risk. NIST Special Publication 800-52 provides guidance on protecting transmission integrity using Transport Layer Security (TLS). NIST Special Publication 800-77 provides guidance on protecting transmission integrity using IPsec. NIST Special Publication 800-81 provides guidance on Domain Name System (DNS) message authentication and integrity verification. NSTISSI No. 7003 contains guidance on the use of Protective Distribution Systems.
-        controlLevel: MODERATE
-        enhancements: (1)\nThe organization employs cryptographic mechanisms to recognize changes to information during transmission unless otherwise protected by alternative physical measures.\nEnhancement Supplemental Guidance: Alternative physical protection measures include, for example, protected distribution systems.
-        supplement: High: (1) 
-
-    SC-09:
-        code: SC-09
-        class: TECHNICAL
-        subclass: Transmission Confidentiality 
-        family: System and Communications Protection
-        control: The information system protects the confidentiality of transmitted information.
-        guidance: If the organization is relying on a commercial service provider for transmission services as a commodity item rather than a fully dedicated service, it may be more difficult to obtain the necessary assurances regarding the implementation of needed security controls for transmission confidentiality. When it is infeasible or impractical to obtain the necessary security controls and assurances of control effectiveness through appropriate contracting vehicles, the organization either implements appropriate compensating security controls or explicitly accepts the additional risk. NIST Special Publication 800-52 provides guidance on protecting transmission confidentiality using Transport Layer Security (TLS). NIST Special Publication 800-77 provides guidance on protecting transmission confidentiality using IPsec. NSTISSI No. 7003 contains guidance on the use of Protective Distribution Systems. Related security control: AC-17.
-        controlLevel: MODERATE
-        enhancements: (1)\nThe organization employs cryptographic mechanisms to prevent unauthorized disclosure of information during transmission unless otherwise protected by alternative physical measures.\nEnhancement Supplemental Guidance: Alternative physical protection measures include, for example, protected distribution systems.
-        supplement: High: (1) 
-
-    SC-10:
-        code: SC-10
-        class: TECHNICAL
-        subclass: Network Disconnect 
-        family: System and Communications Protection
-        control: The information system terminates a network connection at the end of a session or after [Assignment: organization-defined time period] of inactivity.
-        guidance: The organization applies this control within the context of risk management that considers specific mission or operational requirements.
-        controlLevel: MODERATE
-        enhancements: None
-        supplement: None 
-
-    SC-11:
-        code: SC-11
-        class: TECHNICAL
-        subclass: Trusted Path 
-        family: System and Communications Protection
-        control: The information system establishes a trusted communications path between the user and the following security functions of the system: [Assignment: organization-defined security functions to include at a minimum, information system authentication and reauthentication].
-        guidance: Supplemental Guidance: A trusted path is employed for high-confidence connections between the security functions of the information system and the user (e.g., for login).
-        controlLevel: NONE
-        enhancements: None
-        supplement: None 
-
-    SC-12:
-        code: SC-12
-        class: TECHNICAL
-        subclass: Cryptographic Key Establishment and Management 
-        family: System and Communications Protection
-        control: When cryptography is required and employed within the information system, the organization establishes and manages cryptographic keys using automated mechanisms with supporting procedures or manual procedures.
-        guidance: NIST Special Publication 800-56 provides guidance on cryptographic key establishment. NIST Special Publication 800-57 provides guidance on cryptographic key management.
-        controlLevel: MODERATE
-        enhancements: None
-        supplement: None 
-
-    SC-13:
-        code: SC-13
-        class: TECHNICAL
-        subclass: Use of Cryptography 
-        family: System and Communications Protection
-        control: For information requiring cryptographic protection, the information system implements cryptographic mechanisms that comply with applicable laws, Executive Orders, directives, policies, regulations, standards, and guidance.
-        guidance: The applicable federal standard for employing cryptography in nonnational security information systems is FIPS 140-2 (as amended). Validation certificates issued by the NIST Cryptographic Module Validation Program (including FIPS 140-1, FIPS 140-2, and future amendments) remain in effect and the modules remain available for continued use and purchase until a validation certificate is specifically revoked. NIST Special Publications 800-56 and 800-57 provide guidance on cryptographic key establishment and cryptographic key management. Additional information on the use of validated cryptography is available at http://csrc.nist.gov/cryptval.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    SC-14:
-        code: SC-14
-        class: TECHNICAL
-        subclass: Public Access Protections 
-        family: System and Communications Protection
-        control: The information system protects the integrity and availability of publicly available information and applications.
-        guidance: None
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    SC-15:
-        code: SC-15
-        class: TECHNICAL
-        subclass: Collaborative Computing 
-        family: System and Communications Protection
-        control: The information system prohibits remote activation of collaborative computing mechanisms and provides an explicit indication of use to the local users.
-        guidance: Collaborative computing mechanisms include, for example, video and audio conferencing capabilities. Explicit indication of use includes, for example, signals to local users when cameras and/or microphones are activated.
-        controlLevel: MODERATE
-        enhancements: (1)\nThe information system provides physical disconnect of camera and microphone in a manner that supports ease of use.
-        supplement: None 
-
-    SC-16:
-        code: SC-16
-        class: TECHNICAL
-        subclass: Transmission of Security Parameters 
-        family: System and Communications Protection
-        control: The information system reliably associates security parameters with information exchanged between information systems.
-        guidance: Security parameters include, for example, security labels and markings. Security parameters may be explicitly or implicitly associated with the information contained within the information system.
-        controlLevel: NONE
-        enhancements: None
-        supplement: None 
-
-    SC-17:
-        code: SC-17
-        class: TECHNICAL
-        subclass: Public Key Infrastructure Certificates 
-        family: System and Communications Protection
-        control: The organization issues public key certificates under an appropriate certificate policy or obtains public key certificates under an appropriate certificate policy from an approved service provider.
-        guidance: For user certificates, each agency either establishes an agency certification authority cross-certified with the Federal Bridge Certification Authority at medium assurance or higher or uses certificates from an approved, shared service provider, as required by OMB Memorandum 05-24. NIST Special Publication 800-32 provides guidance on public key technology. NIST Special Publication 800-63 provides guidance on remote electronic authentication.
-        controlLevel: MODERATE
-        enhancements: None
-        supplement: None 
-
-    SC-18:
-        code: SC-18
-        class: TECHNICAL
-        subclass: Mobile Code 
-        family: System and Communications Protection
-        control: The organization: (i) establishes usage restrictions and implementation guidance for mobile code technologies based on the potential to cause damage to the information system if used maliciously; and (ii) authorizes, monitors, and controls the use of mobile code within the information system.
-        guidance: Mobile code technologies include, for example, Java, JavaScript, ActiveX, PDF, Postscript, Shockwave movies, Flash animations, and VBScript. Usage restrictions and implementation guidance apply to both the selection and use of mobile code installed on organizational servers and mobile code downloaded and executed on individual workstations. Control procedures prevent the development, acquisition, or introduction of unacceptable mobile code within the information system. NIST Special Publication 800-28 provides guidance on active content and mobile code.
-        controlLevel: MODERATE
-        enhancements: None
-        supplement: None 
-
-    SC-19:
-        code: SC-19
-        class: TECHNICAL
-        subclass: Voice Over Internet Protocol 
-        family: System and Communications Protection
-        control: The organization: (i) establishes usage restrictions and implementation guidance for Voice over Internet Protocol (VoIP) technologies based on the potential to cause damage to the information system if used maliciously; and (ii) authorizes, monitors, and controls the use of VoIP within the information system.
-        guidance: NIST Special Publication 800-58 provides guidance on security considerations for VoIP technologies employed in information systems.
-        controlLevel: MODERATE
-        enhancements: None
-        supplement: None 
-
-    SC-20:
-        code: SC-20
-        class: TECHNICAL
-        subclass: Secure Name /Address Resolution Service (Authoritative Source) 
-        family: System and Communications Protection
-        control: The information system that provides name/address resolution service provides additional data origin and integrity artifacts along with the authoritative data it returns in response to resolution queries.
-        guidance: This control enables remote clients to obtain origin authentication and integrity verification assurances for the name/address resolution information obtained through the service. A domain name system (DNS) server is an example of an information system that provides name/address resolution service; digital signatures and cryptographic keys are examples of additional artifacts; and DNS resource records are examples of authoritative data. NIST Special Publication 800-81 provides guidance on secure domain name system deployment.
-        controlLevel: MODERATE
-        enhancements: (1)\nThe information system, when operating as part of a distributed, hierarchical namespace, provides the means to indicate the security status of child subspaces and (if the child supports secure resolution services) enable verification of a chain of trust among parent and child domains.\nEnhancement Supplemental Guidance: An example means to indicate the security status of child subspaces is through the use of delegation signer resource records.
-        supplement: None 
-
-    SC-21:
-        code: SC-21
-        class: TECHNICAL
-        subclass: Secure Name /Address Resolution Service (Recursive or Caching Resolver)
-        family: System and Communications Protection
-        control: The information system that provides name/address resolution service for local clients performs data origin authentication and data integrity verification on the resolution responses it receives from authoritative sources when requested by client systems.
-        guidance: A resolving or caching domain name system (DNS) server is an example of an information system that provides name/address resolution service for local clients and authoritative DNS servers are examples of authoritative sources. NIST Special Publication 800-81 provides guidance on secure domain name system deployment.
-        controlLevel: HIGH
-        enhancements: (1)\nThe information system performs data origin authentication and data integrity verification on all resolution responses whether or not local clients explicitly request this service.\nEnhancement Supplemental Guidance: Local clients include, for example, DNS stub resolvers.
-        supplement: None 
-
-    SC-22:
-        code: SC-22
-        class: TECHNICAL
-        subclass: Architecture and Provisioning for Name/Address Resolution Service (Recursive or Caching Resolver)
-        family: System and Communications Protection
-        control: The information systems that collectively provide name/address resolution service for an organization are fault tolerant and implement role separation.
-        guidance: A domain name system (DNS) server is an example of an information system that provides name/address resolution service. To eliminate single points of failure and to enhance redundancy, there are typically at least two authoritative domain name system (DNS) servers, one configured as primary and the other as secondary. Additionally, the two servers are commonly located in two different network subnets and geographically separated (i.e., not located in the same physical facility). If organizational information technology resources are divided into those resources belonging to internal networks and those resources belonging to external networks, authoritative DNS servers with two roles (internal and external) are established. The DNS server with the internal role provides name/address resolution information pertaining to both internal and external information technology resources while the DNS server with the external role only provides name/address resolution information pertaining to external information technology resources. The list of clients who can access the authoritative DNS server of a particular role is also specified. NIST Special Publication 800-81 provides guidance on secure DNS deployment.
-        controlLevel: MODERATE
-        enhancements: None
-        supplement: None 
-
-    SC-23:
-        code: SC-23
-        class: TECHNICAL
-        subclass: Session Authenticity 
-        family: System and Communications Protection
-        control: The information system provides mechanisms to protect the authenticity of communications sessions.
-        guidance: This control focuses on communications protection at the session, versus packet, level. The intent of this control is to implement session-level protection where needed (e.g., in service-oriented architectures providing web-based services). NIST Special Publication 800-52 provides guidance on the use of transport layer security (TLS) mechanisms. NIST Special Publication 800-77 provides guidance on the deployment of IPsec virtual private networks (VPNs) and other methods of protecting communications sessions. NIST Special Publication 800-95 provides guidance on secure web services.
-        controlLevel: MODERATE
-        enhancements: None
-        supplement: None 
-
-    SI-01:
-        code: SI-01
-        class: OPERATIONAL
-        subclass: System and Information Integrity Policy and Procedures 
-        family: System and Information Integrity
-        control: The organization develops, disseminates, and periodically reviews/updates: (i) a formal, documented, system and information integrity policy that addresses purpose, scope, roles, responsibilities, management commitment, coordination among organizational entities, and compliance; and (ii) formal, documented procedures to facilitate the implementation of the system and information integrity policy and associated system and information integrity controls.
-        guidance: The system and information integrity policy and procedures are consistent with applicable laws, Executive Orders, directives, policies, regulations, standards, and guidance. The system and information integrity policy can be included as part of the general information security policy for the organization. System and information integrity procedures can be developed for the security program in general, and for a particular information system, when required. NIST Special Publication 800-12 provides guidance on security policies and procedures.
-        controlLevel: LOW
-        enhancements: None
-        supplement: None 
-
-    SI-02:
-        code: SI-02
-        class: OPERATIONAL
-        subclass: Flaw Remediation 
-        family: System and Information Integrity
-        control: The organization identifies, reports, and corrects information system flaws.
-        guidance: The organization identifies information systems containing software affected by recently announced software flaws (and potential vulnerabilities resulting from those flaws). The organization (or the software developer/vendor in the case of software developed and maintained by a vendor/contractor) promptly installs newly released security relevant patches, service packs, and hot fixes, and tests patches, service packs, and hot fixes for effectiveness and potential side effects on the organization's information systems before installation. Flaws discovered during security assessments, continuous monitoring, incident response activities, or information system error handling are also addressed expeditiously. Flaw remediation is incorporated into configuration management as an emergency change. NIST Special Publication 800-40, provides guidance on security patch installation and patch management. Related security controls: CA-2, CA-4, CA-7, CM-3, IR-4, SI-11.
-        controlLevel: LOW
-        enhancements: (1)\nThe organization centrally manages the flaw remediation process and installs updates automatically.\n(2)\nThe organization employs automated mechanisms to periodically and upon demand determine the state of information system components with regard to flaw remediation.
-        supplement: Medium: (2) High: (1)(2)
-
-    SI-03:
-        code: SI-03
-        class: OPERATIONAL
-        subclass: Malicious Code Protection 
-        family: System and Information Integrity
-        control: The information system implements malicious code protection.
-        guidance: The organization employs malicious code protection mechanisms at critical information system entry and exit points (e.g., firewalls, electronic mail servers, web servers, proxy servers, remote-access servers) and at workstations, servers, or mobile computing devices on the network. The organization uses the malicious code protection mechanisms to detect and eradicate malicious code (e.g., viruses, worms, Trojan horses, spyware) transported: (i) by electronic mail, electronic mail attachments, Internet accesses, removable media (e.g., USB devices, diskettes or compact disks), or other common means; or (ii) by exploiting information system vulnerabilities. The organization updates malicious code protection mechanisms (including the latest virus definitions) whenever new releases are available in accordance with organizational configuration management policy and procedures. The organization considers using malicious code protection software products from multiple vendors (e.g., using one vendor for boundary devices and servers and another vendor for workstations). The organization also considers the receipt of false positives during malicious code detection and eradication and the resulting potential impact on the availability of the information system. NIST Special Publication 800-83 provides guidance on implementing malicious code protection.
-        controlLevel: LOW
-        enhancements: (1)\nThe organization centrally manages malicious code protection mechanisms.\n(2)\nThe information system automatically updates malicious code protection mechanisms.
-        supplement: Medium: (1)(2) High: (1)(2)
-
-    SI-04:
-        code: SI-04
-        class: OPERATIONAL
-        subclass: Information System Monitoring Tools and Techniques 
-        family: System and Information Integrity
-        control: The organization employs tools and techniques to monitor events on the information system, detect attacks, and provide identification of unauthorized use of the system.
-        guidance: Information system monitoring capability is achieved through a variety of tools and techniques (e.g., intrusion detection systems, intrusion prevention systems, malicious code protection software, audit record monitoring software, network monitoring software). Monitoring devices are strategically deployed within the information system (e.g., at selected perimeter locations, near server farms supporting critical applications) to collect essential information. Monitoring devices are also deployed at ad hoc locations within the system to track specific transactions. Additionally, these devices are used to track the impact of security changes to the information system. The granularity of the information collected is determined by the organization based upon its monitoring objectives and the capability of the information system to support such activities. Organizations consult appropriate legal counsel with regard to all information system monitoring activities. Organizations heighten the level of information system monitoring activity whenever there is an indication of increased risk to organizational operations, organizational assets, or individuals based on law enforcement information, intelligence information, or other credible sources of information. NIST Special Publication 800-61 provides guidance on detecting attacks through various types of security technologies. NIST Special Publication 800-83 provides guidance on detecting malware-based attacks through malicious code protection software. NIST Special Publication 800-92 provides guidance on monitoring and analyzing computer security event logs. NIST Special Publication 800-94 provides guidance on intrusion detection and prevention. Related security control: AC-8.
-        controlLevel: MODERATE
-        enhancements: (1)\nThe organization interconnects and configures individual intrusion detection tools into a systemwide intrusion detection system using common protocols.\n(2)\nThe organization employs automated tools to support near-real-time analysis of events.\n(3)\nThe organization employs automated tools to integrate intrusion detection tools into access control and flow control mechanisms for rapid response to attacks by enabling reconfiguration of these mechanisms in support of attack isolation and elimination.\n(4)\nThe information system monitors inbound and outbound communications for unusual or unauthorized activities or conditions.\nEnhancement Supplemental Guidance: Unusual/unauthorized activities or conditions include, for example, the presence of malicious code, the unauthorized export of information, or signaling to an external information system.\n(5)\nThe information system provides a real-time alert when the following indications of compromise or potential compromise occur: [Assignment: organization-defined list of compromise indicators].
-        supplement: Medium: (4) High: (2)(4)(5)
-
-    SI-05:
-        code: SI-05
-        class: OPERATIONAL
-        subclass: Security Alerts and Advisories 
-        family: System and Information Integrity
-        control: The organization receives information system security alerts/advisories on a regular basis, issues alerts/advisories to appropriate personnel, and takes appropriate actions in response.
-        guidance: The organization documents the types of actions to be taken in response to security alerts/advisories. The organization also maintains contact with special interest groups (e.g., information security forums) that: (i) facilitate sharing of security-related information (e.g., threats, vulnerabilities, and latest security technologies); (ii) provide access to advice from security professionals; and (iii) improve knowledge of security best practices. NIST Special Publication 800-40 provides guidance on monitoring and distributing security alerts and advisories.
-        controlLevel: LOW
-        enhancements: (1)\nThe organization employs automated mechanisms to make security alert and advisory information available throughout the organization as needed.
-        supplement: High: (1) 
-
-    SI-06:
-        code: SI-06
-        class: OPERATIONAL
-        subclass: Security Functionality Verification 
-        family: System and Information Integrity
-        control: The information system verifies the correct operation of security functions [Selection (one or more): upon system startup and restart, upon command by user with appropriate privilege, periodically every [Assignment: organization-defined time-period]] and [Selection (one or more): notifies system administrator, shuts the system down, restarts the system] when anomalies are
-        guidance: The need to verify security functionality applies to all security functions. For those security functions that are not able to execute automated self-tests, the organization either implements compensating security controls or explicitly accepts the risk of not performing the verification as required.
-        controlLevel: HIGH
-        enhancements: (1)\nThe organization employs automated mechanisms to provide notification of failed automated security tests.\n(2)\nThe organization employs automated mechanisms to support management of distributed security testing.
-        supplement: None 
-
-    SI-07:
-        code: SI-07
-        class: OPERATIONAL
-        subclass: Software and Information Integrity 
-        family: System and Information Integrity
-        control: The information system detects and protects against unauthorized changes to software and information.
-        guidance: The organization employs integrity verification applications on the information system to look for evidence of information tampering, errors, and omissions. The organization employs good software engineering practices with regard to commercial off-the-shelf integrity mechanisms (e.g., parity checks, cyclical redundancy checks, cryptographic hashes) and uses tools to automatically monitor the integrity of the information system and the applications it hosts.
-        controlLevel: HIGH
-        enhancements: (1)\nThe organization reassesses the integrity of software and information by performing [Assignment: organization-defined frequency] integrity scans of the system.\n(2)\nThe organization employs automated tools that provide notification to appropriate individuals upon discovering discrepancies during integrity verification.\n(3)\nThe organization employs centrally managed integrity verification tools.
-        supplement: High: (1)(2) 
-
-    SI-08:
-        code: SI-08
-        class: OPERATIONAL
-        subclass: Spam Protection 
-        family: System and Information Integrity
-        control: The information system implements spam protection.
-        guidance: The organization employs spam protection mechanisms at critical information system entry points (e.g., firewalls, electronic mail servers, remote-access servers) and at workstations, servers, or mobile computing devices on the network. The organization uses the spam protection mechanisms to detect and take appropriate action on unsolicited messages transported by electronic mail, electronic mail attachments, Internet accesses, or other common means. Consideration is given to using spam protection software products from multiple vendors (e.g., using one vendor for boundary devices and servers and another vendor for workstations). NIST Special Publication 800-45 provides guidance on electronic mail security.
-        controlLevel: MODERATE
-        enhancements: (1)\nThe organization centrally manages spam protection mechanisms.\n(2)\nThe information system automatically updates spam protection mechanisms.
-        supplement: High: (1)
-
-    SI-09:
-        code: SI-09
-        class: OPERATIONAL
-        subclass: Information Input Restrictions 
-        family: System and Information Integrity
-        control: The organization restricts the capability to input information to the information system to authorized personnel.
-        guidance: Restrictions on personnel authorized to input information to the information system may extend beyond the typical access controls employed by the system and include limitations based on specific operational/project responsibilities.
-        controlLevel: MODERATE
-        enhancements: None
-        supplement: None 
-
-    SI-10:
-        code: SI-10
-        class: OPERATIONAL
-        subclass: Information Accuracy, Completeness, Validity, and Authenticity 
-        family: System and Information Integrity
-        control: The information system checks information for accuracy, completeness, validity, and authenticity.
-        guidance: Checks for accuracy, completeness, validity, and authenticity of information are accomplished as close to the point of origin as possible. Rules for checking the valid syntax of information system inputs (e.g., character set, length, numerical range, acceptable values) are in place to verify that inputs match specified definitions for format and content. Inputs passed to interpreters are prescreened to prevent the content from being unintentionally interpreted as commands. The extent to which the information system is able to check the accuracy, completeness, validity, and authenticity of information is guided by organizational policy and operational requirements.
-        controlLevel: MODERATE
-        enhancements: None
-        supplement: None 
-
-    SI-11:
-        code: SI-11
-        class: OPERATIONAL
-        subclass: Error Handling 
-        family: System and Information Integrity
-        control: The information system identifies and handles error conditions in an expeditious manner without providing information that could be exploited by adversaries.
-        guidance: The structure and content of error messages are carefully considered by the organization. Error messages are revealed only to authorized personnel. Error messages generated by the information system provide timely and useful information without revealing potentially harmful information that could be used by adversaries. Sensitive information (e.g., account numbers, social security numbers, and credit card numbers) are not listed in error logs or associated administrative messages. The extent to which the information system is able to identify and handle error conditions is guided by organizational policy and operational requirements.
-        controlLevel: MODERATE
-        enhancements: None
-        supplement: None 
-
-    SI-12:
-        code: SI-12
-        class: OPERATIONAL
-        subclass: Information Output Handling and Retention 
-        family: System and Information Integrity
-        control: The organization handles and retains output from the information system in accordance with applicable laws, Executive Orders, directives, policies, regulations, standards, and operational requirements.
-        guidance: None
-        controlLevel: MODERATE
-        enhancements: None
-        supplement: None 
+    # Rest of Rev 3 controls go here
+    # ...
Index: application/doctrine/data/fixtures/SecurityControlEnhancement.yml
===================================================================
--- application/doctrine/data/fixtures/SecurityControlEnhancement.yml	(revision 0)
+++ application/doctrine/data/fixtures/SecurityControlEnhancement.yml	(revision 0)
@@ -0,0 +1,27 @@
+SecurityControlEnhancement:
+    Rev0_AC_02_E1:
+        Control: Rev0_AC_02
+        level: MODERATE
+        description: >
+            The organization employs automated mechanisms to support the management of information 
+            system accounts.
+    Rev0_AC_02_E2:
+        Control: Rev0_AC_02
+        level: MODERATE
+        description: >
+            The information system automatically terminates temporary and emergency accounts after [<em>Assignment: 
+            organization-defined time period for each type of account</em>].
+    Rev0_AC_02_E3:
+        Control: Rev0_AC_02
+        level: MODERATE
+        description: >
+            The information system automatically disables inactive accounts after [<em>Assignment: organization-defined 
+            time period</em>].
+    Rev0_AC_02_E4:
+        Control: Rev0_AC_02
+        level: HIGH
+        description: >
+            The organization employs automated mechanisms to ensure that account creation, modification, disabling, and 
+            termination actions are audited and, as required, appropriate individuals are notified.
+            
+    # The rest of the rev 0, 1, 2, 3 enhancements go here
\ No newline at end of file
Index: application/doctrine/migrations/1277925016_version59.php
===================================================================
--- application/doctrine/migrations/1277925016_version59.php	(revision 0)
+++ application/doctrine/migrations/1277925016_version59.php	(revision 0)
@@ -0,0 +1,88 @@
+<?php
+/**
+ * Copyright (c) 2008 Endeavor Systems, Inc.
+ *
+ * This file is part of OpenFISMA.
+ *
+ * OpenFISMA is free software: you can redistribute it and/or modify it under the terms of the GNU General Public 
+ * License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later
+ * version.
+ *
+ * OpenFISMA is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied 
+ * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more 
+ * details.
+ *
+ * You should have received a copy of the GNU General Public License along with OpenFISMA.  If not, see 
+ * {@link http://www.gnu.org/licenses/}.
+ */
+
+/**
+ * Load metadata for security controls and catalogs from YAML fixture files
+ * 
+ * @package Migration
+ * @version $Id: 1276885091_version57.php 3531 2010-06-18 19:32:58Z jboyd $
+ * @copyright (c) Endeavor Systems, Inc. 2010 {@link http://www.endeavorsystems.com}
+ * @author Mark E. Haase <mhaase@endeavorsystems.com>
+ * @license http://www.openfisma.org/content/license GPLv3
+ */
+class Version59 extends Doctrine_Migration_Base
+{
+    /**
+     * Load security control metadata from YAML fixture files
+     * 
+     * This is a slight pain. The easiest way to do it is to copy the YAML files that contain the data into a new,
+     * separate folder by themselves. Then you can just load that folder. Loading the files one at a time will cause
+     * errors because of the references between the files.
+     */
+    public function up()
+    {
+        $tempDir = Fisma::getPath('temp') . '/version59data.' . uniqid();
+
+        if (!mkdir($tempDir, 0777)) {
+            throw new Fisma_Zend_Exception("Could not create temp directory: $tempDir");
+        }
+
+        $basePath = Fisma::getPath('fixture');
+        
+        if (!(   copy($basePath . '/SecurityControl.yml', $tempDir . '/SecurityControl.yml')
+              && copy($basePath . '/SecurityControlCatalog.yml', $tempDir . '/SecurityControlCatalog.yml')
+              && copy($basePath . '/SecurityControlEnhancement.yml', $tempDir . '/SecurityControlEnhancement.yml'))) {
+            throw new Fisma_Zend_Exception("Could not copy fixtures into temp directory: $tempDir");
+        }
+        
+        Doctrine::loadData($tempDir);
+        
+        unlink($tempDir . '/SecurityControl.yml');
+        unlink($tempDir . '/SecurityControlCatalog.yml');
+        unlink($tempDir . '/SecurityControlEnhancement.yml');
+        
+        rmdir($tempDir);
+        
+        // Insert the configuration item which indicates the default catalog.
+        // Default is NIST SP 800-53 Rev 2. This differs from the fixure (which is Rev3) because we don't want to 
+        // force upgrade pre-existing installations.
+        $configuration = new Configuration();
+        
+        $configuration->name = 'default_security_control_catalog_id';
+        $configuration->value = 3;
+        $configuration->description = 'The ID of the default security control catalog which is used when the user'
+                                    . ' doesn\'t explicitly specify a security control catalog.';
+        
+        $configuration->save();
+    }
+    
+    /**
+     * Delete security control metadata
+     */
+    public function down()
+    {
+        $deleteCategoryQuery = Doctrine_Query::create()->delete('SecurityControl');
+        $deleteCategoryQuery->execute();
+        
+        $deleteStepsQuery = Doctrine_Query::create()->delete('SecurityControlCatalog');
+        $deleteStepsQuery->execute();
+
+        $deleteWorkflowQuery = Doctrine_Query::create()->delete('SecurityControlEnhancement');
+        $deleteWorkflowQuery->execute();
+    }
+}
\ No newline at end of file
Index: application/doctrine/migrations/1277922214_version58.php
===================================================================
--- application/doctrine/migrations/1277922214_version58.php	(revision 0)
+++ application/doctrine/migrations/1277922214_version58.php	(revision 0)
@@ -0,0 +1,292 @@
+<?php
+/**
+ * Copyright (c) 2008 Endeavor Systems, Inc.
+ *
+ * This file is part of OpenFISMA.
+ *
+ * OpenFISMA is free software: you can redistribute it and/or modify it under the terms of the GNU General Public 
+ * License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later
+ * version.
+ *
+ * OpenFISMA is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied 
+ * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more 
+ * details.
+ *
+ * You should have received a copy of the GNU General Public License along with OpenFISMA.  If not, see 
+ * {@link http://www.gnu.org/licenses/}.
+ */
+
+/**
+ * Rename the current security control table, then create new security control table, security catalog control table,
+ * and security control enhancements table.
+ * 
+ * @package Migration
+ * @version $Id: 1276885091_version57.php 3531 2010-06-18 19:32:58Z jboyd $
+ * @copyright (c) Endeavor Systems, Inc. 2010 {@link http://www.endeavorsystems.com}
+ * @author Mark E. Haase <mhaase@endeavorsystems.com>
+ * @license http://www.openfisma.org/content/license GPLv3
+ */
+class Version58 extends Doctrine_Migration_Base
+{
+    /**
+     * Want to rename current security_control table. This will be used to update pointers in finding table
+     * to point at the new rows in the new security_control table. Foreign key needs to be dropped.
+     */
+    public function up()
+    {
+        $this->dropForeignKey('finding', 'finding_securitycontrolid_security_control_id');
+
+        $this->renameTable('security_control', 'security_control_backup');
+        
+		$this->createTable('security_control', array(
+             'id' => 
+             array(
+              'type' => 'integer',
+              'length' => 8,
+              'autoincrement' => true,
+              'primary' => true,
+             ),
+             'code' => 
+             array(
+              'type' => 'string',
+              'fixed' => 1,
+              'comment' => 'The control number, e.g. AC-05',
+              'extra' => 
+              array(
+              'searchIndex' => 'unstored',
+              ),
+              'length' => 5,
+             ),
+             'name' => 
+             array(
+              'type' => 'string',
+              'comment' => 'Name of the control',
+              'extra' => 
+              array(
+              'searchIndex' => 'unstored',
+              ),
+              'length' => 255,
+             ),
+             'class' => 
+             array(
+              'type' => 'enum',
+              'values' => 
+              array(
+              0 => 'MANAGEMENT',
+              1 => 'OPERATIONAL',
+              2 => 'TECHNICAL',
+              ),
+              'extra' => 
+              array(
+              'searchIndex' => 'keyword',
+              ),
+              'length' => NULL,
+             ),
+             'subclass' => 
+             array(
+              'type' => 'string',
+              'extra' => 
+              array(
+              'searchIndex' => 'unstored',
+              ),
+              'length' => 255,
+             ),
+             'family' => 
+             array(
+              'type' => 'string',
+              'extra' => 
+              array(
+              'searchIndex' => 'unstored',
+              ),
+              'length' => 255,
+             ),
+             'control' => 
+             array(
+              'type' => 'string',
+              'extra' => 
+              array(
+              'searchIndex' => 'unstored',
+              'purify' => 'html',
+              ),
+              'length' => NULL,
+             ),
+             'supplementalguidance' => 
+             array(
+              'type' => 'string',
+              'extra' => 
+              array(
+              'searchIndex' => 'unstored',
+              'purify' => 'html',
+              ),
+              'length' => NULL,
+             ),
+             'externalreferences' => 
+             array(
+              'type' => 'string',
+              'extra' => 
+              array(
+              'searchIndex' => 'unstored',
+              'purify' => 'html',
+              ),
+              'length' => NULL,
+             ),
+             'prioritycode' => 
+             array(
+              'type' => 'enum',
+              'values' => 
+              array(
+              0 => 'P0',
+              1 => 'P1',
+              2 => 'P2',
+              3 => 'P3',
+              ),
+              'extra' => 
+              array(
+              'searchIndex' => 'keyword',
+              ),
+              'length' => NULL,
+             ),
+             'controllevel' => 
+             array(
+              'type' => 'enum',
+              'values' => 
+              array(
+              0 => 'NONE',
+              1 => 'LOW',
+              2 => 'MODERATE',
+              3 => 'HIGH',
+              ),
+              'extra' => 
+              array(
+              'searchIndex' => 'keyword',
+              'searchAlias' => 'level',
+              ),
+              'length' => NULL,
+             ),
+             'securitycontrolcatalogid' => 
+             array(
+              'type' => 'integer',
+              'comment' => 'Foreign key to the catalog which this control belongs to',
+              'length' => 8,
+             ),
+             ), array(
+             'indexes' => 
+             array(
+             ),
+             'primary' => 
+             array(
+              0 => 'id',
+             ),
+             ));
+             
+ 		$this->createTable('security_control_catalog', array(
+              'id' => 
+              array(
+               'type' => 'integer',
+               'length' => 8,
+               'autoincrement' => true,
+               'primary' => true,
+              ),
+              'name' => 
+              array(
+               'type' => 'string',
+               'fixed' => 1,
+               'extra' => 
+               array(
+               'searchIndex' => 'unstored',
+               ),
+               'length' => NULL,
+              ),
+              ), array(
+              'indexes' => 
+              array(
+              ),
+              'primary' => 
+              array(
+               0 => 'id',
+              ),
+              ));
+
+		$this->createTable('security_control_enhancement', array(
+             'id' => 
+             array(
+              'type' => 'integer',
+              'length' => 8,
+              'autoincrement' => true,
+              'primary' => true,
+             ),
+             'level' => 
+             array(
+              'type' => 'enum',
+              'values' => 
+              array(
+              0 => 'LOW',
+              1 => 'MODERATE',
+              2 => 'HIGH',
+              ),
+              'comment' => 'Indicates the lowest baseline that includes this enhancement.',
+              'length' => NULL,
+             ),
+             'description' => 
+             array(
+              'type' => 'string',
+              'extra' => 
+              array(
+              'purify' => 'html',
+              ),
+              'length' => NULL,
+             ),
+             'securitycontrolid' => 
+             array(
+              'type' => 'integer',
+              'comment' => 'Foreign key',
+              'length' => 8,
+             ),
+             ), array(
+             'indexes' => 
+             array(
+             ),
+             'primary' => 
+             array(
+              0 => 'id',
+             ),
+             ));
+             
+ 		$this->createForeignKey('security_control', 'sssi', array(
+              'name' => 'sssi',
+              'local' => 'securitycontrolcatalogid',
+              'foreign' => 'id',
+              'foreignTable' => 'security_control_catalog',
+              ));
+              
+ 		$this->createForeignKey('security_control_enhancement', 'sssi_1', array(
+              'name' => 'sssi_1',
+              'local' => 'securitycontrolid',
+              'foreign' => 'id',
+              'foreignTable' => 'security_control',
+              ));
+    }
+
+    /**
+     * Drop the tables created above and rename the backup table to its original name
+     */
+    public function down()
+    {
+        $this->dropForeignKey('security_control_enhancement', 'sssi_1');
+
+        $this->dropForeignKey('security_control', 'sssi');
+        
+		$this->dropTable('security_control');
+		$this->dropTable('security_control_catalog');
+		$this->dropTable('security_control_enhancement');
+		
+        $this->renameTable('security_control_backup', 'security_control');
+        
+		$this->createForeignKey('finding', 'finding_securitycontrolid_security_control_id', array(
+             'name' => 'finding_securitycontrolid_security_control_id',
+             'local' => 'securitycontrolid',
+             'foreign' => 'id',
+             'foreignTable' => 'security_control',
+             ));
+    }
+}
\ No newline at end of file
Index: application/doctrine/migrations/1276885091_version57.php
===================================================================
--- application/doctrine/migrations/1276885091_version57.php	(revision 3558)
+++ application/doctrine/migrations/1276885091_version57.php	(working copy)
@@ -19,6 +19,8 @@
 /**
  * Drop the UserOrganization table
  * 
+ * @codingStandardsIgnoreFile
+ *
  * @package Migration
  * @version $Id$
  * @copyright (c) Endeavor Systems, Inc. 2010 {@link http://www.endeavorsystems.com}
Index: application/doctrine/migrations/1277927497_version60.php
===================================================================
--- application/doctrine/migrations/1277927497_version60.php	(revision 0)
+++ application/doctrine/migrations/1277927497_version60.php	(revision 0)
@@ -0,0 +1,77 @@
+<?php
+/**
+ * Copyright (c) 2008 Endeavor Systems, Inc.
+ *
+ * This file is part of OpenFISMA.
+ *
+ * OpenFISMA is free software: you can redistribute it and/or modify it under the terms of the GNU General Public 
+ * License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later
+ * version.
+ *
+ * OpenFISMA is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied 
+ * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more 
+ * details.
+ *
+ * You should have received a copy of the GNU General Public License along with OpenFISMA.  If not, see 
+ * {@link http://www.gnu.org/licenses/}.
+ */
+
+/**
+ * Load metadata for security controls and catalogs from YAML fixture files
+ * 
+ * @package Migration
+ * @version $Id: 1276885091_version57.php 3531 2010-06-18 19:32:58Z jboyd $
+ * @copyright (c) Endeavor Systems, Inc. 2010 {@link http://www.endeavorsystems.com}
+ * @author Mark E. Haase <mhaase@endeavorsystems.com>
+ * @license http://www.openfisma.org/content/license GPLv3
+ */
+class Version60 extends Doctrine_Migration_Base
+{
+    /**
+     * Use the security_control_backup table to reassign foreign key references between finding and security_control.
+     * 
+     * This is ugly to do in Doctrine, so I'm going to use a raw MySQL DBH.
+     * 
+     * Drop the backup table when done and create a new FK from finding to security_control
+     */
+    public function up()
+    {
+        $db = Doctrine_Manager::getInstance()->getConnection(0)->getDbh();
+        
+        // Create a temp table that contains join conditions for mapping old security control to new security control
+        $db->exec('create temporary table security_control_map (old int, new int)');
+        
+        $db->exec('
+            insert into security_control_map 
+                select old.id, new.id
+                from security_control_backup old
+                inner join security_control new on old.code = new.code and new.securitycontrolcatalogid=3
+        ');
+        
+        // Use map table to convert old foreign keys to new foreign keys
+        $db->exec('
+            update finding f set securitycontrolid = (
+            	select m.new 
+            	from security_control_map m
+            	where f.securitycontrolid = m.old
+            )
+        ');
+        
+        $this->dropTable('security_control_backup');
+        
+		$this->createForeignKey('finding', 'finding_securitycontrolid_security_control_id', array(
+             'name' => 'finding_securitycontrolid_security_control_id',
+             'local' => 'securitycontrolid',
+             'foreign' => 'id',
+             'foreignTable' => 'security_control',
+             ));
+    }
+    
+    /**
+     * This is not reversible since we are throwing away foreign key information in the up() method
+     */
+    public function down()
+    {
+        throw new Doctrine_Migration_IrreversibleMigrationException('Version 60 is not reversible.');
+    }
+}
\ No newline at end of file
Index: application/views/helpers/InjectAsset.php
===================================================================
--- application/views/helpers/InjectAsset.php	(revision 3558)
+++ application/views/helpers/InjectAsset.php	(working copy)
@@ -69,12 +69,15 @@
                                  ),
                                 '/stylesheets/combined.css' =>
                                 array('/stylesheets/main.css',
+                                      '/stylesheets/AutoComplete.css',
                                       '/stylesheets/AttachArtifacts.css',
                                       '/stylesheets/Dashboard.css',
+                                      '/stylesheets/Finding.css',
                                       '/stylesheets/FindingSummary.css',
                                       '/stylesheets/Incident.css',
                                       '/stylesheets/Modules.css',
-                                      '/stylesheets/SwitchButton.css'
+                                      '/stylesheets/SwitchButton.css',
+                                      '/stylesheets/Toolbar.css'
                                 )
                             );
 
Index: application/views/scripts/ir-workflow/tree.phtml
===================================================================
--- application/views/scripts/ir-workflow/tree.phtml	(revision 3558)
+++ application/views/scripts/ir-workflow/tree.phtml	(working copy)
@@ -1,6 +1,6 @@
 <?php Fisma_Format_Section::startSection("IR Workflows: Tree View <span id='searchResultsTotalFound'></span>"); ?>
 
-<div class="toolbar">
+<div class="buttonBar">
 <?php
 $expandAll = new Fisma_Yui_Form_Button('expandAll', 
                                        array('label' => 'Expand All', 
Index: application/views/scripts/security-control-catalog-admin/index.phtml
===================================================================
--- application/views/scripts/security-control-catalog-admin/index.phtml	(revision 0)
+++ application/views/scripts/security-control-catalog-admin/index.phtml	(revision 0)
@@ -0,0 +1,7 @@
+<?php
+Fisma_Format_Section::startSection('Security Control Catalog Administration');
+
+echo $this->form;
+
+Fisma_Format_Section::stopSection();
+?>
Index: application/views/scripts/system/view.phtml
===================================================================
--- application/views/scripts/system/view.phtml	(revision 3558)
+++ application/views/scripts/system/view.phtml	(working copy)
@@ -7,7 +7,7 @@
 <form enctype="multipart/form-data"
       action="/panel/system/sub/edit/id/<?php echo $this->escape($this->organization->id, 'none') ?>" 
       method="post">
-    <div class="toolbar">
+    <div class="buttonBar">
         <?php            
             if ($this->acl()->hasPrivilegeForObject('update', $this->organization)) {
                 $discardButton = new Fisma_Yui_Form_Button('discardChanges',
Index: application/views/scripts/incident/incident.phtml
===================================================================
--- application/views/scripts/incident/incident.phtml	(revision 3558)
+++ application/views/scripts/incident/incident.phtml	(working copy)
@@ -1,5 +1,5 @@
 <form method="post" action="<?php echo $this->escape($this->formAction, 'none'); ?>">
-    <div class="toolbar">
+    <div class="buttonBar">
     <?php
     if ($this->updateIncidentPrivilege):
         echo $this->escape($this->discardChangesButton, 'none');
Index: application/views/scripts/incident/users.phtml
===================================================================
--- application/views/scripts/incident/users.phtml	(revision 3558)
+++ application/views/scripts/incident/users.phtml	(working copy)
@@ -4,11 +4,10 @@
     if ($this->updateIncidentPrivilege):
     ?>
         <form method="post" action="/incident/add-user/type/actor/id/<?php echo $this->escape($this->id); ?>">
-            <input type="hidden" id="actorId" name="userId" value="">
-            <div style="position: relative; top: 0px; width: 200px;">&nbsp;
+            <div style="float: left; margin-top: 3px; width: 50%;">
                 <?php echo $this->escape($this->actorAutocomplete, 'none'); ?>
             </div>
-            <div style="position: relative; top 10px; left: 220px; margin-bottom: 20px; width: 150px;">&nbsp;
+            <div style="float: left; margin-left: 15px; margin-bottom: 15px;">
                 <?php echo $this->escape($this->addActorButton, 'none'); ?>
             </div>
         </form>
@@ -67,13 +66,13 @@
     if ($this->updateIncidentPrivilege):
     ?>
     <form method="post" action="/incident/add-user/type/observer/id/<?php echo $this->escape($this->id); ?>">
-        <input type="hidden" id="observerId" name="userId" value="">
-        <div style="position: relative; top: 0px; width: 200px;">&nbsp;
+        <div style="float: left; margin-top: 3px; width: 50%;">
             <?php echo $this->escape($this->observerAutocomplete, 'none'); ?>
         </div>
-        <div style="position: relative; top 10px; left: 220px; margin-bottom: 20px; width: 150px;">&nbsp;
+        <div style="float: left; margin-left: 15px; margin-bottom: 15px;">
             <?php echo $this->escape($this->addObserverButton, 'none'); ?>
         </div>
+        <div style="clear: both;"></div>
     </form>
     <?php
     endif;
Index: application/views/scripts/incident/artifacts.phtml
===================================================================
--- application/views/scripts/incident/artifacts.phtml	(revision 3558)
+++ application/views/scripts/incident/artifacts.phtml	(working copy)
@@ -1,4 +1,4 @@
-<div class="toolbar">
+<div class="buttonBar">
     <?php echo $this->escape($this->uploadPanelButton, 'none'); ?>
 </div>
 
Index: application/views/scripts/incident/comments.phtml
===================================================================
--- application/views/scripts/incident/comments.phtml	(revision 3558)
+++ application/views/scripts/incident/comments.phtml	(working copy)
@@ -1,7 +1,7 @@
 <?php
 Fisma_Format_Section::startSection('Comments');
 ?>
-    <div class="toolbar">
+    <div class="buttonBar">
         <?php echo $this->escape($this->commentButton, 'none'); ?>
     </div>
     <div id="comments">
Index: application/views/scripts/security-control-catalog/single-control.phtml
===================================================================
--- application/views/scripts/security-control-catalog/single-control.phtml	(revision 0)
+++ application/views/scripts/security-control-catalog/single-control.phtml	(revision 0)
@@ -0,0 +1,139 @@
+<table class="keyValues">
+    <tr>
+        <td width="200">
+            <div>
+                Control ID:
+            </div>
+        </td>
+        <td>
+            <?php echo $this->escape($this->securityControl->code); ?>
+        </td>
+    </tr>
+    <tr>
+        <td>Catalog: </td>
+        <td><?php echo $this->escape($this->securityControl->Catalog->name)?></td>
+    </tr>
+    <tr>
+        <td>Name:</td>
+        <td><?php echo $this->escape($this->securityControl->name)?></td>
+    </tr>
+    <tr>
+        <td>Class:</td>
+        <td><?php echo $this->escape($this->securityControl->class)?></td>
+    </tr>
+    <tr>
+        <td>Family:</td>
+        <td><?php echo $this->escape($this->securityControl->family)?></td>
+    </tr>
+    <tr>
+        <td>Control:</td>
+        <td><?php echo $this->escape($this->securityControl->control, 'none')?></td>
+    </tr>
+    <tr>
+        <td>Enhancements:</td>
+        <td>
+            <ol>
+            <?php foreach ($this->securityControl->Enhancements as $enhancement): ?>
+                <li><?php echo $this->escape($enhancement->description, 'none')?></li>
+            <?php endforeach; ?>
+            </ol>
+        </td>
+    </tr>
+    <tr>
+        <td>Supplemental Guidance:</td>
+        <td>
+            <?php echo $this->escape($this->securityControl->supplementalGuidance, 'none'); ?>
+        </td>
+    </tr>
+    <tr>
+        <td>References:</td>
+        <td>
+            <?php echo $this->escape($this->securityControl->externalReferences); ?>
+        </td>
+    </tr>
+    <tr>
+        <td>Priority:</td>
+        <td>
+            <?php echo $this->escape($this->securityControl->priorityCode); ?>
+        </td>
+    </tr>
+    <tr>
+        <td>Low Baseline:</td>
+        <td>
+            <?php 
+            if ('LOW' == $this->securityControl->controlLevel): 
+                echo $this->escape($this->securityControl->code);
+                
+                $i = 0;
+                foreach ($this->securityControl->Enhancements as $enhancement):
+                    $i++;
+                    
+                    if ('LOW' == $enhancement->level):
+                        echo $this->escape(" ($i)");
+                    endif;
+                endforeach;
+            else: 
+            ?>
+                Not Selected
+            <?php 
+            endif; 
+            ?>
+        </td>
+    </tr>
+    <tr>
+        <td>Moderate Baseline:</td>
+        <td>
+            <?php 
+            if ('LOW' == $this->securityControl->controlLevel ||
+                'MODERATE' == $this->securityControl->controlLevel): 
+                
+                echo $this->escape($this->securityControl->code);
+                
+                $i = 0;
+                foreach ($this->securityControl->Enhancements as $enhancement):
+                    $i++;
+                    
+                    if ('LOW' == $enhancement->level ||
+                        'MODERATE' == $enhancement->level):
+                        
+                        echo $this->escape(" ($i)");
+                    endif;
+                endforeach;
+            else: 
+            ?>
+                Not Selected
+            <?php 
+            endif; 
+            ?>
+        </td>
+    </tr>
+    <tr>
+        <td>High Baseline:</td>
+        <td>
+            <?php 
+            if ('LOW' == $this->securityControl->controlLevel ||
+                'MODERATE' == $this->securityControl->controlLevel ||
+                'HIGH' == $this->securityControl->controlLevel): 
+                
+                echo $this->escape($this->securityControl->code);
+                
+                $i = 0;
+                foreach ($this->securityControl->Enhancements as $enhancement):
+                    $i++;
+                    
+                    if ('LOW' == $enhancement->level ||
+                        'MODERATE' == $enhancement->level ||
+                        'HIGH' == $enhancement->level):
+                        
+                        echo $this->escape(" ($i)");
+                    endif;
+                endforeach;
+            else: 
+            ?>
+                Not Selected
+            <?php 
+            endif; 
+            ?>
+        </td>
+    </tr>
+</table>
Index: application/views/scripts/security-control-catalog/toolbar.phtml
===================================================================
--- application/views/scripts/security-control-catalog/toolbar.phtml	(revision 0)
+++ application/views/scripts/security-control-catalog/toolbar.phtml	(revision 0)
@@ -0,0 +1,3 @@
+<div class="toolbar">
+    <?php echo $this->escape($this->toolbarForm, 'none'); ?>
+</div>
Index: application/views/scripts/security-control-catalog/view.phtml
===================================================================
--- application/views/scripts/security-control-catalog/view.phtml	(revision 0)
+++ application/views/scripts/security-control-catalog/view.phtml	(revision 0)
@@ -0,0 +1,10 @@
+<?php 
+Fisma_Format_Section::startSection("Security Control: {$this->securityControl->code}");
+
+echo $this->partial(
+    'security-control-catalog/single-control.phtml',
+    array('securityControl' => $this->securityControl)
+);
+
+Fisma_Format_Section::stopSection();
+?>
Index: application/views/scripts/security-control-catalog/list.phtml
===================================================================
--- application/views/scripts/security-control-catalog/list.phtml	(revision 0)
+++ application/views/scripts/security-control-catalog/list.phtml	(revision 0)
@@ -0,0 +1,14 @@
+<?php 
+
+echo $this->escape(
+    $this->partial('security-control-catalog/toolbar.phtml', array('toolbarForm' => $this->toolbarForm)), 
+    'none'
+);
+
+Fisma_Format_Section::startSection($this->catalogName);
+
+echo $this->controlTable;
+
+Fisma_Format_Section::stopSection(); 
+
+?>
Index: application/views/scripts/remediation/summary.phtml
===================================================================
--- application/views/scripts/remediation/summary.phtml	(revision 3558)
+++ application/views/scripts/remediation/summary.phtml	(working copy)
@@ -121,7 +121,7 @@
     </select>
 </div>
 
-<div class="toolbar">
+<div class="buttonBar">
 <?php
 $expandAll = new Fisma_Yui_Form_Button('expandAll', 
                                        array('label' => 'Expand All', 
Index: application/views/scripts/remediation/mitigation-strategy.phtml
===================================================================
--- application/views/scripts/remediation/mitigation-strategy.phtml	(revision 3558)
+++ application/views/scripts/remediation/mitigation-strategy.phtml	(working copy)
@@ -151,7 +151,7 @@
     <p><i>The mitigation strategy, security control, and risk analysis sections must
           be fully completed before this can be submitted for approval.</i></p>
 
-    <div class='toolbar'><?php echo $this->escape($submitMitigationButton, 'none')?></div>
+    <div class='buttonBar'><?php echo $this->escape($submitMitigationButton, 'none')?></div>
 <?php
 }
 
@@ -172,7 +172,7 @@
             return false;
         }
     </script>
-    <div class='toolbar'><?php echo $this->escape($reviseMitigationButton, 'none')?></div>
+    <div class='buttonBar'><?php echo $this->escape($reviseMitigationButton, 'none')?></div>
 <?php
 }  
 
Index: application/views/scripts/remediation/search.phtml
===================================================================
--- application/views/scripts/remediation/search.phtml	(revision 3558)
+++ application/views/scripts/remediation/search.phtml	(working copy)
@@ -1,5 +1,5 @@
 <?php Fisma_Format_Section::startSection("Search Results <span id='searchResultsTotalFound'></span>"); ?>
-    <div class="toolbar">
+    <div class="buttonBar">
         <?php 
             $exportPdfButton = new Fisma_Yui_Form_Button_Link('exportPdf',
                                           array('value' => 'Export PDF', 
Index: application/views/scripts/remediation/view.phtml
===================================================================
--- application/views/scripts/remediation/view.phtml	(revision 3558)
+++ application/views/scripts/remediation/view.phtml	(working copy)
@@ -13,7 +13,7 @@
       method="post" 
       id="finding_detail"
       name="finding_detail">
-    <div class="toolbar">
+    <div class="buttonBar">
         <?php
             $backToSearchButton = new Fisma_Yui_Form_Button('backToSearch',
                                                       array('label' => 'Back To Search Results', 
Index: application/views/scripts/remediation/artifacts.phtml
===================================================================
--- application/views/scripts/remediation/artifacts.phtml	(revision 3558)
+++ application/views/scripts/remediation/artifacts.phtml	(working copy)
@@ -113,6 +113,6 @@
 
 <p>Evidence can only be uploaded if the finding is in 'EN' status and if you have the required role.</p>
 
-<div class='toolbar'>
+<div class='buttonBar'>
     <?php echo $this->escape($uploadEvidenceButton, 'none');?>
 </div>
Index: application/views/scripts/remediation/security-control.phtml
===================================================================
--- application/views/scripts/remediation/security-control.phtml	(revision 3558)
+++ application/views/scripts/remediation/security-control.phtml	(working copy)
@@ -1,107 +1,32 @@
+<?php
+echo $this->escape($this->securityControlSearchButton, 'none')
+?>
+
+<div id="findingSecurityControlSearch">
+    <?php echo $this->escape($this->form, 'none'); ?>
+</div>
+
 <?php 
-    Fisma_Format_Section::startSection('NIST 800-53 Control Mapping');
-    $organization = $this->finding->ResponsibleOrganization->nickname;
+Fisma_Format_Section::startSection('Security Control');
 ?>
-<table class="keyValues">
-    <tr>
-        <td width="200">
-            <div>
-                Control ID:
-            </div>
-        </td>
-        <td>
-            <span id="security_control" 
-                  type="select" 
-                  name="finding[securityControlId]" 
-                  href="/metainfo/list/o/security_control/format/html/"
-                    <?php
-                    if ($this->acl()->hasPrivilegeForObject('update_control_assignment', $this->finding)
-                        && ('NEW' == $this->finding->status || 'DRAFT' == $this->finding->status)) {
-                        echo $this->escape('class="editable" target="security_control"', 'none');
-                    }
-                    ?>>
 
-                <?php
-                if (!empty($this->finding->securityControlId)) {
-                    echo $this->escape($this->finding->SecurityControl->code);
-                } else {
-                    // nbsp is a hack to make the pencil appear in the right place
-                    echo $this->escape('NONE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;', 'none');
-                }
-                ?>
-            </span>
-        </td>
-    </tr>
-    <?php 
-    if (!empty($this->finding->securityControlId)) {
-        $securityControl = $this->finding->SecurityControl; 
+<div id="securityControlContainer">
+
+    <?php
+    if (!empty($this->finding->securityControlId)):
+        echo $this->partial(
+            'security-control-catalog/single-control.phtml',
+            array('securityControl' => $this->finding->SecurityControl)
+        );
+    else:
     ?>
-        <tr>
-            <td>Class:</td>
-            <td><?php echo $this->escape($securityControl->class)?></td>
-        </tr>
-        <tr>
-            <td>Family:</td>
-            <td><?php echo $this->escape($securityControl->family)?></td>
-        </tr>
-        <tr>
-            <td>Subclass:</td>
-            <td><?php echo $this->escape($securityControl->subclass)?></td>
-        </tr>
-        <tr>
-            <td>Low Impact System:</td>
-            <td>
-                <?php if ('LOW' == $securityControl->controlLevel): ?>
-                    Control Required
-                <?php else: ?>
-                    Control Not Required 
-                <?php endif; ?>
-            </td>
-        </tr>
-        <tr>
-            <td>Moderate Impact System:</td>
-            <td>
-                <?php if ('LOW' == $securityControl->controlLevel || 
-                     'MODERATE' == $securityControl->controlLevel): ?>
-                     Control Required
-                <?php else: ?>
-                     Control Not Required
-                <?php endif; ?>
-            </td>
-        </tr>
-        <tr>
-            <td>High Impact System:</td>
-            <td>
-                <?php if ('LOW' == $securityControl->controlLevel || 
-                     'MODERATE' == $securityControl->controlLevel || 
-                     'HIGH'     == $securityControl->controlLevel): ?>
-                     Control Required
-                <?php else: ?>
-                     Control Not Required
-                <?php endif; ?>
-            </td>
-        </tr>
-        <tr>
-            <td>Control:</td>
-            <td><?php echo $this->escape($securityControl->control)?></td>
-        </tr>
-        <tr>
-            <td>Guidance:</td>
-            <td><?php echo $this->escape($securityControl->guidance)?></td></tr>
-        <tr>
-            <td>Enhancements:</td>
-            <td>
-                <?php echo $this->escape(str_replace("\\n", "<br>", $securityControl->enhancements), 'none'); ?>
-            </td>
-        </tr>
-        <tr>
-            <td>Supplement:</td>
-            <td>
-                <?php echo $this->escape($securityControl->supplement); ?>
-            </td>
-        </tr>
-    <?php 
-    } 
+        <em>No control selected</em>
+    <?php
+    endif;
     ?>
-</table>
-<?php Fisma_Format_Section::stopSection(); ?>
+
+</div>
+
+<?php
+Fisma_Format_Section::stopSection();
+?>
Index: application/views/scripts/remediation/comments.phtml
===================================================================
--- application/views/scripts/remediation/comments.phtml	(revision 3558)
+++ application/views/scripts/remediation/comments.phtml	(working copy)
@@ -1,7 +1,7 @@
 <?php
 Fisma_Format_Section::startSection('Comments');
 ?>
-    <div class="toolbar">
+    <div class="buttonBar">
         <?php echo $this->escape($this->commentButton, 'none'); ?>
     </div>
     
Index: application/views/scripts/asset/sublist.phtml
===================================================================
--- application/views/scripts/asset/sublist.phtml	(revision 3558)
+++ application/views/scripts/asset/sublist.phtml	(working copy)
@@ -6,7 +6,7 @@
     }
 </script>
 <form id="assetresult" method="post" action="/asset/delete">
-<div class="toolbar">
+<div class="buttonBar">
     <?php
         $pdfButton = new Fisma_Yui_Form_Button_Link('pdf', 
                                       array('value' => 'Export PDF', 
Index: application/views/scripts/asset/list.phtml
===================================================================
--- application/views/scripts/asset/list.phtml	(revision 3558)
+++ application/views/scripts/asset/list.phtml	(working copy)
@@ -7,7 +7,7 @@
     }
 </script>
 <form id="assetresult" method="post" action="/panel/asset/sub/multidelete">
-<div class="toolbar">
+<div class="buttonBar">
     <?php
         if ($this->acl()->hasPrivilegeForClass('create', 'Asset')) {
             $importButton = new Fisma_Yui_Form_Button_Link('import',
Index: application/views/scripts/ir-category/tree.phtml
===================================================================
--- application/views/scripts/ir-category/tree.phtml	(revision 3558)
+++ application/views/scripts/ir-category/tree.phtml	(working copy)
@@ -1,6 +1,6 @@
 <?php Fisma_Format_Section::startSection("IR Categories: Tree View"); ?>
 
-<div class="toolbar">
+<div class="buttonBar">
 <?php
 $expandAll = new Fisma_Yui_Form_Button('expandAll', 
                                        array('label' => 'Expand All', 
Index: application/views/scripts/finding-report/plugin-report.phtml
===================================================================
--- application/views/scripts/finding-report/plugin-report.phtml	(revision 3558)
+++ application/views/scripts/finding-report/plugin-report.phtml	(working copy)
@@ -1,6 +1,6 @@
 <?php Fisma_Format_Section::startSection($this->title); ?>
 
-<div class="toolbar">
+<div class="buttonBar">
     <?php
     $exportPdfButton = new Fisma_Yui_Form_Button_Link('exportPdf',
                                   array('value' => 'Export PDF',
Index: application/views/scripts/finding-report/overdue.phtml
===================================================================
--- application/views/scripts/finding-report/overdue.phtml	(revision 3558)
+++ application/views/scripts/finding-report/overdue.phtml	(working copy)
@@ -87,7 +87,7 @@
 
 <?php if ( !empty($this->poamList) ) { ?>
 <?php Fisma_Format_Section::startSection("Poam Search Results"); ?>
-    <div class="toolbar">
+    <div class="buttonBar">
         <?php echo $this->escape($this->links['all'], 'none')?>
         <?php 
             $exportPdfButton = new Fisma_Yui_Form_Button_Link(
Index: application/views/scripts/security-control-catalog-chart/control-deficiencies.xml.phtml
===================================================================
--- application/views/scripts/security-control-catalog-chart/control-deficiencies.xml.phtml	(revision 0)
+++ application/views/scripts/security-control-catalog-chart/control-deficiencies.xml.phtml	(revision 0)
@@ -0,0 +1,46 @@
+<chart>
+    <license>FTA9HNF7P2O.H4X5CWK-2XOI1X0-7L</license>
+
+    <chart_data>
+        <row>
+            <null />
+            <?php
+            foreach ($this->deficiencies as $deficiency):
+            ?>
+                <string><?php echo $this->escape($deficiency['sc_code']); ?></string>
+            <?php
+            endforeach;
+            ?>
+        </row>
+        <row>
+            <string>Open Findings</string>
+            <?php
+            foreach ($this->deficiencies as $deficiency):
+            $tooltip = '1';
+                $tooltip = "{$deficiency['sc_count']} Finding"
+                         . ($deficiency['sc_count'] > 1 ? 's' : '');
+            ?>
+                <number tooltip="<?php echo $this->escape($tooltip)?>">
+                    <?php echo $this->escape($deficiency['sc_count']); ?></number>
+            <?php
+            endforeach;
+            ?>
+        </row>
+    </chart_data>
+
+    <chart_type>column</chart_type>
+    
+    <chart_rect x='50'
+                height='165' 
+                width='625' />
+
+    <axis_category font='arial' 
+                   orientation='vertical_up' />
+
+    <legend layout='vertical'
+            bullet='square' />
+
+    <series_color>
+        <color>416ed7</color>
+    </series_color>
+</chart> 
Index: application/views/scripts/finding-dashboard/index.phtml
===================================================================
--- application/views/scripts/finding-dashboard/index.phtml	(revision 0)
+++ application/views/scripts/finding-dashboard/index.phtml	(revision 0)
@@ -0,0 +1,9 @@
+<?php Fisma_Format_Section::startSection('System Inventory Dashboard'); ?>
+
+<div class='dashboardChart'>
+    <?php echo $this->escape($this->controlDeficienciesChart, 'none'); ?>
+        
+    Current Security Control Deficiencies
+</div>
+
+<?php Fisma_Format_Section::stopSection(); ?>
Index: application/views/scripts/organization/tree.phtml
===================================================================
--- application/views/scripts/organization/tree.phtml	(revision 3558)
+++ application/views/scripts/organization/tree.phtml	(working copy)
@@ -1,6 +1,6 @@
 <?php Fisma_Format_Section::startSection("Organizations: Tree View <span id='searchResultsTotalFound'></span>"); ?>
 
-<div class="toolbar">
+<div class="buttonBar">
 <?php
 $expandAll = new Fisma_Yui_Form_Button('expandAll', 
                                        array('label' => 'Expand All', 
Index: application/views/scripts/finding/template.xls.phtml
===================================================================
--- application/views/scripts/finding/template.xls.phtml	(revision 3558)
+++ application/views/scripts/finding/template.xls.phtml	(working copy)
@@ -18,6 +18,7 @@
  </DocumentProperties>
  <CustomDocumentProperties xmlns="urn:schemas-microsoft-com:office:office">
   <FismaTemplateVersion dt:dt="float"><?php echo $this->escape($this->templateVersion) ?></FismaTemplateVersion>
+  <SecurityControlCatalogId dt:dt="float"><?php echo $this->escape($this->securityControlCatalogId) ?></SecurityControlCatalogId>
  </CustomDocumentProperties>
  <Styles>
   <Style ss:ID="Default" ss:Name="Normal">
@@ -166,8 +167,8 @@
    <Row ss:AutoFitHeight="0" ss:Height="26.25" ss:StyleID="s27">
     <Cell ss:MergeAcross="20" ss:StyleID="s29"><Data ss:Type="String"><?php echo $this->escape(Fisma::configuration()->getConfig('system_name'));?> - Injection Template</Data></Cell>
    </Row>
-   <Row ss:AutoFitHeight="0" ss:Height="110.25" ss:StyleID="s27">
-    <Cell ss:MergeAcross="20" ss:StyleID="m43958186"><Data ss:Type="String">Instructions: &#10;1) Required fields are indicated by an asterix (*). &#10;2) Leave optional fields blank if you do not have that information.&#10;3) Do not modify the format of this template, or it may not upload into <?php echo $this->escape(Fisma::configuration()->getConfig('system_name'));?>. You may hide rows and columns using Excel's menu option: Format-&gt;Row-&gt;Hide&#10;4) To enter an asset for a finding, complete the Network, Asset IP Address, and Asset Port fields. If you do not enter all 3 of these fields, then the asset will be omitted.&#10;5) To enter a product, complete the Product Name, Product Vendor, and Product Version. If you do not enter all 3 of these fields, then the product will be omitted.&#10;&#10;</Data></Cell>
+   <Row ss:AutoFitHeight="0" ss:Height="129.75" ss:StyleID="s27">
+    <Cell ss:MergeAcross="20" ss:StyleID="m43958186"><Data ss:Type="String">Security Catalog: <?php echo $this->escape($this->securityControlCatalogName); ?>&#10;Instructions: &#10;1) Required fields are indicated by an asterix (*). &#10;2) Leave optional fields blank if you do not have that information.&#10;3) Do not modify the format of this template, or it may not upload into <?php echo $this->escape(Fisma::configuration()->getConfig('system_name'));?>. You may hide rows and columns using Excel's menu option: Format-&gt;Row-&gt;Hide&#10;4) To enter an asset for a finding, complete the Network, Asset IP Address, and Asset Port fields. If you do not enter all 3 of these fields, then the asset will be omitted.&#10;5) To enter a product, complete the Product Name, Product Vendor, and Product Version. If you do not enter all 3 of these fields, then the product will be omitted.&#10;&#10;</Data></Cell>
    </Row>
    <Row ss:AutoFitHeight="0" ss:Height="38.25">
     <Cell ss:StyleID="s39"><Data ss:Type="String">System*</Data><Comment
@@ -312,6 +313,7 @@
 ?>
   </Table>
   <WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel">
+   <Visible>SheetHidden</Visible>
    <Print>
     <ValidPrinterInfo/>
     <HorizontalResolution>600</HorizontalResolution>
@@ -343,6 +345,7 @@
 ?>
   </Table>
   <WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel">
+   <Visible>SheetHidden</Visible>
    <Print>
     <ValidPrinterInfo/>
     <HorizontalResolution>600</HorizontalResolution>
@@ -374,6 +377,7 @@
 ?>
   </Table>
   <WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel">
+   <Visible>SheetHidden</Visible>
    <Print>
     <ValidPrinterInfo/>
     <HorizontalResolution>600</HorizontalResolution>
@@ -405,6 +409,7 @@
 ?>
   </Table>
   <WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel">
+   <Visible>SheetHidden</Visible>
    <Print>
     <ValidPrinterInfo/>
     <HorizontalResolution>600</HorizontalResolution>
Index: application/views/scripts/finding/injection.phtml
===================================================================
--- application/views/scripts/finding/injection.phtml	(revision 3558)
+++ application/views/scripts/finding/injection.phtml	(working copy)
@@ -1,23 +1,34 @@
-<?php 
-Fisma_Format_Section::startSection("Spreadsheet Upload"); 
+<?php
+Fisma_Format_Section::startSection("Download Template File"); 
 $microsoftUrl = 'http://www.microsoft.com/downloads/details.aspx?'
               . 'FamilyID=941b3470-3ae9-4aee-8f43-c6bb74cd1466&displaylang=en';
 ?>
-    <form action="/panel/finding/sub/injection" method="POST" enctype="multipart/form-data">
-        <ol>
-            <li>Download the Excel <a href="/finding/template">template file</a>.
-            <p>(The template file requires Excel 2007 or
-            the Office Compatibility Pack, which can be downloaded for free from
-            <a href="<?php echo $this->escape($microsoftUrl, 'none')?>">Microsoft</a>.)</p>
-            <li>Complete the template, following the instructions included in the template header.
-            <li><label for="excelFile">Upload the completed spreadsheet here:</label> <br>
-            <input type="file" name="excelFile" id="excelFile">
-        </ol>
-        <p>
-            <?php
-                $uploadExcelButton = new Fisma_Yui_Form_Button_Submit('uploadExcelSubmit', array('label' => 'Upload'));
-                echo $this->escape($uploadExcelButton, 'none');
-            ?>
-        </p>
-    </form>
-<?php Fisma_Format_Section::stopSection(); ?>
+
+<p>
+    The spreadsheet upload relies on a template file. This template file is generated on-the-fly and includes the
+    latest production metadata, such as names of systems, networks, and finding sources. You should download a new
+    template any time you begin an audit.
+</p>
+<p>
+    <em>The template file requires Excel 2007 or the Office Compatibility Pack, which can be downloaded for free from
+    <a href="<?php echo $this->escape($microsoftUrl, 'none')?>">Microsoft</a>.</em>
+</p>
+
+<?php 
+echo $this->escape($this->downloadForm, 'none');
+
+Fisma_Format_Section::stopSection(); 
+
+Fisma_Format_Section::startSection("Upload Completed Template File"); 
+?>
+
+<p>
+    Select a completed template file and upload it here. Do not change the formatting of the template file, as this
+    may render the file unusable.
+</p>
+
+<?php 
+echo $this->escape($this->uploadForm, 'none');
+
+Fisma_Format_Section::stopSection();
+?>
Index: library/Fisma/Menu.php
===================================================================
--- library/Fisma/Menu.php	(revision 3558)
+++ library/Fisma/Menu.php	(working copy)
@@ -69,13 +69,11 @@
                 $findings->add(new Fisma_Yui_MenuItem('Upload Spreadsheet', '/panel/finding/sub/injection'));
                 $findings->add(new Fisma_Yui_MenuItem('Upload Scan Results', '/panel/finding/sub/plugin'));
             }
-                        
-            if ($acl->hasArea('finding_admin')
-                || $acl->hasArea('finding_report')) {
-                    
-                $findings->addSeparator();
-            }
-            
+                                    
+            $findings->addSeparator();
+
+            $findings->add(new Fisma_Yui_MenuItem('Dashboard', '/finding-dashboard'));
+
             // Finding Administration submenu
             if ($acl->hasArea('finding_admin')) {
                 $findingAdminSubmenu = new Fisma_Yui_Menu('Administration');
@@ -112,6 +110,8 @@
             if ($acl->hasPrivilegeForClass('read', 'Asset')) {
                 $systemInventoryMenu->add(new Fisma_Yui_MenuItem('Assets', '/panel/asset/sub/list'));
             }
+            
+            $systemInventoryMenu->add(new Fisma_Yui_MenuItem('Controls', '/security-control-catalog/list'));
 
             $systemInventoryMenu->add(new Fisma_Yui_MenuItem('Documentation', '/panel/system-document/sub/list'));
 
@@ -127,6 +127,8 @@
             if ($acl->hasArea('system_inventory_admin')) {
                 $systemInventoryAdminMenu = new Fisma_Yui_Menu('Administration');
 
+                $systemInventoryAdminMenu->add(new Fisma_Yui_MenuItem('Controls', '/security-control-catalog-admin'));
+
                 if ($acl->hasPrivilegeForClass('read', 'Network')) {
                     $systemInventoryAdminMenu->add(new Fisma_Yui_MenuItem('Networks', '/panel/network/sub/list'));
                 }
Index: library/Fisma/Zend/Form/Manager.php
===================================================================
--- library/Fisma/Zend/Form/Manager.php	(revision 3558)
+++ library/Fisma/Zend/Form/Manager.php	(working copy)
@@ -46,9 +46,9 @@
         $form = new Fisma_Zend_Form();
         
         // Configure this form to use custom form elements
-        $form->addPrefixPath('Fisma_Zend_Form', 'Fisma/Zend/Form', 'element'); // library/Fisma/Form/...
-        $form->addPrefixPath('Fisma_Zend_Form', 'Fisma/Zend/Form', 'decorator'); // library/Fisma/Form/...
-        $form->addPrefixPath('Fisma_Yui', 'Fisma/Yui', 'element'); // library/Fisma/Yui/...
+        $form->addPrefixPath('Fisma_Zend_Form', 'Fisma/Zend/Form', 'element');
+        $form->addPrefixPath('Fisma_Zend_Form_Decorator', 'Fisma/Zend/Form/Decorator', 'decorator');
+        $form->addPrefixPath('Fisma_Yui', 'Fisma/Yui', 'element');
         $form->setConfig($config);
 
         return $form;
Index: library/Fisma/Zend/Form/Decorator/RenderSelf.php
===================================================================
--- library/Fisma/Zend/Form/Decorator/RenderSelf.php	(revision 0)
+++ library/Fisma/Zend/Form/Decorator/RenderSelf.php	(revision 0)
@@ -0,0 +1,50 @@
+<?php
+/**
+ * Copyright (c) 2010 Endeavor Systems, Inc.
+ *
+ * This file is part of OpenFISMA.
+ *
+ * OpenFISMA is free software: you can redistribute it and/or modify it under the terms of the GNU General Public 
+ * License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later
+ * version.
+ *
+ * OpenFISMA is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied 
+ * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more 
+ * details.
+ *
+ * You should have received a copy of the GNU General Public License along with OpenFISMA.  If not, see 
+ * {@link http://www.gnu.org/licenses/}.
+ */
+
+/**
+ * A decorator which lets an element render itself, if the element has a renderSelf() method
+ * 
+ * @author     Mark E. Haase
+ * @copyright  (c) Endeavor Systems, Inc. 2009 {@link http://www.endeavorsystems.com}
+ * @license    http://www.openfisma.org/content/license GPLv3
+ * @package    Fisma
+ * @subpackage Fisma_Zend
+ * @version    $Id$
+ */
+class Fisma_Zend_Form_Decorator_RenderSelf extends Zend_Form_Decorator_Abstract
+{
+    /**
+     * Allow an element to render itself, if it is capable of doing so.
+     * 
+     * Otherwise, it will return the same content passed in
+     * 
+     * @param string $content
+     */
+    public function render($content)
+    {
+        $render = $content;
+        
+        // Replace content with the element's own self-rendering, if it has a selfRender method
+        $element = $this->getElement();
+        if (method_exists($element, 'renderSelf')) {
+            $render = $element->renderSelf();
+        }
+        
+        return $render;
+    }
+}
Index: library/Fisma/Yui/Form/AutoComplete.php
===================================================================
--- library/Fisma/Yui/Form/AutoComplete.php	(revision 3558)
+++ library/Fisma/Yui/Form/AutoComplete.php	(working copy)
@@ -47,28 +47,47 @@
     function renderSelf() 
     {
         $disabled = "";
-        
+
         if ($this->getAttrib('readonly')) {
             $disabled = "disabled=\"true\"";
         }
 
         $name = $this->getName();
-        
+
+        $hiddenField = $this->getAttrib('hiddenField');
+        $hiddenValue = isset($_POST[$hiddenField]) ? $_POST[$hiddenField] : null;
+        $hiddenValueAttrib = empty($hiddenValue) ? '' : "value=\"$hiddenValue\"";
+
+        $displayedValue = isset($_POST[$name]) ? $_POST[$name] : null;
+        $displayedValueAttrib = empty($displayedValue) ? '' : "value=\"$displayedValue\"";
+                
         $render  = "<div>
-                    <input type=\"text\" name=\"$name\" id=\"$name\" {$disabled} value=\"{$this->getValue()}\"/>
-                    <div id=\"{$this->getAttrib('containerId')}\"></div>
+                    <input type='hidden' 
+                           id='{$this->getAttrib('hiddenField')}' 
+                           name='{$this->getAttrib('hiddenField')}'
+                           $hiddenValueAttrib>
+                    <input type=\"text\" 
+                           name=\"$name\" 
+                           id=\"$name\" 
+                           $displayedValueAttrib
+                           $disabled>
+                    <img class='spinner'
+                         id='{$this->getAttrib('containerId')}Spinner' 
+                         src='/images/spinners/small.gif'>
+                    <div id=\"{$this->getAttrib('containerId')}\"></div>                    
                     </div>";
 
         if (!$this->getAttrib('readonly')) {
-            $render = $render . "
-                <script type='text/javascript'>
+            $render .= 
+                "<script type='text/javascript'>
                 YAHOO.util.Event.onDOMReady(Fisma.AutoComplete.init,
                   { schema: [\"{$this->getAttrib('resultsList')}\", \"{$this->getAttrib('fields')}\"],
                     xhr : \"{$this->getAttrib('xhr')}\",
                     fieldId : \"$name\",
                     containerId: \"{$this->getAttrib('containerId')}\",
-                    hiddenFieldId: \"{$this->getAttrib('hiddenField')}\",
-                    queryPrepend: \"{$this->getAttrib('queryPrepend')}\"
+                    hiddenFieldId: \"$hiddenField\",
+                    queryPrepend: \"{$this->getAttrib('queryPrepend')}\",
+                    callback : '{$this->getAttrib('callback')}'
                   } );
             </script>";
         }
Index: library/Fisma/Doctrine/Record.php
===================================================================
--- library/Fisma/Doctrine/Record.php	(revision 3558)
+++ library/Fisma/Doctrine/Record.php	(working copy)
@@ -115,7 +115,7 @@
      */
     public function getOriginalValue($fieldName)
     {
-        return isset($this->_originalValues[$fieldName]) ? $this->_originalValues[$fieldName] : null;
+        return array_key_exists($fieldName, $this->_originalValues) ? $this->_originalValues[$fieldName] : null;
     }
     
     /**
Index: library/Fisma/Inject/Excel.php
===================================================================
--- library/Fisma/Inject/Excel.php	(revision 3558)
+++ library/Fisma/Inject/Excel.php	(working copy)
@@ -41,8 +41,12 @@
      * The template version is used to make sure that we don't try to process a template which was produced by a
      * previous version of OpenFISMA. This number should be incremented whenever the template file or processing code
      * is modified.
+     * 
+     * Version history:
+     * v1 2009-04-30 Introduce versioning of excel template
+     * v2 2010-06-28 Add metadata regarding which security control catalog was used to produce the template
      */
-    const TEMPLATE_VERSION = 1;
+    const TEMPLATE_VERSION = 2;
     
     /**
      * Maps numerical indexes corresponding to column numbers in the excel upload template onto those
@@ -127,6 +131,9 @@
             );
         }
         
+        // Look up the control catalog ID for this template in the spreadsheet properties. This is used later.
+        $securityControlCatalogId = (int)$spreadsheet->CustomDocumentProperties->SecurityControlCatalogId;
+
         // Have to do some namespace manipulation to make the spreadsheet searchable by xpath.
         $namespaces = $spreadsheet->getNamespaces(true);
         $spreadsheet->registerXPathNamespace('s', $namespaces['']);
@@ -203,18 +210,26 @@
                                                       be out of date. Please try downloading it again.");
             }
             $poam['sourceId'] = $sourceTable->id;
+                        
+            // Match controls by code (e.g. "AC-01") and security control catalog ID
             if (!empty($finding['securityControl'])) {
                 $securityControlTable = Doctrine::getTable('SecurityControl');
-                $securityControlTable = $securityControlTable->findOneByCode($finding['securityControl']);
-                if (!$securityControlTable) {
+                
+                $conditions = 'code = ? and securityControlCatalogId = ?';
+                $parameters = array($finding['securityControl'], $securityControlCatalogId);
+
+                $securityControls = $securityControlTable->findByDql($conditions, $parameters);
+
+                if (count($securityControls) != 1) {
                     $error = "Row $rowNumber: Invalid security control selected. Your template may be out of date."
                            . 'Please try downloading it again.';
                     throw new Fisma_Zend_Exception_InvalidFileFormat($error);
                 }
-                $poam['securityControlId'] = $securityControlTable->id;
+                $poam['securityControlId'] = $securityControls[0]->id;
             } else {
                 $poam['securityControlId'] = null;
             }
+
             $poam['description'] = "<p>{$finding['findingDescription']}</p>";
             if (!empty($finding['contactInfo'])) {
                 $poam['description'] .= "<p>Point of Contact: {$finding['contactInfo']}</p>";
Index: scripts/bin/optimize-indexes.php
===================================================================
--- scripts/bin/optimize-indexes.php	(revision 3558)
+++ scripts/bin/optimize-indexes.php	(working copy)
@@ -46,6 +46,7 @@
         'Organization',
         'Product',
         'Role',
+        'SecurityControl',
         'System',
         'SystemDocument',
         'Source',
Index: public/javascripts/combined.js
===================================================================
--- public/javascripts/combined.js	(revision 3558)
+++ public/javascripts/combined.js	(working copy)
@@ -2599,6 +2599,16 @@
 Fisma.AutoComplete = function() {
     return {
         /**
+         * Used for tracking if there are any open requests.
+         */
+        requestCount : 0,
+        
+        /**
+         * Used for tracking if any results have been populated
+         */
+        resultsPopulated : false,
+        
+        /**
          * Initializes the AutoComplete widget
          *
          * @param oEvent
@@ -2617,7 +2627,44 @@
             ac.maxResultsDisplayed = 20;
             ac.forceSelection = true;
 
+            var spinnerImage = document.getElementById(params.containerId + "Spinner");
+
             /**
+             * Enable the spinner
+             */
+            ac.dataRequestEvent.subscribe(function () {
+                spinnerImage.style.visibility = "visible";
+                Fisma.AutoComplete.requestCount++;
+            });
+
+            /**
+             * Disable the spinner if there are no pending requests
+             */
+            ac.dataReturnEvent.subscribe(function () {
+                Fisma.AutoComplete.requestCount--;
+                
+                if (0 == Fisma.AutoComplete.requestCount) {
+                    spinnerImage.style.visibility = "hidden";
+                }
+            });
+            
+            /**
+             * Re-display the autocomplete menu if the text field loses and then regains focus
+             */
+            ac.getInputEl().onclick = function () {
+                if (Fisma.AutoComplete.resultsPopulated) {
+                    ac.expandContainer();
+                }
+            };
+            
+            /**
+             * Record the fact that the results have been retrieved
+             */
+            ac.containerPopulateEvent.subscribe(function () {
+                Fisma.AutoComplete.resultsPopulated = true;
+            });
+            
+            /**
              * Override generateRequest method of YAHOO.widget.AutoComplete
              *
              * @param {String} query Query terms
@@ -2626,10 +2673,10 @@
             ac.generateRequest = function(query) {
                 return params.queryPrepend + query;
             };
-
+            
             /**
              * Overridable method that returns HTML markup for one result to be populated
-             * as innerHTML of an &lt;LI&gt; element.
+             * as innerHTML of an <li> element.
              *
              * @method formatResult
              * @param oResultData {Object} Result data object.
@@ -2643,8 +2690,15 @@
                 return sMarkup;
             };
 
-            ac.itemSelectEvent.subscribe(Fisma.AutoComplete.subscribe, { hiddenFieldId: params.hiddenFieldId } );
+            ac.itemSelectEvent.subscribe(
+                Fisma.AutoComplete.subscribe, 
+                {
+                    hiddenFieldId : params.hiddenFieldId,
+                    callback : params.callback
+                }
+            );
         },
+
         /**
          * Sets value of hiddenField to item selected
          *
@@ -2654,6 +2708,17 @@
          */
         subscribe : function(sType, aArgs, params) {
             document.getElementById(params.hiddenFieldId).value = aArgs[2][1]['id'];
+
+            // If a valid callback is specified, then call it
+            try {
+                var callbackFunction = Fisma.Util.getObjectFromName(params.callback);
+
+                if ('function' == typeof callbackFunction) {
+                    callbackFunction();
+                }
+            } catch (error) {
+                // do nothing
+            }
         }
     };
 }();
@@ -3047,7 +3112,7 @@
         }
     };
 }();
-Fisma.Finding={commentTable:null,commentCallback:function(f,b){var d=this;var c={timestamp:f.createdTs,username:f.username,comment:f.comment};this.commentTable.addRow(c);this.commentTable.sortColumn(this.commentTable.getColumn(0),YAHOO.widget.DataTable.CLASS_DESC);var a=new Fisma.Blinker(100,6,function(){d.commentTable.highlightRow(0)},function(){d.commentTable.unhighlightRow(0)});a.start();var e=document.getElementById("findingCommentsCount").firstChild;e.nodeValue++;b.hide();b.destroy()}};/**
+Fisma.Finding={commentTable:null,commentCallback:function(f,b){var d=this;var c={timestamp:f.createdTs,username:f.username,comment:f.comment};this.commentTable.addRow(c);this.commentTable.sortColumn(this.commentTable.getColumn(0),YAHOO.widget.DataTable.CLASS_DESC);var a=new Fisma.Blinker(100,6,function(){d.commentTable.highlightRow(0)},function(){d.commentTable.unhighlightRow(0)});a.start();var e=document.getElementById("findingCommentsCount").firstChild;e.nodeValue++;b.hide();b.destroy()},editEcdJustification:function(){var a=document.getElementById("currentChangeDescription");a.style.display="none";var c=a.firstChild.nodeValue;var b=document.createElement("input");b.type="text";b.value=c;b.name="finding[ecdChangeDescription]";a.parentNode.appendChild(b)}};/**
  * Copyright (c) 2008 Endeavor Systems, Inc.
  *
  * This file is part of OpenFISMA.
@@ -3147,6 +3212,44 @@
         inputEl.name = 'finding[ecdChangeDescription]';
         
         currentEcdJustificationEl.parentNode.appendChild(inputEl);
+    },
+    
+    /**
+     * Show the search control on the finding view's Security Control tab
+     */
+    showSecurityControlSearch : function () {
+        var button = document.getElementById('securityControlSearchButton');
+        button.style.display = 'none';
+
+        var searchForm = document.getElementById('findingSecurityControlSearch');
+        searchForm.style.display = 'block';
+    },
+    
+    /**
+     * When the user selects a security control, refresh the screen with that control's data
+     */
+    handleSecurityControlSelection : function () {
+        var controlContainer = document.getElementById('securityControlContainer');
+        
+        controlContainer.innerHTML = '<img src="/images/loading_bar.gif">';
+        
+        var securityControlElement = document.getElementById('finding[securityControlId]');
+        
+        var securityControlId = escape(securityControlElement.value);
+        
+        YAHOO.util.Connect.asyncRequest(
+            'GET', 
+            '/security-control-catalog/single-control/id/' + securityControlId, 
+            {
+                success: function (connection) {
+                    controlContainer.innerHTML = connection.responseText;
+                },
+                
+                failure : function (connection) {
+                    alert('Unable to load security control definition.');
+                }
+            }
+        );
     }
 }
 Fisma.FindingSummary=function(){return{treeRoot:null,filterType:null,filterSource:null,defaultDisplayLevel:2,render:function(h,j,t){if(t){this.treeRoot=j}var p=document.getElementById(h);for(var f in j){var l=j[f];var a=p.insertRow(p.rows.length);a.id=l.nickname+"_ontime";var e=p.insertRow(p.rows.length);e.id=l.nickname+"_overdue";var b=a.insertCell(0);l.expanded=(l.level<this.defaultDisplayLevel-1);var o=l.expanded?l.single_ontime:l.all_ontime;var k=l.expanded?l.single_overdue:l.all_overdue;l.hasOverdue=this.hasOverdue(k);var q=document.createElement("img");q.className="control";q.id=l.nickname+"Img";var g=document.createElement("a");g.appendChild(q);var n=l.children.length>0;if(n){g.nickname=l.nickname;g.findingSummary=this;g.onclick=function(){this.findingSummary.toggleNode(this.nickname);return false};q.src="/images/"+(l.expanded?"minus.png":"plus.png")}else{q.src="/images/leaf_node.png"}var d=document.createElement("div");d.className="treeTable"+l.level+(n?" link":"");d.appendChild(g);var s=document.createElement("img");s.className="icon";s.src="/images/"+l.orgType+".png";g.appendChild(s);g.appendChild(document.createTextNode(l.label));g.appendChild(document.createElement("br"));g.appendChild(document.createTextNode(l.orgTypeLabel));b.appendChild(d);var m=1;for(var r in o){count=o[r];cell=a.insertCell(m++);if(r=="CLOSED"||r=="TOTAL"){cell.className="noDueDate"}else{cell.className="onTime"}this.updateCellCount(cell,count,l.id,r,"ontime",l.expanded)}for(var r in k){count=k[r];cell=e.insertCell(e.childNodes.length);cell.className="overdue";this.updateCellCount(cell,count,l.id,r,"overdue",l.expanded)}a.style.display="none";e.style.display="none";if(l.level<this.defaultDisplayLevel){a.style.display="";if(l.hasOverdue){a.childNodes[0].rowSpan="2";a.childNodes[a.childNodes.length-2].rowSpan="2";a.childNodes[a.childNodes.length-1].rowSpan="2";e.style.display=""}}if(l.children.length>0){this.render(h,l.children)}}},toggleNode:function(a){node=this.findNode(a,this.treeRoot);if(node.expanded){this.collapseNode(node,true);this.hideSubtree(node.children)}else{this.expandNode(node);this.showSubtree(node.children,false)}},expandNode:function(f,b){f.ontime=f.single_ontime;f.overdue=f.single_overdue;f.hasOverdue=this.hasOverdue(f.overdue);var a=document.getElementById(f.nickname+"_ontime");var d=1;for(c in f.ontime){count=f.ontime[c];this.updateCellCount(a.childNodes[d],count,f.id,c,"ontime",true);d++}var e=document.getElementById(f.nickname+"_overdue");if(f.hasOverdue){var d=0;for(c in f.overdue){count=f.overdue[c];this.updateCellCount(e.childNodes[d],count,f.id,c,"overdue",true);d++}}else{a.childNodes[0].rowSpan="1";a.childNodes[a.childNodes.length-2].rowSpan="1";a.childNodes[a.childNodes.length-1].rowSpan="1";e.style.display="none"}if(f.children.length>0){document.getElementById(f.nickname+"Img").src="/images/minus.png"}f.expanded=true;if(b&&f.children.length>0){this.showSubtree(f.children,false);for(var g in f.children){this.expandNode(f.children[g],true)}}},collapseNode:function(f,b){f.ontime=f.all_ontime;f.overdue=f.all_overdue;f.hasOverdue=this.hasOverdue(f.overdue);var a=document.getElementById(f.nickname+"_ontime");var d=1;for(c in f.ontime){count=f.ontime[c];this.updateCellCount(a.childNodes[d],count,f.id,c,"ontime",false);d++}var e=document.getElementById(f.nickname+"_overdue");if(b&&f.hasOverdue){a.childNodes[0].rowSpan="2";a.childNodes[a.childNodes.length-2].rowSpan="2";a.childNodes[a.childNodes.length-1].rowSpan="2";e.style.display="";var d=0;for(c in f.all_overdue){count=f.all_overdue[c];this.updateCellCount(e.childNodes[d],count,f.id,c,"overdue",false);d++}}if(f.children.length>0){this.hideSubtree(f.children)}document.getElementById(f.nickname+"Img").src="/images/plus.png";f.expanded=false},hideSubtree:function(a){for(nodeId in a){node=a[nodeId];ontimeRow=document.getElementById(node.nickname+"_ontime");ontimeRow.style.display="none";overdueRow=document.getElementById(node.nickname+"_overdue");overdueRow.style.display="none";if(node.children.length>0){this.collapseNode(node,false);this.hideSubtree(node.children)}}},showSubtree:function(b,a){for(nodeId in b){node=b[nodeId];if(a&&node.children.length>0){this.expandNode(node);this.showSubtree(node.children,true)}ontimeRow=document.getElementById(node.nickname+"_ontime");ontimeRow.style.display="";overdueRow=document.getElementById(node.nickname+"_overdue");if(node.hasOverdue){ontimeRow.childNodes[0].rowSpan="2";ontimeRow.childNodes[ontimeRow.childNodes.length-2].rowSpan="2";ontimeRow.childNodes[ontimeRow.childNodes.length-1].rowSpan="2";overdueRow.style.display=""}}},collapseAll:function(){for(nodeId in this.treeRoot){node=this.treeRoot[nodeId];this.collapseNode(node,true);this.hideSubtree(node.children)}},expandAll:function(){for(nodeId in this.treeRoot){node=this.treeRoot[nodeId];this.expandNode(node,true)}},findNode:function(e,b){for(var d in b){node=b[d];if(node.nickname==e){return node}else{if(node.children.length>0){var a=this.findNode(e,node.children);if(a!=false){return a}}}}return false},hasOverdue:function(b){for(var a in b){if(b[a]>0){return true}}return false},updateCellCount:function(a,g,d,b,h,e){if(!a.hasChildNodes()){if(g>0){var f=document.createElement("a");f.href=this.makeLink(d,b,h,e);f.appendChild(document.createTextNode(g));a.appendChild(f)}else{a.appendChild(document.createTextNode("-"))}}else{if(a.firstChild.hasChildNodes()){if(g>0){a.firstChild.firstChild.nodeValue=g;a.firstChild.href=this.makeLink(d,b,h,e)}else{a.removeChild(a.firstChild);a.appendChild(document.createTextNode("-"))}}else{if(g>0){a.removeChild(a.firstChild);var f=document.createElement("a");f.href=this.makeLink(d,b,h,e);f.appendChild(document.createTextNode(g));a.appendChild(f)}else{a.firstChild.nodeValue="-"}}}},makeLink:function(f,g,j,i){var e="";if(!(g=="CLOSED"||g=="TOTAL")){var e="/ontime/"+j}var h="";if(g!=""){h="/status/"+escape(g)}var a="";if(!YAHOO.lang.isNull(this.filterType)&&this.filterType!=""){a="/type/"+this.filterType}var b="";if(!YAHOO.lang.isNull(this.filterSource)&&this.filterSource!=""){b="/sourceId/"+this.filterSource}var d="/panel/remediation/sub/search"+e+h+"/responsibleOrganizationId/"+f+"/expanded/"+i+a+b;return d},exportTable:function(b){var a="/remediation/summary-data/format/"+b+this.listExpandedNodes(this.treeRoot,"");document.location=a},listExpandedNodes:function(b,a){for(var e in b){var d=b[e];if(d.expanded){a+="/e/"+d.id;a=this.listExpandedNodes(d.children,a)}else{a+="/c/"+d.id}}return a}}};/**
@@ -4827,7 +4930,7 @@
      * Convert a string name of an object into a reference to that object.
      * 
      * For example, "Fisma.Foo.myFoo" returns a reference to the actual Fisma.Foo.myFoo object, if it exists, 
-     * or null otherwise.
+     * or throws an error if does not exist.
      * 
      * This is useful for sending references to objects in JSON syntax, since JSON cannot encode a reference directly.
      * 
Index: public/javascripts/Fisma/Finding.js
===================================================================
--- public/javascripts/Fisma/Finding.js	(revision 3558)
+++ public/javascripts/Fisma/Finding.js	(working copy)
@@ -98,5 +98,43 @@
         inputEl.name = 'finding[ecdChangeDescription]';
         
         currentEcdJustificationEl.parentNode.appendChild(inputEl);
+    },
+    
+    /**
+     * Show the search control on the finding view's Security Control tab
+     */
+    showSecurityControlSearch : function () {
+        var button = document.getElementById('securityControlSearchButton');
+        button.style.display = 'none';
+
+        var searchForm = document.getElementById('findingSecurityControlSearch');
+        searchForm.style.display = 'block';
+    },
+    
+    /**
+     * When the user selects a security control, refresh the screen with that control's data
+     */
+    handleSecurityControlSelection : function () {
+        var controlContainer = document.getElementById('securityControlContainer');
+        
+        controlContainer.innerHTML = '<img src="/images/loading_bar.gif">';
+        
+        var securityControlElement = document.getElementById('finding[securityControlId]');
+        
+        var securityControlId = escape(securityControlElement.value);
+        
+        YAHOO.util.Connect.asyncRequest(
+            'GET', 
+            '/security-control-catalog/single-control/id/' + securityControlId, 
+            {
+                success: function (connection) {
+                    controlContainer.innerHTML = connection.responseText;
+                },
+                
+                failure : function (connection) {
+                    alert('Unable to load security control definition.');
+                }
+            }
+        );
     }
 }
Index: public/javascripts/Fisma/AutoComplete-min.js
===================================================================
--- public/javascripts/Fisma/AutoComplete-min.js	(revision 3558)
+++ public/javascripts/Fisma/AutoComplete-min.js	(working copy)
@@ -1 +1 @@
-Fisma.AutoComplete=function(){return{init:function(a,e,d){var c=new YAHOO.widget.DS_XHR(d.xhr,d.schema);c.responseType=YAHOO.widget.DS_XHR.TYPE_JSON;c.maxCacheEntries=500;c.queryMatchContains=true;var b=new YAHOO.widget.AutoComplete(d.fieldId,d.containerId,c);b.maxResultsDisplayed=20;b.forceSelection=true;b.generateRequest=function(f){return d.queryPrepend+f};b.formatResult=function(g,i,f){var h=(f)?f:"";h=PHP_JS().htmlspecialchars(h);return h};b.itemSelectEvent.subscribe(Fisma.AutoComplete.subscribe,{hiddenFieldId:d.hiddenFieldId})},subscribe:function(c,b,a){document.getElementById(a.hiddenFieldId).value=b[2][1]["id"]}}}();
\ No newline at end of file
+Fisma.AutoComplete=function(){return{requestCount:0,resultsPopulated:false,init:function(b,f,e){var d=new YAHOO.widget.DS_XHR(e.xhr,e.schema);d.responseType=YAHOO.widget.DS_XHR.TYPE_JSON;d.maxCacheEntries=500;d.queryMatchContains=true;var c=new YAHOO.widget.AutoComplete(e.fieldId,e.containerId,d);c.maxResultsDisplayed=20;c.forceSelection=true;var a=document.getElementById(e.containerId+"Spinner");c.dataRequestEvent.subscribe(function(){a.style.visibility="visible";Fisma.AutoComplete.requestCount++});c.dataReturnEvent.subscribe(function(){Fisma.AutoComplete.requestCount--;if(0==Fisma.AutoComplete.requestCount){a.style.visibility="hidden"}});c.getInputEl().onclick=function(){if(Fisma.AutoComplete.resultsPopulated){c.expandContainer()}};c.containerPopulateEvent.subscribe(function(){Fisma.AutoComplete.resultsPopulated=true});c.generateRequest=function(g){return e.queryPrepend+g};c.formatResult=function(h,j,g){var i=(g)?g:"";i=PHP_JS().htmlspecialchars(i);return i};c.itemSelectEvent.subscribe(Fisma.AutoComplete.subscribe,{hiddenFieldId:e.hiddenFieldId,callback:e.callback})},subscribe:function(e,d,c){document.getElementById(c.hiddenFieldId).value=d[2][1]["id"];try{var b=Fisma.Util.getObjectFromName(c.callback);if("function"==typeof b){b()}}catch(a){}}}}();
\ No newline at end of file
Index: public/javascripts/Fisma/Finding-min.js
===================================================================
--- public/javascripts/Fisma/Finding-min.js	(revision 3558)
+++ public/javascripts/Fisma/Finding-min.js	(working copy)
@@ -1 +1 @@
-Fisma.Finding={commentTable:null,commentCallback:function(f,b){var d=this;var c={timestamp:f.createdTs,username:f.username,comment:f.comment};this.commentTable.addRow(c);this.commentTable.sortColumn(this.commentTable.getColumn(0),YAHOO.widget.DataTable.CLASS_DESC);var a=new Fisma.Blinker(100,6,function(){d.commentTable.highlightRow(0)},function(){d.commentTable.unhighlightRow(0)});a.start();var e=document.getElementById("findingCommentsCount").firstChild;e.nodeValue++;b.hide();b.destroy()},editEcdJustification:function(){var a=document.getElementById("currentChangeDescription");a.style.display="none";var c=a.firstChild.nodeValue;var b=document.createElement("input");b.type="text";b.value=c;b.name="finding[ecdChangeDescription]";a.parentNode.appendChild(b)}};
\ No newline at end of file
+Fisma.Finding={commentTable:null,commentCallback:function(f,b){var d=this;var c={timestamp:f.createdTs,username:f.username,comment:f.comment};this.commentTable.addRow(c);this.commentTable.sortColumn(this.commentTable.getColumn(0),YAHOO.widget.DataTable.CLASS_DESC);var a=new Fisma.Blinker(100,6,function(){d.commentTable.highlightRow(0)},function(){d.commentTable.unhighlightRow(0)});a.start();var e=document.getElementById("findingCommentsCount").firstChild;e.nodeValue++;b.hide();b.destroy()},editEcdJustification:function(){var a=document.getElementById("currentChangeDescription");a.style.display="none";var c=a.firstChild.nodeValue;var b=document.createElement("input");b.type="text";b.value=c;b.name="finding[ecdChangeDescription]";a.parentNode.appendChild(b)},showSecurityControlSearch:function(){var b=document.getElementById("securityControlSearchButton");b.style.display="none";var a=document.getElementById("findingSecurityControlSearch");a.style.display="block"},handleSecurityControlSelection:function(){var a=document.getElementById("securityControlContainer");a.innerHTML='<img src="/images/loading_bar.gif">';var c=document.getElementById("finding[securityControlId]");var b=escape(c.value);YAHOO.util.Connect.asyncRequest("GET","/security-control-catalog/single-control/id/"+b,{success:function(d){a.innerHTML=d.responseText},failure:function(d){alert("Unable to load security control definition.")}})}};
\ No newline at end of file
Index: public/javascripts/Fisma/Util.js
===================================================================
--- public/javascripts/Fisma/Util.js	(revision 3558)
+++ public/javascripts/Fisma/Util.js	(working copy)
@@ -28,7 +28,7 @@
      * Convert a string name of an object into a reference to that object.
      * 
      * For example, "Fisma.Foo.myFoo" returns a reference to the actual Fisma.Foo.myFoo object, if it exists, 
-     * or null otherwise.
+     * or throws an error if does not exist.
      * 
      * This is useful for sending references to objects in JSON syntax, since JSON cannot encode a reference directly.
      * 
Index: public/javascripts/Fisma/AutoComplete.js
===================================================================
--- public/javascripts/Fisma/AutoComplete.js	(revision 3558)
+++ public/javascripts/Fisma/AutoComplete.js	(working copy)
@@ -31,6 +31,16 @@
 Fisma.AutoComplete = function() {
     return {
         /**
+         * Used for tracking if there are any open requests.
+         */
+        requestCount : 0,
+        
+        /**
+         * Used for tracking if any results have been populated
+         */
+        resultsPopulated : false,
+        
+        /**
          * Initializes the AutoComplete widget
          *
          * @param oEvent
@@ -49,7 +59,44 @@
             ac.maxResultsDisplayed = 20;
             ac.forceSelection = true;
 
+            var spinnerImage = document.getElementById(params.containerId + "Spinner");
+
             /**
+             * Enable the spinner
+             */
+            ac.dataRequestEvent.subscribe(function () {
+                spinnerImage.style.visibility = "visible";
+                Fisma.AutoComplete.requestCount++;
+            });
+
+            /**
+             * Disable the spinner if there are no pending requests
+             */
+            ac.dataReturnEvent.subscribe(function () {
+                Fisma.AutoComplete.requestCount--;
+                
+                if (0 == Fisma.AutoComplete.requestCount) {
+                    spinnerImage.style.visibility = "hidden";
+                }
+            });
+            
+            /**
+             * Re-display the autocomplete menu if the text field loses and then regains focus
+             */
+            ac.getInputEl().onclick = function () {
+                if (Fisma.AutoComplete.resultsPopulated) {
+                    ac.expandContainer();
+                }
+            };
+            
+            /**
+             * Record the fact that the results have been retrieved
+             */
+            ac.containerPopulateEvent.subscribe(function () {
+                Fisma.AutoComplete.resultsPopulated = true;
+            });
+            
+            /**
              * Override generateRequest method of YAHOO.widget.AutoComplete
              *
              * @param {String} query Query terms
@@ -58,10 +105,10 @@
             ac.generateRequest = function(query) {
                 return params.queryPrepend + query;
             };
-
+            
             /**
              * Overridable method that returns HTML markup for one result to be populated
-             * as innerHTML of an &lt;LI&gt; element.
+             * as innerHTML of an <li> element.
              *
              * @method formatResult
              * @param oResultData {Object} Result data object.
@@ -75,8 +122,15 @@
                 return sMarkup;
             };
 
-            ac.itemSelectEvent.subscribe(Fisma.AutoComplete.subscribe, { hiddenFieldId: params.hiddenFieldId } );
+            ac.itemSelectEvent.subscribe(
+                Fisma.AutoComplete.subscribe, 
+                {
+                    hiddenFieldId : params.hiddenFieldId,
+                    callback : params.callback
+                }
+            );
         },
+
         /**
          * Sets value of hiddenField to item selected
          *
@@ -86,6 +140,17 @@
          */
         subscribe : function(sType, aArgs, params) {
             document.getElementById(params.hiddenFieldId).value = aArgs[2][1]['id'];
+
+            // If a valid callback is specified, then call it
+            try {
+                var callbackFunction = Fisma.Util.getObjectFromName(params.callback);
+
+                if ('function' == typeof callbackFunction) {
+                    callbackFunction();
+                }
+            } catch (error) {
+                // do nothing
+            }
         }
     };
 }();
Index: public/javascripts/combined-min.js
===================================================================
--- public/javascripts/combined-min.js	(revision 3558)
+++ public/javascripts/combined-min.js	(working copy)
@@ -1 +1 @@
-(function(){if(typeof(this.PHP_JS)==="undefined"){var PHP_JS=function(cfgObj){if(!(this instanceof PHP_JS)){return new PHP_JS(cfgObj)}this.window=cfgObj&&cfgObj.window?cfgObj.window:window;this.php_js={};this.php_js.ini={};if(cfgObj){for(var ini in cfgObj.ini){this.php_js.ini[ini]={};this.php_js.ini[ini].local_value=cfgObj.ini[ini];this.php_js.ini[ini].global_value=cfgObj.ini[ini]}}}}var php_js_shared={};PHP_JS.prototype={constructor:PHP_JS,abs:function(mixed_number){return Math.abs(mixed_number)||0},acos:function(arg){return Math.acos(arg)},acosh:function(arg){return Math.log(arg+Math.sqrt(arg*arg-1))},addslashes:function(str){return(str+"").replace(/([\\"'])/g,"\\$1").replace(/\u0000/g,"\\0")},array_change_key_case:function(array){var case_fn,tmp_ar={},argc=arguments.length,argv=arguments,key;if(array instanceof Array){return array}if(array instanceof Object){if(argc===1||argv[1]==="CASE_LOWER"||argv[1]===0){case_fn="toLowerCase"}else{case_fn="toUpperCase"}for(key in array){tmp_ar[key[case_fn]()]=array[key]}return tmp_ar}return false},array_chunk:function(input,size){for(var x,i=0,c=-1,l=input.length,n=[];i<l;i++){(x=i%size)?n[c][x]=input[i]:n[++c]=[input[i]]}return n},array_combine:function(keys,values){var new_array={},keycount=keys&&keys.length,i=0;if(typeof keys!=="object"||typeof values!=="object"||typeof keycount!=="number"||typeof values.length!=="number"||!keycount){return false}if(keycount!=values.length){return false}for(i=0;i<keycount;i++){new_array[keys[i]]=values[i]}return new_array},array_count_values:function(array){var tmp_arr={},key="",t="";var __getType=function(obj){var t=typeof obj;t=t.toLowerCase();if(t=="object"){t="array"}return t};var __countValue=function(value){switch(typeof(value)){case"number":if(Math.floor(value)!=value){return}case"string":if(value in this){++this[value]}else{this[value]=1}}};t=__getType(array);if(t=="array"){for(key in array){__countValue.call(tmp_arr,array[key])}}return tmp_arr},array_diff:function(){var arr1=arguments[0],retArr={};var k1="",i=1,k="",arr={};arr1keys:for(k1 in arr1){for(i=1;i<arguments.length;i++){arr=arguments[i];for(k in arr){if(arr[k]===arr1[k1]){continue arr1keys}}retArr[k1]=arr1[k1]}}return retArr},array_diff_assoc:function(){var arr1=arguments[0],retArr={};var k1="",i=1,k="",arr={};arr1keys:for(k1 in arr1){for(i=1;i<arguments.length;i++){arr=arguments[i];for(k in arr){if(arr[k]===arr1[k1]&&k===k1){continue arr1keys}}retArr[k1]=arr1[k1]}}return retArr},array_diff_key:function(){var arr1=arguments[0],retArr={};var k1="",i=1,k="",arr={};arr1keys:for(k1 in arr1){for(i=1;i<arguments.length;i++){arr=arguments[i];for(k in arr){if(k===k1){continue arr1keys}}retArr[k1]=arr1[k1]}}return retArr},array_diff_uassoc:function(){var arr1=arguments[0],retArr={},cb=arguments[arguments.length-1];var arr={},i=1,k1="",k="";cb=(typeof cb==="string")?this.window[cb]:(cb instanceof Array)?this.window[cb[0]][cb[1]]:cb;arr1keys:for(k1 in arr1){for(i=1;i<arguments.length-1;i++){arr=arguments[i];for(k in arr){if(arr[k]===arr1[k1]&&cb(k,k1)===0){continue arr1keys}}retArr[k1]=arr1[k1]}}return retArr},array_diff_ukey:function(){var arr1=arguments[0],retArr={},cb=arguments[arguments.length-1];var arr={},i=1,k1="",k="";cb=(typeof cb==="string")?this.window[cb]:(cb instanceof Array)?this.window[cb[0]][cb[1]]:cb;arr1keys:for(k1 in arr1){for(i=1;i<arguments.length-1;i++){arr=arguments[i];for(k in arr){if(cb(k,k1)===0){continue arr1keys}}retArr[k1]=arr1[k1]}}return retArr},array_fill:function(start_index,num,mixed_val){var key,tmp_arr={};if(!isNaN(start_index)&&!isNaN(num)){for(key=0;key<num;key++){tmp_arr[(key+start_index)]=mixed_val}}return tmp_arr},array_fill_keys:function(keys,value){var retObj={},key="";for(key in keys){retObj[keys[key]]=value}return retObj},array_filter:function(arr,func){var retObj={},k;for(k in arr){if(func(arr[k])){retObj[k]=arr[k]}}return retObj},array_flip:function(trans){var key,tmp_ar={};for(key in trans){tmp_ar[trans[key]]=key}return tmp_ar},array_intersect:function(){var arr1=arguments[0],retArr={};var k1="",arr={},i=0,k="";arr1keys:for(k1 in arr1){arrs:for(i=1;i<arguments.length;i++){arr=arguments[i];for(k in arr){if(arr[k]===arr1[k1]){if(i===arguments.length-1){retArr[k1]=arr1[k1]}continue arrs}}continue arr1keys}}return retArr},array_intersect_assoc:function(){var arr1=arguments[0],retArr={};var k1="",arr={},i=0,k="";arr1keys:for(k1 in arr1){arrs:for(i=1;i<arguments.length;i++){arr=arguments[i];for(k in arr){if(arr[k]===arr1[k1]&&k===k1){if(i===arguments.length-1){retArr[k1]=arr1[k1]}continue arrs}}continue arr1keys}}return retArr},array_intersect_key:function(){var arr1=arguments[0],retArr={};var k1="",arr={},i=0,k="";arr1keys:for(k1 in arr1){arrs:for(i=1;i<arguments.length;i++){arr=arguments[i];for(k in arr){if(k===k1){if(i===arguments.length-1){retArr[k1]=arr1[k1]}continue arrs}}continue arr1keys}}return retArr},array_intersect_uassoc:function(){var arr1=arguments[0],retArr={},cb=arguments[arguments.length-1];var k1="",i=1,arr={},k="";cb=(typeof cb==="string")?this.window[cb]:(cb instanceof Array)?this.window[cb[0]][cb[1]]:cb;arr1keys:for(k1 in arr1){arrs:for(i=1;i<arguments.length-1;i++){arr=arguments[i];for(k in arr){if(arr[k]===arr1[k1]&&cb(k,k1)===0){if(i===arguments.length-2){retArr[k1]=arr1[k1]}continue arrs}}continue arr1keys}}return retArr},array_intersect_ukey:function(){var arr1=arguments[0],retArr={},cb=arguments[arguments.length-1];var k1="",i=1,arr={},k="";cb=(typeof cb==="string")?this.window[cb]:(cb instanceof Array)?this.window[cb[0]][cb[1]]:cb;arr1keys:for(k1 in arr1){arrs:for(i=1;i<arguments.length-1;i++){arr=arguments[i];for(k in arr){if(cb(k,k1)===0){if(i===arguments.length-2){retArr[k1]=arr1[k1]}continue arrs}}continue arr1keys}}return retArr},array_key_exists:function(key,search){if(!search||(search.constructor!==Array&&search.constructor!==Object)){return false}return key in search},array_keys:function(input,search_value,argStrict){var tmp_arr={},strict=!!argStrict,include=true,cnt=0;var key="";for(key in input){include=true;if(search_value!=undefined){if(strict&&input[key]!==search_value){include=false}else{if(input[key]!=search_value){include=false}}}if(include){tmp_arr[cnt]=key;cnt++}}return tmp_arr},array_map:function(callback){var argc=arguments.length,argv=arguments;var j=argv[1].length,i=0,k=1,m=0;var tmp=[],tmp_ar=[];while(i<j){while(k<argc){tmp[m++]=argv[k++][i]}m=0;k=1;if(callback){if(typeof callback==="string"){callback=this.window[callback]}tmp_ar[i++]=callback.apply(null,tmp)}else{tmp_ar[i++]=tmp}tmp=[]}return tmp_ar},array_merge:function(){var args=Array.prototype.slice.call(arguments);var retObj={},k,j=0,i=0;var retArr;for(i=0,retArr=true;i<args.length;i++){if(!(args[i] instanceof Array)){retArr=false;break}}if(retArr){return args}var ct=0;for(i=0,ct=0;i<args.length;i++){if(args[i] instanceof Array){for(j=0;j<args[i].length;j++){retObj[ct++]=args[i][j]}}else{for(k in args[i]){if(this.is_int(k)){retObj[ct++]=args[i][k]}else{retObj[k]=args[i][k]}}}}return retObj},array_merge_recursive:function(arr1,arr2){var idx="";if((arr1&&(arr1 instanceof Array))&&(arr2&&(arr2 instanceof Array))){for(idx in arr2){arr1.push(arr2[idx])}}else{if((arr1&&(arr1 instanceof Object))&&(arr2&&(arr2 instanceof Object))){for(idx in arr2){if(idx in arr1){if(typeof arr1[idx]=="object"&&typeof arr2=="object"){arr1[idx]=this.array_merge(arr1[idx],arr2[idx])}else{arr1[idx]=arr2[idx]}}else{arr1[idx]=arr2[idx]}}}}return arr1},array_pad:function(input,pad_size,pad_value){var pad=[],newArray=[],newLength,i=0;if(input instanceof Array&&!isNaN(pad_size)){newLength=((pad_size<0)?(pad_size*-1):pad_size);if(newLength>input.length){for(i=0;i<(newLength-input.length);i++){newArray[i]=pad_value}pad=((pad_size<0)?newArray.concat(input):input.concat(newArray))}else{pad=input}}return pad},array_pop:function(inputArr){var key="",lastKey="";if(inputArr.hasOwnProperty("length")){if(!inputArr.length){return null}return inputArr.pop()}else{for(key in inputArr){if(inputArr.hasOwnProperty(key)){lastKey=key}}if(lastKey){var tmp=inputArr[lastKey];delete (inputArr[lastKey]);return tmp}else{return null}}},array_product:function(input){var Index=0,product=1;if(input instanceof Array){while(Index<input.length){product*=(!isNaN(input[Index])?input[Index]:0);Index++}}else{product=null}return product},array_push:function(inputArr){var i=0,pr="",argv=arguments,argc=argv.length,allDigits=/^\d$/,size=0,highestIdx=0,len=0;if(inputArr.hasOwnProperty("length")){for(i=1;i<argc;i++){inputArr[inputArr.length]=argv[i]}return inputArr.length}for(pr in inputArr){if(inputArr.hasOwnProperty(pr)){++len;if(allDigits.test(pr)){size=parseInt(pr,10);highestIdx=size>highestIdx?size:highestIdx}}}for(i=1;i<argc;i++){inputArr[++highestIdx]=argv[i]}return len+i-1},array_rand:function(input,num_req){var indexes=[];var ticks=num_req||1;var checkDuplicate=function(input,value){var exist=false,index=0;while(index<input.length){if(input[index]===value){exist=true;break}index++}return exist};if(input instanceof Array&&ticks<=input.length){while(true){var rand=Math.floor((Math.random()*input.length));if(indexes.length===ticks){break}if(!checkDuplicate(indexes,rand)){indexes.push(rand)}}}else{indexes=null}return((ticks==1)?indexes.join():indexes)},array_reduce:function(a_input,callback){var lon=a_input.length;var res=0,i=0;var tmp=[];for(i=0;i<lon;i+=2){tmp[0]=a_input[i];if(a_input[(i+1)]){tmp[1]=a_input[(i+1)]}else{tmp[1]=0}res+=callback.apply(null,tmp);tmp=[]}return res},array_reverse:function(array,preserve_keys){var arr_len=array.length,newkey=0,tmp_arr={},key="";preserve_keys=!!preserve_keys;for(key in array){newkey=arr_len-key-1;tmp_arr[preserve_keys?key:newkey]=array[key]}return tmp_arr},array_search:function(needle,haystack,argStrict){var strict=!!argStrict;var key="";for(key in haystack){if((strict&&haystack[key]===needle)||(!strict&&haystack[key]==needle)){return key}}return false},array_shift:function(inputArr){var props=false,shift=undefined,pr="",allDigits=/^\d$/,int_ct=-1,_checkToUpIndices=function(arr,ct,key){if(arr[ct]!==undefined){var tmp=ct;ct+=1;if(ct===key){ct+=1}ct=_checkToUpIndices(arr,ct,key);arr[ct]=arr[tmp];delete arr[tmp]}return ct};if(inputArr.length===0){return null}if(inputArr.length>0){return inputArr.shift()}},array_slice:function(arr,offst,lgth,preserve_keys){var key="";if(!(arr instanceof Array)||(preserve_keys&&offst!==0)){var lgt=0,newAssoc={};for(key in arr){lgt+=1;newAssoc[key]=arr[key]}arr=newAssoc;offst=(offst<0)?lgt+offst:offst;lgth=lgth===undefined?lgt:(lgth<0)?lgt+lgth-offst:lgth;var assoc={};var start=false,it=-1,arrlgth=0,no_pk_idx=0;for(key in arr){++it;if(arrlgth>=lgth){break}if(it==offst){start=true}if(!start){continue}++arrlgth;if(this.is_int(key)&&!preserve_keys){assoc[no_pk_idx++]=arr[key]}else{assoc[key]=arr[key]}}return assoc}if(lgth===undefined){return arr.slice(offst)}else{if(lgth>=0){return arr.slice(offst,offst+lgth)}else{return arr.slice(offst,lgth)}}},array_splice:function(arr,offst,lgth,replacement){var _checkToUpIndices=function(arr,ct,key){if(arr[ct]!==undefined){var tmp=ct;ct+=1;if(ct===key){ct+=1}ct=_checkToUpIndices(arr,ct,key);arr[ct]=arr[tmp];delete arr[tmp]}return ct};if(replacement&&typeof replacement!=="object"){replacement=[replacement]}if(lgth===undefined){lgth=offst>=0?arr.length-offst:-offst}else{if(lgth<0){lgth=(offst>=0?arr.length-offst:-offst)+lgth}}if(!(arr instanceof Array)){var lgt=0,ct=-1,rmvd=[],rmvdObj={},repl_ct=-1,int_ct=-1;var returnArr=true,rmvd_ct=0,rmvd_lgth=0,key="";for(key in arr){lgt+=1}offst=(offst>=0)?offst:lgt+offst;for(key in arr){ct+=1;if(ct<offst){if(this.is_int(key)){int_ct+=1;if(parseInt(key,10)===int_ct){continue}_checkToUpIndices(arr,int_ct,key);arr[int_ct]=arr[key];delete arr[key]}continue}if(returnArr&&this.is_int(key)){rmvd.push(arr[key]);rmvdObj[rmvd_ct++]=arr[key]}else{rmvdObj[key]=arr[key];returnArr=false}rmvd_lgth+=1;if(replacement&&replacement[++repl_ct]){arr[key]=replacement[repl_ct]}else{delete arr[key]}}return returnArr?rmvd:rmvdObj}if(replacement){replacement.unshift(offst,lgth);return Array.prototype.splice.apply(arr,replacement)}return arr.splice(offst,lgth)},array_sum:function(array){var key,sum=0;if(typeof array!=="object"){return null}for(key in array){sum+=(array[key]*1)}return sum},array_udiff:function(){var arr1=arguments[0],retArr={},cb=arguments[arguments.length-1];var arr="",i=1,k1="",k="";cb=(typeof cb==="string")?this.window[cb]:(cb instanceof Array)?this.window[cb[0]][cb[1]]:cb;arr1keys:for(k1 in arr1){for(i=1;i<arguments.length-1;i++){arr=arguments[i];for(k in arr){if(cb(arr[k],arr1[k1])===0){continue arr1keys}}retArr[k1]=arr1[k1]}}return retArr},array_udiff_assoc:function(){var arr1=arguments[0],retArr={},cb=arguments[arguments.length-1];var arr={},i=1,k1="",k="";cb=(typeof cb==="string")?this.window[cb]:(cb instanceof Array)?this.window[cb[0]][cb[1]]:cb;arr1keys:for(k1 in arr1){for(i=1;i<arguments.length-1;i++){arr=arguments[i];for(k in arr){if(cb(arr[k],arr1[k1])===0&&k===k1){continue arr1keys}}retArr[k1]=arr1[k1]}}return retArr},array_udiff_uassoc:function(){var arr1=arguments[0],retArr={},cb=arguments[arguments.length-1],cb0=arguments[arguments.length-2];var k1="",i=1,k="",arr={};cb=(typeof cb==="string")?this.window[cb]:(cb instanceof Array)?this.window[cb[0]][cb[1]]:cb;cb0=(typeof cb0==="string")?this.window[cb0]:(cb0 instanceof Array)?this.window[cb0[0]][cb0[1]]:cb0;arr1keys:for(k1 in arr1){for(i=1;i<arguments.length-2;i++){arr=arguments[i];for(k in arr){if(cb0(arr[k],arr1[k1])===0&&cb(k,k1)===0){continue arr1keys}}retArr[k1]=arr1[k1]}}return retArr},array_uintersect:function(){var arr1=arguments[0],retArr={},cb=arguments[arguments.length-1];var k1="",i=1,arr={},k="";cb=(typeof cb==="string")?this.window[cb]:(cb instanceof Array)?this.window[cb[0]][cb[1]]:cb;arr1keys:for(k1 in arr1){arrs:for(i=1;i<arguments.length-1;i++){arr=arguments[i];for(k in arr){if(cb(arr[k],arr1[k1])===0){if(i===arguments.length-2){retArr[k1]=arr1[k1]}continue arrs}}continue arr1keys}}return retArr},array_uintersect_assoc:function(){var arr1=arguments[0],retArr={},cb=arguments[arguments.length-1];var k1="",i=1,arr={},k="";cb=(typeof cb==="string")?this.window[cb]:(cb instanceof Array)?this.window[cb[0]][cb[1]]:cb;arr1keys:for(k1 in arr1){arrs:for(i=1;i<arguments.length-1;i++){arr=arguments[i];for(k in arr){if(cb(arr[k],arr1[k1])===0&&k===k1){if(i===arguments.length-2){retArr[k1]=arr1[k1]}continue arrs}}continue arr1keys}}return retArr},array_uintersect_uassoc:function(){var arr1=arguments[0],retArr={},cb=arguments[arguments.length-1],cb0=arguments[arguments.length-2];var k1="",i=1,k="",arr={};cb=(typeof cb==="string")?this.window[cb]:(cb instanceof Array)?this.window[cb[0]][cb[1]]:cb;cb0=(typeof cb0==="string")?this.window[cb0]:(cb0 instanceof Array)?this.window[cb0[0]][cb0[1]]:cb0;arr1keys:for(k1 in arr1){arrs:for(i=1;i<arguments.length-2;i++){arr=arguments[i];for(k in arr){if(cb0(arr[k],arr1[k1])===0&&cb(k,k1)===0){if(i===arguments.length-3){retArr[k1]=arr1[k1]}continue arrs}}continue arr1keys}}return retArr},array_unique:function(inputArr){var key="",tmp_arr2={},val="";var __array_search=function(needle,haystack){var fkey="";for(fkey in haystack){if(haystack.hasOwnProperty){if((haystack[fkey]+"")===(needle+"")){return fkey}}}return false};for(key in inputArr){if(inputArr.hasOwnProperty){val=inputArr[key];if(false===__array_search(val,tmp_arr2)){tmp_arr2[key]=val}}}return tmp_arr2},array_unshift:function(array){var argc=arguments.length,argv=arguments,i;for(i=1;i<argc;i++){array.unshift(argv[i])}return(array.length)},array_values:function(input){var tmp_arr=[],cnt=0;var key="";for(key in input){tmp_arr[cnt]=input[key];cnt++}return tmp_arr},array_walk:function(array,funcname,userdata){var key;if(typeof array!=="object"||array===null){return false}for(key in array){if(typeof(userdata)!=="undefined"){eval(funcname+"( array [key] , key , userdata  )")}else{eval(funcname+"(  userdata ) ")}}return true},array_walk_recursive:function(array,funcname,userdata){var key;if(typeof array!="object"){return false}for(key in array){if(typeof array[key]=="object"){return this.array_walk_recursive(array[key],funcname,userdata)}if(typeof(userdata)!="undefined"){eval(funcname+"( array [key] , key , userdata  )")}else{eval(funcname+"(  userdata ) ")}}return true},arsort:function(inputArr,sort_flags){var valArr=[],keyArr=[],k,i,ret,sorter,that=this,strictForIn=false,populateArr=[];switch(sort_flags){case"SORT_STRING":sorter=function(a,b){return that.strnatcmp(b,a)};break;case"SORT_LOCALE_STRING":var loc=this.i18n_loc_get_default();sorter=this.php_js.i18nLocales[loc].sorting;break;case"SORT_NUMERIC":sorter=function(a,b){return(a-b)};break;case"SORT_REGULAR":default:sorter=function(a,b){if(a>b){return 1}if(a<b){return -1}return 0};break}var bubbleSort=function(keyArr,inputArr){var i,j,tempValue,tempKeyVal;for(i=inputArr.length-2;i>=0;i--){for(j=0;j<=i;j++){ret=sorter(inputArr[j+1],inputArr[j]);if(ret>0){tempValue=inputArr[j];inputArr[j]=inputArr[j+1];inputArr[j+1]=tempValue;tempKeyVal=keyArr[j];keyArr[j]=keyArr[j+1];keyArr[j+1]=tempKeyVal}}}};this.php_js=this.php_js||{};this.php_js.ini=this.php_js.ini||{};strictForIn=this.php_js.ini["phpjs.strictForIn"]&&this.php_js.ini["phpjs.strictForIn"].local_value;populateArr=strictForIn?inputArr:populateArr;for(k in inputArr){if(inputArr.hasOwnProperty){valArr.push(inputArr[k]);keyArr.push(k);if(strictForIn){delete inputArr[k]}}}try{bubbleSort(keyArr,valArr)}catch(e){return false}for(i=0;i<valArr.length;i++){populateArr[keyArr[i]]=valArr[i]}return strictForIn?true:populateArr},asin:function(arg){return Math.asin(arg)},asinh:function(arg){return Math.log(arg+Math.sqrt(arg*arg+1))},asort:function(inputArr,sort_flags){var valArr=[],keyArr=[],k,i,ret,sorter,that=this,strictForIn=false,populateArr=[];switch(sort_flags){case"SORT_STRING":sorter=function(a,b){return that.strnatcmp(a,b)};break;case"SORT_LOCALE_STRING":var loc=this.i18n_loc_get_default();sorter=this.php_js.i18nLocales[loc].sorting;break;case"SORT_NUMERIC":sorter=function(a,b){return(a-b)};break;case"SORT_REGULAR":default:sorter=function(a,b){if(a>b){return 1}if(a<b){return -1}return 0};break}var bubbleSort=function(keyArr,inputArr){var i,j,tempValue,tempKeyVal;for(i=inputArr.length-2;i>=0;i--){for(j=0;j<=i;j++){ret=sorter(inputArr[j+1],inputArr[j]);if(ret<0){tempValue=inputArr[j];inputArr[j]=inputArr[j+1];inputArr[j+1]=tempValue;tempKeyVal=keyArr[j];keyArr[j]=keyArr[j+1];keyArr[j+1]=tempKeyVal}}}};this.php_js=this.php_js||{};this.php_js.ini=this.php_js.ini||{};strictForIn=this.php_js.ini["phpjs.strictForIn"]&&this.php_js.ini["phpjs.strictForIn"].local_value;populateArr=strictForIn?inputArr:populateArr;for(k in inputArr){if(inputArr.hasOwnProperty){valArr.push(inputArr[k]);keyArr.push(k);if(strictForIn){delete inputArr[k]}}}try{bubbleSort(keyArr,valArr)}catch(e){return false}for(i=0;i<valArr.length;i++){populateArr[keyArr[i]]=valArr[i]}return strictForIn?true:populateArr},atan:function(arg){return Math.atan(arg)},atan2:function(y,x){return Math.atan2(y,x)},atanh:function(arg){return 0.5*Math.log((1+arg)/(1-arg))},base64_decode:function(data){var b64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var o1,o2,o3,h1,h2,h3,h4,bits,i=0,ac=0,dec="",tmp_arr=[];if(!data){return data}data+="";do{h1=b64.indexOf(data.charAt(i++));h2=b64.indexOf(data.charAt(i++));h3=b64.indexOf(data.charAt(i++));h4=b64.indexOf(data.charAt(i++));bits=h1<<18|h2<<12|h3<<6|h4;o1=bits>>16&255;o2=bits>>8&255;o3=bits&255;if(h3==64){tmp_arr[ac++]=String.fromCharCode(o1)}else{if(h4==64){tmp_arr[ac++]=String.fromCharCode(o1,o2)}else{tmp_arr[ac++]=String.fromCharCode(o1,o2,o3)}}}while(i<data.length);dec=tmp_arr.join("");dec=this.utf8_decode(dec);return dec},base64_encode:function(data){var b64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var o1,o2,o3,h1,h2,h3,h4,bits,i=0,ac=0,enc="",tmp_arr=[];if(!data){return data}data=this.utf8_encode(data+"");do{o1=data.charCodeAt(i++);o2=data.charCodeAt(i++);o3=data.charCodeAt(i++);bits=o1<<16|o2<<8|o3;h1=bits>>18&63;h2=bits>>12&63;h3=bits>>6&63;h4=bits&63;tmp_arr[ac++]=b64.charAt(h1)+b64.charAt(h2)+b64.charAt(h3)+b64.charAt(h4)}while(i<data.length);enc=tmp_arr.join("");switch(data.length%3){case 1:enc=enc.slice(0,-2)+"==";break;case 2:enc=enc.slice(0,-1)+"=";break}return enc},base_convert:function(number,frombase,tobase){return parseInt(number+"",frombase+0).toString(tobase+0)},bin2hex:function(s){var i,f=0,a=[];s+="";f=s.length;for(i=0;i<f;i++){a[i]=s.charCodeAt(i).toString(16).replace(/^([\da-f])$/,"0$1")}return a.join("")},bindec:function(binary_string){binary_string=(binary_string+"").replace(/[^01]/gi,"");return parseInt(binary_string,2)},ceil:function(value){return Math.ceil(value)},checkdate:function(m,d,y){return m>0&&m<13&&y>0&&y<32768&&d>0&&d<=(new Date(y,m,0)).getDate()},chop:function(str,charlist){return this.rtrim(str,charlist)},chr:function(codePt){if(codePt>65535){codePt-=65536;return String.fromCharCode(55296+(codePt>>10),56320+(codePt&1023))}else{return String.fromCharCode(codePt)}},chunk_split:function(body,chunklen,end){chunklen=parseInt(chunklen,10)||76;end=end||"\r\n";if(chunklen<1){return false}return body.match(new RegExp(".{0,"+chunklen+"}","g")).join(end)},class_exists:function(cls){var i="";cls=this.window[cls];if(typeof cls!=="function"){return false}for(i in cls.prototype){return true}for(i in cls){if(i!=="prototype"){return true}}if(cls.toSource&&cls.toSource().match(/this\./)){return true}return false},compact:function(){var matrix={},that=this;var process=function(value){var i=0,l=value.length,key_value="";for(i=0;i<l;i++){key_value=value[i];if(key_value instanceof Array){process(key_value)}else{if(typeof that.window[key_value]!=="undefined"){matrix[key_value]=that.window[key_value]}}}return true};process(arguments);return matrix},cos:function(arg){return Math.cos(arg)},cosh:function(arg){return(Math.exp(arg)+Math.exp(-arg))/2},count:function(mixed_var,mode){var key,cnt=0;if(mixed_var===null){return 0}else{if(mixed_var.constructor!==Array&&mixed_var.constructor!==Object){return 1}}if(mode==="COUNT_RECURSIVE"){mode=1}if(mode!=1){mode=0}for(key in mixed_var){cnt++;if(mode==1&&mixed_var[key]&&(mixed_var[key].constructor===Array||mixed_var[key].constructor===Object)){cnt+=this.count(mixed_var[key],1)}}return cnt},count_chars:function(str,mode){var result={},resultArr=[],i;str=(""+str).split("").sort().join("").match(/(.)\1*/g);if((mode&1)==0){for(i=0;i!=256;i++){result[i]=0}}if(mode===2||mode===4){for(i=0;i!=str.length;i+=1){delete result[str[i].charCodeAt(0)]}for(i in result){result[i]=(mode===4)?String.fromCharCode(i):0}}else{if(mode===3){for(i=0;i!=str.length;i+=1){result[i]=str[i].slice(0,1)}}else{for(i=0;i!=str.length;i+=1){result[str[i].charCodeAt(0)]=str[i].length}}}if(mode<3){return result}for(i in result){resultArr.push(result[i])}return resultArr.join("")},crc32:function(str){str=this.utf8_encode(str);var table="00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D";var crc=0;var x=0;var y=0;crc=crc^(-1);for(var i=0,iTop=str.length;i<iTop;i++){y=(crc^str.charCodeAt(i))&255;x="0x"+table.substr(y*9,8);crc=(crc>>>8)^x}return crc^(-1)},date:function(format,timestamp){var that=this,jsdate,f,formatChr=/\\?([a-z])/gi,formatChrCb,_pad=function(n,c){if((n=n+"").length<c){return new Array((++c)-n.length).join("0")+n}else{return n}},txt_words=["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur","January","February","March","April","May","June","July","August","September","October","November","December"],txt_ordin={1:"st",2:"nd",3:"rd",21:"st",22:"nd",23:"rd",31:"st"};formatChrCb=function(t,s){return f[t]?f[t]():s};f={d:function(){return _pad(f.j(),2)},D:function(){return f.l().slice(0,3)},j:function(){return jsdate.getDate()},l:function(){return txt_words[f.w()]+"day"},N:function(){return f.w()||7},S:function(){return txt_ordin[f.j()]||"th"},w:function(){return jsdate.getDay()},z:function(){var a=new Date(f.Y(),f.n()-1,f.j()),b=new Date(f.Y(),0,1);return Math.round((a-b)/86400000)+1},W:function(){var a=new Date(f.Y(),f.n()-1,f.j()-f.N()+3),b=new Date(a.getFullYear(),0,4);return 1+Math.round((a-b)/86400000/7)},F:function(){return txt_words[6+f.n()]},m:function(){return _pad(f.n(),2)},M:function(){return f.F().slice(0,3)},n:function(){return jsdate.getMonth()+1},t:function(){return(new Date(f.Y(),f.n(),0)).getDate()},L:function(){var y=f.Y(),a=y&3,b=y%400,c=y%100;return 0+(!a&&(c||!b))},o:function(){var n=f.n(),W=f.W(),Y=f.Y();return Y+(n===12&&W<9?-1:n===1&&W>9)},Y:function(){return jsdate.getFullYear()},y:function(){return(f.Y()+"").slice(-2)},a:function(){return jsdate.getHours()>11?"pm":"am"},A:function(){return f.a().toUpperCase()},B:function(){var H=jsdate.getUTCHours()*3600,i=jsdate.getUTCMinutes()*60,s=jsdate.getUTCSeconds();return _pad(Math.floor((H+i+s+3600)/86.4)%1000,3)},g:function(){return f.G()%12||12},G:function(){return jsdate.getHours()},h:function(){return _pad(f.g(),2)},H:function(){return _pad(f.G(),2)},i:function(){return _pad(jsdate.getMinutes(),2)},s:function(){return _pad(jsdate.getSeconds(),2)},u:function(){return _pad(jsdate.getMilliseconds()*1000,6)},e:function(){return"UTC"},I:function(){var a=new Date(f.Y(),0),c=Date.UTC(f.Y(),0),b=new Date(f.Y(),6),d=Date.UTC(f.Y(),6);return 0+((a-c)!==(b-d))},O:function(){var a=jsdate.getTimezoneOffset();return(a>0?"-":"+")+_pad(Math.abs(a/60*100),4)},P:function(){var O=f.O();return(O.substr(0,3)+":"+O.substr(3,2))},T:function(){return"UTC"},Z:function(){return -jsdate.getTimezoneOffset()*60},c:function(){return"Y-m-d\\Th:i:sP".replace(formatChr,formatChrCb)},r:function(){return"D, d M Y H:i:s O".replace(formatChr,formatChrCb)},U:function(){return Math.round(jsdate.getTime()/1000)}};this.date=function(format,timestamp){that=this;jsdate=((typeof timestamp==="undefined")?new Date():(timestamp instanceof Date)?new Date(timestamp):new Date(timestamp*1000));return format.replace(formatChr,formatChrCb)};return this.date(format,timestamp)},decbin:function(number){if(number<0){number=4294967295+number+1}return parseInt(number,10).toString(2)},dechex:function(number){if(number<0){number=4294967295+number+1}return parseInt(number,10).toString(16)},decoct:function(number){if(number<0){number=4294967295+number+1}return parseInt(number,10).toString(8)},deg2rad:function(angle){return(angle/180)*Math.PI},doubleval:function(mixed_var){return this.floatval(mixed_var)},echo:function(){var arg="",argc=arguments.length,argv=arguments,i=0;var win=this.window;var d=win.document;var ns_xhtml="http://www.w3.org/1999/xhtml";var ns_xul="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul";var holder;var stringToDOM=function(str,parent,ns,container){var extraNSs="";if(ns===ns_xul){extraNSs=' xmlns:html="'+ns_xhtml+'"'}var stringContainer="<"+container+' xmlns="'+ns+'"'+extraNSs+">"+str+"</"+container+">";if(win.DOMImplementationLS&&win.DOMImplementationLS.createLSInput&&win.DOMImplementationLS.createLSParser){var lsInput=DOMImplementationLS.createLSInput();lsInput.stringData=stringContainer;var lsParser=DOMImplementationLS.createLSParser(1,null);return lsParser.parse(lsInput).firstChild}else{if(win.DOMParser){return new DOMParser().parseFromString(stringContainer,"text/xml").documentElement.firstChild}else{if(win.ActiveXObject){var d=new ActiveXObject("MSXML2.DOMDocument");d.loadXML(str);return d.documentElement}else{if(d.createElementNS&&d.documentElement.namespaceURI&&(d.documentElement.namespaceURI!==null||d.documentElement.nodeName.toLowerCase()!=="html"||(d.contentType&&d.contentType!=="text/html"))){holder=d.createElementNS(ns,container)}else{holder=d.createElement(container)}holder.innerHTML=str;while(holder.firstChild){parent.appendChild(holder.firstChild)}return false}}}};var ieFix=function(node){if(node.nodeType===1){var newNode=d.createElement(node.nodeName);var i,len;if(node.attributes&&node.attributes.length>0){for(i=0,len=node.attributes.length;i<len;i++){newNode.setAttribute(node.attributes[i].nodeName,node.getAttribute(node.attributes[i].nodeName))}}if(node.childNodes&&node.childNodes.length>0){for(i=0,len=node.childNodes.length;i<len;i++){newNode.appendChild(ieFix(node.childNodes[i]))}}return newNode}else{return d.createTextNode(node.nodeValue)}};for(i=0;i<argc;i++){arg=argv[i];if(this.php_js&&this.php_js.ini&&this.php_js.ini["phpjs.echo_embedded_vars"]){arg=arg.replace(/(.?)\{\$(.*?)\}/g,function(s,m1,m2){if(m1!=="\\"){return m1+eval(m2)}else{return s}})}if(d.appendChild){if(d.body){if(win.navigator.appName=="Microsoft Internet Explorer"){d.body.appendChild(stringToDOM(ieFix(arg)))}else{var unappendedLeft=stringToDOM(arg,d.body,ns_xhtml,"div").cloneNode(true);if(unappendedLeft){d.body.appendChild(unappendedLeft)}}}else{d.documentElement.appendChild(stringToDOM(arg,d.documentElement,ns_xul,"description"))}}else{if(d.write){d.write(arg)}}}},end:function(arr){this.php_js=this.php_js||{};this.php_js.pointers=this.php_js.pointers||[];var indexOf=function(value){for(var i=0,length=this.length;i<length;i++){if(this[i]===value){return i}}return -1};var pointers=this.php_js.pointers;if(!pointers.indexOf){pointers.indexOf=indexOf}if(pointers.indexOf(arr)===-1){pointers.push(arr,0)}var arrpos=pointers.indexOf(arr);if(!(arr instanceof Array)){var ct=0;for(var k in arr){ct++;var val=arr[k]}if(ct===0){return false}pointers[arrpos+1]=ct-1;return val}if(arr.length===0){return false}pointers[arrpos+1]=arr.length-1;return arr[pointers[arrpos+1]]},exp:function(arg){return Math.exp(arg)},explode:function(delimiter,string,limit){var emptyArray={0:""};if(arguments.length<2||typeof arguments[0]=="undefined"||typeof arguments[1]=="undefined"){return null}if(delimiter===""||delimiter===false||delimiter===null){return false}if(typeof delimiter=="function"||typeof delimiter=="object"||typeof string=="function"||typeof string=="object"){return emptyArray}if(delimiter===true){delimiter="1"}if(!limit){return string.toString().split(delimiter.toString())}else{var splitted=string.toString().split(delimiter.toString());var partA=splitted.splice(0,limit-1);var partB=splitted.join(delimiter.toString());partA.push(partB);return partA}},expm1:function(x){var ret=0,n=50;var factorial=function factorial(n){if((n===0)||(n===1)){return 1}else{var result=(n*factorial(n-1));return result}};for(var i=1;i<n;i++){ret+=Math.pow(x,i)/factorial(i)}return ret},floatval:function(mixed_var){return(parseFloat(mixed_var)||0)},floor:function(value){return Math.floor(value)},fmod:function(x,y){var tmp,tmp2,p=0,pY=0,l=0,l2=0;tmp=x.toExponential().match(/^.\.?(.*)e(.+)$/);p=parseInt(tmp[2],10)-(tmp[1]+"").length;tmp=y.toExponential().match(/^.\.?(.*)e(.+)$/);pY=parseInt(tmp[2],10)-(tmp[1]+"").length;if(pY>p){p=pY}tmp2=(x%y);if(p<-100||p>20){l=Math.round(Math.log(tmp2)/Math.log(10));l2=Math.pow(10,l);return(tmp2/l2).toFixed(l-p)*l2}else{return parseFloat(tmp2.toFixed(-p))}},get_class:function(obj){if(obj instanceof Object&&!(obj instanceof Array)&&!(obj instanceof Function)&&obj.constructor&&obj!=this.window){var arr=obj.constructor.toString().match(/function\s*(\w+)/);if(arr&&arr.length==2){return arr[1]}}return false},get_defined_vars:function(){var i="",arr=[],already={};for(i in this.window){try{if(typeof this.window[i]==="function"){if(!already[i]){already[i]=1;arr.push(i)}}else{if(typeof this.window[i]==="object"){for(var j in this.window[i]){if(typeof this.window[j]==="function"&&this.window[j]&&!already[j]){already[j]=1;arr.push(j)}}}}}catch(e){}}return arr},get_headers:function(url,format){var req=this.window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest();if(!req){throw new Error("XMLHttpRequest not supported")}var tmp,headers,pair,i,j=0;req.open("HEAD",url,false);req.send(null);if(req.readyState<3){return false}tmp=req.getAllResponseHeaders();tmp=tmp.split("\n");tmp=this.array_filter(tmp,function(value){return value.substring(1)!==""});headers=format?{}:[];for(i in tmp){if(format){pair=tmp[i].split(":");headers[pair.splice(0,1)]=pair.join(":").substring(1)}else{headers[j++]=tmp[i]}}return headers},get_html_translation_table:function(table,quote_style){var entities={},hash_map={},decimal=0,symbol="";var constMappingTable={},constMappingQuoteStyle={};var useTable={},useQuoteStyle={};constMappingTable[0]="HTML_SPECIALCHARS";constMappingTable[1]="HTML_ENTITIES";constMappingQuoteStyle[0]="ENT_NOQUOTES";constMappingQuoteStyle[2]="ENT_COMPAT";constMappingQuoteStyle[3]="ENT_QUOTES";useTable=!isNaN(table)?constMappingTable[table]:table?table.toUpperCase():"HTML_SPECIALCHARS";useQuoteStyle=!isNaN(quote_style)?constMappingQuoteStyle[quote_style]:quote_style?quote_style.toUpperCase():"ENT_COMPAT";if(useTable!=="HTML_SPECIALCHARS"&&useTable!=="HTML_ENTITIES"){throw new Error("Table: "+useTable+" not supported")}entities["38"]="&amp;";if(useTable==="HTML_ENTITIES"){entities["160"]="&nbsp;";entities["161"]="&iexcl;";entities["162"]="&cent;";entities["163"]="&pound;";entities["164"]="&curren;";entities["165"]="&yen;";entities["166"]="&brvbar;";entities["167"]="&sect;";entities["168"]="&uml;";entities["169"]="&copy;";entities["170"]="&ordf;";entities["171"]="&laquo;";entities["172"]="&not;";entities["173"]="&shy;";entities["174"]="&reg;";entities["175"]="&macr;";entities["176"]="&deg;";entities["177"]="&plusmn;";entities["178"]="&sup2;";entities["179"]="&sup3;";entities["180"]="&acute;";entities["181"]="&micro;";entities["182"]="&para;";entities["183"]="&middot;";entities["184"]="&cedil;";entities["185"]="&sup1;";entities["186"]="&ordm;";entities["187"]="&raquo;";entities["188"]="&frac14;";entities["189"]="&frac12;";entities["190"]="&frac34;";entities["191"]="&iquest;";entities["192"]="&Agrave;";entities["193"]="&Aacute;";entities["194"]="&Acirc;";entities["195"]="&Atilde;";entities["196"]="&Auml;";entities["197"]="&Aring;";entities["198"]="&AElig;";entities["199"]="&Ccedil;";entities["200"]="&Egrave;";entities["201"]="&Eacute;";entities["202"]="&Ecirc;";entities["203"]="&Euml;";entities["204"]="&Igrave;";entities["205"]="&Iacute;";entities["206"]="&Icirc;";entities["207"]="&Iuml;";entities["208"]="&ETH;";entities["209"]="&Ntilde;";entities["210"]="&Ograve;";entities["211"]="&Oacute;";entities["212"]="&Ocirc;";entities["213"]="&Otilde;";entities["214"]="&Ouml;";entities["215"]="&times;";entities["216"]="&Oslash;";entities["217"]="&Ugrave;";entities["218"]="&Uacute;";entities["219"]="&Ucirc;";entities["220"]="&Uuml;";entities["221"]="&Yacute;";entities["222"]="&THORN;";entities["223"]="&szlig;";entities["224"]="&agrave;";entities["225"]="&aacute;";entities["226"]="&acirc;";entities["227"]="&atilde;";entities["228"]="&auml;";entities["229"]="&aring;";entities["230"]="&aelig;";entities["231"]="&ccedil;";entities["232"]="&egrave;";entities["233"]="&eacute;";entities["234"]="&ecirc;";entities["235"]="&euml;";entities["236"]="&igrave;";entities["237"]="&iacute;";entities["238"]="&icirc;";entities["239"]="&iuml;";entities["240"]="&eth;";entities["241"]="&ntilde;";entities["242"]="&ograve;";entities["243"]="&oacute;";entities["244"]="&ocirc;";entities["245"]="&otilde;";entities["246"]="&ouml;";entities["247"]="&divide;";entities["248"]="&oslash;";entities["249"]="&ugrave;";entities["250"]="&uacute;";entities["251"]="&ucirc;";entities["252"]="&uuml;";entities["253"]="&yacute;";entities["254"]="&thorn;";entities["255"]="&yuml;"}if(useQuoteStyle!=="ENT_NOQUOTES"){entities["34"]="&quot;"}if(useQuoteStyle==="ENT_QUOTES"){entities["39"]="&#39;"}entities["60"]="&lt;";entities["62"]="&gt;";for(decimal in entities){symbol=String.fromCharCode(decimal);hash_map[symbol]=entities[decimal]}return hash_map},getdate:function(timestamp){var _w=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var _m=["January","February","March","April","May","June","July","August","September","October","November","December"];var d=((typeof(timestamp)=="undefined")?new Date():(typeof(timestamp)=="object")?new Date(timestamp):new Date(timestamp*1000));var w=d.getDay();var m=d.getMonth();var y=d.getFullYear();var r={};r.seconds=d.getSeconds();r.minutes=d.getMinutes();r.hours=d.getHours();r.mday=d.getDate();r.wday=w;r.mon=m+1;r.year=y;r.yday=Math.floor((d-(new Date(y,0,1)))/86400000);r.weekday=_w[w];r.month=_m[m];r["0"]=parseInt(d.getTime()/1000,10);return r},getrandmax:function(){return 2147483647},hexdec:function(hex_string){hex_string=(hex_string+"").replace(/[^a-f0-9]/gi,"");return parseInt(hex_string,16)},html_entity_decode:function(string,quote_style){var hash_map={},symbol="",tmp_str="",entity="";tmp_str=string.toString();if(false===(hash_map=this.get_html_translation_table("HTML_ENTITIES",quote_style))){return false}delete (hash_map["&"]);hash_map["&"]="&amp;";for(symbol in hash_map){entity=hash_map[symbol];tmp_str=tmp_str.split(entity).join(symbol)}tmp_str=tmp_str.split("&#039;").join("'");return tmp_str},htmlentities:function(string,quote_style){var hash_map={},symbol="",tmp_str="",entity="";tmp_str=string.toString();if(false===(hash_map=this.get_html_translation_table("HTML_ENTITIES",quote_style))){return false}hash_map["'"]="&#039;";for(symbol in hash_map){entity=hash_map[symbol];tmp_str=tmp_str.split(symbol).join(entity)}return tmp_str},htmlspecialchars:function(string,quote_style,charset,double_encode){var optTemp=0,i=0,noquotes=false;if(typeof quote_style==="undefined"||quote_style===null){quote_style=2}string=string.toString();if(double_encode!==false){string=string.replace(/&/g,"&amp;")}string=string.replace(/</g,"&lt;").replace(/>/g,"&gt;");var OPTS={ENT_NOQUOTES:0,ENT_HTML_QUOTE_SINGLE:1,ENT_HTML_QUOTE_DOUBLE:2,ENT_COMPAT:2,ENT_QUOTES:3,ENT_IGNORE:4};if(quote_style===0){noquotes=true}if(typeof quote_style!=="number"){quote_style=[].concat(quote_style);for(i=0;i<quote_style.length;i++){if(OPTS[quote_style[i]]===0){noquotes=true}else{if(OPTS[quote_style[i]]){optTemp=optTemp|OPTS[quote_style[i]]}}}quote_style=optTemp}if(quote_style&OPTS.ENT_HTML_QUOTE_SINGLE){string=string.replace(/'/g,"&#039;")}if(!noquotes){string=string.replace(/"/g,"&quot;")}return string},htmlspecialchars_decode:function(string,quote_style){var optTemp=0,i=0,noquotes=false;if(typeof quote_style==="undefined"){quote_style=2}string=string.toString().replace(/&lt;/g,"<").replace(/&gt;/g,">");var OPTS={ENT_NOQUOTES:0,ENT_HTML_QUOTE_SINGLE:1,ENT_HTML_QUOTE_DOUBLE:2,ENT_COMPAT:2,ENT_QUOTES:3,ENT_IGNORE:4};if(quote_style===0){noquotes=true}if(typeof quote_style!=="number"){quote_style=[].concat(quote_style);for(i=0;i<quote_style.length;i++){if(OPTS[quote_style[i]]===0){noquotes=true}else{if(OPTS[quote_style[i]]){optTemp=optTemp|OPTS[quote_style[i]]}}}quote_style=optTemp}if(quote_style&OPTS.ENT_HTML_QUOTE_SINGLE){string=string.replace(/&#0*39;/g,"'")}if(!noquotes){string=string.replace(/&quot;/g,'"')}string=string.replace(/&amp;/g,"&");return string},http_build_query:function(formdata,numeric_prefix,arg_separator){var value,key,tmp=[];var _http_build_query_helper=function(key,val,arg_separator){var k,tmp=[];if(val===true){val="1"}else{if(val===false){val="0"}}if(val!==null&&typeof(val)==="object"){for(k in val){if(val[k]!==null){tmp.push(_http_build_query_helper(key+"["+k+"]",val[k],arg_separator))}}return tmp.join(arg_separator)}else{if(typeof(val)!=="function"){return this.urlencode(key)+"="+this.urlencode(val)}else{throw new Error("There was an error processing for http_build_query().")}}};if(!arg_separator){arg_separator="&"}for(key in formdata){value=formdata[key];if(numeric_prefix&&!isNaN(key)){key=String(numeric_prefix)+key}tmp.push(_http_build_query_helper(key,value,arg_separator))}return tmp.join(arg_separator)},hypot:function(x,y){return Math.sqrt(x*x+y*y)||0},implode:function(glue,pieces){var i="",retVal="",tGlue="";if(arguments.length===1){pieces=glue;glue=""}if(typeof(pieces)==="object"){if(pieces instanceof Array){return pieces.join(glue)}else{for(i in pieces){retVal+=tGlue+pieces[i];tGlue=glue}return retVal}}else{return pieces}},in_array:function(needle,haystack,argStrict){var key="",strict=!!argStrict;if(strict){for(key in haystack){if(haystack[key]===needle){return true}}}else{for(key in haystack){if(haystack[key]==needle){return true}}}return false},intval:function(mixed_var,base){var tmp;var type=typeof(mixed_var);if(type==="boolean"){return(mixed_var)?1:0}else{if(type==="string"){tmp=parseInt(mixed_var,base||10);return(isNaN(tmp)||!isFinite(tmp))?0:tmp}else{if(type==="number"&&isFinite(mixed_var)){return Math.floor(mixed_var)}else{return 0}}}},ip2long:function(IP){var i=0;IP=IP.match(/^([1-9]\d*|0[0-7]*|0x[\da-f]+)(?:\.([1-9]\d*|0[0-7]*|0x[\da-f]+))?(?:\.([1-9]\d*|0[0-7]*|0x[\da-f]+))?(?:\.([1-9]\d*|0[0-7]*|0x[\da-f]+))?$/i);if(!IP){return false}IP[0]=0;for(i=1;i<5;i+=1){IP[0]+=!!((IP[i]||"").length);IP[i]=parseInt(IP[i])||0}IP.push(256,256,256,256);IP[4+IP[0]]*=Math.pow(256,4-IP[0]);if(IP[1]>=IP[5]||IP[2]>=IP[6]||IP[3]>=IP[7]||IP[4]>=IP[8]){return false}return IP[1]*(IP[0]===1||16777216)+IP[2]*(IP[0]<=2||65536)+IP[3]*(IP[0]<=3||256)+IP[4]*1},is_bool:function(mixed_var){return(typeof mixed_var==="boolean")},is_double:function(mixed_var){return this.is_float(mixed_var)},is_finite:function(val){var warningType="";if(val===Infinity||val===-Infinity){return false}if(typeof val=="object"){warningType=(val instanceof Array?"array":"object")}else{if(typeof val=="string"&&!val.match(/^[\+\-]?\d/)){warningType="string"}}if(warningType){throw new Error("Warning: is_finite() expects parameter 1 to be double, "+warningType+" given")}return true},is_float:function(mixed_var){if(typeof mixed_var!=="number"){return false}return !!(mixed_var%1)},is_infinite:function(val){var warningType="";if(val===Infinity||val===-Infinity){return true}if(typeof val=="object"){warningType=(val instanceof Array?"array":"object")}else{if(typeof val=="string"&&!val.match(/^[\+\-]?\d/)){warningType="string"}}if(warningType){throw new Error("Warning: is_infinite() expects parameter 1 to be double, "+warningType+" given")}return false},is_int:function(mixed_var){if(typeof mixed_var!=="number"){return false}return !(mixed_var%1)},is_integer:function(mixed_var){return this.is_int(mixed_var)},is_long:function(mixed_var){return this.is_float(mixed_var)},is_nan:function(val){var warningType="";if(typeof val=="number"&&isNaN(val)){return true}if(typeof val=="object"){warningType=(val instanceof Array?"array":"object")}else{if(typeof val=="string"&&!val.match(/^[\+\-]?\d/)){warningType="string"}}if(warningType){throw new Error("Warning: is_nan() expects parameter 1 to be double, "+warningType+" given")}return false},is_null:function(mixed_var){return(mixed_var===null)},is_numeric:function(mixed_var){return(typeof(mixed_var)==="number"||typeof(mixed_var)==="string")&&mixed_var!==""&&!isNaN(mixed_var)},is_real:function(mixed_var){return this.is_float(mixed_var)},is_scalar:function(mixed_var){return(/boolean|number|string/).test(typeof mixed_var)},is_string:function(mixed_var){return(typeof(mixed_var)=="string")},join:function(glue,pieces){return this.implode(glue,pieces)},json_decode:function(str_json){var json=this.window.JSON;if(typeof json==="object"&&typeof json.parse==="function"){try{return json.parse(str_json)}catch(err){if(!(err instanceof SyntaxError)){throw new Error("Unexpected error type in json_decode()")}this.php_js=this.php_js||{};this.php_js.last_error_json=4;return null}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;var j;var text=str_json;cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if((/^[\],:{}\s]*$/).test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return j}this.php_js=this.php_js||{};this.php_js.last_error_json=4;return null},json_encode:function(mixed_val){var retVal,json=this.window.JSON;try{if(typeof json==="object"&&typeof json.stringify==="function"){retVal=json.stringify(mixed_val);if(retVal===undefined){throw new SyntaxError("json_encode")}return retVal}var value=mixed_val;var quote=function(string){var escapable=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;var meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'};var str=function(key,holder){var gap="";var indent="    ";var i=0;var k="";var v="";var length=0;var mind=gap;var partial=[];var value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}if(value instanceof PHPJS_Resource){throw new SyntaxError("json_encode")}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v;case"undefined":case"function":default:throw new SyntaxError("json_encode")}};return str("",{"":value})}catch(err){if(!(err instanceof SyntaxError)){throw new Error("Unexpected error type in json_encode()")}this.php_js=this.php_js||{};this.php_js.last_error_json=4;return null}},krsort:function(inputArr,sort_flags){var tmp_arr={},keys=[],sorter,i,k,that=this,strictForIn=false,populateArr=[];switch(sort_flags){case"SORT_STRING":sorter=function(a,b){return that.strnatcmp(b,a)};break;case"SORT_LOCALE_STRING":var loc=this.i18n_loc_get_default();sorter=this.php_js.i18nLocales[loc].sorting;break;case"SORT_NUMERIC":sorter=function(a,b){return(b-a)};break;case"SORT_REGULAR":default:sorter=function(a,b){if(a<b){return 1}if(a>b){return -1}return 0};break}for(k in inputArr){if(inputArr.hasOwnProperty){keys.push(k)}}keys.sort(sorter);this.php_js=this.php_js||{};this.php_js.ini=this.php_js.ini||{};strictForIn=this.php_js.ini["phpjs.strictForIn"]&&this.php_js.ini["phpjs.strictForIn"].local_value;populateArr=strictForIn?inputArr:populateArr;for(i=0;i<keys.length;i++){k=keys[i];tmp_arr[k]=inputArr[k];if(strictForIn){delete inputArr[k]}}for(i in tmp_arr){if(tmp_arr.hasOwnProperty){populateArr[i]=tmp_arr[i]}}return strictForIn?true:populateArr},ksort:function(inputArr,sort_flags){var tmp_arr={},keys=[],sorter,i,k,that=this,strictForIn=false,populateArr=[];switch(sort_flags){case"SORT_STRING":sorter=function(a,b){return that.strnatcmp(a,b)};break;case"SORT_LOCALE_STRING":var loc=this.i18n_loc_get_default();sorter=this.php_js.i18nLocales[loc].sorting;break;case"SORT_NUMERIC":sorter=function(a,b){return(a-b)};break;case"SORT_REGULAR":default:sorter=function(a,b){if(a>b){return 1}if(a<b){return -1}return 0};break}for(k in inputArr){if(inputArr.hasOwnProperty){keys.push(k)}}keys.sort(sorter);this.php_js=this.php_js||{};this.php_js.ini=this.php_js.ini||{};strictForIn=this.php_js.ini["phpjs.strictForIn"]&&this.php_js.ini["phpjs.strictForIn"].local_value;populateArr=strictForIn?inputArr:populateArr;for(i=0;i<keys.length;i++){k=keys[i];tmp_arr[k]=inputArr[k];if(strictForIn){delete inputArr[k]}}for(i in tmp_arr){if(tmp_arr.hasOwnProperty){populateArr[i]=tmp_arr[i]}}return strictForIn?true:populateArr},lcfirst:function(str){str+="";var f=str.charAt(0).toLowerCase();return f+str.substr(1)},lcg_value:function(){return Math.random()},levenshtein:function(s1,s2){if(s1==s2){return 0}var s1_len=s1.length;var s2_len=s2.length;if(s1_len===0){return s2_len}if(s2_len===0){return s1_len}var split=false;try{split=!("0")[0]}catch(e){split=true}if(split){s1=s1.split("");s2=s2.split("")}var v0=new Array(s1_len+1);var v1=new Array(s1_len+1);var s1_idx=0,s2_idx=0,cost=0;for(s1_idx=0;s1_idx<s1_len+1;s1_idx++){v0[s1_idx]=s1_idx}var char_s1="",char_s2="";for(s2_idx=1;s2_idx<=s2_len;s2_idx++){v1[0]=s2_idx;char_s2=s2[s2_idx-1];for(s1_idx=0;s1_idx<s1_len;s1_idx++){char_s1=s1[s1_idx];cost=(char_s1==char_s2)?0:1;var m_min=v0[s1_idx+1]+1;var b=v1[s1_idx]+1;var c=v0[s1_idx]+cost;if(b<m_min){m_min=b}if(c<m_min){m_min=c}v1[s1_idx+1]=m_min}var v_tmp=v0;v0=v1;v1=v_tmp}return v0[s1_len]},log:function(arg,base){if(base===undefined){return Math.log(arg)}else{return Math.log(arg)/Math.log(base)}},log10:function(arg){return Math.log(arg)/Math.LN10},log1p:function(x){var ret=0,n=50;if(x<=-1){return"-INF"}if(x<0||x>1){return Math.log(1+x)}for(var i=1;i<n;i++){if((i%2)===0){ret-=Math.pow(x,i)/i}else{ret+=Math.pow(x,i)/i}}return ret},long2ip:function(proper_address){var output=false;if(!isNaN(proper_address)&&(proper_address>=0||proper_address<=4294967295)){output=Math.floor(proper_address/Math.pow(256,3))+"."+Math.floor((proper_address%Math.pow(256,3))/Math.pow(256,2))+"."+Math.floor(((proper_address%Math.pow(256,3))%Math.pow(256,2))/Math.pow(256,1))+"."+Math.floor((((proper_address%Math.pow(256,3))%Math.pow(256,2))%Math.pow(256,1))/Math.pow(256,0))}return output},ltrim:function(str,charlist){charlist=!charlist?" \\s\u00A0":(charlist+"").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"$1");var re=new RegExp("^["+charlist+"]+","g");return(str+"").replace(re,"")},max:function(){var ar,retVal,i=0,n=0;var argv=arguments,argc=argv.length;var _obj2Array=function(obj){if(obj instanceof Array){return obj}else{var ar=[];for(var i in obj){ar.push(obj[i])}return ar}};var _compare=function(current,next){var i=0,n=0,tmp=0;var nl=0,cl=0;if(current===next){return 0}else{if(typeof current=="object"){if(typeof next=="object"){current=_obj2Array(current);next=_obj2Array(next);cl=current.length;nl=next.length;if(nl>cl){return 1}else{if(nl<cl){return -1}else{for(i=0,n=cl;i<n;++i){tmp=_compare(current[i],next[i]);if(tmp==1){return 1}else{if(tmp==-1){return -1}}}return 0}}}else{return -1}}else{if(typeof next=="object"){return 1}else{if(isNaN(next)&&!isNaN(current)){if(current==0){return 0}else{return(current<0?1:-1)}}else{if(isNaN(current)&&!isNaN(next)){if(next==0){return 0}else{return(next>0?1:-1)}}else{if(next==current){return 0}else{return(next>current?1:-1)}}}}}}};if(argc===0){throw new Error("At least one value should be passed to max()")}else{if(argc===1){if(typeof argv[0]==="object"){ar=_obj2Array(argv[0])}else{throw new Error("Wrong parameter count for max()")}if(ar.length===0){throw new Error("Array must contain at least one element for max()")}}else{ar=argv}}retVal=ar[0];for(i=1,n=ar.length;i<n;++i){if(_compare(retVal,ar[i])==1){retVal=ar[i]}}return retVal},md5:function(str){var xl;var rotateLeft=function(lValue,iShiftBits){return(lValue<<iShiftBits)|(lValue>>>(32-iShiftBits))};var addUnsigned=function(lX,lY){var lX4,lY4,lX8,lY8,lResult;lX8=(lX&2147483648);lY8=(lY&2147483648);lX4=(lX&1073741824);lY4=(lY&1073741824);lResult=(lX&1073741823)+(lY&1073741823);if(lX4&lY4){return(lResult^2147483648^lX8^lY8)}if(lX4|lY4){if(lResult&1073741824){return(lResult^3221225472^lX8^lY8)}else{return(lResult^1073741824^lX8^lY8)}}else{return(lResult^lX8^lY8)}};var _F=function(x,y,z){return(x&y)|((~x)&z)};var _G=function(x,y,z){return(x&z)|(y&(~z))};var _H=function(x,y,z){return(x^y^z)};var _I=function(x,y,z){return(y^(x|(~z)))};var _FF=function(a,b,c,d,x,s,ac){a=addUnsigned(a,addUnsigned(addUnsigned(_F(b,c,d),x),ac));return addUnsigned(rotateLeft(a,s),b)};var _GG=function(a,b,c,d,x,s,ac){a=addUnsigned(a,addUnsigned(addUnsigned(_G(b,c,d),x),ac));return addUnsigned(rotateLeft(a,s),b)};var _HH=function(a,b,c,d,x,s,ac){a=addUnsigned(a,addUnsigned(addUnsigned(_H(b,c,d),x),ac));return addUnsigned(rotateLeft(a,s),b)};var _II=function(a,b,c,d,x,s,ac){a=addUnsigned(a,addUnsigned(addUnsigned(_I(b,c,d),x),ac));return addUnsigned(rotateLeft(a,s),b)};var convertToWordArray=function(str){var lWordCount;var lMessageLength=str.length;var lNumberOfWords_temp1=lMessageLength+8;var lNumberOfWords_temp2=(lNumberOfWords_temp1-(lNumberOfWords_temp1%64))/64;var lNumberOfWords=(lNumberOfWords_temp2+1)*16;var lWordArray=new Array(lNumberOfWords-1);var lBytePosition=0;var lByteCount=0;while(lByteCount<lMessageLength){lWordCount=(lByteCount-(lByteCount%4))/4;lBytePosition=(lByteCount%4)*8;lWordArray[lWordCount]=(lWordArray[lWordCount]|(str.charCodeAt(lByteCount)<<lBytePosition));lByteCount++}lWordCount=(lByteCount-(lByteCount%4))/4;lBytePosition=(lByteCount%4)*8;lWordArray[lWordCount]=lWordArray[lWordCount]|(128<<lBytePosition);lWordArray[lNumberOfWords-2]=lMessageLength<<3;lWordArray[lNumberOfWords-1]=lMessageLength>>>29;return lWordArray};var wordToHex=function(lValue){var wordToHexValue="",wordToHexValue_temp="",lByte,lCount;for(lCount=0;lCount<=3;lCount++){lByte=(lValue>>>(lCount*8))&255;wordToHexValue_temp="0"+lByte.toString(16);wordToHexValue=wordToHexValue+wordToHexValue_temp.substr(wordToHexValue_temp.length-2,2)}return wordToHexValue};var x=[],k,AA,BB,CC,DD,a,b,c,d,S11=7,S12=12,S13=17,S14=22,S21=5,S22=9,S23=14,S24=20,S31=4,S32=11,S33=16,S34=23,S41=6,S42=10,S43=15,S44=21;str=this.utf8_encode(str);x=convertToWordArray(str);a=1732584193;b=4023233417;c=2562383102;d=271733878;xl=x.length;for(k=0;k<xl;k+=16){AA=a;BB=b;CC=c;DD=d;a=_FF(a,b,c,d,x[k+0],S11,3614090360);d=_FF(d,a,b,c,x[k+1],S12,3905402710);c=_FF(c,d,a,b,x[k+2],S13,606105819);b=_FF(b,c,d,a,x[k+3],S14,3250441966);a=_FF(a,b,c,d,x[k+4],S11,4118548399);d=_FF(d,a,b,c,x[k+5],S12,1200080426);c=_FF(c,d,a,b,x[k+6],S13,2821735955);b=_FF(b,c,d,a,x[k+7],S14,4249261313);a=_FF(a,b,c,d,x[k+8],S11,1770035416);d=_FF(d,a,b,c,x[k+9],S12,2336552879);c=_FF(c,d,a,b,x[k+10],S13,4294925233);b=_FF(b,c,d,a,x[k+11],S14,2304563134);a=_FF(a,b,c,d,x[k+12],S11,1804603682);d=_FF(d,a,b,c,x[k+13],S12,4254626195);c=_FF(c,d,a,b,x[k+14],S13,2792965006);b=_FF(b,c,d,a,x[k+15],S14,1236535329);a=_GG(a,b,c,d,x[k+1],S21,4129170786);d=_GG(d,a,b,c,x[k+6],S22,3225465664);c=_GG(c,d,a,b,x[k+11],S23,643717713);b=_GG(b,c,d,a,x[k+0],S24,3921069994);a=_GG(a,b,c,d,x[k+5],S21,3593408605);d=_GG(d,a,b,c,x[k+10],S22,38016083);c=_GG(c,d,a,b,x[k+15],S23,3634488961);b=_GG(b,c,d,a,x[k+4],S24,3889429448);a=_GG(a,b,c,d,x[k+9],S21,568446438);d=_GG(d,a,b,c,x[k+14],S22,3275163606);c=_GG(c,d,a,b,x[k+3],S23,4107603335);b=_GG(b,c,d,a,x[k+8],S24,1163531501);a=_GG(a,b,c,d,x[k+13],S21,2850285829);d=_GG(d,a,b,c,x[k+2],S22,4243563512);c=_GG(c,d,a,b,x[k+7],S23,1735328473);b=_GG(b,c,d,a,x[k+12],S24,2368359562);a=_HH(a,b,c,d,x[k+5],S31,4294588738);d=_HH(d,a,b,c,x[k+8],S32,2272392833);c=_HH(c,d,a,b,x[k+11],S33,1839030562);b=_HH(b,c,d,a,x[k+14],S34,4259657740);a=_HH(a,b,c,d,x[k+1],S31,2763975236);d=_HH(d,a,b,c,x[k+4],S32,1272893353);c=_HH(c,d,a,b,x[k+7],S33,4139469664);b=_HH(b,c,d,a,x[k+10],S34,3200236656);a=_HH(a,b,c,d,x[k+13],S31,681279174);d=_HH(d,a,b,c,x[k+0],S32,3936430074);c=_HH(c,d,a,b,x[k+3],S33,3572445317);b=_HH(b,c,d,a,x[k+6],S34,76029189);a=_HH(a,b,c,d,x[k+9],S31,3654602809);d=_HH(d,a,b,c,x[k+12],S32,3873151461);c=_HH(c,d,a,b,x[k+15],S33,530742520);b=_HH(b,c,d,a,x[k+2],S34,3299628645);a=_II(a,b,c,d,x[k+0],S41,4096336452);d=_II(d,a,b,c,x[k+7],S42,1126891415);c=_II(c,d,a,b,x[k+14],S43,2878612391);b=_II(b,c,d,a,x[k+5],S44,4237533241);a=_II(a,b,c,d,x[k+12],S41,1700485571);d=_II(d,a,b,c,x[k+3],S42,2399980690);c=_II(c,d,a,b,x[k+10],S43,4293915773);b=_II(b,c,d,a,x[k+1],S44,2240044497);a=_II(a,b,c,d,x[k+8],S41,1873313359);d=_II(d,a,b,c,x[k+15],S42,4264355552);c=_II(c,d,a,b,x[k+6],S43,2734768916);b=_II(b,c,d,a,x[k+13],S44,1309151649);a=_II(a,b,c,d,x[k+4],S41,4149444226);d=_II(d,a,b,c,x[k+11],S42,3174756917);c=_II(c,d,a,b,x[k+2],S43,718787259);b=_II(b,c,d,a,x[k+9],S44,3951481745);a=addUnsigned(a,AA);b=addUnsigned(b,BB);c=addUnsigned(c,CC);d=addUnsigned(d,DD)}var temp=wordToHex(a)+wordToHex(b)+wordToHex(c)+wordToHex(d);return temp.toLowerCase()},method_exists:function(obj,method){if(typeof obj==="string"){return this.window[obj]&&typeof this.window[obj][method]==="function"}return typeof obj[method]==="function"},microtime:function(get_as_float){var now=new Date().getTime()/1000;var s=parseInt(now,10);return(get_as_float)?now:(Math.round((now-s)*1000)/1000)+" "+s},min:function(){var ar,retVal,i=0,n=0;var argv=arguments,argc=argv.length;var _obj2Array=function(obj){if(obj instanceof Array){return obj}else{var ar=[];for(var i in obj){ar.push(obj[i])}return ar}};var _compare=function(current,next){var i=0,n=0,tmp=0;var nl=0,cl=0;if(current===next){return 0}else{if(typeof current=="object"){if(typeof next=="object"){current=_obj2Array(current);next=_obj2Array(next);cl=current.length;nl=next.length;if(nl>cl){return 1}else{if(nl<cl){return -1}else{for(i=0,n=cl;i<n;++i){tmp=_compare(current[i],next[i]);if(tmp==1){return 1}else{if(tmp==-1){return -1}}}return 0}}}else{return -1}}else{if(typeof next=="object"){return 1}else{if(isNaN(next)&&!isNaN(current)){if(current==0){return 0}else{return(current<0?1:-1)}}else{if(isNaN(current)&&!isNaN(next)){if(next==0){return 0}else{return(next>0?1:-1)}}else{if(next==current){return 0}else{return(next>current?1:-1)}}}}}}};if(argc===0){throw new Error("At least one value should be passed to min()")}else{if(argc===1){if(typeof argv[0]==="object"){ar=_obj2Array(argv[0])}else{throw new Error("Wrong parameter count for min()")}if(ar.length===0){throw new Error("Array must contain at least one element for min()")}}else{ar=argv}}retVal=ar[0];for(i=1,n=ar.length;i<n;++i){if(_compare(retVal,ar[i])==-1){retVal=ar[i]}}return retVal},mktime:function(){var d=new Date(),r=arguments,i=0,e=["Hours","Minutes","Seconds","Month","Date","FullYear"];for(i=0;i<e.length;i++){if(typeof r[i]==="undefined"){r[i]=d["get"+e[i]]();r[i]+=(i===3)}else{r[i]=parseInt(r[i],10);if(isNaN(r[i])){return false}}}r[5]+=(r[5]>=0?(r[5]<=69?2000:(r[5]<=100?1900:0)):0);d.setFullYear(r[5],r[3]-1,r[4]);d.setHours(r[0],r[1],r[2]);return(d.getTime()/1000>>0)-(d.getTime()<0)},mt_getrandmax:function(){return 2147483647},mt_rand:function(min,max){var argc=arguments.length;if(argc===0){min=0;max=2147483647}else{if(argc===1){throw new Error("Warning: mt_rand() expects exactly 2 parameters, 1 given")}}return Math.floor(Math.random()*(max-min+1))+min},natcasesort:function(inputArr){var valArr=[],keyArr=[],k,i,ret,that=this,strictForIn=false,populateArr=[];var bubbleSort=function(keyArr,inputArr){var i,j,tempValue,tempKeyVal;for(i=inputArr.length-2;i>=0;i--){for(j=0;j<=i;j++){ret=that.strnatcasecmp(inputArr[j+1],inputArr[j]);if(ret<0){tempValue=inputArr[j];inputArr[j]=inputArr[j+1];inputArr[j+1]=tempValue;tempKeyVal=keyArr[j];keyArr[j]=keyArr[j+1];keyArr[j+1]=tempKeyVal}}}};this.php_js=this.php_js||{};this.php_js.ini=this.php_js.ini||{};strictForIn=this.php_js.ini["phpjs.strictForIn"]&&this.php_js.ini["phpjs.strictForIn"].local_value;populateArr=strictForIn?inputArr:populateArr;for(k in inputArr){if(inputArr.hasOwnProperty){valArr.push(inputArr[k]);keyArr.push(k);if(strictForIn){delete inputArr[k]}}}try{bubbleSort(keyArr,valArr)}catch(e){return false}for(i=0;i<valArr.length;i++){populateArr[keyArr[i]]=valArr[i]}return strictForIn?true:populateArr},natsort:function(inputArr){var valArr=[],keyArr=[],k,i,ret,that=this,strictForIn=false,populateArr=[];var bubbleSort=function(keyArr,inputArr){var i,j,tempValue,tempKeyVal;for(i=inputArr.length-2;i>=0;i--){for(j=0;j<=i;j++){ret=that.strnatcmp(inputArr[j+1],inputArr[j]);if(ret<0){tempValue=inputArr[j];inputArr[j]=inputArr[j+1];inputArr[j+1]=tempValue;tempKeyVal=keyArr[j];keyArr[j]=keyArr[j+1];keyArr[j+1]=tempKeyVal}}}};this.php_js=this.php_js||{};this.php_js.ini=this.php_js.ini||{};strictForIn=this.php_js.ini["phpjs.strictForIn"]&&this.php_js.ini["phpjs.strictForIn"].local_value;populateArr=strictForIn?inputArr:populateArr;for(k in inputArr){if(inputArr.hasOwnProperty){valArr.push(inputArr[k]);keyArr.push(k);if(strictForIn){delete inputArr[k]}}}try{bubbleSort(keyArr,valArr)}catch(e){return false}for(i=0;i<valArr.length;i++){populateArr[keyArr[i]]=valArr[i]}return strictForIn?true:populateArr},nl2br:function(str,is_xhtml){var breakTag=(is_xhtml||typeof is_xhtml==="undefined")?"<br />":"<br>";return(str+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+breakTag+"$2")},number_format:function(number,decimals,dec_point,thousands_sep){var n=!isFinite(+number)?0:+number,prec=!isFinite(+decimals)?0:Math.abs(decimals),sep=(typeof thousands_sep==="undefined")?",":thousands_sep,dec=(typeof dec_point==="undefined")?".":dec_point,s="",toFixedFix=function(n,prec){var k=Math.pow(10,prec);return""+Math.round(n*k)/k};s=(prec?toFixedFix(n,prec):""+Math.round(n)).split(".");if(s[0].length>3){s[0]=s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,sep)}if((s[1]||"").length<prec){s[1]=s[1]||"";s[1]+=new Array(prec-s[1].length+1).join("0")}return s.join(dec)},octdec:function(oct_string){oct_string=(oct_string+"").replace(/[^0-7]/gi,"");return parseInt(oct_string,8)},ord:function(string){var str=string+"";var code=str.charCodeAt(0);if(55296<=code&&code<=56319){var hi=code;if(str.length===1){return code}var low=str.charCodeAt(1);if(!low){}return((hi-55296)*1024)+(low-56320)+65536}if(56320<=code&&code<=57343){return code}return code},parse_str:function(str,array){var glue1="=",glue2="&",array2=String(str).split(glue2),i,j,chr,tmp,key,value,bracket,keys,evalStr,that=this,fixStr=function(str){return that.urldecode(str).replace(/([\\"'])/g,"\\$1").replace(/\n/g,"\\n").replace(/\r/g,"\\r")};if(!array){array=this.window}for(i=0;i<array2.length;i++){tmp=array2[i].split(glue1);if(tmp.length<2){tmp=[tmp,""]}key=fixStr(tmp[0]);value=fixStr(tmp[1]);while(key.charAt(0)===" "){key=key.substr(1)}if(key.indexOf("\0")!==-1){key=key.substr(0,key.indexOf("\0"))}if(key&&key.charAt(0)!=="["){keys=[];bracket=0;for(j=0;j<key.length;j++){if(key.charAt(j)==="["&&!bracket){bracket=j+1}else{if(key.charAt(j)==="]"){if(bracket){if(!keys.length){keys.push(key.substr(0,bracket-1))}keys.push(key.substr(bracket,j-bracket));bracket=0;if(key.charAt(j+1)!=="["){break}}}}}if(!keys.length){keys=[key]}for(j=0;j<keys[0].length;j++){chr=keys[0].charAt(j);if(chr===" "||chr==="."||chr==="["){keys[0]=keys[0].substr(0,j)+"_"+keys[0].substr(j+1)}if(chr==="["){break}}evalStr="array";for(j=0;j<keys.length;j++){key=keys[j];if((key!==""&&key!==" ")||j===0){key="'"+key+"'"}else{key=eval(evalStr+".push([]);")-1}evalStr+="["+key+"]";if(j!==keys.length-1&&eval("typeof "+evalStr)==="undefined"){eval(evalStr+" = [];")}}evalStr+=" = '"+value+"';\n";eval(evalStr)}}},parse_url:function(str,component){var o={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/\/?)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var m=o.parser[o.strictMode?"strict":"loose"].exec(str),uri={},i=14;while(i--){uri[o.key[i]]=m[i]||""}switch(component){case"PHP_URL_SCHEME":return uri.protocol;case"PHP_URL_HOST":return uri.host;case"PHP_URL_PORT":return uri.port;case"PHP_URL_USER":return uri.user;case"PHP_URL_PASS":return uri.password;case"PHP_URL_PATH":return uri.path;case"PHP_URL_QUERY":return uri.query;case"PHP_URL_FRAGMENT":return uri.anchor;default:var retArr={};if(uri.protocol!==""){retArr.scheme=uri.protocol}if(uri.host!==""){retArr.host=uri.host}if(uri.port!==""){retArr.port=uri.port}if(uri.user!==""){retArr.user=uri.user}if(uri.password!==""){retArr.pass=uri.password}if(uri.path!==""){retArr.path=uri.path}if(uri.query!==""){retArr.query=uri.query}if(uri.anchor!==""){retArr.fragment=uri.anchor}return retArr}},pi:function(){return Math.PI},pow:function(base,exp){return Math.pow(base,exp)},preg_grep:function(pattern,input,flags){var p="",retObj={};var invert=(flags===1||flags==="PREG_GREP_INVERT");if(typeof pattern==="string"){pattern=eval(pattern)}if(invert){for(p in input){if(!pattern.test(input[p])){retObj[p]=input[p]}}}else{for(p in input){if(pattern.test(input[p])){retObj[p]=input[p]}}}return retObj},preg_quote:function(str){return(str+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!<>\|\:])/g,"\\$1")},print_r:function(array,return_val){var output="",pad_char=" ",pad_val=4,d=this.window.document;var getFuncName=function(fn){var name=(/\W*function\s+([\w\$]+)\s*\(/).exec(fn);if(!name){return"(Anonymous)"}return name[1]};var repeat_char=function(len,pad_char){var str="";for(var i=0;i<len;i++){str+=pad_char}return str};var formatArray=function(obj,cur_depth,pad_val,pad_char){if(cur_depth>0){cur_depth++}var base_pad=repeat_char(pad_val*cur_depth,pad_char);var thick_pad=repeat_char(pad_val*(cur_depth+1),pad_char);var str="";if(typeof obj==="object"&&obj!==null&&obj.constructor&&getFuncName(obj.constructor)!=="PHPJS_Resource"){str+="Array\n"+base_pad+"(\n";for(var key in obj){if(obj[key] instanceof Array){str+=thick_pad+"["+key+"] => "+formatArray(obj[key],cur_depth+1,pad_val,pad_char)}else{str+=thick_pad+"["+key+"] => "+obj[key]+"\n"}}str+=base_pad+")\n"}else{if(obj===null||obj===undefined){str=""}else{str=obj.toString()}}return str};output=formatArray(array,0,pad_val,pad_char);if(return_val!==true){if(d.body){this.echo(output)}else{try{d=XULDocument;this.echo('<pre xmlns="http://www.w3.org/1999/xhtml" style="white-space:pre;">'+output+"</pre>")}catch(e){this.echo(output)}}return true}else{return output}},printf:function(){var body,elmt,d=this.window.document;var ret="";var HTMLNS="http://www.w3.org/1999/xhtml";body=d.getElementsByTagNameNS?(d.getElementsByTagNameNS(HTMLNS,"body")[0]?d.getElementsByTagNameNS(HTMLNS,"body")[0]:d.documentElement.lastChild):d.getElementsByTagName("body")[0];if(!body){return false}ret=this.sprintf.apply(this,arguments);elmt=d.createTextNode(ret);body.appendChild(elmt);return ret.length},property_exists:function(cls,prop){cls=(typeof cls==="string")?this.window[cls]:cls;if(typeof cls==="function"&&cls.toSource&&cls.toSource().match(new RegExp("this\\."+prop+"\\s"))){return true}return(cls[prop]!==undefined&&typeof cls[prop]!=="function")||(cls.prototype!==undefined&&cls.prototype[prop]!==undefined&&typeof cls.prototype[prop]!=="function")||(cls.constructor&&cls.constructor[prop]!==undefined&&typeof cls.constructor[prop]!=="function")},quotemeta:function(str){return(str+"").replace(/([\.\\\+\*\?\[\^\]\$\(\)])/g,"\\$1")},rad2deg:function(angle){return(angle/Math.PI)*180},rand:function(min,max){var argc=arguments.length;if(argc===0){min=0;max=2147483647}else{if(argc===1){throw new Error("Warning: rand() expects exactly 2 parameters, 1 given")}}return Math.floor(Math.random()*(max-min+1))+min},range:function(low,high,step){var matrix=[];var inival,endval,plus;var walker=step||1;var chars=false;if(!isNaN(low)&&!isNaN(high)){inival=low;endval=high}else{if(isNaN(low)&&isNaN(high)){chars=true;inival=low.charCodeAt(0);endval=high.charCodeAt(0)}else{inival=(isNaN(low)?0:low);endval=(isNaN(high)?0:high)}}plus=((inival>endval)?false:true);if(plus){while(inival<=endval){matrix.push(((chars)?String.fromCharCode(inival):inival));inival+=walker}}else{while(inival>=endval){matrix.push(((chars)?String.fromCharCode(inival):inival));inival-=walker}}return matrix},rawurldecode:function(str){return decodeURIComponent(str)},rawurlencode:function(str){str=(str+"").toString();return encodeURIComponent(str).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")},reset:function(arr){this.php_js=this.php_js||{};this.php_js.pointers=this.php_js.pointers||[];var indexOf=function(value){for(var i=0,length=this.length;i<length;i++){if(this[i]===value){return i}}return -1};var pointers=this.php_js.pointers;if(!pointers.indexOf){pointers.indexOf=indexOf}if(pointers.indexOf(arr)===-1){pointers.push(arr,0)}var arrpos=pointers.indexOf(arr);if(!(arr instanceof Array)){for(var k in arr){if(pointers.indexOf(arr)===-1){pointers.push(arr,0)}else{pointers[arrpos+1]=0}return arr[k]}return false}if(arr.length===0){return false}pointers[arrpos+1]=0;return arr[pointers[arrpos+1]]},round:function(val,precision,mode){var retVal=0,v="",integer="",decimal="",decp=0,negative=false;var _round_half_oe=function(dtR,dtLa,even){if(even===true){if(dtLa==50){if((dtR%2)===1){if(dtLa>=5){dtR+=1}else{dtR-=1}}}else{if(dtLa>=5){dtR+=1}}}else{if(dtLa==5){if((dtR%2)===0){if(dtLa>=5){dtR+=1}else{dtR-=1}}}else{if(dtLa>=5){dtR+=1}}}return dtR};var _round_half_ud=function(dtR,dtLa,up){if(up===true){if(dtLa>=5){dtR+=1}}else{if(dtLa>5){dtR+=1}}return dtR};var _round_half=function(val,decplaces,mode){var v=val.toString(),vlen=0,vlenDif=0;var decp=v.indexOf(".");var digitToRound=0,digitToLookAt=0;var integer="",decimal="";var round=null,bool=false;switch(mode){case"up":bool=true;case"down":round=_round_half_ud;break;case"even":bool=true;case"odd":round=_round_half_oe;break}if(decplaces<0){vlen=v.length;decplaces=vlen+decplaces;digitToLookAt=Number(v.charAt(decplaces));digitToRound=Number(v.charAt(decplaces-1));digitToRound=round(digitToRound,digitToLookAt,bool);v=v.slice(0,decplaces-1);vlenDif=vlen-v.length-1;if(digitToRound==10){v=String(Number(v)+1)+"0"}else{v+=digitToRound}v=Number(v)*(Math.pow(10,vlenDif))}else{if(decplaces>0){integer=v.slice(0,decp);decimal=v.slice(decp+1);digitToLookAt=Number(decimal.charAt(decplaces));digitToRound=Number(decimal.charAt(decplaces-1));digitToRound=round(digitToRound,digitToLookAt,bool);decimal=decimal.slice(0,decplaces-1);if(digitToRound==10){v=Number(integer+"."+decimal)+(1*(Math.pow(10,(0-decimal.length))))}else{v=Number(integer+"."+decimal+digitToRound)}}else{integer=v.slice(0,decp);decimal=v.slice(decp+1);digitToLookAt=Number(decimal.charAt(decplaces));digitToRound=Number(integer.charAt(integer.length-1));digitToRound=round(digitToRound,digitToLookAt,bool);decimal="0";integer=integer.slice(0,integer.length-1);if(digitToRound==10){v=Number(integer)+1}else{v=Number(integer+digitToRound)}}}return v};if(typeof precision=="undefined"){precision=0}if(typeof mode=="undefined"){mode="PHP_ROUND_HALF_UP"}if(val<0){negative=true}else{negative=false}v=Math.abs(val).toString();decp=v.indexOf(".");if((decp==-1)&&(precision>=0)){return val}else{if(decp==-1){integer=v;decimal="0"}else{integer=v.slice(0,decp);if(precision>=0){decimal=v.substr(decp+1,precision+1)}else{decimal="0"}}if((precision>0)&&(precision>=decimal.length)){return val}else{if((precision<0)&&(Math.abs(precision)>=integer.length)){return 0}}val=Number(integer+"."+decimal)}switch(mode){case 0:case"PHP_ROUND_HALF_UP":retVal=_round_half(val,precision,"up");break;case 1:case"PHP_ROUND_HALF_DOWN":retVal=_round_half(val,precision,"down");break;case 2:case"PHP_ROUND_HALF_EVEN":retVal=_round_half(val,precision,"even");break;case 3:case"PHP_ROUND_HALF_ODD":retVal=_round_half(val,precision,"odd");break}if(negative){return 0-retVal}else{return retVal}},rsort:function(inputArr,sort_flags){var valArr=[],k="",i=0,sorter=false,that=this,strictForIn=false,populateArr=[];switch(sort_flags){case"SORT_STRING":sorter=function(a,b){return that.strnatcmp(b,a)};break;case"SORT_LOCALE_STRING":var loc=this.i18n_loc_get_default();sorter=this.php_js.i18nLocales[loc].sorting;break;case"SORT_NUMERIC":sorter=function(a,b){return(b-a)};break;case"SORT_REGULAR":default:sorter=function(a,b){if(a<b){return 1}if(a>b){return -1}return 0};break}this.php_js=this.php_js||{};this.php_js.ini=this.php_js.ini||{};strictForIn=this.php_js.ini["phpjs.strictForIn"]&&this.php_js.ini["phpjs.strictForIn"].local_value;populateArr=strictForIn?inputArr:populateArr;for(k in inputArr){if(inputArr.hasOwnProperty){valArr.push(inputArr[k]);if(strictForIn){delete inputArr[k]}}}valArr.sort(sorter);for(i=0;i<valArr.length;i++){populateArr[i]=valArr[i]}return strictForIn?true:populateArr},rtrim:function(str,charlist){charlist=!charlist?" \\s\u00A0":(charlist+"").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"\\$1");var re=new RegExp("["+charlist+"]+$","g");return(str+"").replace(re,"")},serialize:function(mixed_value){var _getType=function(inp){var type=typeof inp,match;var key;if(type=="object"&&!inp){return"null"}if(type=="object"){if(!inp.constructor){return"object"}var cons=inp.constructor.toString();match=cons.match(/(\w+)\(/);if(match){cons=match[1].toLowerCase()}var types=["boolean","number","string","array"];for(key in types){if(cons==types[key]){type=types[key];break}}}return type};var type=_getType(mixed_value);var val,ktype="";switch(type){case"function":val="";break;case"boolean":val="b:"+(mixed_value?"1":"0");break;case"number":val=(Math.round(mixed_value)==mixed_value?"i":"d")+":"+mixed_value;break;case"string":mixed_value=this.utf8_encode(mixed_value);val="s:"+encodeURIComponent(mixed_value).replace(/%../g,"x").length+':"'+mixed_value+'"';break;case"array":case"object":val="a";var count=0;var vals="";var okey;var key;for(key in mixed_value){ktype=_getType(mixed_value[key]);if(ktype=="function"){continue}okey=(key.match(/^[0-9]+$/)?parseInt(key,10):key);vals+=this.serialize(okey)+this.serialize(mixed_value[key]);count++}val+=":"+count+":{"+vals+"}";break;case"undefined":default:val="N";break}if(type!="object"&&type!="array"){val+=";"}return val},setcookie:function(name,value,expires,path,domain,secure){return this.setrawcookie(name,encodeURIComponent(value),expires,path,domain,secure)},setrawcookie:function(name,value,expires,path,domain,secure){if(typeof expires==="string"&&(/^\d+$/).test(expires)){expires=parseInt(expires,10)}if(expires instanceof Date){expires=expires.toGMTString()}else{if(typeof(expires)==="number"){expires=(new Date(expires*1000)).toGMTString()}}var r=[name+"="+value],s={},i="";s={expires:expires,path:path,domain:domain};for(i in s){if(s.hasOwnProperty(i)){s[i]&&r.push(i+"="+s[i])}}return secure&&r.push("secure"),this.window.document.cookie=r.join(";"),true},settype:function(vr,type){var is_array=function(arr){return typeof arr==="object"&&typeof arr.length==="number"&&!(arr.propertyIsEnumerable("length"))&&typeof arr.splice==="function"};var v,mtch,i,obj;v=this[vr]?this[vr]:vr;try{switch(type){case"boolean":if(is_array(v)&&v.length===0){this[vr]=false}else{if(v==="0"){this[vr]=false}else{if(typeof v==="object"&&!is_array(v)){var lgth=false;for(i in v){lgth=true}this[vr]=lgth}else{this[vr]=!!v}}}break;case"integer":if(typeof v==="number"){this[vr]=parseInt(v,10)}else{if(typeof v==="string"){mtch=v.match(/^([+\-]?)(\d+)/);if(!mtch){this[vr]=0}else{this[vr]=parseInt(v,10)}}else{if(v===true){this[vr]=1}else{if(v===false||v===null){this[vr]=0}else{if(is_array(v)&&v.length===0){this[vr]=0}else{if(typeof v==="object"){this[vr]=1}}}}}}break;case"float":if(typeof v==="string"){mtch=v.match(/^([+\-]?)(\d+(\.\d+)?|\.\d+)([eE][+\-]?\d+)?/);if(!mtch){this[vr]=0}else{this[vr]=parseFloat(v,10)}}else{if(v===true){this[vr]=1}else{if(v===false||v===null){this[vr]=0}else{if(is_array(v)&&v.length===0){this[vr]=0}else{if(typeof v==="object"){this[vr]=1}}}}}break;case"string":if(v===null||v===false){this[vr]=""}else{if(is_array(v)){this[vr]="Array"}else{if(typeof v==="object"){this[vr]="Object"}else{if(v===true){this[vr]="1"}else{this[vr]+=""}}}}break;case"array":if(v===null){this[vr]=[]}else{if(typeof v!=="object"){this[vr]=[v]}}break;case"object":if(v===null){this[vr]={}}else{if(is_array(v)){for(i=0,obj={};i<v.length;i++){obj[i]=v}this[vr]=obj}else{if(typeof v!=="object"){this[vr]={scalar:v}}}}break;case"null":delete this[vr];break}return true}catch(e){return false}},sha1:function(str){var rotate_left=function(n,s){var t4=(n<<s)|(n>>>(32-s));return t4};var cvt_hex=function(val){var str="";var i;var v;for(i=7;i>=0;i--){v=(val>>>(i*4))&15;str+=v.toString(16)}return str};var blockstart;var i,j;var W=new Array(80);var H0=1732584193;var H1=4023233417;var H2=2562383102;var H3=271733878;var H4=3285377520;var A,B,C,D,E;var temp;str=this.utf8_encode(str);var str_len=str.length;var word_array=[];for(i=0;i<str_len-3;i+=4){j=str.charCodeAt(i)<<24|str.charCodeAt(i+1)<<16|str.charCodeAt(i+2)<<8|str.charCodeAt(i+3);word_array.push(j)}switch(str_len%4){case 0:i=2147483648;break;case 1:i=str.charCodeAt(str_len-1)<<24|8388608;break;case 2:i=str.charCodeAt(str_len-2)<<24|str.charCodeAt(str_len-1)<<16|32768;break;case 3:i=str.charCodeAt(str_len-3)<<24|str.charCodeAt(str_len-2)<<16|str.charCodeAt(str_len-1)<<8|128;break}word_array.push(i);while((word_array.length%16)!=14){word_array.push(0)}word_array.push(str_len>>>29);word_array.push((str_len<<3)&4294967295);for(blockstart=0;blockstart<word_array.length;blockstart+=16){for(i=0;i<16;i++){W[i]=word_array[blockstart+i]}for(i=16;i<=79;i++){W[i]=rotate_left(W[i-3]^W[i-8]^W[i-14]^W[i-16],1)}A=H0;B=H1;C=H2;D=H3;E=H4;for(i=0;i<=19;i++){temp=(rotate_left(A,5)+((B&C)|(~B&D))+E+W[i]+1518500249)&4294967295;E=D;D=C;C=rotate_left(B,30);B=A;A=temp}for(i=20;i<=39;i++){temp=(rotate_left(A,5)+(B^C^D)+E+W[i]+1859775393)&4294967295;E=D;D=C;C=rotate_left(B,30);B=A;A=temp}for(i=40;i<=59;i++){temp=(rotate_left(A,5)+((B&C)|(B&D)|(C&D))+E+W[i]+2400959708)&4294967295;E=D;D=C;C=rotate_left(B,30);B=A;A=temp}for(i=60;i<=79;i++){temp=(rotate_left(A,5)+(B^C^D)+E+W[i]+3395469782)&4294967295;E=D;D=C;C=rotate_left(B,30);B=A;A=temp}H0=(H0+A)&4294967295;H1=(H1+B)&4294967295;H2=(H2+C)&4294967295;H3=(H3+D)&4294967295;H4=(H4+E)&4294967295}temp=cvt_hex(H0)+cvt_hex(H1)+cvt_hex(H2)+cvt_hex(H3)+cvt_hex(H4);return temp.toLowerCase()},shuffle:function(inputArr){var valArr=[],k="",i=0,strictForIn=false,populateArr=[];for(k in inputArr){if(inputArr.hasOwnProperty){valArr.push(inputArr[k]);if(strictForIn){delete inputArr[k]}}}valArr.sort(function(){return 0.5-Math.random()});this.php_js=this.php_js||{};this.php_js.ini=this.php_js.ini||{};strictForIn=this.php_js.ini["phpjs.strictForIn"]&&this.php_js.ini["phpjs.strictForIn"].local_value;populateArr=strictForIn?inputArr:populateArr;for(i=0;i<valArr.length;i++){populateArr[i]=valArr[i]}return strictForIn?true:populateArr},sin:function(arg){return Math.sin(arg)},sinh:function(arg){return(Math.exp(arg)-Math.exp(-arg))/2},sizeof:function(mixed_var,mode){return this.count(mixed_var,mode)},sort:function(inputArr,sort_flags){var valArr=[],keyArr=[],k="",i=0,sorter=false,that=this,strictForIn=false,populateArr=[];switch(sort_flags){case"SORT_STRING":sorter=function(a,b){return that.strnatcmp(a,b)};break;case"SORT_LOCALE_STRING":var loc=this.i18n_loc_get_default();sorter=this.php_js.i18nLocales[loc].sorting;break;case"SORT_NUMERIC":sorter=function(a,b){return(a-b)};break;case"SORT_REGULAR":default:sorter=function(a,b){if(a>b){return 1}if(a<b){return -1}return 0};break}this.php_js=this.php_js||{};this.php_js.ini=this.php_js.ini||{};strictForIn=this.php_js.ini["phpjs.strictForIn"]&&this.php_js.ini["phpjs.strictForIn"].local_value;populateArr=strictForIn?inputArr:populateArr;for(k in inputArr){if(inputArr.hasOwnProperty){valArr.push(inputArr[k]);if(strictForIn){delete inputArr[k]}}}valArr.sort(sorter);for(i=0;i<valArr.length;i++){populateArr[i]=valArr[i]}return strictForIn?true:populateArr},soundex:function(str){var s="";var i,j,l,p=isNaN(p)?4:p>10?10:p<4?4:p;var m={BFPV:1,CGJKQSXZ:2,DT:3,L:4,MN:5,R:6};var r=(s=(str+"").toUpperCase().replace(/[^A-Z]/g,"").split("")).splice(0,1);var sl=0;sl=s.length;for(i=-1,l=sl;++i<l;){for(j in m){if(j.indexOf(s[i])+1&&r[r.length-1]!=m[j]&&r.push(m[j])){break}}}return r.length>p&&(r.length=p),r.join("")+(new Array(p-r.length+1)).join("0")},split:function(delimiter,string){return this.explode(delimiter,string)},sprintf:function(){var regex=/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuidfegEG])/g;var a=arguments,i=0,format=a[i++];var pad=function(str,len,chr,leftJustify){if(!chr){chr=" "}var padding=(str.length>=len)?"":Array(1+len-str.length>>>0).join(chr);return leftJustify?str+padding:padding+str};var justify=function(value,prefix,leftJustify,minWidth,zeroPad,customPadChar){var diff=minWidth-value.length;if(diff>0){if(leftJustify||!zeroPad){value=pad(value,minWidth,customPadChar,leftJustify)}else{value=value.slice(0,prefix.length)+pad("",diff,"0",true)+value.slice(prefix.length)}}return value};var formatBaseX=function(value,base,prefix,leftJustify,minWidth,precision,zeroPad){var number=value>>>0;prefix=prefix&&number&&{"2":"0b","8":"0","16":"0x"}[base]||"";value=prefix+pad(number.toString(base),precision||0,"0",false);return justify(value,prefix,leftJustify,minWidth,zeroPad)};var formatString=function(value,leftJustify,minWidth,precision,zeroPad,customPadChar){if(precision!=null){value=value.slice(0,precision)}return justify(value,"",leftJustify,minWidth,zeroPad,customPadChar)};var doFormat=function(substring,valueIndex,flags,minWidth,_,precision,type){var number;var prefix;var method;var textTransform;var value;if(substring=="%%"){return"%"}var leftJustify=false,positivePrefix="",zeroPad=false,prefixBaseX=false,customPadChar=" ";var flagsl=flags.length;for(var j=0;flags&&j<flagsl;j++){switch(flags.charAt(j)){case" ":positivePrefix=" ";break;case"+":positivePrefix="+";break;case"-":leftJustify=true;break;case"'":customPadChar=flags.charAt(j+1);break;case"0":zeroPad=true;break;case"#":prefixBaseX=true;break}}if(!minWidth){minWidth=0}else{if(minWidth=="*"){minWidth=+a[i++]}else{if(minWidth.charAt(0)=="*"){minWidth=+a[minWidth.slice(1,-1)]}else{minWidth=+minWidth}}}if(minWidth<0){minWidth=-minWidth;leftJustify=true}if(!isFinite(minWidth)){throw new Error("sprintf: (minimum-)width must be finite")}if(!precision){precision="fFeE".indexOf(type)>-1?6:(type=="d")?0:undefined}else{if(precision=="*"){precision=+a[i++]}else{if(precision.charAt(0)=="*"){precision=+a[precision.slice(1,-1)]}else{precision=+precision}}}value=valueIndex?a[valueIndex.slice(0,-1)]:a[i++];switch(type){case"s":return formatString(String(value),leftJustify,minWidth,precision,zeroPad,customPadChar);case"c":return formatString(String.fromCharCode(+value),leftJustify,minWidth,precision,zeroPad);case"b":return formatBaseX(value,2,prefixBaseX,leftJustify,minWidth,precision,zeroPad);case"o":return formatBaseX(value,8,prefixBaseX,leftJustify,minWidth,precision,zeroPad);case"x":return formatBaseX(value,16,prefixBaseX,leftJustify,minWidth,precision,zeroPad);case"X":return formatBaseX(value,16,prefixBaseX,leftJustify,minWidth,precision,zeroPad).toUpperCase();case"u":return formatBaseX(value,10,prefixBaseX,leftJustify,minWidth,precision,zeroPad);case"i":case"d":number=parseInt(+value,10);prefix=number<0?"-":positivePrefix;value=prefix+pad(String(Math.abs(number)),precision,"0",false);return justify(value,prefix,leftJustify,minWidth,zeroPad);case"e":case"E":case"f":case"F":case"g":case"G":number=+value;prefix=number<0?"-":positivePrefix;method=["toExponential","toFixed","toPrecision"]["efg".indexOf(type.toLowerCase())];textTransform=["toString","toUpperCase"]["eEfFgG".indexOf(type)%2];value=prefix+Math.abs(number)[method](precision);return justify(value,prefix,leftJustify,minWidth,zeroPad)[textTransform]();default:return substring}};return format.replace(regex,doFormat)},sql_regcase:function(str){this.setlocale("LC_ALL",0);var i=0,upper="",lower="",pos=0,retStr="";upper=this.php_js.locales[this.php_js.localeCategories.LC_CTYPE].LC_CTYPE.upper;lower=this.php_js.locales[this.php_js.localeCategories.LC_CTYPE].LC_CTYPE.lower;for(i=0;i<str.length;i++){if(((pos=upper.indexOf(str.charAt(i)))!==-1)||((pos=lower.indexOf(str.charAt(i)))!==-1)){retStr+="["+upper.charAt(pos)+lower.charAt(pos)+"]"}else{retStr+=str.charAt(i)}}return retStr},sqrt:function(arg){return Math.sqrt(arg)},str_getcsv:function(input,delimiter,enclosure,escape){var output=[];var backwards=function(str){return str.split("").reverse().join("")};var pq=function(str){return(str+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g,"\\$1")};delimiter=delimiter||",";enclosure=enclosure||'"';escape=escape||"\\";input=input.replace(new RegExp("^\\s*"+pq(enclosure)),"").replace(new RegExp(pq(enclosure)+"\\s*$"),"");input=backwards(input).split(new RegExp(pq(enclosure)+"\\s*"+pq(delimiter)+"\\s*"+pq(enclosure)+"(?!"+pq(escape)+")","g")).reverse();for(var i=0;i<input.length;i++){output.push(backwards(input[i]).replace(new RegExp(pq(escape)+pq(enclosure),"g"),enclosure))}return output},str_ireplace:function(search,replace,subject){var i,k="";var searchl=0;var reg;var escapeRegex=function(s){return s.replace(/([\\\^\$*+\[\]?{}.=!:(|)])/g,"\\$1")};search+="";searchl=search.length;if(!(replace instanceof Array)){replace=[replace];if(search instanceof Array){while(searchl>replace.length){replace[replace.length]=replace[0]}}}if(!(search instanceof Array)){search=[search]}while(search.length>replace.length){replace[replace.length]=""}if(subject instanceof Array){for(k in subject){if(subject.hasOwnProperty(k)){subject[k]=str_ireplace(search,replace,subject[k])}}return subject}searchl=search.length;for(i=0;i<searchl;i++){reg=new RegExp(escapeRegex(search[i]),"gi");subject=subject.replace(reg,replace[i])}return subject},str_pad:function(input,pad_length,pad_string,pad_type){var half="",pad_to_go;var str_pad_repeater=function(s,len){var collect="",i;while(collect.length<len){collect+=s}collect=collect.substr(0,len);return collect};input+="";pad_string=pad_string!==undefined?pad_string:" ";if(pad_type!="STR_PAD_LEFT"&&pad_type!="STR_PAD_RIGHT"&&pad_type!="STR_PAD_BOTH"){pad_type="STR_PAD_RIGHT"}if((pad_to_go=pad_length-input.length)>0){if(pad_type=="STR_PAD_LEFT"){input=str_pad_repeater(pad_string,pad_to_go)+input}else{if(pad_type=="STR_PAD_RIGHT"){input=input+str_pad_repeater(pad_string,pad_to_go)}else{if(pad_type=="STR_PAD_BOTH"){half=str_pad_repeater(pad_string,Math.ceil(pad_to_go/2));input=half+input+half;input=input.substr(0,pad_length)}}}}return input},str_repeat:function(input,multiplier){return new Array(multiplier+1).join(input)},str_replace:function(search,replace,subject,count){var i=0,j=0,temp="",repl="",sl=0,fl=0,f=[].concat(search),r=[].concat(replace),s=subject,ra=r instanceof Array,sa=s instanceof Array;s=[].concat(s);if(count){this.window[count]=0}for(i=0,sl=s.length;i<sl;i++){if(s[i]===""){continue}for(j=0,fl=f.length;j<fl;j++){temp=s[i]+"";repl=ra?(r[j]!==undefined?r[j]:""):r[0];s[i]=(temp).split(f[j]).join(repl);if(count&&s[i]!==temp){this.window[count]+=(temp.length-s[i].length)/f[j].length}}}return sa?s:s[0]},str_rot13:function(str){return(str+"").replace(/[A-Za-z]/g,function(c){return String.fromCharCode((((c=c.charCodeAt(0))&223)-52)%26+(c&32)+65)})},str_shuffle:function(str){if(str==undefined){throw"Wrong parameter count for str_shuffle()"}var getRandomInt=function(max){return Math.floor(Math.random()*(max+1))};var newStr="",rand=0;while(str.length){rand=getRandomInt(str.length-1);newStr+=str.charAt(rand);str=str.substring(0,rand)+str.substr(rand+1)}return newStr},str_split:function(string,split_length){if(string===undefined||!string.toString||split_length<1){return false}return string.toString().match(new RegExp(".{1,"+(split_length||"1")+"}","g"))},str_word_count:function(str,format,charlist){var l=str.length,tmpStr="";var i=0;var c="";var wArr=[],wC=0;var assArr={},aC=0,reg="";if(charlist){for(i=0;i<=charlist.length-1;i++){if(i!=charlist.length-1){reg=reg+charlist.charCodeAt(i)+"|"}else{reg=reg+charlist.charCodeAt(i)}}reg=new RegExp(reg)}for(i=0;i<=l-1;i++){c=str.charCodeAt(i);if((c<91&&c>64)||(c<123&&c>96)||c==45||c==39||(reg&&reg.test(c))){if(tmpStr==""&&format==2){aC=i}tmpStr=tmpStr+String.fromCharCode(c)}else{if(tmpStr!=""){if(format!=2){wArr[wArr.length]=tmpStr}else{assArr[aC]=tmpStr}tmpStr="";wC++}}}if(!format){return wC}else{if(format==1){return wArr}else{if(format==2){return assArr}}}throw"You have supplied an incorrect format"},strcasecmp:function(f_string1,f_string2){var string1=(f_string1+"").toLowerCase();var string2=(f_string2+"").toLowerCase();if(string1>string2){return 1}else{if(string1==string2){return 0}}return -1},strchr:function(haystack,needle,bool){return this.strstr(haystack,needle,bool)},strcmp:function(str1,str2){return((str1==str2)?0:((str1>str2)?1:-1))},strcspn:function(str,mask,start,length){start=start?start:0;var count=(length&&((start+length)<str.length))?start+length:str.length;strct:for(var i=start,lgth=0;i<count;i++){for(var j=0;j<mask.length;j++){if(str.charAt(i).indexOf(mask[j])!==-1){continue strct}}++lgth}return lgth},strip_tags:function(str,allowed_tags){var key="",allowed=false;var matches=[];var allowed_array=[];var allowed_tag="";var i=0;var k="";var html="";var replacer=function(search,replace,str){return str.split(search).join(replace)};if(allowed_tags){allowed_array=allowed_tags.match(/([a-zA-Z0-9]+)/gi)}str+="";matches=str.match(/(<\/?[\S][^>]*>)/gi);for(key in matches){if(isNaN(key)){continue}html=matches[key].toString();allowed=false;for(k in allowed_array){allowed_tag=allowed_array[k];i=-1;if(i!=0){i=html.toLowerCase().indexOf("<"+allowed_tag+">")}if(i!=0){i=html.toLowerCase().indexOf("<"+allowed_tag+" ")}if(i!=0){i=html.toLowerCase().indexOf("</"+allowed_tag)}if(i==0){allowed=true;break}}if(!allowed){str=replacer(html,"",str)}}return str},stripos:function(f_haystack,f_needle,f_offset){var haystack=(f_haystack+"").toLowerCase();var needle=(f_needle+"").toLowerCase();var index=0;if((index=haystack.indexOf(needle,f_offset))!==-1){return index}return false},stripslashes:function(str){return(str+"").replace(/\\(.?)/g,function(s,n1){switch(n1){case"\\":return"\\";case"0":return"\u0000";case"":return"";default:return n1}})},stristr:function(haystack,needle,bool){var pos=0;haystack+="";pos=haystack.toLowerCase().indexOf((needle+"").toLowerCase());if(pos==-1){return false}else{if(bool){return haystack.substr(0,pos)}else{return haystack.slice(pos)}}},strlen:function(string){var str=string+"";var i=0,chr="",lgth=0;var getWholeChar=function(str,i){var code=str.charCodeAt(i);var next="",prev="";if(55296<=code&&code<=56319){if(str.length<=(i+1)){throw"High surrogate without following low surrogate"}next=str.charCodeAt(i+1);if(56320>next||next>57343){throw"High surrogate without following low surrogate"}return str.charAt(i)+str.charAt(i+1)}else{if(56320<=code&&code<=57343){if(i===0){throw"Low surrogate without preceding high surrogate"}prev=str.charCodeAt(i-1);if(55296>prev||prev>56319){throw"Low surrogate without preceding high surrogate"}return false}}return str.charAt(i)};for(i=0,lgth=0;i<str.length;i++){if((chr=getWholeChar(str,i))===false){continue}lgth++}return lgth},strnatcasecmp:function(str1,str2){var a=(str1+"").toLowerCase();var b=(str2+"").toLowerCase();var isWhitespaceChar=function(a){return a.charCodeAt(0)<=32};var isDigitChar=function(a){var charCode=a.charCodeAt(0);return(charCode>=48&&charCode<=57)};var compareRight=function(a,b){var bias=0;var ia=0;var ib=0;var ca;var cb;for(;;ia++,ib++){ca=a.charAt(ia);cb=b.charAt(ib);if(!isDigitChar(ca)&&!isDigitChar(cb)){return bias}else{if(!isDigitChar(ca)){return -1}else{if(!isDigitChar(cb)){return +1}else{if(ca<cb){if(bias==0){bias=-1}}else{if(ca>cb){if(bias==0){bias=+1}}else{if(ca==0&&cb==0){return bias}}}}}}}};var ia=0,ib=0;var nza=0,nzb=0;var ca,cb;var result;while(true){nza=nzb=0;ca=a.charAt(ia);cb=b.charAt(ib);while(isWhitespaceChar(ca)||ca=="0"){if(ca=="0"){nza++}else{nza=0}ca=a.charAt(++ia)}while(isWhitespaceChar(cb)||cb=="0"){if(cb=="0"){nzb++}else{nzb=0}cb=b.charAt(++ib)}if(isDigitChar(ca)&&isDigitChar(cb)){if((result=compareRight(a.substring(ia),b.substring(ib)))!=0){return result}}if(ca==0&&cb==0){return nza-nzb}if(ca<cb){return -1}else{if(ca>cb){return +1}}++ia;++ib}},strnatcmp:function(f_string1,f_string2,f_version){var i=0;if(f_version==undefined){f_version=false}var __strnatcmp_split=function(f_string){var result=[];var buffer="";var chr="";var i=0,f_stringl=0;var text=true;f_stringl=f_string.length;for(i=0;i<f_stringl;i++){chr=f_string.substring(i,i+1);if(chr.match(/\d/)){if(text){if(buffer.length>0){result[result.length]=buffer;buffer=""}text=false}buffer+=chr}else{if((text==false)&&(chr==".")&&(i<(f_string.length-1))&&(f_string.substring(i+1,i+2).match(/\d/))){result[result.length]=buffer;buffer=""}else{if(text==false){if(buffer.length>0){result[result.length]=parseInt(buffer,10);buffer=""}text=true}buffer+=chr}}}if(buffer.length>0){if(text){result[result.length]=buffer}else{result[result.length]=parseInt(buffer,10)}}return result};var array1=__strnatcmp_split(f_string1+"");var array2=__strnatcmp_split(f_string2+"");var len=array1.length;var text=true;var result=-1;var r=0;if(len>array2.length){len=array2.length;result=1}for(i=0;i<len;i++){if(isNaN(array1[i])){if(isNaN(array2[i])){text=true;if((r=this.strcmp(array1[i],array2[i]))!=0){return r}}else{if(text){return 1}else{return -1}}}else{if(isNaN(array2[i])){if(text){return -1}else{return 1}}else{if(text||f_version){if((r=(array1[i]-array2[i]))!=0){return r}}else{if((r=this.strcmp(array1[i].toString(),array2[i].toString()))!=0){return r}}text=false}}}return result},strncasecmp:function(argStr1,argStr2,len){var diff,i=0;var str1=(argStr1+"").toLowerCase().substr(0,len);var str2=(argStr2+"").toLowerCase().substr(0,len);if(str1.length!==str2.length){if(str1.length<str2.length){len=str1.length;if(str2.substr(0,str1.length)==str1){return str1.length-str2.length}}else{len=str2.length;if(str1.substr(0,str2.length)==str2){return str1.length-str2.length}}}else{len=str1.length}for(diff=0,i=0;i<len;i++){diff=str1.charCodeAt(i)-str2.charCodeAt(i);if(diff!==0){return diff}}return 0},strncmp:function(str1,str2,lgth){var s1=(str1+"").substr(0,lgth);var s2=(str2+"").substr(0,lgth);return((s1==s2)?0:((s1>s2)?1:-1))},strpbrk:function(haystack,char_list){for(var i=0,len=haystack.length;i<len;++i){if(char_list.indexOf(haystack.charAt(i))>=0){return haystack.slice(i)}}return false},strpos:function(haystack,needle,offset){var i=(haystack+"").indexOf(needle,(offset?offset:0));return i===-1?false:i},strrchr:function(haystack,needle){var pos=0;if(typeof needle!=="string"){needle=String.fromCharCode(parseInt(needle,10))}needle=needle.charAt(0);pos=haystack.lastIndexOf(needle);if(pos===-1){return false}return haystack.substr(pos)},strrev:function(string){string=string+"";var grapheme_extend=/(.)([\uDC00-\uDFFF\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065E\u0670\u06D6-\u06DC\u06DE-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0901-\u0903\u093C\u093E-\u094D\u0951-\u0954\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C01-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C82\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D02\u0D03\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F90-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B6-\u17D3\u17DD\u180B-\u180D\u18A9\u1920-\u192B\u1930-\u193B\u19B0-\u19C0\u19C8\u19C9\u1A17-\u1A1B\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAA\u1C24-\u1C37\u1DC0-\u1DE6\u1DFE\u1DFF\u20D0-\u20F0\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA67C\uA67D\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C4\uA926-\uA92D\uA947-\uA953\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uFB1E\uFE00-\uFE0F\uFE20-\uFE26])/g;string=string.replace(grapheme_extend,"$2$1");return string.split("").reverse().join("")},strripos:function(haystack,needle,offset){haystack=(haystack+"").toLowerCase();needle=(needle+"").toLowerCase();var i=-1;if(offset){i=(haystack+"").slice(offset).lastIndexOf(needle);if(i!==-1){i+=offset}}else{i=(haystack+"").lastIndexOf(needle)}return i>=0?i:false},strrpos:function(haystack,needle,offset){var i=-1;if(offset){i=(haystack+"").slice(offset).lastIndexOf(needle);if(i!==-1){i+=offset}}else{i=(haystack+"").lastIndexOf(needle)}return i>=0?i:false},strspn:function(str1,str2,start,lgth){var found;var stri;var strj;var j=0;var i=0;start=start?(start<0?(str1.length+start):start):0;lgth=lgth?((lgth<0)?(str1.length+lgth-start):lgth):str1.length-start;str1=str1.substr(start,lgth);for(i=0;i<str1.length;i++){found=0;stri=str1.substring(i,i+1);for(j=0;j<=str2.length;j++){strj=str2.substring(j,j+1);if(stri==strj){found=1;break}}if(found!=1){return i}}return i},strstr:function(haystack,needle,bool){var pos=0;haystack+="";pos=haystack.indexOf(needle);if(pos==-1){return false}else{if(bool){return haystack.substr(0,pos)}else{return haystack.slice(pos)}}},strtok:function(str,tokens){this.php_js=this.php_js||{};if(tokens===undefined){tokens=str;str=this.php_js.strtokleftOver}if(str.length===0){return false}if(tokens.indexOf(str.charAt(0))!==-1){return this.strtok(str.substr(1),tokens)}for(var i=0;i<str.length;i++){if(tokens.indexOf(str.charAt(i))!==-1){break}}this.php_js.strtokleftOver=str.substr(i+1);return str.substring(0,i)},strtolower:function(str){return(str+"").toLowerCase()},strtotime:function(str,now){var i,match,s,strTmp="",parse="";strTmp=str;strTmp=strTmp.replace(/\s{2,}|^\s|\s$/g," ");strTmp=strTmp.replace(/[\t\r\n]/g,"");if(strTmp=="now"){return(new Date()).getTime()/1000}else{if(!isNaN(parse=Date.parse(strTmp))){return(parse/1000)}else{if(now){now=new Date(now*1000)}else{now=new Date()}}}strTmp=strTmp.toLowerCase();var __is={day:{sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6},mon:{jan:0,feb:1,mar:2,apr:3,may:4,jun:5,jul:6,aug:7,sep:8,oct:9,nov:10,dec:11}};var process=function(m){var ago=(m[2]&&m[2]=="ago");var num=(num=m[0]=="last"?-1:1)*(ago?-1:1);switch(m[0]){case"last":case"next":switch(m[1].substring(0,3)){case"yea":now.setFullYear(now.getFullYear()+num);break;case"mon":now.setMonth(now.getMonth()+num);break;case"wee":now.setDate(now.getDate()+(num*7));break;case"day":now.setDate(now.getDate()+num);break;case"hou":now.setHours(now.getHours()+num);break;case"min":now.setMinutes(now.getMinutes()+num);break;case"sec":now.setSeconds(now.getSeconds()+num);break;default:var day;if(typeof(day=__is.day[m[1].substring(0,3)])!="undefined"){var diff=day-now.getDay();if(diff==0){diff=7*num}else{if(diff>0){if(m[0]=="last"){diff-=7}}else{if(m[0]=="next"){diff+=7}}}now.setDate(now.getDate()+diff)}}break;default:if(/\d+/.test(m[0])){num*=parseInt(m[0],10);switch(m[1].substring(0,3)){case"yea":now.setFullYear(now.getFullYear()+num);break;case"mon":now.setMonth(now.getMonth()+num);break;case"wee":now.setDate(now.getDate()+(num*7));break;case"day":now.setDate(now.getDate()+num);break;case"hou":now.setHours(now.getHours()+num);break;case"min":now.setMinutes(now.getMinutes()+num);break;case"sec":now.setSeconds(now.getSeconds()+num);break}}else{return false}break}return true};match=strTmp.match(/^(\d{2,4}-\d{2}-\d{2})(?:\s(\d{1,2}:\d{2}(:\d{2})?)?(?:\.(\d+))?)?$/);if(match!=null){if(!match[2]){match[2]="00:00:00"}else{if(!match[3]){match[2]+=":00"}}s=match[1].split(/-/g);for(i in __is.mon){if(__is.mon[i]==s[1]-1){s[1]=i}}s[0]=parseInt(s[0],10);s[0]=(s[0]>=0&&s[0]<=69)?"20"+(s[0]<10?"0"+s[0]:s[0]+""):(s[0]>=70&&s[0]<=99)?"19"+s[0]:s[0]+"";return parseInt(this.strtotime(s[2]+" "+s[1]+" "+s[0]+" "+match[2])+(match[4]?match[4]/1000:""),10)}var regex="([+-]?\\d+\\s(years?|months?|weeks?|days?|hours?|min|minutes?|sec|seconds?|sun\\.?|sunday|mon\\.?|monday|tue\\.?|tuesday|wed\\.?|wednesday|thu\\.?|thursday|fri\\.?|friday|sat\\.?|saturday)|(last|next)\\s(years?|months?|weeks?|days?|hours?|min|minutes?|sec|seconds?|sun\\.?|sunday|mon\\.?|monday|tue\\.?|tuesday|wed\\.?|wednesday|thu\\.?|thursday|fri\\.?|friday|sat\\.?|saturday))(\\sago)?";match=strTmp.match(new RegExp(regex,"gi"));if(match==null){return false}for(i=0;i<match.length;i++){if(!process(match[i].split(" "))){return false}}return(now.getTime()/1000)},strtoupper:function(str){return(str+"").toUpperCase()},strtr:function(str,from,to){var fr="",i=0,j=0,lenStr=0,lenFrom=0,tmpStrictForIn=false,fromTypeStr="",toTypeStr="",istr="";var tmpFrom=[];var tmpTo=[];var ret="";var match=false;if(typeof from==="object"){tmpStrictForIn=this.ini_set("phpjs.strictForIn",false);from=this.krsort(from);this.ini_set("phpjs.strictForIn",tmpStrictForIn);for(fr in from){if(from.hasOwnProperty(fr)){tmpFrom.push(fr);tmpTo.push(from[fr])}}from=tmpFrom;to=tmpTo}lenStr=str.length;lenFrom=from.length;fromTypeStr=typeof from==="string";toTypeStr=typeof to==="string";for(i=0;i<lenStr;i++){match=false;if(fromTypeStr){istr=str.charAt(i);for(j=0;j<lenFrom;j++){if(istr==from.charAt(j)){match=true;break}}}else{for(j=0;j<lenFrom;j++){if(str.substr(i,from[j].length)==from[j]){match=true;i=(i+from[j].length)-1;break}}}if(match){ret+=toTypeStr?to.charAt(j):to[j]}else{ret+=str.charAt(i)}}return ret},substr:function(str,start,len){str+="";var end=str.length;if(start<0){start+=end}end=typeof len==="undefined"?end:(len<0?len+end:len+start);return start>=str.length||start<0||start>end?!1:str.slice(start,end)},substr_compare:function(main_str,str,offset,length,case_insensitivity){if(!offset&&offset!==0){throw"Missing offset for substr_compare()"}if(offset<0){offset=main_str.length+offset}if(length&&length>(main_str.length-offset)){return false}length=length||main_str.length-offset;main_str=main_str.substr(offset,length);str=str.substr(0,length);if(case_insensitivity){main_str=(main_str+"").toLowerCase();str=(str+"").toLowerCase();if(main_str==str){return 0}return(main_str>str)?1:-1}return((main_str==str)?0:((main_str>str)?1:-1))},substr_count:function(haystack,needle,offset,length){var pos=0,cnt=0;haystack+="";needle+="";if(isNaN(offset)){offset=0}if(isNaN(length)){length=0}offset--;while((offset=haystack.indexOf(needle,offset+1))!=-1){if(length>0&&(offset+needle.length)>length){return false}else{cnt++}}return cnt},substr_replace:function(str,replace,start,length){if(start<0){start=start+str.length}length=length!==undefined?length:str.length;if(length<0){length=length+str.length-start}return str.slice(0,start)+replace.substr(0,length)+replace.slice(length)+str.slice(start+length)},tan:function(arg){return Math.tan(arg)},tanh:function(arg){return(Math.exp(arg)-Math.exp(-arg))/(Math.exp(arg)+Math.exp(-arg))},time:function(){return Math.floor(new Date().getTime()/1000)},trim:function(str,charlist){var whitespace,l=0,i=0;str+="";if(!charlist){whitespace=" \n\r\t\f\x0b\xa0\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u200b\u2028\u2029\u3000"}else{charlist+="";whitespace=charlist.replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"$1")}l=str.length;for(i=0;i<l;i++){if(whitespace.indexOf(str.charAt(i))===-1){str=str.substring(i);break}}l=str.length;for(i=l-1;i>=0;i--){if(whitespace.indexOf(str.charAt(i))===-1){str=str.substring(0,i+1);break}}return whitespace.indexOf(str.charAt(0))===-1?str:""},uasort:function(inputArr,sorter){var valArr=[],keyArr=[],tempKeyVal,tempValue,ret,k="",i=0,strictForIn=false,populateArr=[];if(typeof sorter==="string"){sorter=this[sorter]}else{if(sorter instanceof Array){sorter=this[sorter[0]][sorter[1]]}}var sorterNew=function(keyArr,valArr){for(var i=valArr.length-2;i>=0;i--){for(var j=0;j<=i;j++){ret=sorter(valArr[j+1],valArr[j]);if(ret<0){tempValue=valArr[j];valArr[j]=valArr[j+1];valArr[j+1]=tempValue;tempKeyVal=keyArr[j];keyArr[j]=keyArr[j+1];keyArr[j+1]=tempKeyVal}}}};this.php_js=this.php_js||{};this.php_js.ini=this.php_js.ini||{};strictForIn=this.php_js.ini["phpjs.strictForIn"]&&this.php_js.ini["phpjs.strictForIn"].local_value;populateArr=strictForIn?inputArr:populateArr;for(k in inputArr){if(inputArr.hasOwnProperty){valArr.push(inputArr[k]);keyArr.push(k);if(strictForIn){delete inputArr[k]}}}try{sorterNew(keyArr,valArr)}catch(e){return false}for(i=0;i<valArr.length;i++){populateArr[keyArr[i]]=valArr[i]}return strictForIn?true:populateArr},ucfirst:function(str){str+="";var f=str.charAt(0).toUpperCase();return f+str.substr(1)},ucwords:function(str){return(str+"").replace(/^(.)|\s(.)/g,function($1){return $1.toUpperCase()})},uksort:function(inputArr,sorter){var tmp_arr={},keys=[],i=0,k="",strictForIn=false,populateArr=[];if(typeof sorter==="string"){sorter=this.window[sorter]}for(k in inputArr){if(inputArr.hasOwnProperty){keys.push(k)}}try{if(sorter){keys.sort(sorter)}else{keys.sort()}}catch(e){return false}this.php_js=this.php_js||{};this.php_js.ini=this.php_js.ini||{};strictForIn=this.php_js.ini["phpjs.strictForIn"]&&this.php_js.ini["phpjs.strictForIn"].local_value;populateArr=strictForIn?inputArr:populateArr;for(i=0;i<keys.length;i++){k=keys[i];tmp_arr[k]=inputArr[k];if(strictForIn){delete inputArr[k]}}for(i in tmp_arr){if(tmp_arr.hasOwnProperty){populateArr[i]=tmp_arr[i]}}return strictForIn?true:populateArr},unserialize:function(data){var that=this;var utf8Overhead=function(chr){var code=chr.charCodeAt(0);if(code<128){return 0}if(code<2048){return 1}return 2};var error=function(type,msg,filename,line){throw new that.window[type](msg,filename,line)};var read_until=function(data,offset,stopchr){var buf=[];var chr=data.slice(offset,offset+1);var i=2;while(chr!=stopchr){if((i+offset)>data.length){error("Error","Invalid")}buf.push(chr);chr=data.slice(offset+(i-1),offset+i);i+=1}return[buf.length,buf.join("")]};var read_chrs=function(data,offset,length){var buf;buf=[];for(var i=0;i<length;i++){var chr=data.slice(offset+(i-1),offset+i);buf.push(chr);length-=utf8Overhead(chr)}return[buf.length,buf.join("")]};var _unserialize=function(data,offset){var readdata;var readData;var chrs=0;var ccount;var stringlength;var keyandchrs;var keys;if(!offset){offset=0}var dtype=(data.slice(offset,offset+1)).toLowerCase();var dataoffset=offset+2;var typeconvert=function(x){return x};switch(dtype){case"i":typeconvert=function(x){return parseInt(x,10)};readData=read_until(data,dataoffset,";");chrs=readData[0];readdata=readData[1];dataoffset+=chrs+1;break;case"b":typeconvert=function(x){return parseInt(x,10)!==0};readData=read_until(data,dataoffset,";");chrs=readData[0];readdata=readData[1];dataoffset+=chrs+1;break;case"d":typeconvert=function(x){return parseFloat(x)};readData=read_until(data,dataoffset,";");chrs=readData[0];readdata=readData[1];dataoffset+=chrs+1;break;case"n":readdata=null;break;case"s":ccount=read_until(data,dataoffset,":");chrs=ccount[0];stringlength=ccount[1];dataoffset+=chrs+2;readData=read_chrs(data,dataoffset+1,parseInt(stringlength,10));chrs=readData[0];readdata=readData[1];dataoffset+=chrs+2;if(chrs!=parseInt(stringlength,10)&&chrs!=readdata.length){error("SyntaxError","String length mismatch")}readdata=that.utf8_decode(readdata);break;case"a":readdata={};keyandchrs=read_until(data,dataoffset,":");chrs=keyandchrs[0];keys=keyandchrs[1];dataoffset+=chrs+2;for(var i=0;i<parseInt(keys,10);i++){var kprops=_unserialize(data,dataoffset);var kchrs=kprops[1];var key=kprops[2];dataoffset+=kchrs;var vprops=_unserialize(data,dataoffset);var vchrs=vprops[1];var value=vprops[2];dataoffset+=vchrs;readdata[key]=value}dataoffset+=1;break;default:error("SyntaxError","Unknown / Unhandled data type(s): "+dtype);break}return[dtype,dataoffset-offset,typeconvert(readdata)]};return _unserialize((data+""),0)[2]},urldecode:function(str){return decodeURIComponent(str.replace(/\+/g,"%20"))},urlencode:function(str){str=(str+"").toString();return encodeURIComponent(str).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")},usort:function(inputArr,sorter){var valArr=[],k="",i=0,strictForIn=false,populateArr=[];if(typeof sorter==="string"){sorter=this[sorter]}else{if(sorter instanceof Array){sorter=this[sorter[0]][sorter[1]]}}this.php_js=this.php_js||{};this.php_js.ini=this.php_js.ini||{};strictForIn=this.php_js.ini["phpjs.strictForIn"]&&this.php_js.ini["phpjs.strictForIn"].local_value;populateArr=strictForIn?inputArr:populateArr;for(k in inputArr){if(inputArr.hasOwnProperty){valArr.push(inputArr[k]);if(strictForIn){delete inputArr[k]}}}try{valArr.sort(sorter)}catch(e){return false}for(i=0;i<valArr.length;i++){populateArr[i]=valArr[i]}return strictForIn?true:populateArr},utf8_decode:function(str_data){var tmp_arr=[],i=0,ac=0,c1=0,c2=0,c3=0;str_data+="";while(i<str_data.length){c1=str_data.charCodeAt(i);if(c1<128){tmp_arr[ac++]=String.fromCharCode(c1);i++}else{if((c1>191)&&(c1<224)){c2=str_data.charCodeAt(i+1);tmp_arr[ac++]=String.fromCharCode(((c1&31)<<6)|(c2&63));i+=2}else{c2=str_data.charCodeAt(i+1);c3=str_data.charCodeAt(i+2);tmp_arr[ac++]=String.fromCharCode(((c1&15)<<12)|((c2&63)<<6)|(c3&63));i+=3}}}return tmp_arr.join("")},utf8_encode:function(argString){var string=(argString+"");var utftext="";var start,end;var stringl=0;start=end=0;stringl=string.length;for(var n=0;n<stringl;n++){var c1=string.charCodeAt(n);var enc=null;if(c1<128){end++}else{if(c1>127&&c1<2048){enc=String.fromCharCode((c1>>6)|192)+String.fromCharCode((c1&63)|128)}else{enc=String.fromCharCode((c1>>12)|224)+String.fromCharCode(((c1>>6)&63)|128)+String.fromCharCode((c1&63)|128)}}if(enc!==null){if(end>start){utftext+=string.substring(start,end)}utftext+=enc;start=end=n+1}}if(end>start){utftext+=string.substring(start,string.length)}return utftext},var_dump:function(){var output="",pad_char=" ",pad_val=4,lgth=0,i=0,d=this.window.document;var getFuncName=function(fn){var name=(/\W*function\s+([\w\$]+)\s*\(/).exec(fn);if(!name){return"(Anonymous)"}return name[1]};var repeat_char=function(len,pad_char){var str="";for(var i=0;i<len;i++){str+=pad_char}return str};var getScalarVal=function(val){var ret="";if(val===null){ret="NULL"}else{if(typeof val==="boolean"){ret="bool("+val+")"}else{if(typeof val==="string"){ret="string("+val.length+') "'+val+'"'}else{if(typeof val==="number"){if(parseFloat(val)==parseInt(val,10)){ret="int("+val+")"}else{ret="float("+val+")"}}else{if(val===undefined){ret="UNDEFINED"}else{if(typeof val==="function"){ret="FUNCTION"}}}}}}return ret};var formatArray=function(obj,cur_depth,pad_val,pad_char){var someProp="";if(cur_depth>0){cur_depth++}var base_pad=repeat_char(pad_val*(cur_depth-1),pad_char);var thick_pad=repeat_char(pad_val*(cur_depth+1),pad_char);var str="";var val="";if(typeof obj==="object"&&obj!==null){if(obj.constructor&&getFuncName(obj.constructor)==="PHPJS_Resource"){return obj.var_dump()}lgth=0;for(someProp in obj){lgth++}str+="array("+lgth+") {\n";for(var key in obj){if(typeof obj[key]==="object"&&obj[key]!==null){str+=thick_pad+"["+key+"] =>\n"+thick_pad+formatArray(obj[key],cur_depth+1,pad_val,pad_char)}else{val=getScalarVal(obj[key]);str+=thick_pad+"["+key+"] =>\n"+thick_pad+val+"\n"}}str+=base_pad+"}\n"}else{str=getScalarVal(obj)}return str};output=formatArray(arguments[0],0,pad_val,pad_char);for(i=1;i<arguments.length;i++){output+="\n"+formatArray(arguments[i],0,pad_val,pad_char)}if(d.body){this.echo(output)}else{try{d=XULDocument;this.echo('<pre xmlns="http://www.w3.org/1999/xhtml" style="white-space:pre;">'+output+"</pre>")}catch(e){this.echo(output)}}},var_export:function(mixed_expression,bool_return){var retstr="",iret="",cnt=0,x=[],i=0,funcParts=[];var getFuncName=function(fn){var name=(/\W*function\s+([\w\$]+)\s*\(/).exec(fn);if(!name){return"(Anonymous)"}return name[1]};var __getType=function(inp){var i=0;var match,type=typeof inp;if(type==="object"&&inp.constructor&&getFuncName(inp.constructor)==="PHPJS_Resource"){return"resource"}if(type==="function"){return"function"}if(type==="object"&&!inp){return"null"}if(type==="object"){if(!inp.constructor){return"object"}var cons=inp.constructor.toString();match=cons.match(/(\w+)\(/);if(match){cons=match[1].toLowerCase()}var types=["boolean","number","string","array"];for(i=0;i<types.length;i++){if(cons===types[i]){type=types[i];break}}}return type};var type=__getType(mixed_expression);if(type===null){retstr="NULL"}else{if(type==="array"||type==="object"){for(i in mixed_expression){x[cnt++]=this.var_export(i,true)+" => "+this.var_export(mixed_expression[i],true)}iret=x.join(",\n  ");retstr="array (\n  "+iret+"\n)"}else{if(type==="function"){funcParts=mixed_expression.toString().match(/function .*?\((.*?)\) \{([\s\S]*)\}/);retstr="create_function ('"+funcParts[1]+"', '"+funcParts[2].replace(new RegExp("'","g"),"\\'")+"')"}else{if(type==="resource"){retstr="NULL"}else{retstr=(!isNaN(mixed_expression))?mixed_expression:"'"+mixed_expression.replace(/(["'])/g,"\\$1").replace(/\0/g,"\\0")+"'"}}}}if(bool_return!==true){this.echo(retstr);return null}else{return retstr}},vprintf:function(format,args){var body,elmt;var ret="",d=this.window.document;var HTMLNS="http://www.w3.org/1999/xhtml";body=d.getElementsByTagNameNS?(d.getElementsByTagNameNS(HTMLNS,"body")[0]?d.getElementsByTagNameNS(HTMLNS,"body")[0]:d.documentElement.lastChild):d.getElementsByTagName("body")[0];if(!body){return false}ret=this.sprintf.apply(this,[format].concat(args));elmt=d.createTextNode(ret);body.appendChild(elmt);return ret.length},vsprintf:function(format,args){return this.sprintf.apply(this,[format].concat(args))},wordwrap:function(str,int_width,str_break,cut){var m=((arguments.length>=2)?arguments[1]:75);var b=((arguments.length>=3)?arguments[2]:"\n");var c=((arguments.length>=4)?arguments[3]:false);var i,j,l,s,r;str+="";if(m<1){return str}for(i=-1,l=(r=str.split(/\r\n|\n|\r/)).length;++i<l;r[i]+=s){for(s=r[i],r[i]="";s.length>m;r[i]+=s.slice(0,j)+((s=s.slice(j)).length?b:"")){j=c==2||(j=s.slice(0,m+1).match(/\S*(\s)?$/))[1]?m:j.input.length-j[0].length||c==1&&m||j.input.length+(j=s.slice(m).match(/^\S*/)).input.length}}return r.join("\n")}};this.PHP_JS=PHP_JS}());tinyMCE.init({theme:"advanced",mode:"textareas",cleanup:false,element_format:"html",plugins:"spellchecker, searchreplace, insertdatetime, print, fullscreen",plugin_insertdate_dateFormat:"%Y-%m-%d",plugin_insertdate_timeFormat:"%H:%M:%S",browsers:"msie,gecko,safari,opera",theme_advanced_buttons1:"bold, italic, underline, |, 	                           bullist, numlist, |, 	                           outdent, indent, |, 	                           spellchecker, search, replace, |, 	                           link, unlink, print, fullscreen",theme_advanced_buttons2:"",theme_advanced_buttons3:"",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",theme_advanced_statusbar_location:"bottom",theme_advanced_resizing:true,spellchecker_rpc_url:"/javascripts/tiny_mce/plugins/spellchecker/rpc.php",spellchecker_languages:"+English=en"});var requiredMajorVersion=9;var requiredMinorVersion=0;var requiredRevision=45;var Fisma={};$P=new PHP_JS();String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};var readyFunc=function(){var g=YAHOO.util.Selector.query(".date");for(var b=0;b<g.length;b++){YAHOO.util.Event.on(g[b].getAttribute("id")+"_show","click",callCalendar,g[b].getAttribute("id"))}var a=function(){if(document.getElementById("remediationSearchAging")){var k=document.getElementById("remediationSearchAging").value.trim()}else{return}var h=document.getElementById("created_date_begin");var j=document.getElementById("created_date_end");if(k=="0"){h.disabled=false;j.disabled=false;document.getElementById("show1").disabled=false;document.getElementById("show2").disabled=false}else{h.disabled=true;j.disabled=true;h.value="";j.value="";document.getElementById("show1").disabled=true;document.getElementById("show2").disabled=true}};YAHOO.util.Event.on("remediationSearchAging","change",a);a();var f=function(){if(document.getElementById("created_date_begin")&&document.getElementById("created_date_end")){var j=document.getElementById("created_date_begin").value.trim();var h=document.getElementById("created_date_end").value.trim()}else{return}if(j!=""||h!=""){document.getElementById("remediationSearchAging").disabled=true}else{document.getElementById("remediationSearchAging").disabled=false}};YAHOO.util.Event.on("created_date_begin","change",f);YAHOO.util.Event.on("created_date_end","change",f);f();var d=function(){if(document.getElementById("encrypt")){var j=document.getElementById("encrypt")}else{return}var h=j.value.trim();if(h=="sha256"){j.style.display=""}else{j.style.display="none"}};YAHOO.util.Event.on("encrypt","change",d);d();YAHOO.util.Event.on("function_screen","change",search_function);search_function();YAHOO.util.Event.on("add_function","click",function(){var h=new YAHOO.util.Selector.query("#availableFunctions option");for(var j=0;j<h.length;j++){if(h[j].selected==true){document.getElementById("existFunctions").appendChild(h[j])}}return false});YAHOO.util.Event.on("remove_function","click",function(){var h=YAHOO.util.Selector.query("#existFunctions option");for(var j=0;j<h.length;j++){if(h[j].selected==true){document.getElementById("availableFunctions").appendChild(h[j])}}return false});YAHOO.util.Event.on(YAHOO.util.Selector.query("form[name=assign_right]"),"submit",function(){var h=YAHOO.util.Selector.query("#existFunctions option");for(var j=0;j<h.length;j++){h[j].selected=true}});YAHOO.util.Event.on("searchAsset","click",searchAsset);YAHOO.util.Event.on("search_product","click",searchProduct);YAHOO.util.Event.on(YAHOO.util.Selector.query(".confirm"),"click",function(){var h="DELETING CONFIRMATION!";if(confirm(h)==true){return true}return false});asset_detail();getProdId()};function search_function(){var f=YAHOO.util.Selector.query("select[name=function_screen]");if(f==""){return}var k=name="";var d=YAHOO.util.Selector.query("select[name=function_screen] option");for(var g=0;g<d.length;g++){if(d[g].selected==true){name=d[g].text}}if(""!=name){k+="/screen_name/"+name}var b=YAHOO.util.Selector.query("#existFunctions option");var j="";for(var g=0;g<b.length;g++){if(g==0){j+=b[g].value}else{j+=","+b[g].value}}var a=document.getElementById("function_screen").getAttribute("url")+"/do/availableFunctions"+k+"/existFunctions/"+j;var h=YAHOO.util.Connect.asyncRequest("GET",a,{success:function(l){document.getElementById("availableFunctions").parentNode.innerHTML='<select style="width: 250px;" name="availableFunctions" id="availableFunctions" size="20" multiple="">'+l.responseText+"</select>"},failure:handleFailure})}var handleFailure=function(a){alert("error")};function getProdId(){var a=document.getElementById("productId");YAHOO.util.Event.on(a,"change",function(){document.getElementById("productId").value=a.value})}var searchProduct=function(){var d=document.getElementById("search_product");var b=d.getAttribute("url");var a=YAHOO.util.Selector.query("input.product");for(var f=0;f<a.length;f++){if(a[f].value!=undefined&&a[f].value!=""){b+="/"+a[f].name+"/"+a[f].value}}YAHOO.util.Connect.asyncRequest("GET",b,{success:function(g){document.getElementById("productId").parentNode.innerHTML=g.responseText;document.getElementById("productId").style.width="400px";getProdId()},failure:handleFailure})};var searchAsset=function(){var b=new YAHOO.util.Element("orgSystemId");if(b.get("id")==undefined){return}var g=b.get("value");var h="";if(0!=parseInt(g)){h+="/system_id/"+g}var f=YAHOO.util.Selector.query("input.assets");for(var d=0;d<f.length;d++){if(f[d].value!=undefined&&f[d].value!=""){h+="/"+f[d].name+"/"+f[d].value}}var a=document.getElementById("orgSystemId").getAttribute("url")+h;YAHOO.util.Connect.asyncRequest("GET",a,{success:function(l){document.getElementById("assetId").options.length=0;var j=YAHOO.lang.JSON.parse(l.responseText);j=j.table.records;for(var k=0;k<j.length;k++){document.getElementById("assetId").options.add(new Option(j[k].name,j[k].id))}},failure:handleFailure})};function asset_detail(){YAHOO.util.Event.on("assetId","change",function(){var a=this.getAttribute("url")+this.value;YAHOO.util.Connect.asyncRequest("GET",a,{success:function(b){document.getElementById("asset_info").innerHTML=b.responseText},failure:handleFailure})})}function message(d,a){d=$P.stripslashes(d);if(document.getElementById("msgbar")){var b=document.getElementById("msgbar")}else{return}if(b.innerHTML){b.innerHTML=b.innerHTML+d}else{b.innerHTML=d}b.style.fontWeight="bold";if(a=="warning"){b.style.color="red"}else{b.style.color="green";b.style.borderColor="green";b.style.backgroundColor="lightgreen"}b.style.display="block"}function toggleSearchOptions(b){var a=document.getElementById("advanced_searchbox");if(a.style.display=="none"){a.style.display="";b.value="Basic Search"}else{a.style.display="none";b.value="Advanced Search"}}function showJustification(){if(document.getElementById("ecd_justification")){document.getElementById("ecd_justification").style.display=""}}function addBookmark(f,d){if(window.sidebar){window.sidebar.addPanel(d.title,d.href,"")}else{if(window.opera){var b=document.createElement("A");b.rel="sidebar";b.target="_search";b.title=d.title;b.href=d.href;b.click()}else{if(document.all){window.external.AddFavorite(d.href,d.title)}else{alert("Your browser does not support automatic bookmarks. Please try to bookmark this page manually instead.")}}}}function highlight(d,b){if(""==b){return}b.sort();b.reverse();for(var a in b){highlightWord(d,b[a])}}function highlightWord(d,a){if(d&&d.hasChildNodes){var b;for(b=0;b<d.childNodes.length;b++){highlightWord(d.childNodes[b],a)}}if(d&&d.nodeType==3){tempNodeVal=d.nodeValue.toLowerCase();tempWordVal=a.toLowerCase();if(tempNodeVal.indexOf(tempWordVal)!=-1){pn=d.parentNode;if(pn.className!="highlight"){nv=d.nodeValue;ni=tempNodeVal.indexOf(tempWordVal);before=document.createTextNode(nv.substr(0,ni));docWordVal=nv.substr(ni,a.length);after=document.createTextNode(nv.substr(ni+a.length));hiwordtext=document.createTextNode(docWordVal);hiword=document.createElement("span");hiword.className="highlight";hiword.appendChild(hiwordtext);pn.insertBefore(before,d);pn.insertBefore(hiword,d);pn.insertBefore(after,d);pn.removeChild(d)}}}}function removeHighlight(b){if(b.hasChildNodes){var a;for(a=0;a<b.childNodes.length;a++){removeHighlight(b.childNodes[a])}}if(b.nodeType==3){pn=b.parentNode;if(pn.className=="highlight"){prevSib=pn.previousSibling;nextSib=pn.nextSibling;nextSib.nodeValue=prevSib.nodeValue+b.nodeValue+nextSib.nodeValue;prevSib.nodeValue="";b.nodeValue=""}}}function switchYear(f){if(!isFinite(f)){f=0}var g=document.getElementById("gen_shortcut");var d=g.getAttribute("year");d=Number(d)+Number(f);g.setAttribute("year",d);var a=g.getAttribute("url")+d+"/";var b=YAHOO.util.Selector.query("#gen_shortcut span:nth-child(1)");b[0].innerHTML=d;b[0].parentNode.setAttribute("href",a);b[1].parentNode.setAttribute("href",a+"q/1/");b[2].parentNode.setAttribute("href",a+"q/2/");b[3].parentNode.setAttribute("href",a+"q/3/");b[4].parentNode.setAttribute("href",a+"q/4/")}function form_confirm(h,g){var k=false;elements=YAHOO.util.Selector.query("[name*='finding']");for(var b=0;b<elements.length;b++){var j=elements[b].tagName.toUpperCase();if(j=="INPUT"){var a=elements[b].type;if(a=="text"||a=="password"){var d=elements[b].getAttribute("_value");if(typeof(d)=="undefined"){d=""}if(d!=elements[b].value){}}if(a=="checkbox"||a=="radio"){var d=elements[b].checked?"on":"off";if(d!=elements[b].getAttribute("_value")){k=true}}}else{if(j=="SELECT"){var d=elements[b].getAttribute("_value");if(typeof(d)=="undefined"){d=""}if(d!=elements[b].options[elements[b].selectedIndex].value){k=true}}else{if(j=="TEXTAREA"){var d=elements[b].getAttribute("_value");if(typeof(d)=="undefined"){d=""}var f=elements[b].value?elements[b].value:elements[b].innerHTML;if(d!=f){k=true}}}}}if(k){if(confirm('WARNING: You have unsaved changes on the page. If you continue, these changes will be lost. If you want to save your changes, click "Cancel" now and then click "Save Changes".')){return true}else{return false}}if(confirm("WARNING: You are about to "+g+'. This action cannot be undone. Please click "Ok" to confirm your action or click "Cancel" to stop.')){return true}return false}function dump(a){var b=""+a;for(i in a){if("function"!=typeof(a[i])){b+=i+" : "+a[i]+"\n"}}alert(b)}var e=YAHOO.util.Event;e.onDOMReady(readyFunc);function callCalendar(a,b){showCalendar(b,b+"_show")}function showCalendar(g,d){var m=YAHOO.util.Event,j=YAHOO.util.Dom,k,h;var l=j.get(d);var k;var h;if(!k){function f(){j.get(g).value="";a()}function a(){k.hide()}k=new YAHOO.widget.Dialog("container",{visible:false,context:[g,"tl","bl"],draggable:true,close:true});k.setHeader("Pick A Date");k.setBody('<div id="cal"></div><div class="clear"></div>');k.render(document.body);dialogEl=document.getElementById("container");dialogEl.style.padding="0px";k.showEvent.subscribe(function(){if(YAHOO.env.ua.ie){k.fireEvent("changeContent")}})}if(!h){h=new YAHOO.widget.Calendar("cal",{iframe:false,hide_blank_weeks:true});h.render();h.selectEvent.subscribe(function(){if(h.getSelectedDates().length>0){var o=h.getSelectedDates()[0];var n=(o.getDate()<10)?"0"+o.getDate():o.getDate();var q=(o.getMonth()+1<10)?"0"+(o.getMonth()+1):(o.getMonth()+1);var p=o.getFullYear();j.get(g).value=p+"-"+q+"-"+n}else{j.get(g).value=""}k.hide();if("finding[currentEcd]"==j.get(g).name){validateEcd()}});h.renderEvent.subscribe(function(){k.fireEvent("changeContent")})}var b=h.getSelectedDates();if(b.length>0){h.cfg.setProperty("pagedate",b[0]);h.render()}k.show()}function updateTimeField(b){var d=document.getElementById(b);var k=document.getElementById(b+"Hour");var l=document.getElementById(b+"Minute");var a=document.getElementById(b+"Ampm");var h=k.value;var g=l.value;var j=a.value;if("PM"==j){h=parseInt(h)+12}h=$P.str_pad(h,2,"0","STR_PAD_LEFT");g=$P.str_pad(g,2,"0","STR_PAD_LEFT");var f=h+":"+g+":00";d.value=f}YAHOO.namespace("fisma.CheckboxTree");YAHOO.fisma.CheckboxTree.rootNode;YAHOO.fisma.CheckboxTree.handleClick=function(l,d){if(d.altKey){return}var j=l.parentNode;var m=j.nextSibling.childNodes[0];if(m.getAttribute("nestedLevel")>l.getAttribute("nestedLevel")){var a=l.getAttribute("nestedlevel");var f=new Array();var n=true;var b=j.nextSibling;var k=b.childNodes[0];while(k.getAttribute("nestedLevel")>a){if(!k.checked){n=false}f.push(k);if(b.nextSibling){b=b.nextSibling;k=b.childNodes[0]}else{break}}if(n){l.checked=false}else{l.checked=true}for(var g in f){var h=f[g];if(n){h.checked=false}else{h.checked=true}}}};function setupEditFields(){var a=YAHOO.util.Selector.query(".editable");YAHOO.util.Event.on(a,"click",function(g){removeHighlight(document);var l=this.getAttribute("target");YAHOO.util.Dom.removeClass(this,"editable");this.removeAttribute("target");if(l){var m=document.getElementById(l);var b=m.getAttribute("name");var n=m.getAttribute("type");var d=m.getAttribute("href");var j=m.className;var k=m.offsetWidth;var q=m.offsetHeight;var f=m.innerText?m.innerText:m.textContent;var r=m.innerHTML;if(n=="text"){m.outerHTML='<input length="50" name="'+b+'" id="'+l+'" class="'+j+'" type="text" />';textEl=document.getElementById(l);textEl.setAttribute("value",f.trim());if(k<200){k=200}textEl.style.width=(k-10)+"px";if(j=="date"){var m=document.getElementById(l);m.onfocus=function(){showCalendar(l,l+"_show")};calendarIcon=document.createElement("img");calendarIcon.id=l+"_show";calendarIcon.src="/images/calendar.gif";calendarIcon.alt="Calendar";m.parentNode.appendChild(calendarIcon);YAHOO.util.Event.on(l+"_show","click",function(){showCalendar(l,l+"_show")})}}else{if(n=="textarea"){var s=m.getAttribute("rows");var h=m.getAttribute("cols");m.outerHTML='<textarea id="'+b+'" rows="'+s+'" cols="'+h+'" name="'+b+'"></textarea>';var p=document.getElementById(b);p.value=r;p.style.width=k+"px";p.style.height=q+"px";tinyMCE.execCommand("mceAddControl",true,b)}else{YAHOO.util.Connect.asyncRequest("GET",d+"value/"+f.trim(),{success:function(t){if(n=="select"){m.outerHTML='<select name="'+b+'">'+t.responseText+"</select>"}},failure:function(t){alert("Failed to load the specified panel.")}},null)}}}})}function validateEcd(){var g=document.getElementById("expectedCompletionDate");var d=g.value;var f=new Date();var a=f.getFullYear();var b=f.getMonth();b=b+1;if(b<10){b="0"+b}var h=f.getDate();if(h<10){h="0"+h}if(d.replace(/\-/g,"")<=parseInt(""+a+""+b+""+h)){alert("Warning: You entered an ECD date in the past.")}}if(window.HTMLElement){HTMLElement.prototype.__defineSetter__("outerHTML",function(b){var a=this.ownerDocument.createRange();a.setStartBefore(this);var d=a.createContextualFragment(b);this.parentNode.replaceChild(d,this);return b});HTMLElement.prototype.__defineGetter__("outerHTML",function(){var a;var b=this.attributes;var f="<"+this.tagName.toLowerCase();for(var d=0;d<b.length;d++){a=b[d];if(a.specified){f+=" "+a.name+'="'+a.value+'"'}}if(!this.canHaveChildren){return f+">"}return f+">"+this.innerHTML+"</"+this.tagName.toLowerCase()+">"});HTMLElement.prototype.__defineGetter__("canHaveChildren",function(){switch(this.tagName.toLowerCase()){case"area":case"base":case"basefont":case"col":case"frame":case"hr":case"img":case"br":case"input":case"isindex":case"link":case"meta":case"param":return false}return true})}var helpPanels=new Array();function showHelp(b,d){if(helpPanels[d]){helpPanels[d].show()}else{var a=new YAHOO.widget.Panel("helpPanel",{width:"400px"});a.setHeader("Help");a.setBody("Loading...");a.render(document.body);a.center();a.show();YAHOO.util.Connect.asyncRequest("GET","/help/help/module/"+d,{success:function(f){f.argument.setBody(f.responseText);f.argument.center()},failure:function(f){alert("Failed to load the help module.")},argument:a},null);helpPanels[d]=a}}function selectAllUnsafe(){var a=YAHOO.util.Dom.getElementsBy(function(b){return(b.tagName=="INPUT"&&b.type=="checkbox")});for(i in a){a[i].checked="checked"}}function selectAll(){alert("Not implemented")}function selectNoneUnsafe(){var a=YAHOO.util.Dom.getElementsBy(function(b){return(b.tagName=="INPUT"&&b.type=="checkbox")});for(i in a){a[i].checked=""}}function selectNone(){alert("Not implemented")}function elDump(a){props="";for(prop in a){props+=prop+" : "+a[prop]+"\n"}alert(props)}function delok(b){var a="Are you sure that you want to delete this "+b+"?";if(confirm(a)==true){return true}return false}function GeneratePassword(){var a=document.getElementById("generate_password");YAHOO.util.Connect.asyncRequest("GET","/user/generate-password/format/html",{success:function(b){document.getElementById("password").value=b.responseText;document.getElementById("confirmPassword").value=b.responseText},failure:function(b){alert("Failed to generate password: "+b.statusText)}},null);return false}var check_account=function(){var b=document.getElementById("username").value;b=encodeURIComponent(b);var a="/user/check-account/format/json/account/"+b;YAHOO.util.Connect.asyncRequest("GET",a,{success:function(f){var d=YAHOO.lang.JSON.parse(f.responseText);message(d.msg,d.type)},failure:function(d){alert("Failed to generate password: "+d.statusText)}},null);return false};var isIE=(navigator.appVersion.indexOf("MSIE")!=-1)?true:false;var isWin=(navigator.appVersion.toLowerCase().indexOf("win")!=-1)?true:false;var isOpera=(navigator.userAgent.indexOf("Opera")!=-1)?true:false;function ControlVersion(){var a;var b;var d;try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");a=b.GetVariable("$version")}catch(d){}if(!a){try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");a="WIN 6,0,21,0";b.AllowScriptAccess="always";a=b.GetVariable("$version")}catch(d){}}if(!a){try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");a=b.GetVariable("$version")}catch(d){}}if(!a){try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");a="WIN 3,0,18,0"}catch(d){}}if(!a){try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");a="WIN 2,0,0,11"}catch(d){a=-1}}return a}function GetSwfVer(){var j=-1;if(navigator.plugins!=null&&navigator.plugins.length>0){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var h=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"";var a=navigator.plugins["Shockwave Flash"+h].description;var g=a.split(" ");var d=g[2].split(".");var k=d[0];var b=d[1];var f=g[3];if(f==""){f=g[4]}if(f[0]=="d"){f=f.substring(1)}else{if(f[0]=="r"){f=f.substring(1);if(f.indexOf("d")>0){f=f.substring(0,f.indexOf("d"))}}}var j=k+"."+b+"."+f}}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.6")!=-1){j=4}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.5")!=-1){j=3}else{if(navigator.userAgent.toLowerCase().indexOf("webtv")!=-1){j=2}else{if(isIE&&isWin&&!isOpera){j=ControlVersion()}}}}}return j}function DetectFlashVer(h,f,d){versionStr=GetSwfVer();if(versionStr==-1){return false}else{if(versionStr!=0){if(isIE&&isWin&&!isOpera){tempArray=versionStr.split(" ");tempString=tempArray[1];versionArray=tempString.split(",")}else{versionArray=versionStr.split(".")}var g=versionArray[0];var a=versionArray[1];var b=versionArray[2];if(g>parseFloat(h)){return true}else{if(g==parseFloat(h)){if(a>parseFloat(f)){return true}else{if(a==parseFloat(f)){if(b>=parseFloat(d)){return true}}}}}return false}}}function AC_AddExtension(b,a){if(b.indexOf("?")!=-1){return b.replace(/\?/,a+"?")}else{return b+a}}function AC_Generateobj(g,f,a){var d="";if(isIE&&isWin&&!isOpera){d+="<object ";for(var b in g){d+=b+'="'+g[b]+'" '}d+=">";for(var b in f){d+='<param name="'+b+'" value="'+f[b]+'" /> '}d+="</object>"}else{d+="<embed ";for(var b in a){d+=b+'="'+a[b]+'" '}d+="> </embed>"}return d}function AC_FL_RunContent(){var a=AC_GetArgs(arguments,".swf","movie","clsid:d27cdb6e-ae6d-11cf-96b8-444553540000","application/x-shockwave-flash");return AC_Generateobj(a.objAttrs,a.params,a.embedAttrs)}function AC_SW_RunContent(){var a=AC_GetArgs(arguments,".dcr","src","clsid:166B1BCA-3F9C-11CF-8075-444553540000",null);return AC_Generateobj(a.objAttrs,a.params,a.embedAttrs)}function AC_GetArgs(b,g,j,f,k){var a=new Object();a.embedAttrs=new Object();a.params=new Object();a.objAttrs=new Object();for(var d=0;d<b.length;d=d+2){var h=b[d].toLowerCase();switch(h){case"classid":break;case"pluginspage":a.embedAttrs[b[d]]=b[d+1];break;case"src":case"movie":b[d+1]=AC_AddExtension(b[d+1],g);a.embedAttrs.src=b[d+1];a.params[j]=b[d+1];break;case"onafterupdate":case"onbeforeupdate":case"onblur":case"oncellchange":case"onclick":case"ondblclick":case"ondrag":case"ondragend":case"ondragenter":case"ondragleave":case"ondragover":case"ondrop":case"onfinish":case"onfocus":case"onhelp":case"onmousedown":case"onmouseup":case"onmouseover":case"onmousemove":case"onmouseout":case"onkeypress":case"onkeydown":case"onkeyup":case"onload":case"onlosecapture":case"onpropertychange":case"onreadystatechange":case"onrowsdelete":case"onrowenter":case"onrowexit":case"onrowsinserted":case"onstart":case"onscroll":case"onbeforeeditfocus":case"onactivate":case"onbeforedeactivate":case"ondeactivate":case"type":case"codebase":case"id":a.objAttrs[b[d]]=b[d+1];break;case"width":case"height":case"align":case"vspace":case"hspace":case"class":case"title":case"accesskey":case"name":case"tabindex":a.embedAttrs[b[d]]=a.objAttrs[b[d]]=b[d+1];break;default:a.embedAttrs[b[d]]=a.params[b[d]]=b[d+1]}}a.objAttrs.classid=f;if(k){a.embedAttrs.type=k}return a}Fisma.AttachArtifacts={sampleInterval:1000,apcId:null,yuiProgressBar:null,pollingTimeoutId:null,lastAsyncRequest:null,pollingEnabled:false,config:null,yuiPanel:null,showPanel:function(h,f){Fisma.AttachArtifacts.config=f;var g=new YAHOO.widget.Panel("panel",{modal:true,close:true});g.setHeader("Upload Artifact");g.setBody("Loading...");g.render(document.body);g.center();g.show();g.hideEvent.subscribe(function(){Fisma.AttachArtifacts.cancelPanel.call(Fisma.AttachArtifacts)});Fisma.AttachArtifacts.yuiPanel=g;var j="/artifact/upload-form";if(f.form){j+="/form/"+encodeURIComponent(f.form)}YAHOO.util.Connect.asyncRequest("GET",j,{success:function(a){a.argument.setBody(a.responseText);a.argument.center()},failure:function(a){a.argument.setBody("The content for this panel could not be loaded.");a.argument.center()},argument:g},null)},trackUploadProgress:function(){var m=document.getElementById("fileUpload");if(""==m.value){alert("Please select a file.");return false}var l=document.getElementById("uploadButton");l.disabled=true;var n=this;var p=document.getElementById("progress_key");if(p){this.apcId=p.value;var k=document.getElementById("progressBarContainer");var r=parseInt(YAHOO.util.Dom.getStyle(k,"width"));var o=parseInt(YAHOO.util.Dom.getStyle(k,"height"));YAHOO.util.Dom.removeClass(k,"attachArtifactsProgressBar");while(k.hasChildNodes()){k.removeChild(k.firstChild)}var j=new YAHOO.widget.ProgressBar();j.set("width",r);j.set("height",o);j.set("ariaTextTemplate","Upload is {value}% complete");j.set("anim",true);var q=j.get("anim");q.duration=2;q.method=YAHOO.util.Easing.easeNone;j.render("progressBarContainer");YAHOO.util.Dom.addClass(k,"attachArtifactsProgressBar");this.yuiProgressBar=j;this.pollingEnabled=true;setTimeout(function(){n.getProgress.call(n)},this.sampleInterval)}document.getElementById("progressBarContainer").style.display="block";document.getElementById("progressTextContainer").style.display="block";setTimeout(function(){n.postForm.call(n)},0);return false},postForm:function(){var f=this;var d="/"+encodeURIComponent(this.config.server.controller)+"/"+encodeURIComponent(this.config.server.action)+"/id/"+encodeURIComponent(this.config.id)+"/format/json";YAHOO.util.Connect.setForm("uploadArtifactForm",true);YAHOO.util.Connect.asyncRequest("POST",d,{upload:function(a){f.handleUploadComplete.call(f,a)},failure:function(a){alert("Document upload failed.")}},null)},getProgress:function(){var b=this;if(this.pollingEnabled){this.lastAsyncRequest=YAHOO.util.Connect.asyncRequest("GET","/artifact/upload-progress/format/json/id/"+this.apcId,{success:function(n){try{var o=YAHOO.lang.JSON.parse(n.responseText)}catch(l){if(l instanceof SyntaxError){o=new Object();o.progress=false}else{throw l}}if(!o.progress){b.yuiProgressBar.destroy();b.yuiProgressBar=null;b.pollingEnabled=false;var j=document.getElementById("progressBarContainer");YAHOO.util.Dom.addClass(j,"attachArtifactsProgressBar");var a=document.createElement("img");a.src="/images/loading_bar.gif";j.appendChild(a);b.pollingTimeoutId=null;return}var m=Math.round((o.progress.current/o.progress.total)*100);b.yuiProgressBar.set("value",m);var k=document.getElementById("progressTextContainer").firstChild;k.nodeValue=m+"%";b.pollingTimeoutId=setTimeout(function(){b.getProgress.call(b)},b.sampleInterval)}},null)}},handleUploadComplete:function(o){try{var p=YAHOO.lang.JSON.parse(o.responseText)}catch(m){if(m instanceof SyntaxError){p=new Object();p.success=false;p.message="Invalid response from server."}else{throw m}}this.pollingEnabled=false;clearTimeout(this.pollingTimeoutId);YAHOO.util.Connect.abort(this.lastAsyncRequest);if(this.yuiProgressBar){this.yuiProgressBar.get("anim").duration=0.5;this.yuiProgressBar.set("value",100)}var l=document.getElementById("progressTextContainer").firstChild;l.nodeValue="Verifying file.";if(!p.success){alert("Upload Failed: "+p.message);l.nodeValue="Uploading...";document.getElementById("progressBarContainer").style.display="none";document.getElementById("progressTextContainer").style.display="none";var j=document.getElementById("uploadButton");j.disabled=false;return}var n=Fisma[this.config.callback.object];if(typeof n!="Undefined"){var k=n[this.config.callback.method];if(typeof k=="function"){k.call(n,this.yuiPanel)}}},cancelPanel:function(){if(this.pollingEnabled){this.pollingEnabled=false;clearTimeout(this.pollingTimeoutId)}if(this.lastAsyncRequest){YAHOO.util.Connect.abort(this.lastAsyncRequest)}}};Fisma.AttachArtifacts={sampleInterval:1000,apcId:null,yuiProgressBar:null,pollingTimeoutId:null,lastAsyncRequest:null,pollingEnabled:false,config:null,yuiPanel:null,showPanel:function(f,b){Fisma.AttachArtifacts.config=b;var a=new YAHOO.widget.Panel("panel",{modal:true,close:true});a.setHeader("Upload Artifact");a.setBody("Loading...");a.render(document.body);a.center();a.show();a.hideEvent.subscribe(function(){Fisma.AttachArtifacts.cancelPanel.call(Fisma.AttachArtifacts)});Fisma.AttachArtifacts.yuiPanel=a;var d="/artifact/upload-form";if(b.form){d+="/form/"+encodeURIComponent(b.form)}YAHOO.util.Connect.asyncRequest("GET",d,{success:function(g){g.argument.setBody(g.responseText);g.argument.center()},failure:function(g){g.argument.setBody("The content for this panel could not be loaded.");g.argument.center()},argument:a},null)},trackUploadProgress:function(){var h=document.getElementById("fileUpload");if(""==h.value){alert("Please select a file.");return false}var j=document.getElementById("uploadButton");j.disabled=true;var g=this;var d=document.getElementById("progress_key");if(d){this.apcId=d.value;var k=document.getElementById("progressBarContainer");var a=parseInt(YAHOO.util.Dom.getStyle(k,"width"));var f=parseInt(YAHOO.util.Dom.getStyle(k,"height"));YAHOO.util.Dom.removeClass(k,"attachArtifactsProgressBar");while(k.hasChildNodes()){k.removeChild(k.firstChild)}var l=new YAHOO.widget.ProgressBar();l.set("width",a);l.set("height",f);l.set("ariaTextTemplate","Upload is {value}% complete");l.set("anim",true);var b=l.get("anim");b.duration=2;b.method=YAHOO.util.Easing.easeNone;l.render("progressBarContainer");YAHOO.util.Dom.addClass(k,"attachArtifactsProgressBar");this.yuiProgressBar=l;this.pollingEnabled=true;setTimeout(function(){g.getProgress.call(g)},this.sampleInterval)}document.getElementById("progressBarContainer").style.display="block";document.getElementById("progressTextContainer").style.display="block";setTimeout(function(){g.postForm.call(g)},0);return false},postForm:function(){var a=this;var b="/"+encodeURIComponent(this.config.server.controller)+"/"+encodeURIComponent(this.config.server.action)+"/id/"+encodeURIComponent(this.config.id)+"/format/json";YAHOO.util.Connect.setForm("uploadArtifactForm",true);YAHOO.util.Connect.asyncRequest("POST",b,{upload:function(d){a.handleUploadComplete.call(a,d)},failure:function(d){alert("Document upload failed.")}},null)},getProgress:function(){var a=this;if(this.pollingEnabled){this.lastAsyncRequest=YAHOO.util.Connect.asyncRequest("GET","/artifact/upload-progress/format/json/id/"+this.apcId,{success:function(f){try{var d=YAHOO.lang.JSON.parse(f.responseText)}catch(h){if(h instanceof SyntaxError){d=new Object();d.progress=false}else{throw h}}if(!d.progress){a.yuiProgressBar.destroy();a.yuiProgressBar=null;a.pollingEnabled=false;var k=document.getElementById("progressBarContainer");YAHOO.util.Dom.addClass(k,"attachArtifactsProgressBar");var b=document.createElement("img");b.src="/images/loading_bar.gif";k.appendChild(b);a.pollingTimeoutId=null;return}var g=Math.round((d.progress.current/d.progress.total)*100);a.yuiProgressBar.set("value",g);var j=document.getElementById("progressTextContainer").firstChild;j.nodeValue=g+"%";a.pollingTimeoutId=setTimeout(function(){a.getProgress.call(a)},a.sampleInterval)}},null)}},handleUploadComplete:function(f){try{var d=YAHOO.lang.JSON.parse(f.responseText)}catch(h){if(h instanceof SyntaxError){d=new Object();d.success=false;d.message="Invalid response from server."}else{throw h}}this.pollingEnabled=false;clearTimeout(this.pollingTimeoutId);YAHOO.util.Connect.abort(this.lastAsyncRequest);if(this.yuiProgressBar){this.yuiProgressBar.get("anim").duration=0.5;this.yuiProgressBar.set("value",100)}var j=document.getElementById("progressTextContainer").firstChild;j.nodeValue="Verifying file.";if(!d.success){alert("Upload Failed: "+d.message);j.nodeValue="Uploading...";document.getElementById("progressBarContainer").style.display="none";document.getElementById("progressTextContainer").style.display="none";var b=document.getElementById("uploadButton");b.disabled=false;return}var g=Fisma[this.config.callback.object];if(typeof g!="Undefined"){var a=g[this.config.callback.method];if(typeof a=="function"){a.call(g,this.yuiPanel)}}},cancelPanel:function(){if(this.pollingEnabled){this.pollingEnabled=false;clearTimeout(this.pollingTimeoutId)}if(this.lastAsyncRequest){YAHOO.util.Connect.abort(this.lastAsyncRequest)}}};Fisma.AutoComplete=function(){return{init:function(g,h,j){var k=new YAHOO.widget.DS_XHR(j.xhr,j.schema);k.responseType=YAHOO.widget.DS_XHR.TYPE_JSON;k.maxCacheEntries=500;k.queryMatchContains=true;var f=new YAHOO.widget.AutoComplete(j.fieldId,j.containerId,k);f.maxResultsDisplayed=20;f.forceSelection=true;f.generateRequest=function(a){return j.queryPrepend+a};f.formatResult=function(d,a,l){var b=(l)?l:"";b=PHP_JS().htmlspecialchars(b);return b};f.itemSelectEvent.subscribe(Fisma.AutoComplete.subscribe,{hiddenFieldId:j.hiddenFieldId})},subscribe:function(g,d,f){document.getElementById(f.hiddenFieldId).value=d[2][1]["id"]}}}();Fisma.AutoComplete=function(){return{init:function(a,g,f){var d=new YAHOO.widget.DS_XHR(f.xhr,f.schema);d.responseType=YAHOO.widget.DS_XHR.TYPE_JSON;d.maxCacheEntries=500;d.queryMatchContains=true;var b=new YAHOO.widget.AutoComplete(f.fieldId,f.containerId,d);b.maxResultsDisplayed=20;b.forceSelection=true;b.generateRequest=function(h){return f.queryPrepend+h};b.formatResult=function(j,l,h){var k=(h)?h:"";k=PHP_JS().htmlspecialchars(k);return k};b.itemSelectEvent.subscribe(Fisma.AutoComplete.subscribe,{hiddenFieldId:f.hiddenFieldId})},subscribe:function(d,b,a){document.getElementById(a.hiddenFieldId).value=b[2][1]["id"]}}}();Fisma.Blinker=function(g,j,f,h){this.interval=g;this.cycles=j;this.cyclesRemaining=j;this.onFunction=f;this.offFunction=h;this.state=0};Fisma.Blinker.prototype.start=function(){this.cycle()};Fisma.Blinker.prototype.cycle=function(){var b=this;if(1===this.state){this.offFunction()}else{this.onFunction()}this.state=1-this.state;this.cyclesRemaining--;if(this.cyclesRemaining>0){setTimeout(function(){b.cycle.call(b)},this.interval)}};Fisma.Blinker=function(a,d,b,f){this.interval=a;this.cycles=d;this.cyclesRemaining=d;this.onFunction=b;this.offFunction=f;this.state=0};Fisma.Blinker.prototype.start=function(){this.cycle()};Fisma.Blinker.prototype.cycle=function(){var a=this;if(1===this.state){this.offFunction()}else{this.onFunction()}this.state=1-this.state;this.cyclesRemaining--;if(this.cyclesRemaining>0){setTimeout(function(){a.cycle.call(a)},this.interval)}};Fisma.Commentable={asyncRequest:null,config:null,yuiPanel:null,showPanel:function(g,d){Fisma.Commentable.config=d;var f=new YAHOO.widget.Panel("panel",{modal:true,close:true});f.setHeader("Add Comment");f.setBody("Loading...");f.render(document.body);f.center();f.show();f.hideEvent.subscribe(function(){Fisma.Commentable.closePanel.call(Fisma.Commentable)});Fisma.Commentable.yuiPanel=f;YAHOO.util.Connect.asyncRequest("GET","/comment/form",{success:function(a){a.argument.setBody(a.responseText);a.argument.center()},failure:function(a){a.argument.setBody("The content for this panel could not be loaded.");a.argument.center()},argument:f},null);return false},postComment:function(){var b="/comment/add/id/"+encodeURIComponent(Fisma.Commentable.config.id)+"/type/"+encodeURIComponent(Fisma.Commentable.config.type)+"/format/json";YAHOO.util.Connect.setForm("addCommentForm");Fisma.Commentable.asyncRequest=YAHOO.util.Connect.asyncRequest("POST",b,{success:function(a){Fisma.Commentable.commentCallback.call(Fisma.Commentable,a)},failure:function(a){alert("Document upload failed.")}},null);return false},commentCallback:function(m){var n;try{var h=YAHOO.lang.JSON.parse(m.responseText);n=h.response}catch(k){if(k instanceof SyntaxError){n=new Object();n.success=false;n.message="Invalid response from server."}else{throw k}}if(!n.success){alert("Error: "+n.message);return}var l=Fisma[this.config.callback.object];if(typeof l!="Undefined"){var j=l[this.config.callback.method];if(typeof j=="function"){j.call(l,n.comment,this.yuiPanel)}}},closePanel:function(){if(this.asyncRequest){YAHOO.util.Connect.abort(this.asyncRequest)}}};Fisma.Commentable={asyncRequest:null,config:null,yuiPanel:null,showPanel:function(d,b){Fisma.Commentable.config=b;var a=new YAHOO.widget.Panel("panel",{modal:true,close:true});a.setHeader("Add Comment");a.setBody("Loading...");a.render(document.body);a.center();a.show();a.hideEvent.subscribe(function(){Fisma.Commentable.closePanel.call(Fisma.Commentable)});Fisma.Commentable.yuiPanel=a;YAHOO.util.Connect.asyncRequest("GET","/comment/form",{success:function(f){f.argument.setBody(f.responseText);f.argument.center()},failure:function(f){f.argument.setBody("The content for this panel could not be loaded.");f.argument.center()},argument:a},null);return false},postComment:function(){var a="/comment/add/id/"+encodeURIComponent(Fisma.Commentable.config.id)+"/type/"+encodeURIComponent(Fisma.Commentable.config.type)+"/format/json";YAHOO.util.Connect.setForm("addCommentForm");Fisma.Commentable.asyncRequest=YAHOO.util.Connect.asyncRequest("POST",a,{success:function(b){Fisma.Commentable.commentCallback.call(Fisma.Commentable,b)},failure:function(b){alert("Document upload failed.")}},null);return false},commentCallback:function(f){var d;try{var b=YAHOO.lang.JSON.parse(f.responseText);d=b.response}catch(h){if(h instanceof SyntaxError){d=new Object();d.success=false;d.message="Invalid response from server."}else{throw h}}if(!d.success){alert("Error: "+d.message);return}var g=Fisma[this.config.callback.object];if(typeof g!="Undefined"){var a=g[this.config.callback.method];if(typeof a=="function"){a.call(g,d.comment,this.yuiPanel)}}},closePanel:function(){if(this.asyncRequest){YAHOO.util.Connect.abort(this.asyncRequest)}}};Fisma.Email=function(){return{panelElement:null,showRecipientDialog:function(){if(Fisma.Email.panelElement!=null&&Fisma.Email.panelElement instanceof YAHOO.widget.Panel){Fisma.Email.panelElement.removeMask();Fisma.Email.panelElement.destroy();Fisma.Email.panelElement=null}var m=document.createElement("div");var j=document.createElement("p");var g=document.createTextNode("* Target E-mail Address:");j.appendChild(g);m.appendChild(j);var l=document.createElement("input");l.id="testEmailRecipient";l.name="recipient";m.appendChild(l);var k=document.createElement("div");k.style.height="10px";m.appendChild(k);var h=document.createElement("input");h.type="button";h.id="dialogRecipientSendBtn";h.style.marginLeft="10px";h.value="Send";m.appendChild(h);Fisma.Email.panelElement=Fisma.HtmlPanel.showPanel("Test E-mail Configuration",m.innerHTML);document.getElementById("dialogRecipientSendBtn").onclick=Fisma.Email.sendTestEmail},sendTestEmail:function(){if(document.getElementById("testEmailRecipient").value==""){alert("Recipient is required.");document.getElementById("testEmailRecipient").focus();return false}var d=document.getElementById("testEmailRecipient").value;var f=document.getElementById("email_config");f.elements.recipient.value=d;YAHOO.util.Connect.setForm(f);YAHOO.util.Connect.asyncRequest("POST","/config/test-email-config/format/json",{success:function(a){var b=YAHOO.lang.JSON.parse(a.responseText);message(b.msg,b.type)},failure:function(a){alert("Failed to send mail: "+a.statusText)}},null);if(Fisma.Email.panelElement!=null&&Fisma.Email.panelElement instanceof YAHOO.widget.Panel){Fisma.Email.panelElement.removeMask();Fisma.Email.panelElement.destroy();Fisma.Email.panelElement=null}}}}();Fisma.Email=function(){return{panelElement:null,showRecipientDialog:function(){if(Fisma.Email.panelElement!=null&&Fisma.Email.panelElement instanceof YAHOO.widget.Panel){Fisma.Email.panelElement.removeMask();Fisma.Email.panelElement.destroy();Fisma.Email.panelElement=null}var d=document.createElement("div");var h=document.createElement("p");var b=document.createTextNode("* Target E-mail Address:");h.appendChild(b);d.appendChild(h);var f=document.createElement("input");f.id="testEmailRecipient";f.name="recipient";d.appendChild(f);var g=document.createElement("div");g.style.height="10px";d.appendChild(g);var a=document.createElement("input");a.type="button";a.id="dialogRecipientSendBtn";a.style.marginLeft="10px";a.value="Send";d.appendChild(a);Fisma.Email.panelElement=Fisma.HtmlPanel.showPanel("Test E-mail Configuration",d.innerHTML);document.getElementById("dialogRecipientSendBtn").onclick=Fisma.Email.sendTestEmail},sendTestEmail:function(){if(document.getElementById("testEmailRecipient").value==""){alert("Recipient is required.");document.getElementById("testEmailRecipient").focus();return false}var b=document.getElementById("testEmailRecipient").value;var a=document.getElementById("email_config");a.elements.recipient.value=b;YAHOO.util.Connect.setForm(a);YAHOO.util.Connect.asyncRequest("POST","/config/test-email-config/format/json",{success:function(f){var d=YAHOO.lang.JSON.parse(f.responseText);message(d.msg,d.type)},failure:function(d){alert("Failed to send mail: "+d.statusText)}},null);if(Fisma.Email.panelElement!=null&&Fisma.Email.panelElement instanceof YAHOO.widget.Panel){Fisma.Email.panelElement.removeMask();Fisma.Email.panelElement.destroy();Fisma.Email.panelElement=null}}}}();Fisma.Finding={commentTable:null,commentCallback:function(j,g){var l=this;var m={timestamp:j.createdTs,username:j.username,comment:j.comment};this.commentTable.addRow(m);this.commentTable.sortColumn(this.commentTable.getColumn(0),YAHOO.widget.DataTable.CLASS_DESC);var h=new Fisma.Blinker(100,6,function(){l.commentTable.highlightRow(0)},function(){l.commentTable.unhighlightRow(0)});h.start();var k=document.getElementById("findingCommentsCount").firstChild;k.nodeValue++;g.hide();g.destroy()}};Fisma.Finding={commentTable:null,commentCallback:function(h,b){var f=this;var d={timestamp:h.createdTs,username:h.username,comment:h.comment};this.commentTable.addRow(d);this.commentTable.sortColumn(this.commentTable.getColumn(0),YAHOO.widget.DataTable.CLASS_DESC);var a=new Fisma.Blinker(100,6,function(){f.commentTable.highlightRow(0)},function(){f.commentTable.unhighlightRow(0)});a.start();var g=document.getElementById("findingCommentsCount").firstChild;g.nodeValue++;b.hide();b.destroy()},editEcdJustification:function(){var a=document.getElementById("currentChangeDescription");a.style.display="none";var d=a.firstChild.nodeValue;var b=document.createElement("input");b.type="text";b.value=d;b.name="finding[ecdChangeDescription]";a.parentNode.appendChild(b)}};Fisma.FindingSummary=function(){return{treeRoot:null,filterType:null,filterSource:null,defaultDisplayLevel:2,render:function(F,E,u){if(u){this.treeRoot=E}var y=document.getElementById(F);for(var H in E){var C=E[H];var L=y.insertRow(y.rows.length);L.id=C.nickname+"_ontime";var I=y.insertRow(y.rows.length);I.id=C.nickname+"_overdue";var K=L.insertCell(0);C.expanded=(C.level<this.defaultDisplayLevel-1);var z=C.expanded?C.single_ontime:C.all_ontime;var D=C.expanded?C.single_overdue:C.all_overdue;C.hasOverdue=this.hasOverdue(D);var x=document.createElement("img");x.className="control";x.id=C.nickname+"Img";var G=document.createElement("a");G.appendChild(x);var A=C.children.length>0;if(A){G.nickname=C.nickname;G.findingSummary=this;G.onclick=function(){this.findingSummary.toggleNode(this.nickname);return false};x.src="/images/"+(C.expanded?"minus.png":"plus.png")}else{x.src="/images/leaf_node.png"}var J=document.createElement("div");J.className="treeTable"+C.level+(A?" link":"");J.appendChild(G);var v=document.createElement("img");v.className="icon";v.src="/images/"+C.orgType+".png";G.appendChild(v);G.appendChild(document.createTextNode(C.label));G.appendChild(document.createElement("br"));G.appendChild(document.createTextNode(C.orgTypeLabel));K.appendChild(J);var B=1;for(var w in z){count=z[w];cell=L.insertCell(B++);if(w=="CLOSED"||w=="TOTAL"){cell.className="noDueDate"}else{cell.className="onTime"}this.updateCellCount(cell,count,C.id,w,"ontime",C.expanded)}for(var w in D){count=D[w];cell=I.insertCell(I.childNodes.length);cell.className="overdue";this.updateCellCount(cell,count,C.id,w,"overdue",C.expanded)}L.style.display="none";I.style.display="none";if(C.level<this.defaultDisplayLevel){L.style.display="";if(C.hasOverdue){L.childNodes[0].rowSpan="2";L.childNodes[L.childNodes.length-2].rowSpan="2";L.childNodes[L.childNodes.length-1].rowSpan="2";I.style.display=""}}if(C.children.length>0){this.render(F,C.children)}}},toggleNode:function(b){node=this.findNode(b,this.treeRoot);if(node.expanded){this.collapseNode(node,true);this.hideSubtree(node.children)}else{this.expandNode(node);this.showSubtree(node.children,false)}},expandNode:function(l,h){l.ontime=l.single_ontime;l.overdue=l.single_overdue;l.hasOverdue=this.hasOverdue(l.overdue);var j=document.getElementById(l.nickname+"_ontime");var n=1;for(c in l.ontime){count=l.ontime[c];this.updateCellCount(j.childNodes[n],count,l.id,c,"ontime",true);n++}var m=document.getElementById(l.nickname+"_overdue");if(l.hasOverdue){var n=0;for(c in l.overdue){count=l.overdue[c];this.updateCellCount(m.childNodes[n],count,l.id,c,"overdue",true);n++}}else{j.childNodes[0].rowSpan="1";j.childNodes[j.childNodes.length-2].rowSpan="1";j.childNodes[j.childNodes.length-1].rowSpan="1";m.style.display="none"}if(l.children.length>0){document.getElementById(l.nickname+"Img").src="/images/minus.png"}l.expanded=true;if(h&&l.children.length>0){this.showSubtree(l.children,false);for(var k in l.children){this.expandNode(l.children[k],true)}}},collapseNode:function(j,g){j.ontime=j.all_ontime;j.overdue=j.all_overdue;j.hasOverdue=this.hasOverdue(j.overdue);var h=document.getElementById(j.nickname+"_ontime");var l=1;for(c in j.ontime){count=j.ontime[c];this.updateCellCount(h.childNodes[l],count,j.id,c,"ontime",false);l++}var k=document.getElementById(j.nickname+"_overdue");if(g&&j.hasOverdue){h.childNodes[0].rowSpan="2";h.childNodes[h.childNodes.length-2].rowSpan="2";h.childNodes[h.childNodes.length-1].rowSpan="2";k.style.display="";var l=0;for(c in j.all_overdue){count=j.all_overdue[c];this.updateCellCount(k.childNodes[l],count,j.id,c,"overdue",false);l++}}if(j.children.length>0){this.hideSubtree(j.children)}document.getElementById(j.nickname+"Img").src="/images/plus.png";j.expanded=false},hideSubtree:function(b){for(nodeId in b){node=b[nodeId];ontimeRow=document.getElementById(node.nickname+"_ontime");ontimeRow.style.display="none";overdueRow=document.getElementById(node.nickname+"_overdue");overdueRow.style.display="none";if(node.children.length>0){this.collapseNode(node,false);this.hideSubtree(node.children)}}},showSubtree:function(d,f){for(nodeId in d){node=d[nodeId];if(f&&node.children.length>0){this.expandNode(node);this.showSubtree(node.children,true)}ontimeRow=document.getElementById(node.nickname+"_ontime");ontimeRow.style.display="";overdueRow=document.getElementById(node.nickname+"_overdue");if(node.hasOverdue){ontimeRow.childNodes[0].rowSpan="2";ontimeRow.childNodes[ontimeRow.childNodes.length-2].rowSpan="2";ontimeRow.childNodes[ontimeRow.childNodes.length-1].rowSpan="2";overdueRow.style.display=""}}},collapseAll:function(){for(nodeId in this.treeRoot){node=this.treeRoot[nodeId];this.collapseNode(node,true);this.hideSubtree(node.children)}},expandAll:function(){for(nodeId in this.treeRoot){node=this.treeRoot[nodeId];this.expandNode(node,true)}},findNode:function(h,f){for(var j in f){node=f[j];if(node.nickname==h){return node}else{if(node.children.length>0){var g=this.findNode(h,node.children);if(g!=false){return g}}}}return false},hasOverdue:function(d){for(var f in d){if(d[f]>0){return true}}return false},updateCellCount:function(k,m,p,j,l,o){if(!k.hasChildNodes()){if(m>0){var n=document.createElement("a");n.href=this.makeLink(p,j,l,o);n.appendChild(document.createTextNode(m));k.appendChild(n)}else{k.appendChild(document.createTextNode("-"))}}else{if(k.firstChild.hasChildNodes()){if(m>0){k.firstChild.firstChild.nodeValue=m;k.firstChild.href=this.makeLink(p,j,l,o)}else{k.removeChild(k.firstChild);k.appendChild(document.createTextNode("-"))}}else{if(m>0){k.removeChild(k.firstChild);var n=document.createElement("a");n.href=this.makeLink(p,j,l,o);n.appendChild(document.createTextNode(m));k.appendChild(n)}else{k.firstChild.nodeValue="-"}}}},makeLink:function(o,n,k,l){var p="";if(!(n=="CLOSED"||n=="TOTAL")){var p="/ontime/"+k}var m="";if(n!=""){m="/status/"+escape(n)}var s="";if(!YAHOO.lang.isNull(this.filterType)&&this.filterType!=""){s="/type/"+this.filterType}var r="";if(!YAHOO.lang.isNull(this.filterSource)&&this.filterSource!=""){r="/sourceId/"+this.filterSource}var q="/panel/remediation/sub/search"+p+m+"/responsibleOrganizationId/"+o+"/expanded/"+l+s+r;return q},exportTable:function(d){var f="/remediation/summary-data/format/"+d+this.listExpandedNodes(this.treeRoot,"");document.location=f},listExpandedNodes:function(f,g){for(var h in f){var j=f[h];if(j.expanded){g+="/e/"+j.id;g=this.listExpandedNodes(j.children,g)}else{g+="/c/"+j.id}}return g}}};Fisma.FindingSummary=function(){return{treeRoot:null,filterType:null,filterSource:null,defaultDisplayLevel:2,render:function(j,k,u){if(u){this.treeRoot=k}var q=document.getElementById(j);for(var g in k){var m=k[g];var a=q.insertRow(q.rows.length);a.id=m.nickname+"_ontime";var f=q.insertRow(q.rows.length);f.id=m.nickname+"_overdue";var b=a.insertCell(0);m.expanded=(m.level<this.defaultDisplayLevel-1);var p=m.expanded?m.single_ontime:m.all_ontime;var l=m.expanded?m.single_overdue:m.all_overdue;m.hasOverdue=this.hasOverdue(l);var r=document.createElement("img");r.className="control";r.id=m.nickname+"Img";var h=document.createElement("a");h.appendChild(r);var o=m.children.length>0;if(o){h.nickname=m.nickname;h.findingSummary=this;h.onclick=function(){this.findingSummary.toggleNode(this.nickname);return false};r.src="/images/"+(m.expanded?"minus.png":"plus.png")}else{r.src="/images/leaf_node.png"}var d=document.createElement("div");d.className="treeTable"+m.level+(o?" link":"");d.appendChild(h);var t=document.createElement("img");t.className="icon";t.src="/images/"+m.orgType+".png";h.appendChild(t);h.appendChild(document.createTextNode(m.label));h.appendChild(document.createElement("br"));h.appendChild(document.createTextNode(m.orgTypeLabel));b.appendChild(d);var n=1;for(var s in p){count=p[s];cell=a.insertCell(n++);if(s=="CLOSED"||s=="TOTAL"){cell.className="noDueDate"}else{cell.className="onTime"}this.updateCellCount(cell,count,m.id,s,"ontime",m.expanded)}for(var s in l){count=l[s];cell=f.insertCell(f.childNodes.length);cell.className="overdue";this.updateCellCount(cell,count,m.id,s,"overdue",m.expanded)}a.style.display="none";f.style.display="none";if(m.level<this.defaultDisplayLevel){a.style.display="";if(m.hasOverdue){a.childNodes[0].rowSpan="2";a.childNodes[a.childNodes.length-2].rowSpan="2";a.childNodes[a.childNodes.length-1].rowSpan="2";f.style.display=""}}if(m.children.length>0){this.render(j,m.children)}}},toggleNode:function(a){node=this.findNode(a,this.treeRoot);if(node.expanded){this.collapseNode(node,true);this.hideSubtree(node.children)}else{this.expandNode(node);this.showSubtree(node.children,false)}},expandNode:function(g,b){g.ontime=g.single_ontime;g.overdue=g.single_overdue;g.hasOverdue=this.hasOverdue(g.overdue);var a=document.getElementById(g.nickname+"_ontime");var d=1;for(c in g.ontime){count=g.ontime[c];this.updateCellCount(a.childNodes[d],count,g.id,c,"ontime",true);d++}var f=document.getElementById(g.nickname+"_overdue");if(g.hasOverdue){var d=0;for(c in g.overdue){count=g.overdue[c];this.updateCellCount(f.childNodes[d],count,g.id,c,"overdue",true);d++}}else{a.childNodes[0].rowSpan="1";a.childNodes[a.childNodes.length-2].rowSpan="1";a.childNodes[a.childNodes.length-1].rowSpan="1";f.style.display="none"}if(g.children.length>0){document.getElementById(g.nickname+"Img").src="/images/minus.png"}g.expanded=true;if(b&&g.children.length>0){this.showSubtree(g.children,false);for(var h in g.children){this.expandNode(g.children[h],true)}}},collapseNode:function(g,b){g.ontime=g.all_ontime;g.overdue=g.all_overdue;g.hasOverdue=this.hasOverdue(g.overdue);var a=document.getElementById(g.nickname+"_ontime");var d=1;for(c in g.ontime){count=g.ontime[c];this.updateCellCount(a.childNodes[d],count,g.id,c,"ontime",false);d++}var f=document.getElementById(g.nickname+"_overdue");if(b&&g.hasOverdue){a.childNodes[0].rowSpan="2";a.childNodes[a.childNodes.length-2].rowSpan="2";a.childNodes[a.childNodes.length-1].rowSpan="2";f.style.display="";var d=0;for(c in g.all_overdue){count=g.all_overdue[c];this.updateCellCount(f.childNodes[d],count,g.id,c,"overdue",false);d++}}if(g.children.length>0){this.hideSubtree(g.children)}document.getElementById(g.nickname+"Img").src="/images/plus.png";g.expanded=false},hideSubtree:function(a){for(nodeId in a){node=a[nodeId];ontimeRow=document.getElementById(node.nickname+"_ontime");ontimeRow.style.display="none";overdueRow=document.getElementById(node.nickname+"_overdue");overdueRow.style.display="none";if(node.children.length>0){this.collapseNode(node,false);this.hideSubtree(node.children)}}},showSubtree:function(b,a){for(nodeId in b){node=b[nodeId];if(a&&node.children.length>0){this.expandNode(node);this.showSubtree(node.children,true)}ontimeRow=document.getElementById(node.nickname+"_ontime");ontimeRow.style.display="";overdueRow=document.getElementById(node.nickname+"_overdue");if(node.hasOverdue){ontimeRow.childNodes[0].rowSpan="2";ontimeRow.childNodes[ontimeRow.childNodes.length-2].rowSpan="2";ontimeRow.childNodes[ontimeRow.childNodes.length-1].rowSpan="2";overdueRow.style.display=""}}},collapseAll:function(){for(nodeId in this.treeRoot){node=this.treeRoot[nodeId];this.collapseNode(node,true);this.hideSubtree(node.children)}},expandAll:function(){for(nodeId in this.treeRoot){node=this.treeRoot[nodeId];this.expandNode(node,true)}},findNode:function(f,b){for(var d in b){node=b[d];if(node.nickname==f){return node}else{if(node.children.length>0){var a=this.findNode(f,node.children);if(a!=false){return a}}}}return false},hasOverdue:function(b){for(var a in b){if(b[a]>0){return true}}return false},updateCellCount:function(a,h,d,b,j,f){if(!a.hasChildNodes()){if(h>0){var g=document.createElement("a");g.href=this.makeLink(d,b,j,f);g.appendChild(document.createTextNode(h));a.appendChild(g)}else{a.appendChild(document.createTextNode("-"))}}else{if(a.firstChild.hasChildNodes()){if(h>0){a.firstChild.firstChild.nodeValue=h;a.firstChild.href=this.makeLink(d,b,j,f)}else{a.removeChild(a.firstChild);a.appendChild(document.createTextNode("-"))}}else{if(h>0){a.removeChild(a.firstChild);var g=document.createElement("a");g.href=this.makeLink(d,b,j,f);g.appendChild(document.createTextNode(h));a.appendChild(g)}else{a.firstChild.nodeValue="-"}}}},makeLink:function(g,h,l,k){var f="";if(!(h=="CLOSED"||h=="TOTAL")){var f="/ontime/"+l}var j="";if(h!=""){j="/status/"+escape(h)}var a="";if(!YAHOO.lang.isNull(this.filterType)&&this.filterType!=""){a="/type/"+this.filterType}var b="";if(!YAHOO.lang.isNull(this.filterSource)&&this.filterSource!=""){b="/sourceId/"+this.filterSource}var d="/panel/remediation/sub/search"+f+j+"/responsibleOrganizationId/"+g+"/expanded/"+k+a+b;return d},exportTable:function(b){var a="/remediation/summary-data/format/"+b+this.listExpandedNodes(this.treeRoot,"");document.location=a},listExpandedNodes:function(b,a){for(var f in b){var d=b[f];if(d.expanded){a+="/e/"+d.id;a=this.listExpandedNodes(d.children,a)}else{a+="/c/"+d.id}}return a}}};Fisma.HtmlPanel=function(){return{showPanel:function(h,k,f,j){if(typeof(f)=="undefined"||f==null){f="panel"}if(typeof(j)=="undefined"||j==null){j={width:"540px",modal:true}}var g=new YAHOO.widget.Panel(f,j);g.setHeader(h);g.setBody("Loading...");g.render(document.body);g.center();g.show();if(k!=""){g.setBody(k);g.center()}return g}}}();Fisma.HtmlPanel=function(){return{showPanel:function(g,d,b,f){if(typeof(b)=="undefined"||b==null){b="panel"}if(typeof(f)=="undefined"||f==null){f={width:"540px",modal:true}}var a=new YAHOO.widget.Panel(b,f);a.setHeader(g);a.setBody("Loading...");a.render(document.body);a.center();a.show();if(d!=""){a.setBody(d);a.center()}return a}}}();Fisma.Incident={commentTable:null,attachArtifactCallback:function(b){window.location.href=window.location.href},commentCallback:function(j,g){var l=this;var m={timestamp:j.createdTs,username:j.username,comment:j.comment};this.commentTable.addRow(m);this.commentTable.sortColumn(this.commentTable.getColumn(0),YAHOO.widget.DataTable.CLASS_DESC);var h=new Fisma.Blinker(100,6,function(){l.commentTable.highlightRow(0)},function(){l.commentTable.unhighlightRow(0)});h.start();var k=document.getElementById("incidentCommentsCount").firstChild;k.nodeValue++;g.hide();g.destroy()}};Fisma.Incident={commentTable:null,attachArtifactCallback:function(a){window.location.href=window.location.href},commentCallback:function(h,b){var f=this;var d={timestamp:h.createdTs,username:h.username,comment:h.comment};this.commentTable.addRow(d);this.commentTable.sortColumn(this.commentTable.getColumn(0),YAHOO.widget.DataTable.CLASS_DESC);var a=new Fisma.Blinker(100,6,function(){f.commentTable.highlightRow(0)},function(){f.commentTable.unhighlightRow(0)});a.start();var g=document.getElementById("incidentCommentsCount").firstChild;g.nodeValue++;b.hide();b.destroy()}};Fisma.Module={handleSwitchButtonStateChange:function(f){f.setBusy(true);var d=f.state?"true":"false";var g="/config/set-module/id/"+f.payload.id+"/enabled/"+d+"/format/json/";YAHOO.util.Connect.asyncRequest("GET",g,{success:Fisma.Module.handleAsyncResponse,failure:Fisma.Module.handleAsyncResponse,argument:f},null)},handleAsyncResponse:function(f){try{var j=YAHOO.lang.JSON.parse(f.responseText)}catch(h){if(h instanceof SyntaxError){j=new Object();j.success=false;j.message="Invalid response from server."}else{throw h}}if(!j.success){alert("Error: Not able to change module status. Reason: "+j.message)}var g=f.argument;g.setBusy(false)}};Fisma.Module={handleSwitchButtonStateChange:function(a){a.setBusy(true);var b=a.state?"true":"false";var d="/config/set-module/id/"+a.payload.id+"/enabled/"+b+"/format/json/";YAHOO.util.Connect.asyncRequest("GET",d,{success:Fisma.Module.handleAsyncResponse,failure:Fisma.Module.handleAsyncResponse,argument:a},null)},handleAsyncResponse:function(b){try{var d=YAHOO.lang.JSON.parse(b.responseText)}catch(f){if(f instanceof SyntaxError){d=new Object();d.success=false;d.message="Invalid response from server."}else{throw f}}if(!d.success){alert("Error: Not able to change module status. Reason: "+d.message)}var a=b.argument;a.setBusy(false)}};function upload_evidence(){if(!form_confirm(document.finding_detail,"Upload Evidence")){return false}Fisma.UrlPanel.showPanel("Upload Evidence","/remediation/upload-form",upload_evidence_form_init);return false}function upload_evidence_form_init(){document.finding_detail_upload_evidence.action=document.finding_detail.action}function ev_approve(l){if(!form_confirm(document.finding_detail,"approve the evidence package")){return false}var m=document.createElement("div");var k=document.createElement("p");k.appendChild(document.createTextNode("Comments (OPTIONAL):"));m.appendChild(k);var g=document.createElement("textarea");g.rows=5;g.cols=60;g.id="dialog_comment";g.name="comment";m.appendChild(g);var j=document.createElement("div");j.style.height="20px";m.appendChild(j);var h=document.createElement("input");h.type="button";h.id="dialog_continue";h.value="Continue";m.appendChild(h);Fisma.HtmlPanel.showPanel("Evidence Approval",m.innerHTML);document.getElementById("dialog_continue").onclick=function(){var b=l;if(document.all){var a=document.getElementById("dialog_comment").innerHTML}else{var a=document.getElementById("dialog_comment").value}b.elements.comment.value=a;b.elements.decision.value="APPROVED";var d=document.createElement("input");d.type="hidden";d.name="submit_ea";d.value="APPROVED";b.appendChild(d);b.submit()}}function ev_deny(l){if(!form_confirm(document.finding_detail,"deny the evidence package")){return false}var m=document.createElement("div");var k=document.createElement("p");k.appendChild(document.createTextNode("Comments:"));m.appendChild(k);var g=document.createElement("textarea");g.rows=5;g.cols=60;g.id="dialog_comment";g.name="comment";m.appendChild(g);var j=document.createElement("div");j.style.height="20px";m.appendChild(j);var h=document.createElement("input");h.type="button";h.id="dialog_continue";h.value="Continue";m.appendChild(h);Fisma.HtmlPanel.showPanel("Evidence Denial",m.innerHTML);document.getElementById("dialog_continue").onclick=function(){var b=l;if(document.all){var a=document.getElementById("dialog_comment").innerHTML}else{var a=document.getElementById("dialog_comment").value}if(a.match(/^\s*$/)){alert("Comments are required in order to deny.");return}b.elements.comment.value=a;b.elements.decision.value="DENIED";var d=document.createElement("input");d.type="hidden";d.name="submit_ea";d.value="DENIED";b.appendChild(d);b.submit()}}function ms_approve(n){if(!form_confirm(document.finding_detail,"approve the mitigation strategy")){return false}var o=document.createElement("div");var m=document.createElement("p");var l=document.createTextNode("Comments (OPTIONAL):");m.appendChild(l);o.appendChild(m);var j=document.createElement("textarea");j.id="dialog_comment";j.name="comment";j.rows=5;j.cols=60;o.appendChild(j);var k=document.createElement("div");k.style.height="20px";o.appendChild(k);var h=document.createElement("input");h.type="button";h.id="dialog_continue";h.value="Continue";o.appendChild(h);Fisma.HtmlPanel.showPanel("Mitigation Strategy Approval",o.innerHTML);document.getElementById("dialog_continue").onclick=function(){var b=n;if(document.all){var a=document.getElementById("dialog_comment").innerHTML}else{var a=document.getElementById("dialog_comment").value}b.elements.comment.value=a;b.elements.decision.value="APPROVED";var d=document.createElement("input");d.type="hidden";d.name="submit_msa";d.value="APPROVED";b.appendChild(d);b.submit()}}function ms_deny(n){if(!form_confirm(document.finding_detail,"deny the mitigation strategy")){return false}var o=document.createElement("div");var m=document.createElement("p");var l=document.createTextNode("Comments:");m.appendChild(l);o.appendChild(m);var j=document.createElement("textarea");j.id="dialog_comment";j.name="comment";j.rows=5;j.cols=60;o.appendChild(j);var k=document.createElement("div");k.style.height="20px";o.appendChild(k);var h=document.createElement("input");h.type="button";h.id="dialog_continue";h.value="Continue";o.appendChild(h);Fisma.HtmlPanel.showPanel("Mitigation Strategy Denial",o.innerHTML);document.getElementById("dialog_continue").onclick=function(){var b=n;if(document.all){var a=document.getElementById("dialog_comment").innerHTML}else{var a=document.getElementById("dialog_comment").value}if(a.match(/^\s*$/)){alert("Comments are required in order to submit.");return}b.elements.comment.value=a;b.elements.decision.value="DENIED";var d=document.createElement("input");d.type="hidden";d.name="submit_msa";d.value="DENIED";b.appendChild(d);b.submit()}}function upload_evidence(){if(!form_confirm(document.finding_detail,"Upload Evidence")){return false}Fisma.UrlPanel.showPanel("Upload Evidence","/remediation/upload-form",upload_evidence_form_init);return false}function upload_evidence_form_init(){document.finding_detail_upload_evidence.action=document.finding_detail.action}function ev_approve(f){if(!form_confirm(document.finding_detail,"approve the evidence package")){return false}var d=document.createElement("div");var g=document.createElement("p");g.appendChild(document.createTextNode("Comments (OPTIONAL):"));d.appendChild(g);var b=document.createElement("textarea");b.rows=5;b.cols=60;b.id="dialog_comment";b.name="comment";d.appendChild(b);var h=document.createElement("div");h.style.height="20px";d.appendChild(h);var a=document.createElement("input");a.type="button";a.id="dialog_continue";a.value="Continue";d.appendChild(a);Fisma.HtmlPanel.showPanel("Evidence Approval",d.innerHTML);document.getElementById("dialog_continue").onclick=function(){var k=f;if(document.all){var l=document.getElementById("dialog_comment").innerHTML}else{var l=document.getElementById("dialog_comment").value}k.elements.comment.value=l;k.elements.decision.value="APPROVED";var j=document.createElement("input");j.type="hidden";j.name="submit_ea";j.value="APPROVED";k.appendChild(j);k.submit()}}function ev_deny(f){if(!form_confirm(document.finding_detail,"deny the evidence package")){return false}var d=document.createElement("div");var g=document.createElement("p");g.appendChild(document.createTextNode("Comments:"));d.appendChild(g);var b=document.createElement("textarea");b.rows=5;b.cols=60;b.id="dialog_comment";b.name="comment";d.appendChild(b);var h=document.createElement("div");h.style.height="20px";d.appendChild(h);var a=document.createElement("input");a.type="button";a.id="dialog_continue";a.value="Continue";d.appendChild(a);Fisma.HtmlPanel.showPanel("Evidence Denial",d.innerHTML);document.getElementById("dialog_continue").onclick=function(){var k=f;if(document.all){var l=document.getElementById("dialog_comment").innerHTML}else{var l=document.getElementById("dialog_comment").value}if(l.match(/^\s*$/)){alert("Comments are required in order to deny.");return}k.elements.comment.value=l;k.elements.decision.value="DENIED";var j=document.createElement("input");j.type="hidden";j.name="submit_ea";j.value="DENIED";k.appendChild(j);k.submit()}}function ms_approve(f){if(!form_confirm(document.finding_detail,"approve the mitigation strategy")){return false}var d=document.createElement("div");var g=document.createElement("p");var h=document.createTextNode("Comments (OPTIONAL):");g.appendChild(h);d.appendChild(g);var a=document.createElement("textarea");a.id="dialog_comment";a.name="comment";a.rows=5;a.cols=60;d.appendChild(a);var j=document.createElement("div");j.style.height="20px";d.appendChild(j);var b=document.createElement("input");b.type="button";b.id="dialog_continue";b.value="Continue";d.appendChild(b);Fisma.HtmlPanel.showPanel("Mitigation Strategy Approval",d.innerHTML);document.getElementById("dialog_continue").onclick=function(){var l=f;if(document.all){var m=document.getElementById("dialog_comment").innerHTML}else{var m=document.getElementById("dialog_comment").value}l.elements.comment.value=m;l.elements.decision.value="APPROVED";var k=document.createElement("input");k.type="hidden";k.name="submit_msa";k.value="APPROVED";l.appendChild(k);l.submit()}}function ms_deny(f){if(!form_confirm(document.finding_detail,"deny the mitigation strategy")){return false}var d=document.createElement("div");var g=document.createElement("p");var h=document.createTextNode("Comments:");g.appendChild(h);d.appendChild(g);var a=document.createElement("textarea");a.id="dialog_comment";a.name="comment";a.rows=5;a.cols=60;d.appendChild(a);var j=document.createElement("div");j.style.height="20px";d.appendChild(j);var b=document.createElement("input");b.type="button";b.id="dialog_continue";b.value="Continue";d.appendChild(b);Fisma.HtmlPanel.showPanel("Mitigation Strategy Denial",d.innerHTML);document.getElementById("dialog_continue").onclick=function(){var l=f;if(document.all){var m=document.getElementById("dialog_comment").innerHTML}else{var m=document.getElementById("dialog_comment").value}if(m.match(/^\s*$/)){alert("Comments are required in order to submit.");return}l.elements.comment.value=m;l.elements.decision.value="DENIED";var k=document.createElement("input");k.type="hidden";k.name="submit_msa";k.value="DENIED";l.appendChild(k);l.submit()}}Fisma.SwitchButton=function(f,g,h,j){var k=this;if(f.nodeType&&f.nodeType==document.ELEMENT_NODE){this.element=f}else{if("string"==typeof f){this.element=document.getElementById(f);if(!this.element){throw'Invalid element name "'+name+'"'}}else{throw"Invalid element for switch button constructor"}}this.createDomElements();this.state=g;this.payload=j;if(!this.state){this.element.style.backgroundPosition="-54px 100%"}this.element.onclick=function(){k.toggleSwitch.call(k)};if(""!=h){callbackObj=Fisma.Util.getObjectFromName(h);if("function"==typeof callbackObj){this.callback=callbackObj}else{throw"Specified callback is not a function: "+h}}};Fisma.SwitchButton.prototype={createDomElements:function(){YAHOO.util.Dom.addClass(this.element,"switchButton");var g=document.createElement("span");YAHOO.util.Dom.addClass(g,"border");this.element.appendChild(g);var d=document.createElement("span");YAHOO.util.Dom.addClass(d,"spinner");var f=document.createElement("img");f.src="/images/spinners/small.gif";d.appendChild(f);this.element.appendChild(d);this.spinner=d;this.proxyElement=document.createElement("div");this.proxyElement.style.display="none";document.body.appendChild(this.proxyElement)},toggleSwitch:function(){var d=this;var f;if(this.state){f={left:{from:0,to:-54,unit:"px"}};this.state=false}else{f={left:{from:-54,to:0,unit:"px"}};this.state=true}var g=new YAHOO.util.Anim(this.proxyElement,f,0.1,YAHOO.util.Easing.easeOut);g.onTween.subscribe(function(){d.element.style.backgroundPosition=d.proxyElement.style.left+" 100%"});g.animate();if(this.callback){this.callback(this)}},setBusy:function(b){if(b){this.spinner.style.visibility="visible"}else{this.spinner.style.visibility="hidden"}}};Fisma.SwitchButton=function(b,a,g,f){var d=this;if(b.nodeType&&b.nodeType==document.ELEMENT_NODE){this.element=b}else{if("string"==typeof b){this.element=document.getElementById(b);if(!this.element){throw'Invalid element name "'+name+'"'}}else{throw"Invalid element for switch button constructor"}}this.createDomElements();this.state=a;this.payload=f;if(!this.state){this.element.style.backgroundPosition="-54px 100%"}this.element.onclick=function(){d.toggleSwitch.call(d)};if(""!=g){callbackObj=Fisma.Util.getObjectFromName(g);if("function"==typeof callbackObj){this.callback=callbackObj}else{throw"Specified callback is not a function: "+g}}};Fisma.SwitchButton.prototype={createDomElements:function(){YAHOO.util.Dom.addClass(this.element,"switchButton");var d=document.createElement("span");YAHOO.util.Dom.addClass(d,"border");this.element.appendChild(d);var b=document.createElement("span");YAHOO.util.Dom.addClass(b,"spinner");var a=document.createElement("img");a.src="/images/spinners/small.gif";b.appendChild(a);this.element.appendChild(b);this.spinner=b;this.proxyElement=document.createElement("div");this.proxyElement.style.display="none";document.body.appendChild(this.proxyElement)},toggleSwitch:function(){var b=this;var a;if(this.state){a={left:{from:0,to:-54,unit:"px"}};this.state=false}else{a={left:{from:-54,to:0,unit:"px"}};this.state=true}var d=new YAHOO.util.Anim(this.proxyElement,a,0.1,YAHOO.util.Easing.easeOut);d.onTween.subscribe(function(){b.element.style.backgroundPosition=b.proxyElement.style.left+" 100%"});d.animate();if(this.callback){this.callback(this)}},setBusy:function(a){if(a){this.spinner.style.visibility="visible"}else{this.spinner.style.visibility="hidden"}}};Fisma.System={uploadDocumentCallback:function(b){window.location.href=window.location.href}};Fisma.System={uploadDocumentCallback:function(a){window.location.href=window.location.href}};Fisma.TabView={};Fisma.TabView={};Fisma.TabView.Roles=function(){return{init:function(d,f,g){YAHOO.util.Event.addListener("role","change",function(a){YAHOO.util.Dom.batch(YAHOO.util.Dom.getChildren("role"),function(n){var o=Fisma.tabView;var p=o.get("tabs");if(n.selected){var m=0;for(var q in p){if(p[q].get("id")==n.value){m=1;break}}if(!m){for(var q in d){if(d[q]["id"]==n.value){var r=d[q]["nickname"];break}}var b=new YAHOO.widget.Tab({id:n.value,label:r,dataSrc:"/user/get-organization-subform/user/"+f+"/role/"+n.value+"/readOnly/"+g,cacheData:true,active:true});b.subscribe("dataLoadedChange",Fisma.prepareTab);o.addTab(b)}}else{for(var q in p){if(p[q].get("id")==n.value){o.removeTab(p[q])}}}})})}}}();Fisma.TabView.Roles=function(){return{init:function(b,a,d){YAHOO.util.Event.addListener("role","change",function(f){YAHOO.util.Dom.batch(YAHOO.util.Dom.getChildren("role"),function(l){var k=Fisma.tabView;var j=k.get("tabs");if(l.selected){var m=0;for(var h in j){if(j[h].get("id")==l.value){m=1;break}}if(!m){for(var h in b){if(b[h]["id"]==l.value){var g=b[h]["nickname"];break}}var n=new YAHOO.widget.Tab({id:l.value,label:g,dataSrc:"/user/get-organization-subform/user/"+a+"/role/"+l.value+"/readOnly/"+d,cacheData:true,active:true});n.subscribe("dataLoadedChange",Fisma.prepareTab);k.addTab(n)}}else{for(var h in j){if(j[h].get("id")==l.value){k.removeTab(j[h])}}}})})}}}();Fisma.TableFormat={greenColor:"lightgreen",yellowColor:"yellow",redColor:"pink",green:function(b){b.style.backgroundColor=Fisma.TableFormat.greenColor},yellow:function(b){b.style.backgroundColor=Fisma.TableFormat.yellowColor},red:function(b){b.style.backgroundColor=Fisma.TableFormat.redColor},securityAuthorization:function(f,g,j,h){f.innerHTML=h;dateParts=h.split("-");if(3==dateParts.length){authorizedDate=new Date(dateParts[0],dateParts[1],dateParts[2]);greenDate=new Date();greenDate.setMonth(greenDate.getMonth()-30);yellowDate=new Date();yellowDate.setMonth(yellowDate.getMonth()-36);if(authorizedDate>=greenDate){Fisma.TableFormat.green(f.parentNode)}else{if(authorizedDate>=yellowDate){Fisma.TableFormat.yellow(f.parentNode)}else{Fisma.TableFormat.red(f.parentNode)}}}},selfAssessment:function(f,g,j,h){f.innerHTML=h;dateParts=h.split("-");if(3==dateParts.length){assessmentDate=new Date(dateParts[0],dateParts[1],dateParts[2]);greenDate=new Date();greenDate.setMonth(greenDate.getMonth()-8);yellowDate=new Date();yellowDate.setMonth(yellowDate.getMonth()-12);if(assessmentDate>=greenDate){Fisma.TableFormat.green(f.parentNode)}else{if(assessmentDate>=yellowDate){Fisma.TableFormat.yellow(f.parentNode)}else{Fisma.TableFormat.red(f.parentNode)}}}},contingencyPlanTest:function(f,g,j,h){Fisma.TableFormat.selfAssessment(f,g,j,h)},yesNo:function(f,g,j,h){f.innerHTML=h;if("YES"==h){Fisma.TableFormat.green(f.parentNode)}else{if("NO"==h){Fisma.TableFormat.red(f.parentNode)}}},editControl:function(l,m,k,j){var h=document.createElement("img");h.src="/images/edit.png";var g=document.createElement("a");g.href=j;g.appendChild(h);l.appendChild(g)},deleteControl:function(l,m,k,j){var h=document.createElement("img");h.src="/images/del.png";var g=document.createElement("a");g.href=j;g.appendChild(h);l.appendChild(g)}};Fisma.TableFormat={greenColor:"lightgreen",yellowColor:"yellow",redColor:"pink",green:function(a){a.style.backgroundColor=Fisma.TableFormat.greenColor},yellow:function(a){a.style.backgroundColor=Fisma.TableFormat.yellowColor},red:function(a){a.style.backgroundColor=Fisma.TableFormat.redColor},securityAuthorization:function(b,a,d,f){b.innerHTML=f;dateParts=f.split("-");if(3==dateParts.length){authorizedDate=new Date(dateParts[0],dateParts[1],dateParts[2]);greenDate=new Date();greenDate.setMonth(greenDate.getMonth()-30);yellowDate=new Date();yellowDate.setMonth(yellowDate.getMonth()-36);if(authorizedDate>=greenDate){Fisma.TableFormat.green(b.parentNode)}else{if(authorizedDate>=yellowDate){Fisma.TableFormat.yellow(b.parentNode)}else{Fisma.TableFormat.red(b.parentNode)}}}},selfAssessment:function(b,a,d,f){b.innerHTML=f;dateParts=f.split("-");if(3==dateParts.length){assessmentDate=new Date(dateParts[0],dateParts[1],dateParts[2]);greenDate=new Date();greenDate.setMonth(greenDate.getMonth()-8);yellowDate=new Date();yellowDate.setMonth(yellowDate.getMonth()-12);if(assessmentDate>=greenDate){Fisma.TableFormat.green(b.parentNode)}else{if(assessmentDate>=yellowDate){Fisma.TableFormat.yellow(b.parentNode)}else{Fisma.TableFormat.red(b.parentNode)}}}},contingencyPlanTest:function(b,a,d,f){Fisma.TableFormat.selfAssessment(b,a,d,f)},yesNo:function(b,a,d,f){b.innerHTML=f;if("YES"==f){Fisma.TableFormat.green(b.parentNode)}else{if("NO"==f){Fisma.TableFormat.red(b.parentNode)}}},editControl:function(f,d,g,h){var a=document.createElement("img");a.src="/images/edit.png";var b=document.createElement("a");b.href=h;b.appendChild(a);f.appendChild(b)},deleteControl:function(f,d,g,h){var a=document.createElement("img");a.src="/images/del.png";var b=document.createElement("a");b.href=h;b.appendChild(a);f.appendChild(b)}};Fisma.UrlPanel=function(){return{showPanel:function(k,g,j,m,l){if(typeof(m)=="undefined"||m==null){m="panel"}if(typeof(l)=="undefined"||l==null){l={width:"540px",modal:true}}var h=new YAHOO.widget.Panel(m,l);h.setHeader(k);h.setBody("Loading...");h.render(document.body);h.center();h.show();if(g!=""){YAHOO.util.Connect.asyncRequest("GET",g,{success:function(a){a.argument.setBody(a.responseText);a.argument.center();if(typeof(j)=="function"){j()}},failure:function(a){alert("Failed to load the specified panel.")},argument:h},null)}return h}}}();Fisma.UrlPanel=function(){return{showPanel:function(g,b,h,d,f){if(typeof(d)=="undefined"||d==null){d="panel"}if(typeof(f)=="undefined"||f==null){f={width:"540px",modal:true}}var a=new YAHOO.widget.Panel(d,f);a.setHeader(g);a.setBody("Loading...");a.render(document.body);a.center();a.show();if(b!=""){YAHOO.util.Connect.asyncRequest("GET",b,{success:function(j){j.argument.setBody(j.responseText);j.argument.center();if(typeof(h)=="function"){h()}},failure:function(j){alert("Failed to load the specified panel.")},argument:a},null)}return a}}}();Fisma.Util={getObjectFromName:function(g){var d=g.split(".");var f=window;for(piece in d){f=f[d[piece]];if(f==undefined){throw"Specified object does not exist: "+g}}return f}};Fisma.Util={getObjectFromName:function(d){var b=d.split(".");var a=window;for(piece in b){a=a[b[piece]];if(a==undefined){throw"Specified object does not exist: "+d}}return a}};
\ No newline at end of file
+(function(){if(typeof(this.PHP_JS)==="undefined"){var PHP_JS=function(cfgObj){if(!(this instanceof PHP_JS)){return new PHP_JS(cfgObj)}this.window=cfgObj&&cfgObj.window?cfgObj.window:window;this.php_js={};this.php_js.ini={};if(cfgObj){for(var ini in cfgObj.ini){this.php_js.ini[ini]={};this.php_js.ini[ini].local_value=cfgObj.ini[ini];this.php_js.ini[ini].global_value=cfgObj.ini[ini]}}}}var php_js_shared={};PHP_JS.prototype={constructor:PHP_JS,abs:function(mixed_number){return Math.abs(mixed_number)||0},acos:function(arg){return Math.acos(arg)},acosh:function(arg){return Math.log(arg+Math.sqrt(arg*arg-1))},addslashes:function(str){return(str+"").replace(/([\\"'])/g,"\\$1").replace(/\u0000/g,"\\0")},array_change_key_case:function(array){var case_fn,tmp_ar={},argc=arguments.length,argv=arguments,key;if(array instanceof Array){return array}if(array instanceof Object){if(argc===1||argv[1]==="CASE_LOWER"||argv[1]===0){case_fn="toLowerCase"}else{case_fn="toUpperCase"}for(key in array){tmp_ar[key[case_fn]()]=array[key]}return tmp_ar}return false},array_chunk:function(input,size){for(var x,i=0,c=-1,l=input.length,n=[];i<l;i++){(x=i%size)?n[c][x]=input[i]:n[++c]=[input[i]]}return n},array_combine:function(keys,values){var new_array={},keycount=keys&&keys.length,i=0;if(typeof keys!=="object"||typeof values!=="object"||typeof keycount!=="number"||typeof values.length!=="number"||!keycount){return false}if(keycount!=values.length){return false}for(i=0;i<keycount;i++){new_array[keys[i]]=values[i]}return new_array},array_count_values:function(array){var tmp_arr={},key="",t="";var __getType=function(obj){var t=typeof obj;t=t.toLowerCase();if(t=="object"){t="array"}return t};var __countValue=function(value){switch(typeof(value)){case"number":if(Math.floor(value)!=value){return}case"string":if(value in this){++this[value]}else{this[value]=1}}};t=__getType(array);if(t=="array"){for(key in array){__countValue.call(tmp_arr,array[key])}}return tmp_arr},array_diff:function(){var arr1=arguments[0],retArr={};var k1="",i=1,k="",arr={};arr1keys:for(k1 in arr1){for(i=1;i<arguments.length;i++){arr=arguments[i];for(k in arr){if(arr[k]===arr1[k1]){continue arr1keys}}retArr[k1]=arr1[k1]}}return retArr},array_diff_assoc:function(){var arr1=arguments[0],retArr={};var k1="",i=1,k="",arr={};arr1keys:for(k1 in arr1){for(i=1;i<arguments.length;i++){arr=arguments[i];for(k in arr){if(arr[k]===arr1[k1]&&k===k1){continue arr1keys}}retArr[k1]=arr1[k1]}}return retArr},array_diff_key:function(){var arr1=arguments[0],retArr={};var k1="",i=1,k="",arr={};arr1keys:for(k1 in arr1){for(i=1;i<arguments.length;i++){arr=arguments[i];for(k in arr){if(k===k1){continue arr1keys}}retArr[k1]=arr1[k1]}}return retArr},array_diff_uassoc:function(){var arr1=arguments[0],retArr={},cb=arguments[arguments.length-1];var arr={},i=1,k1="",k="";cb=(typeof cb==="string")?this.window[cb]:(cb instanceof Array)?this.window[cb[0]][cb[1]]:cb;arr1keys:for(k1 in arr1){for(i=1;i<arguments.length-1;i++){arr=arguments[i];for(k in arr){if(arr[k]===arr1[k1]&&cb(k,k1)===0){continue arr1keys}}retArr[k1]=arr1[k1]}}return retArr},array_diff_ukey:function(){var arr1=arguments[0],retArr={},cb=arguments[arguments.length-1];var arr={},i=1,k1="",k="";cb=(typeof cb==="string")?this.window[cb]:(cb instanceof Array)?this.window[cb[0]][cb[1]]:cb;arr1keys:for(k1 in arr1){for(i=1;i<arguments.length-1;i++){arr=arguments[i];for(k in arr){if(cb(k,k1)===0){continue arr1keys}}retArr[k1]=arr1[k1]}}return retArr},array_fill:function(start_index,num,mixed_val){var key,tmp_arr={};if(!isNaN(start_index)&&!isNaN(num)){for(key=0;key<num;key++){tmp_arr[(key+start_index)]=mixed_val}}return tmp_arr},array_fill_keys:function(keys,value){var retObj={},key="";for(key in keys){retObj[keys[key]]=value}return retObj},array_filter:function(arr,func){var retObj={},k;for(k in arr){if(func(arr[k])){retObj[k]=arr[k]}}return retObj},array_flip:function(trans){var key,tmp_ar={};for(key in trans){tmp_ar[trans[key]]=key}return tmp_ar},array_intersect:function(){var arr1=arguments[0],retArr={};var k1="",arr={},i=0,k="";arr1keys:for(k1 in arr1){arrs:for(i=1;i<arguments.length;i++){arr=arguments[i];for(k in arr){if(arr[k]===arr1[k1]){if(i===arguments.length-1){retArr[k1]=arr1[k1]}continue arrs}}continue arr1keys}}return retArr},array_intersect_assoc:function(){var arr1=arguments[0],retArr={};var k1="",arr={},i=0,k="";arr1keys:for(k1 in arr1){arrs:for(i=1;i<arguments.length;i++){arr=arguments[i];for(k in arr){if(arr[k]===arr1[k1]&&k===k1){if(i===arguments.length-1){retArr[k1]=arr1[k1]}continue arrs}}continue arr1keys}}return retArr},array_intersect_key:function(){var arr1=arguments[0],retArr={};var k1="",arr={},i=0,k="";arr1keys:for(k1 in arr1){arrs:for(i=1;i<arguments.length;i++){arr=arguments[i];for(k in arr){if(k===k1){if(i===arguments.length-1){retArr[k1]=arr1[k1]}continue arrs}}continue arr1keys}}return retArr},array_intersect_uassoc:function(){var arr1=arguments[0],retArr={},cb=arguments[arguments.length-1];var k1="",i=1,arr={},k="";cb=(typeof cb==="string")?this.window[cb]:(cb instanceof Array)?this.window[cb[0]][cb[1]]:cb;arr1keys:for(k1 in arr1){arrs:for(i=1;i<arguments.length-1;i++){arr=arguments[i];for(k in arr){if(arr[k]===arr1[k1]&&cb(k,k1)===0){if(i===arguments.length-2){retArr[k1]=arr1[k1]}continue arrs}}continue arr1keys}}return retArr},array_intersect_ukey:function(){var arr1=arguments[0],retArr={},cb=arguments[arguments.length-1];var k1="",i=1,arr={},k="";cb=(typeof cb==="string")?this.window[cb]:(cb instanceof Array)?this.window[cb[0]][cb[1]]:cb;arr1keys:for(k1 in arr1){arrs:for(i=1;i<arguments.length-1;i++){arr=arguments[i];for(k in arr){if(cb(k,k1)===0){if(i===arguments.length-2){retArr[k1]=arr1[k1]}continue arrs}}continue arr1keys}}return retArr},array_key_exists:function(key,search){if(!search||(search.constructor!==Array&&search.constructor!==Object)){return false}return key in search},array_keys:function(input,search_value,argStrict){var tmp_arr={},strict=!!argStrict,include=true,cnt=0;var key="";for(key in input){include=true;if(search_value!=undefined){if(strict&&input[key]!==search_value){include=false}else{if(input[key]!=search_value){include=false}}}if(include){tmp_arr[cnt]=key;cnt++}}return tmp_arr},array_map:function(callback){var argc=arguments.length,argv=arguments;var j=argv[1].length,i=0,k=1,m=0;var tmp=[],tmp_ar=[];while(i<j){while(k<argc){tmp[m++]=argv[k++][i]}m=0;k=1;if(callback){if(typeof callback==="string"){callback=this.window[callback]}tmp_ar[i++]=callback.apply(null,tmp)}else{tmp_ar[i++]=tmp}tmp=[]}return tmp_ar},array_merge:function(){var args=Array.prototype.slice.call(arguments);var retObj={},k,j=0,i=0;var retArr;for(i=0,retArr=true;i<args.length;i++){if(!(args[i] instanceof Array)){retArr=false;break}}if(retArr){return args}var ct=0;for(i=0,ct=0;i<args.length;i++){if(args[i] instanceof Array){for(j=0;j<args[i].length;j++){retObj[ct++]=args[i][j]}}else{for(k in args[i]){if(this.is_int(k)){retObj[ct++]=args[i][k]}else{retObj[k]=args[i][k]}}}}return retObj},array_merge_recursive:function(arr1,arr2){var idx="";if((arr1&&(arr1 instanceof Array))&&(arr2&&(arr2 instanceof Array))){for(idx in arr2){arr1.push(arr2[idx])}}else{if((arr1&&(arr1 instanceof Object))&&(arr2&&(arr2 instanceof Object))){for(idx in arr2){if(idx in arr1){if(typeof arr1[idx]=="object"&&typeof arr2=="object"){arr1[idx]=this.array_merge(arr1[idx],arr2[idx])}else{arr1[idx]=arr2[idx]}}else{arr1[idx]=arr2[idx]}}}}return arr1},array_pad:function(input,pad_size,pad_value){var pad=[],newArray=[],newLength,i=0;if(input instanceof Array&&!isNaN(pad_size)){newLength=((pad_size<0)?(pad_size*-1):pad_size);if(newLength>input.length){for(i=0;i<(newLength-input.length);i++){newArray[i]=pad_value}pad=((pad_size<0)?newArray.concat(input):input.concat(newArray))}else{pad=input}}return pad},array_pop:function(inputArr){var key="",lastKey="";if(inputArr.hasOwnProperty("length")){if(!inputArr.length){return null}return inputArr.pop()}else{for(key in inputArr){if(inputArr.hasOwnProperty(key)){lastKey=key}}if(lastKey){var tmp=inputArr[lastKey];delete (inputArr[lastKey]);return tmp}else{return null}}},array_product:function(input){var Index=0,product=1;if(input instanceof Array){while(Index<input.length){product*=(!isNaN(input[Index])?input[Index]:0);Index++}}else{product=null}return product},array_push:function(inputArr){var i=0,pr="",argv=arguments,argc=argv.length,allDigits=/^\d$/,size=0,highestIdx=0,len=0;if(inputArr.hasOwnProperty("length")){for(i=1;i<argc;i++){inputArr[inputArr.length]=argv[i]}return inputArr.length}for(pr in inputArr){if(inputArr.hasOwnProperty(pr)){++len;if(allDigits.test(pr)){size=parseInt(pr,10);highestIdx=size>highestIdx?size:highestIdx}}}for(i=1;i<argc;i++){inputArr[++highestIdx]=argv[i]}return len+i-1},array_rand:function(input,num_req){var indexes=[];var ticks=num_req||1;var checkDuplicate=function(input,value){var exist=false,index=0;while(index<input.length){if(input[index]===value){exist=true;break}index++}return exist};if(input instanceof Array&&ticks<=input.length){while(true){var rand=Math.floor((Math.random()*input.length));if(indexes.length===ticks){break}if(!checkDuplicate(indexes,rand)){indexes.push(rand)}}}else{indexes=null}return((ticks==1)?indexes.join():indexes)},array_reduce:function(a_input,callback){var lon=a_input.length;var res=0,i=0;var tmp=[];for(i=0;i<lon;i+=2){tmp[0]=a_input[i];if(a_input[(i+1)]){tmp[1]=a_input[(i+1)]}else{tmp[1]=0}res+=callback.apply(null,tmp);tmp=[]}return res},array_reverse:function(array,preserve_keys){var arr_len=array.length,newkey=0,tmp_arr={},key="";preserve_keys=!!preserve_keys;for(key in array){newkey=arr_len-key-1;tmp_arr[preserve_keys?key:newkey]=array[key]}return tmp_arr},array_search:function(needle,haystack,argStrict){var strict=!!argStrict;var key="";for(key in haystack){if((strict&&haystack[key]===needle)||(!strict&&haystack[key]==needle)){return key}}return false},array_shift:function(inputArr){var props=false,shift=undefined,pr="",allDigits=/^\d$/,int_ct=-1,_checkToUpIndices=function(arr,ct,key){if(arr[ct]!==undefined){var tmp=ct;ct+=1;if(ct===key){ct+=1}ct=_checkToUpIndices(arr,ct,key);arr[ct]=arr[tmp];delete arr[tmp]}return ct};if(inputArr.length===0){return null}if(inputArr.length>0){return inputArr.shift()}},array_slice:function(arr,offst,lgth,preserve_keys){var key="";if(!(arr instanceof Array)||(preserve_keys&&offst!==0)){var lgt=0,newAssoc={};for(key in arr){lgt+=1;newAssoc[key]=arr[key]}arr=newAssoc;offst=(offst<0)?lgt+offst:offst;lgth=lgth===undefined?lgt:(lgth<0)?lgt+lgth-offst:lgth;var assoc={};var start=false,it=-1,arrlgth=0,no_pk_idx=0;for(key in arr){++it;if(arrlgth>=lgth){break}if(it==offst){start=true}if(!start){continue}++arrlgth;if(this.is_int(key)&&!preserve_keys){assoc[no_pk_idx++]=arr[key]}else{assoc[key]=arr[key]}}return assoc}if(lgth===undefined){return arr.slice(offst)}else{if(lgth>=0){return arr.slice(offst,offst+lgth)}else{return arr.slice(offst,lgth)}}},array_splice:function(arr,offst,lgth,replacement){var _checkToUpIndices=function(arr,ct,key){if(arr[ct]!==undefined){var tmp=ct;ct+=1;if(ct===key){ct+=1}ct=_checkToUpIndices(arr,ct,key);arr[ct]=arr[tmp];delete arr[tmp]}return ct};if(replacement&&typeof replacement!=="object"){replacement=[replacement]}if(lgth===undefined){lgth=offst>=0?arr.length-offst:-offst}else{if(lgth<0){lgth=(offst>=0?arr.length-offst:-offst)+lgth}}if(!(arr instanceof Array)){var lgt=0,ct=-1,rmvd=[],rmvdObj={},repl_ct=-1,int_ct=-1;var returnArr=true,rmvd_ct=0,rmvd_lgth=0,key="";for(key in arr){lgt+=1}offst=(offst>=0)?offst:lgt+offst;for(key in arr){ct+=1;if(ct<offst){if(this.is_int(key)){int_ct+=1;if(parseInt(key,10)===int_ct){continue}_checkToUpIndices(arr,int_ct,key);arr[int_ct]=arr[key];delete arr[key]}continue}if(returnArr&&this.is_int(key)){rmvd.push(arr[key]);rmvdObj[rmvd_ct++]=arr[key]}else{rmvdObj[key]=arr[key];returnArr=false}rmvd_lgth+=1;if(replacement&&replacement[++repl_ct]){arr[key]=replacement[repl_ct]}else{delete arr[key]}}return returnArr?rmvd:rmvdObj}if(replacement){replacement.unshift(offst,lgth);return Array.prototype.splice.apply(arr,replacement)}return arr.splice(offst,lgth)},array_sum:function(array){var key,sum=0;if(typeof array!=="object"){return null}for(key in array){sum+=(array[key]*1)}return sum},array_udiff:function(){var arr1=arguments[0],retArr={},cb=arguments[arguments.length-1];var arr="",i=1,k1="",k="";cb=(typeof cb==="string")?this.window[cb]:(cb instanceof Array)?this.window[cb[0]][cb[1]]:cb;arr1keys:for(k1 in arr1){for(i=1;i<arguments.length-1;i++){arr=arguments[i];for(k in arr){if(cb(arr[k],arr1[k1])===0){continue arr1keys}}retArr[k1]=arr1[k1]}}return retArr},array_udiff_assoc:function(){var arr1=arguments[0],retArr={},cb=arguments[arguments.length-1];var arr={},i=1,k1="",k="";cb=(typeof cb==="string")?this.window[cb]:(cb instanceof Array)?this.window[cb[0]][cb[1]]:cb;arr1keys:for(k1 in arr1){for(i=1;i<arguments.length-1;i++){arr=arguments[i];for(k in arr){if(cb(arr[k],arr1[k1])===0&&k===k1){continue arr1keys}}retArr[k1]=arr1[k1]}}return retArr},array_udiff_uassoc:function(){var arr1=arguments[0],retArr={},cb=arguments[arguments.length-1],cb0=arguments[arguments.length-2];var k1="",i=1,k="",arr={};cb=(typeof cb==="string")?this.window[cb]:(cb instanceof Array)?this.window[cb[0]][cb[1]]:cb;cb0=(typeof cb0==="string")?this.window[cb0]:(cb0 instanceof Array)?this.window[cb0[0]][cb0[1]]:cb0;arr1keys:for(k1 in arr1){for(i=1;i<arguments.length-2;i++){arr=arguments[i];for(k in arr){if(cb0(arr[k],arr1[k1])===0&&cb(k,k1)===0){continue arr1keys}}retArr[k1]=arr1[k1]}}return retArr},array_uintersect:function(){var arr1=arguments[0],retArr={},cb=arguments[arguments.length-1];var k1="",i=1,arr={},k="";cb=(typeof cb==="string")?this.window[cb]:(cb instanceof Array)?this.window[cb[0]][cb[1]]:cb;arr1keys:for(k1 in arr1){arrs:for(i=1;i<arguments.length-1;i++){arr=arguments[i];for(k in arr){if(cb(arr[k],arr1[k1])===0){if(i===arguments.length-2){retArr[k1]=arr1[k1]}continue arrs}}continue arr1keys}}return retArr},array_uintersect_assoc:function(){var arr1=arguments[0],retArr={},cb=arguments[arguments.length-1];var k1="",i=1,arr={},k="";cb=(typeof cb==="string")?this.window[cb]:(cb instanceof Array)?this.window[cb[0]][cb[1]]:cb;arr1keys:for(k1 in arr1){arrs:for(i=1;i<arguments.length-1;i++){arr=arguments[i];for(k in arr){if(cb(arr[k],arr1[k1])===0&&k===k1){if(i===arguments.length-2){retArr[k1]=arr1[k1]}continue arrs}}continue arr1keys}}return retArr},array_uintersect_uassoc:function(){var arr1=arguments[0],retArr={},cb=arguments[arguments.length-1],cb0=arguments[arguments.length-2];var k1="",i=1,k="",arr={};cb=(typeof cb==="string")?this.window[cb]:(cb instanceof Array)?this.window[cb[0]][cb[1]]:cb;cb0=(typeof cb0==="string")?this.window[cb0]:(cb0 instanceof Array)?this.window[cb0[0]][cb0[1]]:cb0;arr1keys:for(k1 in arr1){arrs:for(i=1;i<arguments.length-2;i++){arr=arguments[i];for(k in arr){if(cb0(arr[k],arr1[k1])===0&&cb(k,k1)===0){if(i===arguments.length-3){retArr[k1]=arr1[k1]}continue arrs}}continue arr1keys}}return retArr},array_unique:function(inputArr){var key="",tmp_arr2={},val="";var __array_search=function(needle,haystack){var fkey="";for(fkey in haystack){if(haystack.hasOwnProperty){if((haystack[fkey]+"")===(needle+"")){return fkey}}}return false};for(key in inputArr){if(inputArr.hasOwnProperty){val=inputArr[key];if(false===__array_search(val,tmp_arr2)){tmp_arr2[key]=val}}}return tmp_arr2},array_unshift:function(array){var argc=arguments.length,argv=arguments,i;for(i=1;i<argc;i++){array.unshift(argv[i])}return(array.length)},array_values:function(input){var tmp_arr=[],cnt=0;var key="";for(key in input){tmp_arr[cnt]=input[key];cnt++}return tmp_arr},array_walk:function(array,funcname,userdata){var key;if(typeof array!=="object"||array===null){return false}for(key in array){if(typeof(userdata)!=="undefined"){eval(funcname+"( array [key] , key , userdata  )")}else{eval(funcname+"(  userdata ) ")}}return true},array_walk_recursive:function(array,funcname,userdata){var key;if(typeof array!="object"){return false}for(key in array){if(typeof array[key]=="object"){return this.array_walk_recursive(array[key],funcname,userdata)}if(typeof(userdata)!="undefined"){eval(funcname+"( array [key] , key , userdata  )")}else{eval(funcname+"(  userdata ) ")}}return true},arsort:function(inputArr,sort_flags){var valArr=[],keyArr=[],k,i,ret,sorter,that=this,strictForIn=false,populateArr=[];switch(sort_flags){case"SORT_STRING":sorter=function(a,b){return that.strnatcmp(b,a)};break;case"SORT_LOCALE_STRING":var loc=this.i18n_loc_get_default();sorter=this.php_js.i18nLocales[loc].sorting;break;case"SORT_NUMERIC":sorter=function(a,b){return(a-b)};break;case"SORT_REGULAR":default:sorter=function(a,b){if(a>b){return 1}if(a<b){return -1}return 0};break}var bubbleSort=function(keyArr,inputArr){var i,j,tempValue,tempKeyVal;for(i=inputArr.length-2;i>=0;i--){for(j=0;j<=i;j++){ret=sorter(inputArr[j+1],inputArr[j]);if(ret>0){tempValue=inputArr[j];inputArr[j]=inputArr[j+1];inputArr[j+1]=tempValue;tempKeyVal=keyArr[j];keyArr[j]=keyArr[j+1];keyArr[j+1]=tempKeyVal}}}};this.php_js=this.php_js||{};this.php_js.ini=this.php_js.ini||{};strictForIn=this.php_js.ini["phpjs.strictForIn"]&&this.php_js.ini["phpjs.strictForIn"].local_value;populateArr=strictForIn?inputArr:populateArr;for(k in inputArr){if(inputArr.hasOwnProperty){valArr.push(inputArr[k]);keyArr.push(k);if(strictForIn){delete inputArr[k]}}}try{bubbleSort(keyArr,valArr)}catch(e){return false}for(i=0;i<valArr.length;i++){populateArr[keyArr[i]]=valArr[i]}return strictForIn?true:populateArr},asin:function(arg){return Math.asin(arg)},asinh:function(arg){return Math.log(arg+Math.sqrt(arg*arg+1))},asort:function(inputArr,sort_flags){var valArr=[],keyArr=[],k,i,ret,sorter,that=this,strictForIn=false,populateArr=[];switch(sort_flags){case"SORT_STRING":sorter=function(a,b){return that.strnatcmp(a,b)};break;case"SORT_LOCALE_STRING":var loc=this.i18n_loc_get_default();sorter=this.php_js.i18nLocales[loc].sorting;break;case"SORT_NUMERIC":sorter=function(a,b){return(a-b)};break;case"SORT_REGULAR":default:sorter=function(a,b){if(a>b){return 1}if(a<b){return -1}return 0};break}var bubbleSort=function(keyArr,inputArr){var i,j,tempValue,tempKeyVal;for(i=inputArr.length-2;i>=0;i--){for(j=0;j<=i;j++){ret=sorter(inputArr[j+1],inputArr[j]);if(ret<0){tempValue=inputArr[j];inputArr[j]=inputArr[j+1];inputArr[j+1]=tempValue;tempKeyVal=keyArr[j];keyArr[j]=keyArr[j+1];keyArr[j+1]=tempKeyVal}}}};this.php_js=this.php_js||{};this.php_js.ini=this.php_js.ini||{};strictForIn=this.php_js.ini["phpjs.strictForIn"]&&this.php_js.ini["phpjs.strictForIn"].local_value;populateArr=strictForIn?inputArr:populateArr;for(k in inputArr){if(inputArr.hasOwnProperty){valArr.push(inputArr[k]);keyArr.push(k);if(strictForIn){delete inputArr[k]}}}try{bubbleSort(keyArr,valArr)}catch(e){return false}for(i=0;i<valArr.length;i++){populateArr[keyArr[i]]=valArr[i]}return strictForIn?true:populateArr},atan:function(arg){return Math.atan(arg)},atan2:function(y,x){return Math.atan2(y,x)},atanh:function(arg){return 0.5*Math.log((1+arg)/(1-arg))},base64_decode:function(data){var b64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var o1,o2,o3,h1,h2,h3,h4,bits,i=0,ac=0,dec="",tmp_arr=[];if(!data){return data}data+="";do{h1=b64.indexOf(data.charAt(i++));h2=b64.indexOf(data.charAt(i++));h3=b64.indexOf(data.charAt(i++));h4=b64.indexOf(data.charAt(i++));bits=h1<<18|h2<<12|h3<<6|h4;o1=bits>>16&255;o2=bits>>8&255;o3=bits&255;if(h3==64){tmp_arr[ac++]=String.fromCharCode(o1)}else{if(h4==64){tmp_arr[ac++]=String.fromCharCode(o1,o2)}else{tmp_arr[ac++]=String.fromCharCode(o1,o2,o3)}}}while(i<data.length);dec=tmp_arr.join("");dec=this.utf8_decode(dec);return dec},base64_encode:function(data){var b64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var o1,o2,o3,h1,h2,h3,h4,bits,i=0,ac=0,enc="",tmp_arr=[];if(!data){return data}data=this.utf8_encode(data+"");do{o1=data.charCodeAt(i++);o2=data.charCodeAt(i++);o3=data.charCodeAt(i++);bits=o1<<16|o2<<8|o3;h1=bits>>18&63;h2=bits>>12&63;h3=bits>>6&63;h4=bits&63;tmp_arr[ac++]=b64.charAt(h1)+b64.charAt(h2)+b64.charAt(h3)+b64.charAt(h4)}while(i<data.length);enc=tmp_arr.join("");switch(data.length%3){case 1:enc=enc.slice(0,-2)+"==";break;case 2:enc=enc.slice(0,-1)+"=";break}return enc},base_convert:function(number,frombase,tobase){return parseInt(number+"",frombase+0).toString(tobase+0)},bin2hex:function(s){var i,f=0,a=[];s+="";f=s.length;for(i=0;i<f;i++){a[i]=s.charCodeAt(i).toString(16).replace(/^([\da-f])$/,"0$1")}return a.join("")},bindec:function(binary_string){binary_string=(binary_string+"").replace(/[^01]/gi,"");return parseInt(binary_string,2)},ceil:function(value){return Math.ceil(value)},checkdate:function(m,d,y){return m>0&&m<13&&y>0&&y<32768&&d>0&&d<=(new Date(y,m,0)).getDate()},chop:function(str,charlist){return this.rtrim(str,charlist)},chr:function(codePt){if(codePt>65535){codePt-=65536;return String.fromCharCode(55296+(codePt>>10),56320+(codePt&1023))}else{return String.fromCharCode(codePt)}},chunk_split:function(body,chunklen,end){chunklen=parseInt(chunklen,10)||76;end=end||"\r\n";if(chunklen<1){return false}return body.match(new RegExp(".{0,"+chunklen+"}","g")).join(end)},class_exists:function(cls){var i="";cls=this.window[cls];if(typeof cls!=="function"){return false}for(i in cls.prototype){return true}for(i in cls){if(i!=="prototype"){return true}}if(cls.toSource&&cls.toSource().match(/this\./)){return true}return false},compact:function(){var matrix={},that=this;var process=function(value){var i=0,l=value.length,key_value="";for(i=0;i<l;i++){key_value=value[i];if(key_value instanceof Array){process(key_value)}else{if(typeof that.window[key_value]!=="undefined"){matrix[key_value]=that.window[key_value]}}}return true};process(arguments);return matrix},cos:function(arg){return Math.cos(arg)},cosh:function(arg){return(Math.exp(arg)+Math.exp(-arg))/2},count:function(mixed_var,mode){var key,cnt=0;if(mixed_var===null){return 0}else{if(mixed_var.constructor!==Array&&mixed_var.constructor!==Object){return 1}}if(mode==="COUNT_RECURSIVE"){mode=1}if(mode!=1){mode=0}for(key in mixed_var){cnt++;if(mode==1&&mixed_var[key]&&(mixed_var[key].constructor===Array||mixed_var[key].constructor===Object)){cnt+=this.count(mixed_var[key],1)}}return cnt},count_chars:function(str,mode){var result={},resultArr=[],i;str=(""+str).split("").sort().join("").match(/(.)\1*/g);if((mode&1)==0){for(i=0;i!=256;i++){result[i]=0}}if(mode===2||mode===4){for(i=0;i!=str.length;i+=1){delete result[str[i].charCodeAt(0)]}for(i in result){result[i]=(mode===4)?String.fromCharCode(i):0}}else{if(mode===3){for(i=0;i!=str.length;i+=1){result[i]=str[i].slice(0,1)}}else{for(i=0;i!=str.length;i+=1){result[str[i].charCodeAt(0)]=str[i].length}}}if(mode<3){return result}for(i in result){resultArr.push(result[i])}return resultArr.join("")},crc32:function(str){str=this.utf8_encode(str);var table="00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D";var crc=0;var x=0;var y=0;crc=crc^(-1);for(var i=0,iTop=str.length;i<iTop;i++){y=(crc^str.charCodeAt(i))&255;x="0x"+table.substr(y*9,8);crc=(crc>>>8)^x}return crc^(-1)},date:function(format,timestamp){var that=this,jsdate,f,formatChr=/\\?([a-z])/gi,formatChrCb,_pad=function(n,c){if((n=n+"").length<c){return new Array((++c)-n.length).join("0")+n}else{return n}},txt_words=["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur","January","February","March","April","May","June","July","August","September","October","November","December"],txt_ordin={1:"st",2:"nd",3:"rd",21:"st",22:"nd",23:"rd",31:"st"};formatChrCb=function(t,s){return f[t]?f[t]():s};f={d:function(){return _pad(f.j(),2)},D:function(){return f.l().slice(0,3)},j:function(){return jsdate.getDate()},l:function(){return txt_words[f.w()]+"day"},N:function(){return f.w()||7},S:function(){return txt_ordin[f.j()]||"th"},w:function(){return jsdate.getDay()},z:function(){var a=new Date(f.Y(),f.n()-1,f.j()),b=new Date(f.Y(),0,1);return Math.round((a-b)/86400000)+1},W:function(){var a=new Date(f.Y(),f.n()-1,f.j()-f.N()+3),b=new Date(a.getFullYear(),0,4);return 1+Math.round((a-b)/86400000/7)},F:function(){return txt_words[6+f.n()]},m:function(){return _pad(f.n(),2)},M:function(){return f.F().slice(0,3)},n:function(){return jsdate.getMonth()+1},t:function(){return(new Date(f.Y(),f.n(),0)).getDate()},L:function(){var y=f.Y(),a=y&3,b=y%400,c=y%100;return 0+(!a&&(c||!b))},o:function(){var n=f.n(),W=f.W(),Y=f.Y();return Y+(n===12&&W<9?-1:n===1&&W>9)},Y:function(){return jsdate.getFullYear()},y:function(){return(f.Y()+"").slice(-2)},a:function(){return jsdate.getHours()>11?"pm":"am"},A:function(){return f.a().toUpperCase()},B:function(){var H=jsdate.getUTCHours()*3600,i=jsdate.getUTCMinutes()*60,s=jsdate.getUTCSeconds();return _pad(Math.floor((H+i+s+3600)/86.4)%1000,3)},g:function(){return f.G()%12||12},G:function(){return jsdate.getHours()},h:function(){return _pad(f.g(),2)},H:function(){return _pad(f.G(),2)},i:function(){return _pad(jsdate.getMinutes(),2)},s:function(){return _pad(jsdate.getSeconds(),2)},u:function(){return _pad(jsdate.getMilliseconds()*1000,6)},e:function(){return"UTC"},I:function(){var a=new Date(f.Y(),0),c=Date.UTC(f.Y(),0),b=new Date(f.Y(),6),d=Date.UTC(f.Y(),6);return 0+((a-c)!==(b-d))},O:function(){var a=jsdate.getTimezoneOffset();return(a>0?"-":"+")+_pad(Math.abs(a/60*100),4)},P:function(){var O=f.O();return(O.substr(0,3)+":"+O.substr(3,2))},T:function(){return"UTC"},Z:function(){return -jsdate.getTimezoneOffset()*60},c:function(){return"Y-m-d\\Th:i:sP".replace(formatChr,formatChrCb)},r:function(){return"D, d M Y H:i:s O".replace(formatChr,formatChrCb)},U:function(){return Math.round(jsdate.getTime()/1000)}};this.date=function(format,timestamp){that=this;jsdate=((typeof timestamp==="undefined")?new Date():(timestamp instanceof Date)?new Date(timestamp):new Date(timestamp*1000));return format.replace(formatChr,formatChrCb)};return this.date(format,timestamp)},decbin:function(number){if(number<0){number=4294967295+number+1}return parseInt(number,10).toString(2)},dechex:function(number){if(number<0){number=4294967295+number+1}return parseInt(number,10).toString(16)},decoct:function(number){if(number<0){number=4294967295+number+1}return parseInt(number,10).toString(8)},deg2rad:function(angle){return(angle/180)*Math.PI},doubleval:function(mixed_var){return this.floatval(mixed_var)},echo:function(){var arg="",argc=arguments.length,argv=arguments,i=0;var win=this.window;var d=win.document;var ns_xhtml="http://www.w3.org/1999/xhtml";var ns_xul="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul";var holder;var stringToDOM=function(str,parent,ns,container){var extraNSs="";if(ns===ns_xul){extraNSs=' xmlns:html="'+ns_xhtml+'"'}var stringContainer="<"+container+' xmlns="'+ns+'"'+extraNSs+">"+str+"</"+container+">";if(win.DOMImplementationLS&&win.DOMImplementationLS.createLSInput&&win.DOMImplementationLS.createLSParser){var lsInput=DOMImplementationLS.createLSInput();lsInput.stringData=stringContainer;var lsParser=DOMImplementationLS.createLSParser(1,null);return lsParser.parse(lsInput).firstChild}else{if(win.DOMParser){return new DOMParser().parseFromString(stringContainer,"text/xml").documentElement.firstChild}else{if(win.ActiveXObject){var d=new ActiveXObject("MSXML2.DOMDocument");d.loadXML(str);return d.documentElement}else{if(d.createElementNS&&d.documentElement.namespaceURI&&(d.documentElement.namespaceURI!==null||d.documentElement.nodeName.toLowerCase()!=="html"||(d.contentType&&d.contentType!=="text/html"))){holder=d.createElementNS(ns,container)}else{holder=d.createElement(container)}holder.innerHTML=str;while(holder.firstChild){parent.appendChild(holder.firstChild)}return false}}}};var ieFix=function(node){if(node.nodeType===1){var newNode=d.createElement(node.nodeName);var i,len;if(node.attributes&&node.attributes.length>0){for(i=0,len=node.attributes.length;i<len;i++){newNode.setAttribute(node.attributes[i].nodeName,node.getAttribute(node.attributes[i].nodeName))}}if(node.childNodes&&node.childNodes.length>0){for(i=0,len=node.childNodes.length;i<len;i++){newNode.appendChild(ieFix(node.childNodes[i]))}}return newNode}else{return d.createTextNode(node.nodeValue)}};for(i=0;i<argc;i++){arg=argv[i];if(this.php_js&&this.php_js.ini&&this.php_js.ini["phpjs.echo_embedded_vars"]){arg=arg.replace(/(.?)\{\$(.*?)\}/g,function(s,m1,m2){if(m1!=="\\"){return m1+eval(m2)}else{return s}})}if(d.appendChild){if(d.body){if(win.navigator.appName=="Microsoft Internet Explorer"){d.body.appendChild(stringToDOM(ieFix(arg)))}else{var unappendedLeft=stringToDOM(arg,d.body,ns_xhtml,"div").cloneNode(true);if(unappendedLeft){d.body.appendChild(unappendedLeft)}}}else{d.documentElement.appendChild(stringToDOM(arg,d.documentElement,ns_xul,"description"))}}else{if(d.write){d.write(arg)}}}},end:function(arr){this.php_js=this.php_js||{};this.php_js.pointers=this.php_js.pointers||[];var indexOf=function(value){for(var i=0,length=this.length;i<length;i++){if(this[i]===value){return i}}return -1};var pointers=this.php_js.pointers;if(!pointers.indexOf){pointers.indexOf=indexOf}if(pointers.indexOf(arr)===-1){pointers.push(arr,0)}var arrpos=pointers.indexOf(arr);if(!(arr instanceof Array)){var ct=0;for(var k in arr){ct++;var val=arr[k]}if(ct===0){return false}pointers[arrpos+1]=ct-1;return val}if(arr.length===0){return false}pointers[arrpos+1]=arr.length-1;return arr[pointers[arrpos+1]]},exp:function(arg){return Math.exp(arg)},explode:function(delimiter,string,limit){var emptyArray={0:""};if(arguments.length<2||typeof arguments[0]=="undefined"||typeof arguments[1]=="undefined"){return null}if(delimiter===""||delimiter===false||delimiter===null){return false}if(typeof delimiter=="function"||typeof delimiter=="object"||typeof string=="function"||typeof string=="object"){return emptyArray}if(delimiter===true){delimiter="1"}if(!limit){return string.toString().split(delimiter.toString())}else{var splitted=string.toString().split(delimiter.toString());var partA=splitted.splice(0,limit-1);var partB=splitted.join(delimiter.toString());partA.push(partB);return partA}},expm1:function(x){var ret=0,n=50;var factorial=function factorial(n){if((n===0)||(n===1)){return 1}else{var result=(n*factorial(n-1));return result}};for(var i=1;i<n;i++){ret+=Math.pow(x,i)/factorial(i)}return ret},floatval:function(mixed_var){return(parseFloat(mixed_var)||0)},floor:function(value){return Math.floor(value)},fmod:function(x,y){var tmp,tmp2,p=0,pY=0,l=0,l2=0;tmp=x.toExponential().match(/^.\.?(.*)e(.+)$/);p=parseInt(tmp[2],10)-(tmp[1]+"").length;tmp=y.toExponential().match(/^.\.?(.*)e(.+)$/);pY=parseInt(tmp[2],10)-(tmp[1]+"").length;if(pY>p){p=pY}tmp2=(x%y);if(p<-100||p>20){l=Math.round(Math.log(tmp2)/Math.log(10));l2=Math.pow(10,l);return(tmp2/l2).toFixed(l-p)*l2}else{return parseFloat(tmp2.toFixed(-p))}},get_class:function(obj){if(obj instanceof Object&&!(obj instanceof Array)&&!(obj instanceof Function)&&obj.constructor&&obj!=this.window){var arr=obj.constructor.toString().match(/function\s*(\w+)/);if(arr&&arr.length==2){return arr[1]}}return false},get_defined_vars:function(){var i="",arr=[],already={};for(i in this.window){try{if(typeof this.window[i]==="function"){if(!already[i]){already[i]=1;arr.push(i)}}else{if(typeof this.window[i]==="object"){for(var j in this.window[i]){if(typeof this.window[j]==="function"&&this.window[j]&&!already[j]){already[j]=1;arr.push(j)}}}}}catch(e){}}return arr},get_headers:function(url,format){var req=this.window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest();if(!req){throw new Error("XMLHttpRequest not supported")}var tmp,headers,pair,i,j=0;req.open("HEAD",url,false);req.send(null);if(req.readyState<3){return false}tmp=req.getAllResponseHeaders();tmp=tmp.split("\n");tmp=this.array_filter(tmp,function(value){return value.substring(1)!==""});headers=format?{}:[];for(i in tmp){if(format){pair=tmp[i].split(":");headers[pair.splice(0,1)]=pair.join(":").substring(1)}else{headers[j++]=tmp[i]}}return headers},get_html_translation_table:function(table,quote_style){var entities={},hash_map={},decimal=0,symbol="";var constMappingTable={},constMappingQuoteStyle={};var useTable={},useQuoteStyle={};constMappingTable[0]="HTML_SPECIALCHARS";constMappingTable[1]="HTML_ENTITIES";constMappingQuoteStyle[0]="ENT_NOQUOTES";constMappingQuoteStyle[2]="ENT_COMPAT";constMappingQuoteStyle[3]="ENT_QUOTES";useTable=!isNaN(table)?constMappingTable[table]:table?table.toUpperCase():"HTML_SPECIALCHARS";useQuoteStyle=!isNaN(quote_style)?constMappingQuoteStyle[quote_style]:quote_style?quote_style.toUpperCase():"ENT_COMPAT";if(useTable!=="HTML_SPECIALCHARS"&&useTable!=="HTML_ENTITIES"){throw new Error("Table: "+useTable+" not supported")}entities["38"]="&amp;";if(useTable==="HTML_ENTITIES"){entities["160"]="&nbsp;";entities["161"]="&iexcl;";entities["162"]="&cent;";entities["163"]="&pound;";entities["164"]="&curren;";entities["165"]="&yen;";entities["166"]="&brvbar;";entities["167"]="&sect;";entities["168"]="&uml;";entities["169"]="&copy;";entities["170"]="&ordf;";entities["171"]="&laquo;";entities["172"]="&not;";entities["173"]="&shy;";entities["174"]="&reg;";entities["175"]="&macr;";entities["176"]="&deg;";entities["177"]="&plusmn;";entities["178"]="&sup2;";entities["179"]="&sup3;";entities["180"]="&acute;";entities["181"]="&micro;";entities["182"]="&para;";entities["183"]="&middot;";entities["184"]="&cedil;";entities["185"]="&sup1;";entities["186"]="&ordm;";entities["187"]="&raquo;";entities["188"]="&frac14;";entities["189"]="&frac12;";entities["190"]="&frac34;";entities["191"]="&iquest;";entities["192"]="&Agrave;";entities["193"]="&Aacute;";entities["194"]="&Acirc;";entities["195"]="&Atilde;";entities["196"]="&Auml;";entities["197"]="&Aring;";entities["198"]="&AElig;";entities["199"]="&Ccedil;";entities["200"]="&Egrave;";entities["201"]="&Eacute;";entities["202"]="&Ecirc;";entities["203"]="&Euml;";entities["204"]="&Igrave;";entities["205"]="&Iacute;";entities["206"]="&Icirc;";entities["207"]="&Iuml;";entities["208"]="&ETH;";entities["209"]="&Ntilde;";entities["210"]="&Ograve;";entities["211"]="&Oacute;";entities["212"]="&Ocirc;";entities["213"]="&Otilde;";entities["214"]="&Ouml;";entities["215"]="&times;";entities["216"]="&Oslash;";entities["217"]="&Ugrave;";entities["218"]="&Uacute;";entities["219"]="&Ucirc;";entities["220"]="&Uuml;";entities["221"]="&Yacute;";entities["222"]="&THORN;";entities["223"]="&szlig;";entities["224"]="&agrave;";entities["225"]="&aacute;";entities["226"]="&acirc;";entities["227"]="&atilde;";entities["228"]="&auml;";entities["229"]="&aring;";entities["230"]="&aelig;";entities["231"]="&ccedil;";entities["232"]="&egrave;";entities["233"]="&eacute;";entities["234"]="&ecirc;";entities["235"]="&euml;";entities["236"]="&igrave;";entities["237"]="&iacute;";entities["238"]="&icirc;";entities["239"]="&iuml;";entities["240"]="&eth;";entities["241"]="&ntilde;";entities["242"]="&ograve;";entities["243"]="&oacute;";entities["244"]="&ocirc;";entities["245"]="&otilde;";entities["246"]="&ouml;";entities["247"]="&divide;";entities["248"]="&oslash;";entities["249"]="&ugrave;";entities["250"]="&uacute;";entities["251"]="&ucirc;";entities["252"]="&uuml;";entities["253"]="&yacute;";entities["254"]="&thorn;";entities["255"]="&yuml;"}if(useQuoteStyle!=="ENT_NOQUOTES"){entities["34"]="&quot;"}if(useQuoteStyle==="ENT_QUOTES"){entities["39"]="&#39;"}entities["60"]="&lt;";entities["62"]="&gt;";for(decimal in entities){symbol=String.fromCharCode(decimal);hash_map[symbol]=entities[decimal]}return hash_map},getdate:function(timestamp){var _w=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var _m=["January","February","March","April","May","June","July","August","September","October","November","December"];var d=((typeof(timestamp)=="undefined")?new Date():(typeof(timestamp)=="object")?new Date(timestamp):new Date(timestamp*1000));var w=d.getDay();var m=d.getMonth();var y=d.getFullYear();var r={};r.seconds=d.getSeconds();r.minutes=d.getMinutes();r.hours=d.getHours();r.mday=d.getDate();r.wday=w;r.mon=m+1;r.year=y;r.yday=Math.floor((d-(new Date(y,0,1)))/86400000);r.weekday=_w[w];r.month=_m[m];r["0"]=parseInt(d.getTime()/1000,10);return r},getrandmax:function(){return 2147483647},hexdec:function(hex_string){hex_string=(hex_string+"").replace(/[^a-f0-9]/gi,"");return parseInt(hex_string,16)},html_entity_decode:function(string,quote_style){var hash_map={},symbol="",tmp_str="",entity="";tmp_str=string.toString();if(false===(hash_map=this.get_html_translation_table("HTML_ENTITIES",quote_style))){return false}delete (hash_map["&"]);hash_map["&"]="&amp;";for(symbol in hash_map){entity=hash_map[symbol];tmp_str=tmp_str.split(entity).join(symbol)}tmp_str=tmp_str.split("&#039;").join("'");return tmp_str},htmlentities:function(string,quote_style){var hash_map={},symbol="",tmp_str="",entity="";tmp_str=string.toString();if(false===(hash_map=this.get_html_translation_table("HTML_ENTITIES",quote_style))){return false}hash_map["'"]="&#039;";for(symbol in hash_map){entity=hash_map[symbol];tmp_str=tmp_str.split(symbol).join(entity)}return tmp_str},htmlspecialchars:function(string,quote_style,charset,double_encode){var optTemp=0,i=0,noquotes=false;if(typeof quote_style==="undefined"||quote_style===null){quote_style=2}string=string.toString();if(double_encode!==false){string=string.replace(/&/g,"&amp;")}string=string.replace(/</g,"&lt;").replace(/>/g,"&gt;");var OPTS={ENT_NOQUOTES:0,ENT_HTML_QUOTE_SINGLE:1,ENT_HTML_QUOTE_DOUBLE:2,ENT_COMPAT:2,ENT_QUOTES:3,ENT_IGNORE:4};if(quote_style===0){noquotes=true}if(typeof quote_style!=="number"){quote_style=[].concat(quote_style);for(i=0;i<quote_style.length;i++){if(OPTS[quote_style[i]]===0){noquotes=true}else{if(OPTS[quote_style[i]]){optTemp=optTemp|OPTS[quote_style[i]]}}}quote_style=optTemp}if(quote_style&OPTS.ENT_HTML_QUOTE_SINGLE){string=string.replace(/'/g,"&#039;")}if(!noquotes){string=string.replace(/"/g,"&quot;")}return string},htmlspecialchars_decode:function(string,quote_style){var optTemp=0,i=0,noquotes=false;if(typeof quote_style==="undefined"){quote_style=2}string=string.toString().replace(/&lt;/g,"<").replace(/&gt;/g,">");var OPTS={ENT_NOQUOTES:0,ENT_HTML_QUOTE_SINGLE:1,ENT_HTML_QUOTE_DOUBLE:2,ENT_COMPAT:2,ENT_QUOTES:3,ENT_IGNORE:4};if(quote_style===0){noquotes=true}if(typeof quote_style!=="number"){quote_style=[].concat(quote_style);for(i=0;i<quote_style.length;i++){if(OPTS[quote_style[i]]===0){noquotes=true}else{if(OPTS[quote_style[i]]){optTemp=optTemp|OPTS[quote_style[i]]}}}quote_style=optTemp}if(quote_style&OPTS.ENT_HTML_QUOTE_SINGLE){string=string.replace(/&#0*39;/g,"'")}if(!noquotes){string=string.replace(/&quot;/g,'"')}string=string.replace(/&amp;/g,"&");return string},http_build_query:function(formdata,numeric_prefix,arg_separator){var value,key,tmp=[];var _http_build_query_helper=function(key,val,arg_separator){var k,tmp=[];if(val===true){val="1"}else{if(val===false){val="0"}}if(val!==null&&typeof(val)==="object"){for(k in val){if(val[k]!==null){tmp.push(_http_build_query_helper(key+"["+k+"]",val[k],arg_separator))}}return tmp.join(arg_separator)}else{if(typeof(val)!=="function"){return this.urlencode(key)+"="+this.urlencode(val)}else{throw new Error("There was an error processing for http_build_query().")}}};if(!arg_separator){arg_separator="&"}for(key in formdata){value=formdata[key];if(numeric_prefix&&!isNaN(key)){key=String(numeric_prefix)+key}tmp.push(_http_build_query_helper(key,value,arg_separator))}return tmp.join(arg_separator)},hypot:function(x,y){return Math.sqrt(x*x+y*y)||0},implode:function(glue,pieces){var i="",retVal="",tGlue="";if(arguments.length===1){pieces=glue;glue=""}if(typeof(pieces)==="object"){if(pieces instanceof Array){return pieces.join(glue)}else{for(i in pieces){retVal+=tGlue+pieces[i];tGlue=glue}return retVal}}else{return pieces}},in_array:function(needle,haystack,argStrict){var key="",strict=!!argStrict;if(strict){for(key in haystack){if(haystack[key]===needle){return true}}}else{for(key in haystack){if(haystack[key]==needle){return true}}}return false},intval:function(mixed_var,base){var tmp;var type=typeof(mixed_var);if(type==="boolean"){return(mixed_var)?1:0}else{if(type==="string"){tmp=parseInt(mixed_var,base||10);return(isNaN(tmp)||!isFinite(tmp))?0:tmp}else{if(type==="number"&&isFinite(mixed_var)){return Math.floor(mixed_var)}else{return 0}}}},ip2long:function(IP){var i=0;IP=IP.match(/^([1-9]\d*|0[0-7]*|0x[\da-f]+)(?:\.([1-9]\d*|0[0-7]*|0x[\da-f]+))?(?:\.([1-9]\d*|0[0-7]*|0x[\da-f]+))?(?:\.([1-9]\d*|0[0-7]*|0x[\da-f]+))?$/i);if(!IP){return false}IP[0]=0;for(i=1;i<5;i+=1){IP[0]+=!!((IP[i]||"").length);IP[i]=parseInt(IP[i])||0}IP.push(256,256,256,256);IP[4+IP[0]]*=Math.pow(256,4-IP[0]);if(IP[1]>=IP[5]||IP[2]>=IP[6]||IP[3]>=IP[7]||IP[4]>=IP[8]){return false}return IP[1]*(IP[0]===1||16777216)+IP[2]*(IP[0]<=2||65536)+IP[3]*(IP[0]<=3||256)+IP[4]*1},is_bool:function(mixed_var){return(typeof mixed_var==="boolean")},is_double:function(mixed_var){return this.is_float(mixed_var)},is_finite:function(val){var warningType="";if(val===Infinity||val===-Infinity){return false}if(typeof val=="object"){warningType=(val instanceof Array?"array":"object")}else{if(typeof val=="string"&&!val.match(/^[\+\-]?\d/)){warningType="string"}}if(warningType){throw new Error("Warning: is_finite() expects parameter 1 to be double, "+warningType+" given")}return true},is_float:function(mixed_var){if(typeof mixed_var!=="number"){return false}return !!(mixed_var%1)},is_infinite:function(val){var warningType="";if(val===Infinity||val===-Infinity){return true}if(typeof val=="object"){warningType=(val instanceof Array?"array":"object")}else{if(typeof val=="string"&&!val.match(/^[\+\-]?\d/)){warningType="string"}}if(warningType){throw new Error("Warning: is_infinite() expects parameter 1 to be double, "+warningType+" given")}return false},is_int:function(mixed_var){if(typeof mixed_var!=="number"){return false}return !(mixed_var%1)},is_integer:function(mixed_var){return this.is_int(mixed_var)},is_long:function(mixed_var){return this.is_float(mixed_var)},is_nan:function(val){var warningType="";if(typeof val=="number"&&isNaN(val)){return true}if(typeof val=="object"){warningType=(val instanceof Array?"array":"object")}else{if(typeof val=="string"&&!val.match(/^[\+\-]?\d/)){warningType="string"}}if(warningType){throw new Error("Warning: is_nan() expects parameter 1 to be double, "+warningType+" given")}return false},is_null:function(mixed_var){return(mixed_var===null)},is_numeric:function(mixed_var){return(typeof(mixed_var)==="number"||typeof(mixed_var)==="string")&&mixed_var!==""&&!isNaN(mixed_var)},is_real:function(mixed_var){return this.is_float(mixed_var)},is_scalar:function(mixed_var){return(/boolean|number|string/).test(typeof mixed_var)},is_string:function(mixed_var){return(typeof(mixed_var)=="string")},join:function(glue,pieces){return this.implode(glue,pieces)},json_decode:function(str_json){var json=this.window.JSON;if(typeof json==="object"&&typeof json.parse==="function"){try{return json.parse(str_json)}catch(err){if(!(err instanceof SyntaxError)){throw new Error("Unexpected error type in json_decode()")}this.php_js=this.php_js||{};this.php_js.last_error_json=4;return null}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;var j;var text=str_json;cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if((/^[\],:{}\s]*$/).test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return j}this.php_js=this.php_js||{};this.php_js.last_error_json=4;return null},json_encode:function(mixed_val){var retVal,json=this.window.JSON;try{if(typeof json==="object"&&typeof json.stringify==="function"){retVal=json.stringify(mixed_val);if(retVal===undefined){throw new SyntaxError("json_encode")}return retVal}var value=mixed_val;var quote=function(string){var escapable=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;var meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'};var str=function(key,holder){var gap="";var indent="    ";var i=0;var k="";var v="";var length=0;var mind=gap;var partial=[];var value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}if(value instanceof PHPJS_Resource){throw new SyntaxError("json_encode")}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v;case"undefined":case"function":default:throw new SyntaxError("json_encode")}};return str("",{"":value})}catch(err){if(!(err instanceof SyntaxError)){throw new Error("Unexpected error type in json_encode()")}this.php_js=this.php_js||{};this.php_js.last_error_json=4;return null}},krsort:function(inputArr,sort_flags){var tmp_arr={},keys=[],sorter,i,k,that=this,strictForIn=false,populateArr=[];switch(sort_flags){case"SORT_STRING":sorter=function(a,b){return that.strnatcmp(b,a)};break;case"SORT_LOCALE_STRING":var loc=this.i18n_loc_get_default();sorter=this.php_js.i18nLocales[loc].sorting;break;case"SORT_NUMERIC":sorter=function(a,b){return(b-a)};break;case"SORT_REGULAR":default:sorter=function(a,b){if(a<b){return 1}if(a>b){return -1}return 0};break}for(k in inputArr){if(inputArr.hasOwnProperty){keys.push(k)}}keys.sort(sorter);this.php_js=this.php_js||{};this.php_js.ini=this.php_js.ini||{};strictForIn=this.php_js.ini["phpjs.strictForIn"]&&this.php_js.ini["phpjs.strictForIn"].local_value;populateArr=strictForIn?inputArr:populateArr;for(i=0;i<keys.length;i++){k=keys[i];tmp_arr[k]=inputArr[k];if(strictForIn){delete inputArr[k]}}for(i in tmp_arr){if(tmp_arr.hasOwnProperty){populateArr[i]=tmp_arr[i]}}return strictForIn?true:populateArr},ksort:function(inputArr,sort_flags){var tmp_arr={},keys=[],sorter,i,k,that=this,strictForIn=false,populateArr=[];switch(sort_flags){case"SORT_STRING":sorter=function(a,b){return that.strnatcmp(a,b)};break;case"SORT_LOCALE_STRING":var loc=this.i18n_loc_get_default();sorter=this.php_js.i18nLocales[loc].sorting;break;case"SORT_NUMERIC":sorter=function(a,b){return(a-b)};break;case"SORT_REGULAR":default:sorter=function(a,b){if(a>b){return 1}if(a<b){return -1}return 0};break}for(k in inputArr){if(inputArr.hasOwnProperty){keys.push(k)}}keys.sort(sorter);this.php_js=this.php_js||{};this.php_js.ini=this.php_js.ini||{};strictForIn=this.php_js.ini["phpjs.strictForIn"]&&this.php_js.ini["phpjs.strictForIn"].local_value;populateArr=strictForIn?inputArr:populateArr;for(i=0;i<keys.length;i++){k=keys[i];tmp_arr[k]=inputArr[k];if(strictForIn){delete inputArr[k]}}for(i in tmp_arr){if(tmp_arr.hasOwnProperty){populateArr[i]=tmp_arr[i]}}return strictForIn?true:populateArr},lcfirst:function(str){str+="";var f=str.charAt(0).toLowerCase();return f+str.substr(1)},lcg_value:function(){return Math.random()},levenshtein:function(s1,s2){if(s1==s2){return 0}var s1_len=s1.length;var s2_len=s2.length;if(s1_len===0){return s2_len}if(s2_len===0){return s1_len}var split=false;try{split=!("0")[0]}catch(e){split=true}if(split){s1=s1.split("");s2=s2.split("")}var v0=new Array(s1_len+1);var v1=new Array(s1_len+1);var s1_idx=0,s2_idx=0,cost=0;for(s1_idx=0;s1_idx<s1_len+1;s1_idx++){v0[s1_idx]=s1_idx}var char_s1="",char_s2="";for(s2_idx=1;s2_idx<=s2_len;s2_idx++){v1[0]=s2_idx;char_s2=s2[s2_idx-1];for(s1_idx=0;s1_idx<s1_len;s1_idx++){char_s1=s1[s1_idx];cost=(char_s1==char_s2)?0:1;var m_min=v0[s1_idx+1]+1;var b=v1[s1_idx]+1;var c=v0[s1_idx]+cost;if(b<m_min){m_min=b}if(c<m_min){m_min=c}v1[s1_idx+1]=m_min}var v_tmp=v0;v0=v1;v1=v_tmp}return v0[s1_len]},log:function(arg,base){if(base===undefined){return Math.log(arg)}else{return Math.log(arg)/Math.log(base)}},log10:function(arg){return Math.log(arg)/Math.LN10},log1p:function(x){var ret=0,n=50;if(x<=-1){return"-INF"}if(x<0||x>1){return Math.log(1+x)}for(var i=1;i<n;i++){if((i%2)===0){ret-=Math.pow(x,i)/i}else{ret+=Math.pow(x,i)/i}}return ret},long2ip:function(proper_address){var output=false;if(!isNaN(proper_address)&&(proper_address>=0||proper_address<=4294967295)){output=Math.floor(proper_address/Math.pow(256,3))+"."+Math.floor((proper_address%Math.pow(256,3))/Math.pow(256,2))+"."+Math.floor(((proper_address%Math.pow(256,3))%Math.pow(256,2))/Math.pow(256,1))+"."+Math.floor((((proper_address%Math.pow(256,3))%Math.pow(256,2))%Math.pow(256,1))/Math.pow(256,0))}return output},ltrim:function(str,charlist){charlist=!charlist?" \\s\u00A0":(charlist+"").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"$1");var re=new RegExp("^["+charlist+"]+","g");return(str+"").replace(re,"")},max:function(){var ar,retVal,i=0,n=0;var argv=arguments,argc=argv.length;var _obj2Array=function(obj){if(obj instanceof Array){return obj}else{var ar=[];for(var i in obj){ar.push(obj[i])}return ar}};var _compare=function(current,next){var i=0,n=0,tmp=0;var nl=0,cl=0;if(current===next){return 0}else{if(typeof current=="object"){if(typeof next=="object"){current=_obj2Array(current);next=_obj2Array(next);cl=current.length;nl=next.length;if(nl>cl){return 1}else{if(nl<cl){return -1}else{for(i=0,n=cl;i<n;++i){tmp=_compare(current[i],next[i]);if(tmp==1){return 1}else{if(tmp==-1){return -1}}}return 0}}}else{return -1}}else{if(typeof next=="object"){return 1}else{if(isNaN(next)&&!isNaN(current)){if(current==0){return 0}else{return(current<0?1:-1)}}else{if(isNaN(current)&&!isNaN(next)){if(next==0){return 0}else{return(next>0?1:-1)}}else{if(next==current){return 0}else{return(next>current?1:-1)}}}}}}};if(argc===0){throw new Error("At least one value should be passed to max()")}else{if(argc===1){if(typeof argv[0]==="object"){ar=_obj2Array(argv[0])}else{throw new Error("Wrong parameter count for max()")}if(ar.length===0){throw new Error("Array must contain at least one element for max()")}}else{ar=argv}}retVal=ar[0];for(i=1,n=ar.length;i<n;++i){if(_compare(retVal,ar[i])==1){retVal=ar[i]}}return retVal},md5:function(str){var xl;var rotateLeft=function(lValue,iShiftBits){return(lValue<<iShiftBits)|(lValue>>>(32-iShiftBits))};var addUnsigned=function(lX,lY){var lX4,lY4,lX8,lY8,lResult;lX8=(lX&2147483648);lY8=(lY&2147483648);lX4=(lX&1073741824);lY4=(lY&1073741824);lResult=(lX&1073741823)+(lY&1073741823);if(lX4&lY4){return(lResult^2147483648^lX8^lY8)}if(lX4|lY4){if(lResult&1073741824){return(lResult^3221225472^lX8^lY8)}else{return(lResult^1073741824^lX8^lY8)}}else{return(lResult^lX8^lY8)}};var _F=function(x,y,z){return(x&y)|((~x)&z)};var _G=function(x,y,z){return(x&z)|(y&(~z))};var _H=function(x,y,z){return(x^y^z)};var _I=function(x,y,z){return(y^(x|(~z)))};var _FF=function(a,b,c,d,x,s,ac){a=addUnsigned(a,addUnsigned(addUnsigned(_F(b,c,d),x),ac));return addUnsigned(rotateLeft(a,s),b)};var _GG=function(a,b,c,d,x,s,ac){a=addUnsigned(a,addUnsigned(addUnsigned(_G(b,c,d),x),ac));return addUnsigned(rotateLeft(a,s),b)};var _HH=function(a,b,c,d,x,s,ac){a=addUnsigned(a,addUnsigned(addUnsigned(_H(b,c,d),x),ac));return addUnsigned(rotateLeft(a,s),b)};var _II=function(a,b,c,d,x,s,ac){a=addUnsigned(a,addUnsigned(addUnsigned(_I(b,c,d),x),ac));return addUnsigned(rotateLeft(a,s),b)};var convertToWordArray=function(str){var lWordCount;var lMessageLength=str.length;var lNumberOfWords_temp1=lMessageLength+8;var lNumberOfWords_temp2=(lNumberOfWords_temp1-(lNumberOfWords_temp1%64))/64;var lNumberOfWords=(lNumberOfWords_temp2+1)*16;var lWordArray=new Array(lNumberOfWords-1);var lBytePosition=0;var lByteCount=0;while(lByteCount<lMessageLength){lWordCount=(lByteCount-(lByteCount%4))/4;lBytePosition=(lByteCount%4)*8;lWordArray[lWordCount]=(lWordArray[lWordCount]|(str.charCodeAt(lByteCount)<<lBytePosition));lByteCount++}lWordCount=(lByteCount-(lByteCount%4))/4;lBytePosition=(lByteCount%4)*8;lWordArray[lWordCount]=lWordArray[lWordCount]|(128<<lBytePosition);lWordArray[lNumberOfWords-2]=lMessageLength<<3;lWordArray[lNumberOfWords-1]=lMessageLength>>>29;return lWordArray};var wordToHex=function(lValue){var wordToHexValue="",wordToHexValue_temp="",lByte,lCount;for(lCount=0;lCount<=3;lCount++){lByte=(lValue>>>(lCount*8))&255;wordToHexValue_temp="0"+lByte.toString(16);wordToHexValue=wordToHexValue+wordToHexValue_temp.substr(wordToHexValue_temp.length-2,2)}return wordToHexValue};var x=[],k,AA,BB,CC,DD,a,b,c,d,S11=7,S12=12,S13=17,S14=22,S21=5,S22=9,S23=14,S24=20,S31=4,S32=11,S33=16,S34=23,S41=6,S42=10,S43=15,S44=21;str=this.utf8_encode(str);x=convertToWordArray(str);a=1732584193;b=4023233417;c=2562383102;d=271733878;xl=x.length;for(k=0;k<xl;k+=16){AA=a;BB=b;CC=c;DD=d;a=_FF(a,b,c,d,x[k+0],S11,3614090360);d=_FF(d,a,b,c,x[k+1],S12,3905402710);c=_FF(c,d,a,b,x[k+2],S13,606105819);b=_FF(b,c,d,a,x[k+3],S14,3250441966);a=_FF(a,b,c,d,x[k+4],S11,4118548399);d=_FF(d,a,b,c,x[k+5],S12,1200080426);c=_FF(c,d,a,b,x[k+6],S13,2821735955);b=_FF(b,c,d,a,x[k+7],S14,4249261313);a=_FF(a,b,c,d,x[k+8],S11,1770035416);d=_FF(d,a,b,c,x[k+9],S12,2336552879);c=_FF(c,d,a,b,x[k+10],S13,4294925233);b=_FF(b,c,d,a,x[k+11],S14,2304563134);a=_FF(a,b,c,d,x[k+12],S11,1804603682);d=_FF(d,a,b,c,x[k+13],S12,4254626195);c=_FF(c,d,a,b,x[k+14],S13,2792965006);b=_FF(b,c,d,a,x[k+15],S14,1236535329);a=_GG(a,b,c,d,x[k+1],S21,4129170786);d=_GG(d,a,b,c,x[k+6],S22,3225465664);c=_GG(c,d,a,b,x[k+11],S23,643717713);b=_GG(b,c,d,a,x[k+0],S24,3921069994);a=_GG(a,b,c,d,x[k+5],S21,3593408605);d=_GG(d,a,b,c,x[k+10],S22,38016083);c=_GG(c,d,a,b,x[k+15],S23,3634488961);b=_GG(b,c,d,a,x[k+4],S24,3889429448);a=_GG(a,b,c,d,x[k+9],S21,568446438);d=_GG(d,a,b,c,x[k+14],S22,3275163606);c=_GG(c,d,a,b,x[k+3],S23,4107603335);b=_GG(b,c,d,a,x[k+8],S24,1163531501);a=_GG(a,b,c,d,x[k+13],S21,2850285829);d=_GG(d,a,b,c,x[k+2],S22,4243563512);c=_GG(c,d,a,b,x[k+7],S23,1735328473);b=_GG(b,c,d,a,x[k+12],S24,2368359562);a=_HH(a,b,c,d,x[k+5],S31,4294588738);d=_HH(d,a,b,c,x[k+8],S32,2272392833);c=_HH(c,d,a,b,x[k+11],S33,1839030562);b=_HH(b,c,d,a,x[k+14],S34,4259657740);a=_HH(a,b,c,d,x[k+1],S31,2763975236);d=_HH(d,a,b,c,x[k+4],S32,1272893353);c=_HH(c,d,a,b,x[k+7],S33,4139469664);b=_HH(b,c,d,a,x[k+10],S34,3200236656);a=_HH(a,b,c,d,x[k+13],S31,681279174);d=_HH(d,a,b,c,x[k+0],S32,3936430074);c=_HH(c,d,a,b,x[k+3],S33,3572445317);b=_HH(b,c,d,a,x[k+6],S34,76029189);a=_HH(a,b,c,d,x[k+9],S31,3654602809);d=_HH(d,a,b,c,x[k+12],S32,3873151461);c=_HH(c,d,a,b,x[k+15],S33,530742520);b=_HH(b,c,d,a,x[k+2],S34,3299628645);a=_II(a,b,c,d,x[k+0],S41,4096336452);d=_II(d,a,b,c,x[k+7],S42,1126891415);c=_II(c,d,a,b,x[k+14],S43,2878612391);b=_II(b,c,d,a,x[k+5],S44,4237533241);a=_II(a,b,c,d,x[k+12],S41,1700485571);d=_II(d,a,b,c,x[k+3],S42,2399980690);c=_II(c,d,a,b,x[k+10],S43,4293915773);b=_II(b,c,d,a,x[k+1],S44,2240044497);a=_II(a,b,c,d,x[k+8],S41,1873313359);d=_II(d,a,b,c,x[k+15],S42,4264355552);c=_II(c,d,a,b,x[k+6],S43,2734768916);b=_II(b,c,d,a,x[k+13],S44,1309151649);a=_II(a,b,c,d,x[k+4],S41,4149444226);d=_II(d,a,b,c,x[k+11],S42,3174756917);c=_II(c,d,a,b,x[k+2],S43,718787259);b=_II(b,c,d,a,x[k+9],S44,3951481745);a=addUnsigned(a,AA);b=addUnsigned(b,BB);c=addUnsigned(c,CC);d=addUnsigned(d,DD)}var temp=wordToHex(a)+wordToHex(b)+wordToHex(c)+wordToHex(d);return temp.toLowerCase()},method_exists:function(obj,method){if(typeof obj==="string"){return this.window[obj]&&typeof this.window[obj][method]==="function"}return typeof obj[method]==="function"},microtime:function(get_as_float){var now=new Date().getTime()/1000;var s=parseInt(now,10);return(get_as_float)?now:(Math.round((now-s)*1000)/1000)+" "+s},min:function(){var ar,retVal,i=0,n=0;var argv=arguments,argc=argv.length;var _obj2Array=function(obj){if(obj instanceof Array){return obj}else{var ar=[];for(var i in obj){ar.push(obj[i])}return ar}};var _compare=function(current,next){var i=0,n=0,tmp=0;var nl=0,cl=0;if(current===next){return 0}else{if(typeof current=="object"){if(typeof next=="object"){current=_obj2Array(current);next=_obj2Array(next);cl=current.length;nl=next.length;if(nl>cl){return 1}else{if(nl<cl){return -1}else{for(i=0,n=cl;i<n;++i){tmp=_compare(current[i],next[i]);if(tmp==1){return 1}else{if(tmp==-1){return -1}}}return 0}}}else{return -1}}else{if(typeof next=="object"){return 1}else{if(isNaN(next)&&!isNaN(current)){if(current==0){return 0}else{return(current<0?1:-1)}}else{if(isNaN(current)&&!isNaN(next)){if(next==0){return 0}else{return(next>0?1:-1)}}else{if(next==current){return 0}else{return(next>current?1:-1)}}}}}}};if(argc===0){throw new Error("At least one value should be passed to min()")}else{if(argc===1){if(typeof argv[0]==="object"){ar=_obj2Array(argv[0])}else{throw new Error("Wrong parameter count for min()")}if(ar.length===0){throw new Error("Array must contain at least one element for min()")}}else{ar=argv}}retVal=ar[0];for(i=1,n=ar.length;i<n;++i){if(_compare(retVal,ar[i])==-1){retVal=ar[i]}}return retVal},mktime:function(){var d=new Date(),r=arguments,i=0,e=["Hours","Minutes","Seconds","Month","Date","FullYear"];for(i=0;i<e.length;i++){if(typeof r[i]==="undefined"){r[i]=d["get"+e[i]]();r[i]+=(i===3)}else{r[i]=parseInt(r[i],10);if(isNaN(r[i])){return false}}}r[5]+=(r[5]>=0?(r[5]<=69?2000:(r[5]<=100?1900:0)):0);d.setFullYear(r[5],r[3]-1,r[4]);d.setHours(r[0],r[1],r[2]);return(d.getTime()/1000>>0)-(d.getTime()<0)},mt_getrandmax:function(){return 2147483647},mt_rand:function(min,max){var argc=arguments.length;if(argc===0){min=0;max=2147483647}else{if(argc===1){throw new Error("Warning: mt_rand() expects exactly 2 parameters, 1 given")}}return Math.floor(Math.random()*(max-min+1))+min},natcasesort:function(inputArr){var valArr=[],keyArr=[],k,i,ret,that=this,strictForIn=false,populateArr=[];var bubbleSort=function(keyArr,inputArr){var i,j,tempValue,tempKeyVal;for(i=inputArr.length-2;i>=0;i--){for(j=0;j<=i;j++){ret=that.strnatcasecmp(inputArr[j+1],inputArr[j]);if(ret<0){tempValue=inputArr[j];inputArr[j]=inputArr[j+1];inputArr[j+1]=tempValue;tempKeyVal=keyArr[j];keyArr[j]=keyArr[j+1];keyArr[j+1]=tempKeyVal}}}};this.php_js=this.php_js||{};this.php_js.ini=this.php_js.ini||{};strictForIn=this.php_js.ini["phpjs.strictForIn"]&&this.php_js.ini["phpjs.strictForIn"].local_value;populateArr=strictForIn?inputArr:populateArr;for(k in inputArr){if(inputArr.hasOwnProperty){valArr.push(inputArr[k]);keyArr.push(k);if(strictForIn){delete inputArr[k]}}}try{bubbleSort(keyArr,valArr)}catch(e){return false}for(i=0;i<valArr.length;i++){populateArr[keyArr[i]]=valArr[i]}return strictForIn?true:populateArr},natsort:function(inputArr){var valArr=[],keyArr=[],k,i,ret,that=this,strictForIn=false,populateArr=[];var bubbleSort=function(keyArr,inputArr){var i,j,tempValue,tempKeyVal;for(i=inputArr.length-2;i>=0;i--){for(j=0;j<=i;j++){ret=that.strnatcmp(inputArr[j+1],inputArr[j]);if(ret<0){tempValue=inputArr[j];inputArr[j]=inputArr[j+1];inputArr[j+1]=tempValue;tempKeyVal=keyArr[j];keyArr[j]=keyArr[j+1];keyArr[j+1]=tempKeyVal}}}};this.php_js=this.php_js||{};this.php_js.ini=this.php_js.ini||{};strictForIn=this.php_js.ini["phpjs.strictForIn"]&&this.php_js.ini["phpjs.strictForIn"].local_value;populateArr=strictForIn?inputArr:populateArr;for(k in inputArr){if(inputArr.hasOwnProperty){valArr.push(inputArr[k]);keyArr.push(k);if(strictForIn){delete inputArr[k]}}}try{bubbleSort(keyArr,valArr)}catch(e){return false}for(i=0;i<valArr.length;i++){populateArr[keyArr[i]]=valArr[i]}return strictForIn?true:populateArr},nl2br:function(str,is_xhtml){var breakTag=(is_xhtml||typeof is_xhtml==="undefined")?"<br />":"<br>";return(str+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+breakTag+"$2")},number_format:function(number,decimals,dec_point,thousands_sep){var n=!isFinite(+number)?0:+number,prec=!isFinite(+decimals)?0:Math.abs(decimals),sep=(typeof thousands_sep==="undefined")?",":thousands_sep,dec=(typeof dec_point==="undefined")?".":dec_point,s="",toFixedFix=function(n,prec){var k=Math.pow(10,prec);return""+Math.round(n*k)/k};s=(prec?toFixedFix(n,prec):""+Math.round(n)).split(".");if(s[0].length>3){s[0]=s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,sep)}if((s[1]||"").length<prec){s[1]=s[1]||"";s[1]+=new Array(prec-s[1].length+1).join("0")}return s.join(dec)},octdec:function(oct_string){oct_string=(oct_string+"").replace(/[^0-7]/gi,"");return parseInt(oct_string,8)},ord:function(string){var str=string+"";var code=str.charCodeAt(0);if(55296<=code&&code<=56319){var hi=code;if(str.length===1){return code}var low=str.charCodeAt(1);if(!low){}return((hi-55296)*1024)+(low-56320)+65536}if(56320<=code&&code<=57343){return code}return code},parse_str:function(str,array){var glue1="=",glue2="&",array2=String(str).split(glue2),i,j,chr,tmp,key,value,bracket,keys,evalStr,that=this,fixStr=function(str){return that.urldecode(str).replace(/([\\"'])/g,"\\$1").replace(/\n/g,"\\n").replace(/\r/g,"\\r")};if(!array){array=this.window}for(i=0;i<array2.length;i++){tmp=array2[i].split(glue1);if(tmp.length<2){tmp=[tmp,""]}key=fixStr(tmp[0]);value=fixStr(tmp[1]);while(key.charAt(0)===" "){key=key.substr(1)}if(key.indexOf("\0")!==-1){key=key.substr(0,key.indexOf("\0"))}if(key&&key.charAt(0)!=="["){keys=[];bracket=0;for(j=0;j<key.length;j++){if(key.charAt(j)==="["&&!bracket){bracket=j+1}else{if(key.charAt(j)==="]"){if(bracket){if(!keys.length){keys.push(key.substr(0,bracket-1))}keys.push(key.substr(bracket,j-bracket));bracket=0;if(key.charAt(j+1)!=="["){break}}}}}if(!keys.length){keys=[key]}for(j=0;j<keys[0].length;j++){chr=keys[0].charAt(j);if(chr===" "||chr==="."||chr==="["){keys[0]=keys[0].substr(0,j)+"_"+keys[0].substr(j+1)}if(chr==="["){break}}evalStr="array";for(j=0;j<keys.length;j++){key=keys[j];if((key!==""&&key!==" ")||j===0){key="'"+key+"'"}else{key=eval(evalStr+".push([]);")-1}evalStr+="["+key+"]";if(j!==keys.length-1&&eval("typeof "+evalStr)==="undefined"){eval(evalStr+" = [];")}}evalStr+=" = '"+value+"';\n";eval(evalStr)}}},parse_url:function(str,component){var o={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/\/?)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var m=o.parser[o.strictMode?"strict":"loose"].exec(str),uri={},i=14;while(i--){uri[o.key[i]]=m[i]||""}switch(component){case"PHP_URL_SCHEME":return uri.protocol;case"PHP_URL_HOST":return uri.host;case"PHP_URL_PORT":return uri.port;case"PHP_URL_USER":return uri.user;case"PHP_URL_PASS":return uri.password;case"PHP_URL_PATH":return uri.path;case"PHP_URL_QUERY":return uri.query;case"PHP_URL_FRAGMENT":return uri.anchor;default:var retArr={};if(uri.protocol!==""){retArr.scheme=uri.protocol}if(uri.host!==""){retArr.host=uri.host}if(uri.port!==""){retArr.port=uri.port}if(uri.user!==""){retArr.user=uri.user}if(uri.password!==""){retArr.pass=uri.password}if(uri.path!==""){retArr.path=uri.path}if(uri.query!==""){retArr.query=uri.query}if(uri.anchor!==""){retArr.fragment=uri.anchor}return retArr}},pi:function(){return Math.PI},pow:function(base,exp){return Math.pow(base,exp)},preg_grep:function(pattern,input,flags){var p="",retObj={};var invert=(flags===1||flags==="PREG_GREP_INVERT");if(typeof pattern==="string"){pattern=eval(pattern)}if(invert){for(p in input){if(!pattern.test(input[p])){retObj[p]=input[p]}}}else{for(p in input){if(pattern.test(input[p])){retObj[p]=input[p]}}}return retObj},preg_quote:function(str){return(str+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!<>\|\:])/g,"\\$1")},print_r:function(array,return_val){var output="",pad_char=" ",pad_val=4,d=this.window.document;var getFuncName=function(fn){var name=(/\W*function\s+([\w\$]+)\s*\(/).exec(fn);if(!name){return"(Anonymous)"}return name[1]};var repeat_char=function(len,pad_char){var str="";for(var i=0;i<len;i++){str+=pad_char}return str};var formatArray=function(obj,cur_depth,pad_val,pad_char){if(cur_depth>0){cur_depth++}var base_pad=repeat_char(pad_val*cur_depth,pad_char);var thick_pad=repeat_char(pad_val*(cur_depth+1),pad_char);var str="";if(typeof obj==="object"&&obj!==null&&obj.constructor&&getFuncName(obj.constructor)!=="PHPJS_Resource"){str+="Array\n"+base_pad+"(\n";for(var key in obj){if(obj[key] instanceof Array){str+=thick_pad+"["+key+"] => "+formatArray(obj[key],cur_depth+1,pad_val,pad_char)}else{str+=thick_pad+"["+key+"] => "+obj[key]+"\n"}}str+=base_pad+")\n"}else{if(obj===null||obj===undefined){str=""}else{str=obj.toString()}}return str};output=formatArray(array,0,pad_val,pad_char);if(return_val!==true){if(d.body){this.echo(output)}else{try{d=XULDocument;this.echo('<pre xmlns="http://www.w3.org/1999/xhtml" style="white-space:pre;">'+output+"</pre>")}catch(e){this.echo(output)}}return true}else{return output}},printf:function(){var body,elmt,d=this.window.document;var ret="";var HTMLNS="http://www.w3.org/1999/xhtml";body=d.getElementsByTagNameNS?(d.getElementsByTagNameNS(HTMLNS,"body")[0]?d.getElementsByTagNameNS(HTMLNS,"body")[0]:d.documentElement.lastChild):d.getElementsByTagName("body")[0];if(!body){return false}ret=this.sprintf.apply(this,arguments);elmt=d.createTextNode(ret);body.appendChild(elmt);return ret.length},property_exists:function(cls,prop){cls=(typeof cls==="string")?this.window[cls]:cls;if(typeof cls==="function"&&cls.toSource&&cls.toSource().match(new RegExp("this\\."+prop+"\\s"))){return true}return(cls[prop]!==undefined&&typeof cls[prop]!=="function")||(cls.prototype!==undefined&&cls.prototype[prop]!==undefined&&typeof cls.prototype[prop]!=="function")||(cls.constructor&&cls.constructor[prop]!==undefined&&typeof cls.constructor[prop]!=="function")},quotemeta:function(str){return(str+"").replace(/([\.\\\+\*\?\[\^\]\$\(\)])/g,"\\$1")},rad2deg:function(angle){return(angle/Math.PI)*180},rand:function(min,max){var argc=arguments.length;if(argc===0){min=0;max=2147483647}else{if(argc===1){throw new Error("Warning: rand() expects exactly 2 parameters, 1 given")}}return Math.floor(Math.random()*(max-min+1))+min},range:function(low,high,step){var matrix=[];var inival,endval,plus;var walker=step||1;var chars=false;if(!isNaN(low)&&!isNaN(high)){inival=low;endval=high}else{if(isNaN(low)&&isNaN(high)){chars=true;inival=low.charCodeAt(0);endval=high.charCodeAt(0)}else{inival=(isNaN(low)?0:low);endval=(isNaN(high)?0:high)}}plus=((inival>endval)?false:true);if(plus){while(inival<=endval){matrix.push(((chars)?String.fromCharCode(inival):inival));inival+=walker}}else{while(inival>=endval){matrix.push(((chars)?String.fromCharCode(inival):inival));inival-=walker}}return matrix},rawurldecode:function(str){return decodeURIComponent(str)},rawurlencode:function(str){str=(str+"").toString();return encodeURIComponent(str).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")},reset:function(arr){this.php_js=this.php_js||{};this.php_js.pointers=this.php_js.pointers||[];var indexOf=function(value){for(var i=0,length=this.length;i<length;i++){if(this[i]===value){return i}}return -1};var pointers=this.php_js.pointers;if(!pointers.indexOf){pointers.indexOf=indexOf}if(pointers.indexOf(arr)===-1){pointers.push(arr,0)}var arrpos=pointers.indexOf(arr);if(!(arr instanceof Array)){for(var k in arr){if(pointers.indexOf(arr)===-1){pointers.push(arr,0)}else{pointers[arrpos+1]=0}return arr[k]}return false}if(arr.length===0){return false}pointers[arrpos+1]=0;return arr[pointers[arrpos+1]]},round:function(val,precision,mode){var retVal=0,v="",integer="",decimal="",decp=0,negative=false;var _round_half_oe=function(dtR,dtLa,even){if(even===true){if(dtLa==50){if((dtR%2)===1){if(dtLa>=5){dtR+=1}else{dtR-=1}}}else{if(dtLa>=5){dtR+=1}}}else{if(dtLa==5){if((dtR%2)===0){if(dtLa>=5){dtR+=1}else{dtR-=1}}}else{if(dtLa>=5){dtR+=1}}}return dtR};var _round_half_ud=function(dtR,dtLa,up){if(up===true){if(dtLa>=5){dtR+=1}}else{if(dtLa>5){dtR+=1}}return dtR};var _round_half=function(val,decplaces,mode){var v=val.toString(),vlen=0,vlenDif=0;var decp=v.indexOf(".");var digitToRound=0,digitToLookAt=0;var integer="",decimal="";var round=null,bool=false;switch(mode){case"up":bool=true;case"down":round=_round_half_ud;break;case"even":bool=true;case"odd":round=_round_half_oe;break}if(decplaces<0){vlen=v.length;decplaces=vlen+decplaces;digitToLookAt=Number(v.charAt(decplaces));digitToRound=Number(v.charAt(decplaces-1));digitToRound=round(digitToRound,digitToLookAt,bool);v=v.slice(0,decplaces-1);vlenDif=vlen-v.length-1;if(digitToRound==10){v=String(Number(v)+1)+"0"}else{v+=digitToRound}v=Number(v)*(Math.pow(10,vlenDif))}else{if(decplaces>0){integer=v.slice(0,decp);decimal=v.slice(decp+1);digitToLookAt=Number(decimal.charAt(decplaces));digitToRound=Number(decimal.charAt(decplaces-1));digitToRound=round(digitToRound,digitToLookAt,bool);decimal=decimal.slice(0,decplaces-1);if(digitToRound==10){v=Number(integer+"."+decimal)+(1*(Math.pow(10,(0-decimal.length))))}else{v=Number(integer+"."+decimal+digitToRound)}}else{integer=v.slice(0,decp);decimal=v.slice(decp+1);digitToLookAt=Number(decimal.charAt(decplaces));digitToRound=Number(integer.charAt(integer.length-1));digitToRound=round(digitToRound,digitToLookAt,bool);decimal="0";integer=integer.slice(0,integer.length-1);if(digitToRound==10){v=Number(integer)+1}else{v=Number(integer+digitToRound)}}}return v};if(typeof precision=="undefined"){precision=0}if(typeof mode=="undefined"){mode="PHP_ROUND_HALF_UP"}if(val<0){negative=true}else{negative=false}v=Math.abs(val).toString();decp=v.indexOf(".");if((decp==-1)&&(precision>=0)){return val}else{if(decp==-1){integer=v;decimal="0"}else{integer=v.slice(0,decp);if(precision>=0){decimal=v.substr(decp+1,precision+1)}else{decimal="0"}}if((precision>0)&&(precision>=decimal.length)){return val}else{if((precision<0)&&(Math.abs(precision)>=integer.length)){return 0}}val=Number(integer+"."+decimal)}switch(mode){case 0:case"PHP_ROUND_HALF_UP":retVal=_round_half(val,precision,"up");break;case 1:case"PHP_ROUND_HALF_DOWN":retVal=_round_half(val,precision,"down");break;case 2:case"PHP_ROUND_HALF_EVEN":retVal=_round_half(val,precision,"even");break;case 3:case"PHP_ROUND_HALF_ODD":retVal=_round_half(val,precision,"odd");break}if(negative){return 0-retVal}else{return retVal}},rsort:function(inputArr,sort_flags){var valArr=[],k="",i=0,sorter=false,that=this,strictForIn=false,populateArr=[];switch(sort_flags){case"SORT_STRING":sorter=function(a,b){return that.strnatcmp(b,a)};break;case"SORT_LOCALE_STRING":var loc=this.i18n_loc_get_default();sorter=this.php_js.i18nLocales[loc].sorting;break;case"SORT_NUMERIC":sorter=function(a,b){return(b-a)};break;case"SORT_REGULAR":default:sorter=function(a,b){if(a<b){return 1}if(a>b){return -1}return 0};break}this.php_js=this.php_js||{};this.php_js.ini=this.php_js.ini||{};strictForIn=this.php_js.ini["phpjs.strictForIn"]&&this.php_js.ini["phpjs.strictForIn"].local_value;populateArr=strictForIn?inputArr:populateArr;for(k in inputArr){if(inputArr.hasOwnProperty){valArr.push(inputArr[k]);if(strictForIn){delete inputArr[k]}}}valArr.sort(sorter);for(i=0;i<valArr.length;i++){populateArr[i]=valArr[i]}return strictForIn?true:populateArr},rtrim:function(str,charlist){charlist=!charlist?" \\s\u00A0":(charlist+"").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"\\$1");var re=new RegExp("["+charlist+"]+$","g");return(str+"").replace(re,"")},serialize:function(mixed_value){var _getType=function(inp){var type=typeof inp,match;var key;if(type=="object"&&!inp){return"null"}if(type=="object"){if(!inp.constructor){return"object"}var cons=inp.constructor.toString();match=cons.match(/(\w+)\(/);if(match){cons=match[1].toLowerCase()}var types=["boolean","number","string","array"];for(key in types){if(cons==types[key]){type=types[key];break}}}return type};var type=_getType(mixed_value);var val,ktype="";switch(type){case"function":val="";break;case"boolean":val="b:"+(mixed_value?"1":"0");break;case"number":val=(Math.round(mixed_value)==mixed_value?"i":"d")+":"+mixed_value;break;case"string":mixed_value=this.utf8_encode(mixed_value);val="s:"+encodeURIComponent(mixed_value).replace(/%../g,"x").length+':"'+mixed_value+'"';break;case"array":case"object":val="a";var count=0;var vals="";var okey;var key;for(key in mixed_value){ktype=_getType(mixed_value[key]);if(ktype=="function"){continue}okey=(key.match(/^[0-9]+$/)?parseInt(key,10):key);vals+=this.serialize(okey)+this.serialize(mixed_value[key]);count++}val+=":"+count+":{"+vals+"}";break;case"undefined":default:val="N";break}if(type!="object"&&type!="array"){val+=";"}return val},setcookie:function(name,value,expires,path,domain,secure){return this.setrawcookie(name,encodeURIComponent(value),expires,path,domain,secure)},setrawcookie:function(name,value,expires,path,domain,secure){if(typeof expires==="string"&&(/^\d+$/).test(expires)){expires=parseInt(expires,10)}if(expires instanceof Date){expires=expires.toGMTString()}else{if(typeof(expires)==="number"){expires=(new Date(expires*1000)).toGMTString()}}var r=[name+"="+value],s={},i="";s={expires:expires,path:path,domain:domain};for(i in s){if(s.hasOwnProperty(i)){s[i]&&r.push(i+"="+s[i])}}return secure&&r.push("secure"),this.window.document.cookie=r.join(";"),true},settype:function(vr,type){var is_array=function(arr){return typeof arr==="object"&&typeof arr.length==="number"&&!(arr.propertyIsEnumerable("length"))&&typeof arr.splice==="function"};var v,mtch,i,obj;v=this[vr]?this[vr]:vr;try{switch(type){case"boolean":if(is_array(v)&&v.length===0){this[vr]=false}else{if(v==="0"){this[vr]=false}else{if(typeof v==="object"&&!is_array(v)){var lgth=false;for(i in v){lgth=true}this[vr]=lgth}else{this[vr]=!!v}}}break;case"integer":if(typeof v==="number"){this[vr]=parseInt(v,10)}else{if(typeof v==="string"){mtch=v.match(/^([+\-]?)(\d+)/);if(!mtch){this[vr]=0}else{this[vr]=parseInt(v,10)}}else{if(v===true){this[vr]=1}else{if(v===false||v===null){this[vr]=0}else{if(is_array(v)&&v.length===0){this[vr]=0}else{if(typeof v==="object"){this[vr]=1}}}}}}break;case"float":if(typeof v==="string"){mtch=v.match(/^([+\-]?)(\d+(\.\d+)?|\.\d+)([eE][+\-]?\d+)?/);if(!mtch){this[vr]=0}else{this[vr]=parseFloat(v,10)}}else{if(v===true){this[vr]=1}else{if(v===false||v===null){this[vr]=0}else{if(is_array(v)&&v.length===0){this[vr]=0}else{if(typeof v==="object"){this[vr]=1}}}}}break;case"string":if(v===null||v===false){this[vr]=""}else{if(is_array(v)){this[vr]="Array"}else{if(typeof v==="object"){this[vr]="Object"}else{if(v===true){this[vr]="1"}else{this[vr]+=""}}}}break;case"array":if(v===null){this[vr]=[]}else{if(typeof v!=="object"){this[vr]=[v]}}break;case"object":if(v===null){this[vr]={}}else{if(is_array(v)){for(i=0,obj={};i<v.length;i++){obj[i]=v}this[vr]=obj}else{if(typeof v!=="object"){this[vr]={scalar:v}}}}break;case"null":delete this[vr];break}return true}catch(e){return false}},sha1:function(str){var rotate_left=function(n,s){var t4=(n<<s)|(n>>>(32-s));return t4};var cvt_hex=function(val){var str="";var i;var v;for(i=7;i>=0;i--){v=(val>>>(i*4))&15;str+=v.toString(16)}return str};var blockstart;var i,j;var W=new Array(80);var H0=1732584193;var H1=4023233417;var H2=2562383102;var H3=271733878;var H4=3285377520;var A,B,C,D,E;var temp;str=this.utf8_encode(str);var str_len=str.length;var word_array=[];for(i=0;i<str_len-3;i+=4){j=str.charCodeAt(i)<<24|str.charCodeAt(i+1)<<16|str.charCodeAt(i+2)<<8|str.charCodeAt(i+3);word_array.push(j)}switch(str_len%4){case 0:i=2147483648;break;case 1:i=str.charCodeAt(str_len-1)<<24|8388608;break;case 2:i=str.charCodeAt(str_len-2)<<24|str.charCodeAt(str_len-1)<<16|32768;break;case 3:i=str.charCodeAt(str_len-3)<<24|str.charCodeAt(str_len-2)<<16|str.charCodeAt(str_len-1)<<8|128;break}word_array.push(i);while((word_array.length%16)!=14){word_array.push(0)}word_array.push(str_len>>>29);word_array.push((str_len<<3)&4294967295);for(blockstart=0;blockstart<word_array.length;blockstart+=16){for(i=0;i<16;i++){W[i]=word_array[blockstart+i]}for(i=16;i<=79;i++){W[i]=rotate_left(W[i-3]^W[i-8]^W[i-14]^W[i-16],1)}A=H0;B=H1;C=H2;D=H3;E=H4;for(i=0;i<=19;i++){temp=(rotate_left(A,5)+((B&C)|(~B&D))+E+W[i]+1518500249)&4294967295;E=D;D=C;C=rotate_left(B,30);B=A;A=temp}for(i=20;i<=39;i++){temp=(rotate_left(A,5)+(B^C^D)+E+W[i]+1859775393)&4294967295;E=D;D=C;C=rotate_left(B,30);B=A;A=temp}for(i=40;i<=59;i++){temp=(rotate_left(A,5)+((B&C)|(B&D)|(C&D))+E+W[i]+2400959708)&4294967295;E=D;D=C;C=rotate_left(B,30);B=A;A=temp}for(i=60;i<=79;i++){temp=(rotate_left(A,5)+(B^C^D)+E+W[i]+3395469782)&4294967295;E=D;D=C;C=rotate_left(B,30);B=A;A=temp}H0=(H0+A)&4294967295;H1=(H1+B)&4294967295;H2=(H2+C)&4294967295;H3=(H3+D)&4294967295;H4=(H4+E)&4294967295}temp=cvt_hex(H0)+cvt_hex(H1)+cvt_hex(H2)+cvt_hex(H3)+cvt_hex(H4);return temp.toLowerCase()},shuffle:function(inputArr){var valArr=[],k="",i=0,strictForIn=false,populateArr=[];for(k in inputArr){if(inputArr.hasOwnProperty){valArr.push(inputArr[k]);if(strictForIn){delete inputArr[k]}}}valArr.sort(function(){return 0.5-Math.random()});this.php_js=this.php_js||{};this.php_js.ini=this.php_js.ini||{};strictForIn=this.php_js.ini["phpjs.strictForIn"]&&this.php_js.ini["phpjs.strictForIn"].local_value;populateArr=strictForIn?inputArr:populateArr;for(i=0;i<valArr.length;i++){populateArr[i]=valArr[i]}return strictForIn?true:populateArr},sin:function(arg){return Math.sin(arg)},sinh:function(arg){return(Math.exp(arg)-Math.exp(-arg))/2},sizeof:function(mixed_var,mode){return this.count(mixed_var,mode)},sort:function(inputArr,sort_flags){var valArr=[],keyArr=[],k="",i=0,sorter=false,that=this,strictForIn=false,populateArr=[];switch(sort_flags){case"SORT_STRING":sorter=function(a,b){return that.strnatcmp(a,b)};break;case"SORT_LOCALE_STRING":var loc=this.i18n_loc_get_default();sorter=this.php_js.i18nLocales[loc].sorting;break;case"SORT_NUMERIC":sorter=function(a,b){return(a-b)};break;case"SORT_REGULAR":default:sorter=function(a,b){if(a>b){return 1}if(a<b){return -1}return 0};break}this.php_js=this.php_js||{};this.php_js.ini=this.php_js.ini||{};strictForIn=this.php_js.ini["phpjs.strictForIn"]&&this.php_js.ini["phpjs.strictForIn"].local_value;populateArr=strictForIn?inputArr:populateArr;for(k in inputArr){if(inputArr.hasOwnProperty){valArr.push(inputArr[k]);if(strictForIn){delete inputArr[k]}}}valArr.sort(sorter);for(i=0;i<valArr.length;i++){populateArr[i]=valArr[i]}return strictForIn?true:populateArr},soundex:function(str){var s="";var i,j,l,p=isNaN(p)?4:p>10?10:p<4?4:p;var m={BFPV:1,CGJKQSXZ:2,DT:3,L:4,MN:5,R:6};var r=(s=(str+"").toUpperCase().replace(/[^A-Z]/g,"").split("")).splice(0,1);var sl=0;sl=s.length;for(i=-1,l=sl;++i<l;){for(j in m){if(j.indexOf(s[i])+1&&r[r.length-1]!=m[j]&&r.push(m[j])){break}}}return r.length>p&&(r.length=p),r.join("")+(new Array(p-r.length+1)).join("0")},split:function(delimiter,string){return this.explode(delimiter,string)},sprintf:function(){var regex=/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuidfegEG])/g;var a=arguments,i=0,format=a[i++];var pad=function(str,len,chr,leftJustify){if(!chr){chr=" "}var padding=(str.length>=len)?"":Array(1+len-str.length>>>0).join(chr);return leftJustify?str+padding:padding+str};var justify=function(value,prefix,leftJustify,minWidth,zeroPad,customPadChar){var diff=minWidth-value.length;if(diff>0){if(leftJustify||!zeroPad){value=pad(value,minWidth,customPadChar,leftJustify)}else{value=value.slice(0,prefix.length)+pad("",diff,"0",true)+value.slice(prefix.length)}}return value};var formatBaseX=function(value,base,prefix,leftJustify,minWidth,precision,zeroPad){var number=value>>>0;prefix=prefix&&number&&{"2":"0b","8":"0","16":"0x"}[base]||"";value=prefix+pad(number.toString(base),precision||0,"0",false);return justify(value,prefix,leftJustify,minWidth,zeroPad)};var formatString=function(value,leftJustify,minWidth,precision,zeroPad,customPadChar){if(precision!=null){value=value.slice(0,precision)}return justify(value,"",leftJustify,minWidth,zeroPad,customPadChar)};var doFormat=function(substring,valueIndex,flags,minWidth,_,precision,type){var number;var prefix;var method;var textTransform;var value;if(substring=="%%"){return"%"}var leftJustify=false,positivePrefix="",zeroPad=false,prefixBaseX=false,customPadChar=" ";var flagsl=flags.length;for(var j=0;flags&&j<flagsl;j++){switch(flags.charAt(j)){case" ":positivePrefix=" ";break;case"+":positivePrefix="+";break;case"-":leftJustify=true;break;case"'":customPadChar=flags.charAt(j+1);break;case"0":zeroPad=true;break;case"#":prefixBaseX=true;break}}if(!minWidth){minWidth=0}else{if(minWidth=="*"){minWidth=+a[i++]}else{if(minWidth.charAt(0)=="*"){minWidth=+a[minWidth.slice(1,-1)]}else{minWidth=+minWidth}}}if(minWidth<0){minWidth=-minWidth;leftJustify=true}if(!isFinite(minWidth)){throw new Error("sprintf: (minimum-)width must be finite")}if(!precision){precision="fFeE".indexOf(type)>-1?6:(type=="d")?0:undefined}else{if(precision=="*"){precision=+a[i++]}else{if(precision.charAt(0)=="*"){precision=+a[precision.slice(1,-1)]}else{precision=+precision}}}value=valueIndex?a[valueIndex.slice(0,-1)]:a[i++];switch(type){case"s":return formatString(String(value),leftJustify,minWidth,precision,zeroPad,customPadChar);case"c":return formatString(String.fromCharCode(+value),leftJustify,minWidth,precision,zeroPad);case"b":return formatBaseX(value,2,prefixBaseX,leftJustify,minWidth,precision,zeroPad);case"o":return formatBaseX(value,8,prefixBaseX,leftJustify,minWidth,precision,zeroPad);case"x":return formatBaseX(value,16,prefixBaseX,leftJustify,minWidth,precision,zeroPad);case"X":return formatBaseX(value,16,prefixBaseX,leftJustify,minWidth,precision,zeroPad).toUpperCase();case"u":return formatBaseX(value,10,prefixBaseX,leftJustify,minWidth,precision,zeroPad);case"i":case"d":number=parseInt(+value,10);prefix=number<0?"-":positivePrefix;value=prefix+pad(String(Math.abs(number)),precision,"0",false);return justify(value,prefix,leftJustify,minWidth,zeroPad);case"e":case"E":case"f":case"F":case"g":case"G":number=+value;prefix=number<0?"-":positivePrefix;method=["toExponential","toFixed","toPrecision"]["efg".indexOf(type.toLowerCase())];textTransform=["toString","toUpperCase"]["eEfFgG".indexOf(type)%2];value=prefix+Math.abs(number)[method](precision);return justify(value,prefix,leftJustify,minWidth,zeroPad)[textTransform]();default:return substring}};return format.replace(regex,doFormat)},sql_regcase:function(str){this.setlocale("LC_ALL",0);var i=0,upper="",lower="",pos=0,retStr="";upper=this.php_js.locales[this.php_js.localeCategories.LC_CTYPE].LC_CTYPE.upper;lower=this.php_js.locales[this.php_js.localeCategories.LC_CTYPE].LC_CTYPE.lower;for(i=0;i<str.length;i++){if(((pos=upper.indexOf(str.charAt(i)))!==-1)||((pos=lower.indexOf(str.charAt(i)))!==-1)){retStr+="["+upper.charAt(pos)+lower.charAt(pos)+"]"}else{retStr+=str.charAt(i)}}return retStr},sqrt:function(arg){return Math.sqrt(arg)},str_getcsv:function(input,delimiter,enclosure,escape){var output=[];var backwards=function(str){return str.split("").reverse().join("")};var pq=function(str){return(str+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g,"\\$1")};delimiter=delimiter||",";enclosure=enclosure||'"';escape=escape||"\\";input=input.replace(new RegExp("^\\s*"+pq(enclosure)),"").replace(new RegExp(pq(enclosure)+"\\s*$"),"");input=backwards(input).split(new RegExp(pq(enclosure)+"\\s*"+pq(delimiter)+"\\s*"+pq(enclosure)+"(?!"+pq(escape)+")","g")).reverse();for(var i=0;i<input.length;i++){output.push(backwards(input[i]).replace(new RegExp(pq(escape)+pq(enclosure),"g"),enclosure))}return output},str_ireplace:function(search,replace,subject){var i,k="";var searchl=0;var reg;var escapeRegex=function(s){return s.replace(/([\\\^\$*+\[\]?{}.=!:(|)])/g,"\\$1")};search+="";searchl=search.length;if(!(replace instanceof Array)){replace=[replace];if(search instanceof Array){while(searchl>replace.length){replace[replace.length]=replace[0]}}}if(!(search instanceof Array)){search=[search]}while(search.length>replace.length){replace[replace.length]=""}if(subject instanceof Array){for(k in subject){if(subject.hasOwnProperty(k)){subject[k]=str_ireplace(search,replace,subject[k])}}return subject}searchl=search.length;for(i=0;i<searchl;i++){reg=new RegExp(escapeRegex(search[i]),"gi");subject=subject.replace(reg,replace[i])}return subject},str_pad:function(input,pad_length,pad_string,pad_type){var half="",pad_to_go;var str_pad_repeater=function(s,len){var collect="",i;while(collect.length<len){collect+=s}collect=collect.substr(0,len);return collect};input+="";pad_string=pad_string!==undefined?pad_string:" ";if(pad_type!="STR_PAD_LEFT"&&pad_type!="STR_PAD_RIGHT"&&pad_type!="STR_PAD_BOTH"){pad_type="STR_PAD_RIGHT"}if((pad_to_go=pad_length-input.length)>0){if(pad_type=="STR_PAD_LEFT"){input=str_pad_repeater(pad_string,pad_to_go)+input}else{if(pad_type=="STR_PAD_RIGHT"){input=input+str_pad_repeater(pad_string,pad_to_go)}else{if(pad_type=="STR_PAD_BOTH"){half=str_pad_repeater(pad_string,Math.ceil(pad_to_go/2));input=half+input+half;input=input.substr(0,pad_length)}}}}return input},str_repeat:function(input,multiplier){return new Array(multiplier+1).join(input)},str_replace:function(search,replace,subject,count){var i=0,j=0,temp="",repl="",sl=0,fl=0,f=[].concat(search),r=[].concat(replace),s=subject,ra=r instanceof Array,sa=s instanceof Array;s=[].concat(s);if(count){this.window[count]=0}for(i=0,sl=s.length;i<sl;i++){if(s[i]===""){continue}for(j=0,fl=f.length;j<fl;j++){temp=s[i]+"";repl=ra?(r[j]!==undefined?r[j]:""):r[0];s[i]=(temp).split(f[j]).join(repl);if(count&&s[i]!==temp){this.window[count]+=(temp.length-s[i].length)/f[j].length}}}return sa?s:s[0]},str_rot13:function(str){return(str+"").replace(/[A-Za-z]/g,function(c){return String.fromCharCode((((c=c.charCodeAt(0))&223)-52)%26+(c&32)+65)})},str_shuffle:function(str){if(str==undefined){throw"Wrong parameter count for str_shuffle()"}var getRandomInt=function(max){return Math.floor(Math.random()*(max+1))};var newStr="",rand=0;while(str.length){rand=getRandomInt(str.length-1);newStr+=str.charAt(rand);str=str.substring(0,rand)+str.substr(rand+1)}return newStr},str_split:function(string,split_length){if(string===undefined||!string.toString||split_length<1){return false}return string.toString().match(new RegExp(".{1,"+(split_length||"1")+"}","g"))},str_word_count:function(str,format,charlist){var l=str.length,tmpStr="";var i=0;var c="";var wArr=[],wC=0;var assArr={},aC=0,reg="";if(charlist){for(i=0;i<=charlist.length-1;i++){if(i!=charlist.length-1){reg=reg+charlist.charCodeAt(i)+"|"}else{reg=reg+charlist.charCodeAt(i)}}reg=new RegExp(reg)}for(i=0;i<=l-1;i++){c=str.charCodeAt(i);if((c<91&&c>64)||(c<123&&c>96)||c==45||c==39||(reg&&reg.test(c))){if(tmpStr==""&&format==2){aC=i}tmpStr=tmpStr+String.fromCharCode(c)}else{if(tmpStr!=""){if(format!=2){wArr[wArr.length]=tmpStr}else{assArr[aC]=tmpStr}tmpStr="";wC++}}}if(!format){return wC}else{if(format==1){return wArr}else{if(format==2){return assArr}}}throw"You have supplied an incorrect format"},strcasecmp:function(f_string1,f_string2){var string1=(f_string1+"").toLowerCase();var string2=(f_string2+"").toLowerCase();if(string1>string2){return 1}else{if(string1==string2){return 0}}return -1},strchr:function(haystack,needle,bool){return this.strstr(haystack,needle,bool)},strcmp:function(str1,str2){return((str1==str2)?0:((str1>str2)?1:-1))},strcspn:function(str,mask,start,length){start=start?start:0;var count=(length&&((start+length)<str.length))?start+length:str.length;strct:for(var i=start,lgth=0;i<count;i++){for(var j=0;j<mask.length;j++){if(str.charAt(i).indexOf(mask[j])!==-1){continue strct}}++lgth}return lgth},strip_tags:function(str,allowed_tags){var key="",allowed=false;var matches=[];var allowed_array=[];var allowed_tag="";var i=0;var k="";var html="";var replacer=function(search,replace,str){return str.split(search).join(replace)};if(allowed_tags){allowed_array=allowed_tags.match(/([a-zA-Z0-9]+)/gi)}str+="";matches=str.match(/(<\/?[\S][^>]*>)/gi);for(key in matches){if(isNaN(key)){continue}html=matches[key].toString();allowed=false;for(k in allowed_array){allowed_tag=allowed_array[k];i=-1;if(i!=0){i=html.toLowerCase().indexOf("<"+allowed_tag+">")}if(i!=0){i=html.toLowerCase().indexOf("<"+allowed_tag+" ")}if(i!=0){i=html.toLowerCase().indexOf("</"+allowed_tag)}if(i==0){allowed=true;break}}if(!allowed){str=replacer(html,"",str)}}return str},stripos:function(f_haystack,f_needle,f_offset){var haystack=(f_haystack+"").toLowerCase();var needle=(f_needle+"").toLowerCase();var index=0;if((index=haystack.indexOf(needle,f_offset))!==-1){return index}return false},stripslashes:function(str){return(str+"").replace(/\\(.?)/g,function(s,n1){switch(n1){case"\\":return"\\";case"0":return"\u0000";case"":return"";default:return n1}})},stristr:function(haystack,needle,bool){var pos=0;haystack+="";pos=haystack.toLowerCase().indexOf((needle+"").toLowerCase());if(pos==-1){return false}else{if(bool){return haystack.substr(0,pos)}else{return haystack.slice(pos)}}},strlen:function(string){var str=string+"";var i=0,chr="",lgth=0;var getWholeChar=function(str,i){var code=str.charCodeAt(i);var next="",prev="";if(55296<=code&&code<=56319){if(str.length<=(i+1)){throw"High surrogate without following low surrogate"}next=str.charCodeAt(i+1);if(56320>next||next>57343){throw"High surrogate without following low surrogate"}return str.charAt(i)+str.charAt(i+1)}else{if(56320<=code&&code<=57343){if(i===0){throw"Low surrogate without preceding high surrogate"}prev=str.charCodeAt(i-1);if(55296>prev||prev>56319){throw"Low surrogate without preceding high surrogate"}return false}}return str.charAt(i)};for(i=0,lgth=0;i<str.length;i++){if((chr=getWholeChar(str,i))===false){continue}lgth++}return lgth},strnatcasecmp:function(str1,str2){var a=(str1+"").toLowerCase();var b=(str2+"").toLowerCase();var isWhitespaceChar=function(a){return a.charCodeAt(0)<=32};var isDigitChar=function(a){var charCode=a.charCodeAt(0);return(charCode>=48&&charCode<=57)};var compareRight=function(a,b){var bias=0;var ia=0;var ib=0;var ca;var cb;for(;;ia++,ib++){ca=a.charAt(ia);cb=b.charAt(ib);if(!isDigitChar(ca)&&!isDigitChar(cb)){return bias}else{if(!isDigitChar(ca)){return -1}else{if(!isDigitChar(cb)){return +1}else{if(ca<cb){if(bias==0){bias=-1}}else{if(ca>cb){if(bias==0){bias=+1}}else{if(ca==0&&cb==0){return bias}}}}}}}};var ia=0,ib=0;var nza=0,nzb=0;var ca,cb;var result;while(true){nza=nzb=0;ca=a.charAt(ia);cb=b.charAt(ib);while(isWhitespaceChar(ca)||ca=="0"){if(ca=="0"){nza++}else{nza=0}ca=a.charAt(++ia)}while(isWhitespaceChar(cb)||cb=="0"){if(cb=="0"){nzb++}else{nzb=0}cb=b.charAt(++ib)}if(isDigitChar(ca)&&isDigitChar(cb)){if((result=compareRight(a.substring(ia),b.substring(ib)))!=0){return result}}if(ca==0&&cb==0){return nza-nzb}if(ca<cb){return -1}else{if(ca>cb){return +1}}++ia;++ib}},strnatcmp:function(f_string1,f_string2,f_version){var i=0;if(f_version==undefined){f_version=false}var __strnatcmp_split=function(f_string){var result=[];var buffer="";var chr="";var i=0,f_stringl=0;var text=true;f_stringl=f_string.length;for(i=0;i<f_stringl;i++){chr=f_string.substring(i,i+1);if(chr.match(/\d/)){if(text){if(buffer.length>0){result[result.length]=buffer;buffer=""}text=false}buffer+=chr}else{if((text==false)&&(chr==".")&&(i<(f_string.length-1))&&(f_string.substring(i+1,i+2).match(/\d/))){result[result.length]=buffer;buffer=""}else{if(text==false){if(buffer.length>0){result[result.length]=parseInt(buffer,10);buffer=""}text=true}buffer+=chr}}}if(buffer.length>0){if(text){result[result.length]=buffer}else{result[result.length]=parseInt(buffer,10)}}return result};var array1=__strnatcmp_split(f_string1+"");var array2=__strnatcmp_split(f_string2+"");var len=array1.length;var text=true;var result=-1;var r=0;if(len>array2.length){len=array2.length;result=1}for(i=0;i<len;i++){if(isNaN(array1[i])){if(isNaN(array2[i])){text=true;if((r=this.strcmp(array1[i],array2[i]))!=0){return r}}else{if(text){return 1}else{return -1}}}else{if(isNaN(array2[i])){if(text){return -1}else{return 1}}else{if(text||f_version){if((r=(array1[i]-array2[i]))!=0){return r}}else{if((r=this.strcmp(array1[i].toString(),array2[i].toString()))!=0){return r}}text=false}}}return result},strncasecmp:function(argStr1,argStr2,len){var diff,i=0;var str1=(argStr1+"").toLowerCase().substr(0,len);var str2=(argStr2+"").toLowerCase().substr(0,len);if(str1.length!==str2.length){if(str1.length<str2.length){len=str1.length;if(str2.substr(0,str1.length)==str1){return str1.length-str2.length}}else{len=str2.length;if(str1.substr(0,str2.length)==str2){return str1.length-str2.length}}}else{len=str1.length}for(diff=0,i=0;i<len;i++){diff=str1.charCodeAt(i)-str2.charCodeAt(i);if(diff!==0){return diff}}return 0},strncmp:function(str1,str2,lgth){var s1=(str1+"").substr(0,lgth);var s2=(str2+"").substr(0,lgth);return((s1==s2)?0:((s1>s2)?1:-1))},strpbrk:function(haystack,char_list){for(var i=0,len=haystack.length;i<len;++i){if(char_list.indexOf(haystack.charAt(i))>=0){return haystack.slice(i)}}return false},strpos:function(haystack,needle,offset){var i=(haystack+"").indexOf(needle,(offset?offset:0));return i===-1?false:i},strrchr:function(haystack,needle){var pos=0;if(typeof needle!=="string"){needle=String.fromCharCode(parseInt(needle,10))}needle=needle.charAt(0);pos=haystack.lastIndexOf(needle);if(pos===-1){return false}return haystack.substr(pos)},strrev:function(string){string=string+"";var grapheme_extend=/(.)([\uDC00-\uDFFF\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065E\u0670\u06D6-\u06DC\u06DE-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0901-\u0903\u093C\u093E-\u094D\u0951-\u0954\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C01-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C82\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D02\u0D03\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F90-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B6-\u17D3\u17DD\u180B-\u180D\u18A9\u1920-\u192B\u1930-\u193B\u19B0-\u19C0\u19C8\u19C9\u1A17-\u1A1B\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAA\u1C24-\u1C37\u1DC0-\u1DE6\u1DFE\u1DFF\u20D0-\u20F0\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA67C\uA67D\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C4\uA926-\uA92D\uA947-\uA953\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uFB1E\uFE00-\uFE0F\uFE20-\uFE26])/g;string=string.replace(grapheme_extend,"$2$1");return string.split("").reverse().join("")},strripos:function(haystack,needle,offset){haystack=(haystack+"").toLowerCase();needle=(needle+"").toLowerCase();var i=-1;if(offset){i=(haystack+"").slice(offset).lastIndexOf(needle);if(i!==-1){i+=offset}}else{i=(haystack+"").lastIndexOf(needle)}return i>=0?i:false},strrpos:function(haystack,needle,offset){var i=-1;if(offset){i=(haystack+"").slice(offset).lastIndexOf(needle);if(i!==-1){i+=offset}}else{i=(haystack+"").lastIndexOf(needle)}return i>=0?i:false},strspn:function(str1,str2,start,lgth){var found;var stri;var strj;var j=0;var i=0;start=start?(start<0?(str1.length+start):start):0;lgth=lgth?((lgth<0)?(str1.length+lgth-start):lgth):str1.length-start;str1=str1.substr(start,lgth);for(i=0;i<str1.length;i++){found=0;stri=str1.substring(i,i+1);for(j=0;j<=str2.length;j++){strj=str2.substring(j,j+1);if(stri==strj){found=1;break}}if(found!=1){return i}}return i},strstr:function(haystack,needle,bool){var pos=0;haystack+="";pos=haystack.indexOf(needle);if(pos==-1){return false}else{if(bool){return haystack.substr(0,pos)}else{return haystack.slice(pos)}}},strtok:function(str,tokens){this.php_js=this.php_js||{};if(tokens===undefined){tokens=str;str=this.php_js.strtokleftOver}if(str.length===0){return false}if(tokens.indexOf(str.charAt(0))!==-1){return this.strtok(str.substr(1),tokens)}for(var i=0;i<str.length;i++){if(tokens.indexOf(str.charAt(i))!==-1){break}}this.php_js.strtokleftOver=str.substr(i+1);return str.substring(0,i)},strtolower:function(str){return(str+"").toLowerCase()},strtotime:function(str,now){var i,match,s,strTmp="",parse="";strTmp=str;strTmp=strTmp.replace(/\s{2,}|^\s|\s$/g," ");strTmp=strTmp.replace(/[\t\r\n]/g,"");if(strTmp=="now"){return(new Date()).getTime()/1000}else{if(!isNaN(parse=Date.parse(strTmp))){return(parse/1000)}else{if(now){now=new Date(now*1000)}else{now=new Date()}}}strTmp=strTmp.toLowerCase();var __is={day:{sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6},mon:{jan:0,feb:1,mar:2,apr:3,may:4,jun:5,jul:6,aug:7,sep:8,oct:9,nov:10,dec:11}};var process=function(m){var ago=(m[2]&&m[2]=="ago");var num=(num=m[0]=="last"?-1:1)*(ago?-1:1);switch(m[0]){case"last":case"next":switch(m[1].substring(0,3)){case"yea":now.setFullYear(now.getFullYear()+num);break;case"mon":now.setMonth(now.getMonth()+num);break;case"wee":now.setDate(now.getDate()+(num*7));break;case"day":now.setDate(now.getDate()+num);break;case"hou":now.setHours(now.getHours()+num);break;case"min":now.setMinutes(now.getMinutes()+num);break;case"sec":now.setSeconds(now.getSeconds()+num);break;default:var day;if(typeof(day=__is.day[m[1].substring(0,3)])!="undefined"){var diff=day-now.getDay();if(diff==0){diff=7*num}else{if(diff>0){if(m[0]=="last"){diff-=7}}else{if(m[0]=="next"){diff+=7}}}now.setDate(now.getDate()+diff)}}break;default:if(/\d+/.test(m[0])){num*=parseInt(m[0],10);switch(m[1].substring(0,3)){case"yea":now.setFullYear(now.getFullYear()+num);break;case"mon":now.setMonth(now.getMonth()+num);break;case"wee":now.setDate(now.getDate()+(num*7));break;case"day":now.setDate(now.getDate()+num);break;case"hou":now.setHours(now.getHours()+num);break;case"min":now.setMinutes(now.getMinutes()+num);break;case"sec":now.setSeconds(now.getSeconds()+num);break}}else{return false}break}return true};match=strTmp.match(/^(\d{2,4}-\d{2}-\d{2})(?:\s(\d{1,2}:\d{2}(:\d{2})?)?(?:\.(\d+))?)?$/);if(match!=null){if(!match[2]){match[2]="00:00:00"}else{if(!match[3]){match[2]+=":00"}}s=match[1].split(/-/g);for(i in __is.mon){if(__is.mon[i]==s[1]-1){s[1]=i}}s[0]=parseInt(s[0],10);s[0]=(s[0]>=0&&s[0]<=69)?"20"+(s[0]<10?"0"+s[0]:s[0]+""):(s[0]>=70&&s[0]<=99)?"19"+s[0]:s[0]+"";return parseInt(this.strtotime(s[2]+" "+s[1]+" "+s[0]+" "+match[2])+(match[4]?match[4]/1000:""),10)}var regex="([+-]?\\d+\\s(years?|months?|weeks?|days?|hours?|min|minutes?|sec|seconds?|sun\\.?|sunday|mon\\.?|monday|tue\\.?|tuesday|wed\\.?|wednesday|thu\\.?|thursday|fri\\.?|friday|sat\\.?|saturday)|(last|next)\\s(years?|months?|weeks?|days?|hours?|min|minutes?|sec|seconds?|sun\\.?|sunday|mon\\.?|monday|tue\\.?|tuesday|wed\\.?|wednesday|thu\\.?|thursday|fri\\.?|friday|sat\\.?|saturday))(\\sago)?";match=strTmp.match(new RegExp(regex,"gi"));if(match==null){return false}for(i=0;i<match.length;i++){if(!process(match[i].split(" "))){return false}}return(now.getTime()/1000)},strtoupper:function(str){return(str+"").toUpperCase()},strtr:function(str,from,to){var fr="",i=0,j=0,lenStr=0,lenFrom=0,tmpStrictForIn=false,fromTypeStr="",toTypeStr="",istr="";var tmpFrom=[];var tmpTo=[];var ret="";var match=false;if(typeof from==="object"){tmpStrictForIn=this.ini_set("phpjs.strictForIn",false);from=this.krsort(from);this.ini_set("phpjs.strictForIn",tmpStrictForIn);for(fr in from){if(from.hasOwnProperty(fr)){tmpFrom.push(fr);tmpTo.push(from[fr])}}from=tmpFrom;to=tmpTo}lenStr=str.length;lenFrom=from.length;fromTypeStr=typeof from==="string";toTypeStr=typeof to==="string";for(i=0;i<lenStr;i++){match=false;if(fromTypeStr){istr=str.charAt(i);for(j=0;j<lenFrom;j++){if(istr==from.charAt(j)){match=true;break}}}else{for(j=0;j<lenFrom;j++){if(str.substr(i,from[j].length)==from[j]){match=true;i=(i+from[j].length)-1;break}}}if(match){ret+=toTypeStr?to.charAt(j):to[j]}else{ret+=str.charAt(i)}}return ret},substr:function(str,start,len){str+="";var end=str.length;if(start<0){start+=end}end=typeof len==="undefined"?end:(len<0?len+end:len+start);return start>=str.length||start<0||start>end?!1:str.slice(start,end)},substr_compare:function(main_str,str,offset,length,case_insensitivity){if(!offset&&offset!==0){throw"Missing offset for substr_compare()"}if(offset<0){offset=main_str.length+offset}if(length&&length>(main_str.length-offset)){return false}length=length||main_str.length-offset;main_str=main_str.substr(offset,length);str=str.substr(0,length);if(case_insensitivity){main_str=(main_str+"").toLowerCase();str=(str+"").toLowerCase();if(main_str==str){return 0}return(main_str>str)?1:-1}return((main_str==str)?0:((main_str>str)?1:-1))},substr_count:function(haystack,needle,offset,length){var pos=0,cnt=0;haystack+="";needle+="";if(isNaN(offset)){offset=0}if(isNaN(length)){length=0}offset--;while((offset=haystack.indexOf(needle,offset+1))!=-1){if(length>0&&(offset+needle.length)>length){return false}else{cnt++}}return cnt},substr_replace:function(str,replace,start,length){if(start<0){start=start+str.length}length=length!==undefined?length:str.length;if(length<0){length=length+str.length-start}return str.slice(0,start)+replace.substr(0,length)+replace.slice(length)+str.slice(start+length)},tan:function(arg){return Math.tan(arg)},tanh:function(arg){return(Math.exp(arg)-Math.exp(-arg))/(Math.exp(arg)+Math.exp(-arg))},time:function(){return Math.floor(new Date().getTime()/1000)},trim:function(str,charlist){var whitespace,l=0,i=0;str+="";if(!charlist){whitespace=" \n\r\t\f\x0b\xa0\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u200b\u2028\u2029\u3000"}else{charlist+="";whitespace=charlist.replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"$1")}l=str.length;for(i=0;i<l;i++){if(whitespace.indexOf(str.charAt(i))===-1){str=str.substring(i);break}}l=str.length;for(i=l-1;i>=0;i--){if(whitespace.indexOf(str.charAt(i))===-1){str=str.substring(0,i+1);break}}return whitespace.indexOf(str.charAt(0))===-1?str:""},uasort:function(inputArr,sorter){var valArr=[],keyArr=[],tempKeyVal,tempValue,ret,k="",i=0,strictForIn=false,populateArr=[];if(typeof sorter==="string"){sorter=this[sorter]}else{if(sorter instanceof Array){sorter=this[sorter[0]][sorter[1]]}}var sorterNew=function(keyArr,valArr){for(var i=valArr.length-2;i>=0;i--){for(var j=0;j<=i;j++){ret=sorter(valArr[j+1],valArr[j]);if(ret<0){tempValue=valArr[j];valArr[j]=valArr[j+1];valArr[j+1]=tempValue;tempKeyVal=keyArr[j];keyArr[j]=keyArr[j+1];keyArr[j+1]=tempKeyVal}}}};this.php_js=this.php_js||{};this.php_js.ini=this.php_js.ini||{};strictForIn=this.php_js.ini["phpjs.strictForIn"]&&this.php_js.ini["phpjs.strictForIn"].local_value;populateArr=strictForIn?inputArr:populateArr;for(k in inputArr){if(inputArr.hasOwnProperty){valArr.push(inputArr[k]);keyArr.push(k);if(strictForIn){delete inputArr[k]}}}try{sorterNew(keyArr,valArr)}catch(e){return false}for(i=0;i<valArr.length;i++){populateArr[keyArr[i]]=valArr[i]}return strictForIn?true:populateArr},ucfirst:function(str){str+="";var f=str.charAt(0).toUpperCase();return f+str.substr(1)},ucwords:function(str){return(str+"").replace(/^(.)|\s(.)/g,function($1){return $1.toUpperCase()})},uksort:function(inputArr,sorter){var tmp_arr={},keys=[],i=0,k="",strictForIn=false,populateArr=[];if(typeof sorter==="string"){sorter=this.window[sorter]}for(k in inputArr){if(inputArr.hasOwnProperty){keys.push(k)}}try{if(sorter){keys.sort(sorter)}else{keys.sort()}}catch(e){return false}this.php_js=this.php_js||{};this.php_js.ini=this.php_js.ini||{};strictForIn=this.php_js.ini["phpjs.strictForIn"]&&this.php_js.ini["phpjs.strictForIn"].local_value;populateArr=strictForIn?inputArr:populateArr;for(i=0;i<keys.length;i++){k=keys[i];tmp_arr[k]=inputArr[k];if(strictForIn){delete inputArr[k]}}for(i in tmp_arr){if(tmp_arr.hasOwnProperty){populateArr[i]=tmp_arr[i]}}return strictForIn?true:populateArr},unserialize:function(data){var that=this;var utf8Overhead=function(chr){var code=chr.charCodeAt(0);if(code<128){return 0}if(code<2048){return 1}return 2};var error=function(type,msg,filename,line){throw new that.window[type](msg,filename,line)};var read_until=function(data,offset,stopchr){var buf=[];var chr=data.slice(offset,offset+1);var i=2;while(chr!=stopchr){if((i+offset)>data.length){error("Error","Invalid")}buf.push(chr);chr=data.slice(offset+(i-1),offset+i);i+=1}return[buf.length,buf.join("")]};var read_chrs=function(data,offset,length){var buf;buf=[];for(var i=0;i<length;i++){var chr=data.slice(offset+(i-1),offset+i);buf.push(chr);length-=utf8Overhead(chr)}return[buf.length,buf.join("")]};var _unserialize=function(data,offset){var readdata;var readData;var chrs=0;var ccount;var stringlength;var keyandchrs;var keys;if(!offset){offset=0}var dtype=(data.slice(offset,offset+1)).toLowerCase();var dataoffset=offset+2;var typeconvert=function(x){return x};switch(dtype){case"i":typeconvert=function(x){return parseInt(x,10)};readData=read_until(data,dataoffset,";");chrs=readData[0];readdata=readData[1];dataoffset+=chrs+1;break;case"b":typeconvert=function(x){return parseInt(x,10)!==0};readData=read_until(data,dataoffset,";");chrs=readData[0];readdata=readData[1];dataoffset+=chrs+1;break;case"d":typeconvert=function(x){return parseFloat(x)};readData=read_until(data,dataoffset,";");chrs=readData[0];readdata=readData[1];dataoffset+=chrs+1;break;case"n":readdata=null;break;case"s":ccount=read_until(data,dataoffset,":");chrs=ccount[0];stringlength=ccount[1];dataoffset+=chrs+2;readData=read_chrs(data,dataoffset+1,parseInt(stringlength,10));chrs=readData[0];readdata=readData[1];dataoffset+=chrs+2;if(chrs!=parseInt(stringlength,10)&&chrs!=readdata.length){error("SyntaxError","String length mismatch")}readdata=that.utf8_decode(readdata);break;case"a":readdata={};keyandchrs=read_until(data,dataoffset,":");chrs=keyandchrs[0];keys=keyandchrs[1];dataoffset+=chrs+2;for(var i=0;i<parseInt(keys,10);i++){var kprops=_unserialize(data,dataoffset);var kchrs=kprops[1];var key=kprops[2];dataoffset+=kchrs;var vprops=_unserialize(data,dataoffset);var vchrs=vprops[1];var value=vprops[2];dataoffset+=vchrs;readdata[key]=value}dataoffset+=1;break;default:error("SyntaxError","Unknown / Unhandled data type(s): "+dtype);break}return[dtype,dataoffset-offset,typeconvert(readdata)]};return _unserialize((data+""),0)[2]},urldecode:function(str){return decodeURIComponent(str.replace(/\+/g,"%20"))},urlencode:function(str){str=(str+"").toString();return encodeURIComponent(str).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")},usort:function(inputArr,sorter){var valArr=[],k="",i=0,strictForIn=false,populateArr=[];if(typeof sorter==="string"){sorter=this[sorter]}else{if(sorter instanceof Array){sorter=this[sorter[0]][sorter[1]]}}this.php_js=this.php_js||{};this.php_js.ini=this.php_js.ini||{};strictForIn=this.php_js.ini["phpjs.strictForIn"]&&this.php_js.ini["phpjs.strictForIn"].local_value;populateArr=strictForIn?inputArr:populateArr;for(k in inputArr){if(inputArr.hasOwnProperty){valArr.push(inputArr[k]);if(strictForIn){delete inputArr[k]}}}try{valArr.sort(sorter)}catch(e){return false}for(i=0;i<valArr.length;i++){populateArr[i]=valArr[i]}return strictForIn?true:populateArr},utf8_decode:function(str_data){var tmp_arr=[],i=0,ac=0,c1=0,c2=0,c3=0;str_data+="";while(i<str_data.length){c1=str_data.charCodeAt(i);if(c1<128){tmp_arr[ac++]=String.fromCharCode(c1);i++}else{if((c1>191)&&(c1<224)){c2=str_data.charCodeAt(i+1);tmp_arr[ac++]=String.fromCharCode(((c1&31)<<6)|(c2&63));i+=2}else{c2=str_data.charCodeAt(i+1);c3=str_data.charCodeAt(i+2);tmp_arr[ac++]=String.fromCharCode(((c1&15)<<12)|((c2&63)<<6)|(c3&63));i+=3}}}return tmp_arr.join("")},utf8_encode:function(argString){var string=(argString+"");var utftext="";var start,end;var stringl=0;start=end=0;stringl=string.length;for(var n=0;n<stringl;n++){var c1=string.charCodeAt(n);var enc=null;if(c1<128){end++}else{if(c1>127&&c1<2048){enc=String.fromCharCode((c1>>6)|192)+String.fromCharCode((c1&63)|128)}else{enc=String.fromCharCode((c1>>12)|224)+String.fromCharCode(((c1>>6)&63)|128)+String.fromCharCode((c1&63)|128)}}if(enc!==null){if(end>start){utftext+=string.substring(start,end)}utftext+=enc;start=end=n+1}}if(end>start){utftext+=string.substring(start,string.length)}return utftext},var_dump:function(){var output="",pad_char=" ",pad_val=4,lgth=0,i=0,d=this.window.document;var getFuncName=function(fn){var name=(/\W*function\s+([\w\$]+)\s*\(/).exec(fn);if(!name){return"(Anonymous)"}return name[1]};var repeat_char=function(len,pad_char){var str="";for(var i=0;i<len;i++){str+=pad_char}return str};var getScalarVal=function(val){var ret="";if(val===null){ret="NULL"}else{if(typeof val==="boolean"){ret="bool("+val+")"}else{if(typeof val==="string"){ret="string("+val.length+') "'+val+'"'}else{if(typeof val==="number"){if(parseFloat(val)==parseInt(val,10)){ret="int("+val+")"}else{ret="float("+val+")"}}else{if(val===undefined){ret="UNDEFINED"}else{if(typeof val==="function"){ret="FUNCTION"}}}}}}return ret};var formatArray=function(obj,cur_depth,pad_val,pad_char){var someProp="";if(cur_depth>0){cur_depth++}var base_pad=repeat_char(pad_val*(cur_depth-1),pad_char);var thick_pad=repeat_char(pad_val*(cur_depth+1),pad_char);var str="";var val="";if(typeof obj==="object"&&obj!==null){if(obj.constructor&&getFuncName(obj.constructor)==="PHPJS_Resource"){return obj.var_dump()}lgth=0;for(someProp in obj){lgth++}str+="array("+lgth+") {\n";for(var key in obj){if(typeof obj[key]==="object"&&obj[key]!==null){str+=thick_pad+"["+key+"] =>\n"+thick_pad+formatArray(obj[key],cur_depth+1,pad_val,pad_char)}else{val=getScalarVal(obj[key]);str+=thick_pad+"["+key+"] =>\n"+thick_pad+val+"\n"}}str+=base_pad+"}\n"}else{str=getScalarVal(obj)}return str};output=formatArray(arguments[0],0,pad_val,pad_char);for(i=1;i<arguments.length;i++){output+="\n"+formatArray(arguments[i],0,pad_val,pad_char)}if(d.body){this.echo(output)}else{try{d=XULDocument;this.echo('<pre xmlns="http://www.w3.org/1999/xhtml" style="white-space:pre;">'+output+"</pre>")}catch(e){this.echo(output)}}},var_export:function(mixed_expression,bool_return){var retstr="",iret="",cnt=0,x=[],i=0,funcParts=[];var getFuncName=function(fn){var name=(/\W*function\s+([\w\$]+)\s*\(/).exec(fn);if(!name){return"(Anonymous)"}return name[1]};var __getType=function(inp){var i=0;var match,type=typeof inp;if(type==="object"&&inp.constructor&&getFuncName(inp.constructor)==="PHPJS_Resource"){return"resource"}if(type==="function"){return"function"}if(type==="object"&&!inp){return"null"}if(type==="object"){if(!inp.constructor){return"object"}var cons=inp.constructor.toString();match=cons.match(/(\w+)\(/);if(match){cons=match[1].toLowerCase()}var types=["boolean","number","string","array"];for(i=0;i<types.length;i++){if(cons===types[i]){type=types[i];break}}}return type};var type=__getType(mixed_expression);if(type===null){retstr="NULL"}else{if(type==="array"||type==="object"){for(i in mixed_expression){x[cnt++]=this.var_export(i,true)+" => "+this.var_export(mixed_expression[i],true)}iret=x.join(",\n  ");retstr="array (\n  "+iret+"\n)"}else{if(type==="function"){funcParts=mixed_expression.toString().match(/function .*?\((.*?)\) \{([\s\S]*)\}/);retstr="create_function ('"+funcParts[1]+"', '"+funcParts[2].replace(new RegExp("'","g"),"\\'")+"')"}else{if(type==="resource"){retstr="NULL"}else{retstr=(!isNaN(mixed_expression))?mixed_expression:"'"+mixed_expression.replace(/(["'])/g,"\\$1").replace(/\0/g,"\\0")+"'"}}}}if(bool_return!==true){this.echo(retstr);return null}else{return retstr}},vprintf:function(format,args){var body,elmt;var ret="",d=this.window.document;var HTMLNS="http://www.w3.org/1999/xhtml";body=d.getElementsByTagNameNS?(d.getElementsByTagNameNS(HTMLNS,"body")[0]?d.getElementsByTagNameNS(HTMLNS,"body")[0]:d.documentElement.lastChild):d.getElementsByTagName("body")[0];if(!body){return false}ret=this.sprintf.apply(this,[format].concat(args));elmt=d.createTextNode(ret);body.appendChild(elmt);return ret.length},vsprintf:function(format,args){return this.sprintf.apply(this,[format].concat(args))},wordwrap:function(str,int_width,str_break,cut){var m=((arguments.length>=2)?arguments[1]:75);var b=((arguments.length>=3)?arguments[2]:"\n");var c=((arguments.length>=4)?arguments[3]:false);var i,j,l,s,r;str+="";if(m<1){return str}for(i=-1,l=(r=str.split(/\r\n|\n|\r/)).length;++i<l;r[i]+=s){for(s=r[i],r[i]="";s.length>m;r[i]+=s.slice(0,j)+((s=s.slice(j)).length?b:"")){j=c==2||(j=s.slice(0,m+1).match(/\S*(\s)?$/))[1]?m:j.input.length-j[0].length||c==1&&m||j.input.length+(j=s.slice(m).match(/^\S*/)).input.length}}return r.join("\n")}};this.PHP_JS=PHP_JS}());tinyMCE.init({theme:"advanced",mode:"textareas",cleanup:false,element_format:"html",plugins:"spellchecker, searchreplace, insertdatetime, print, fullscreen",plugin_insertdate_dateFormat:"%Y-%m-%d",plugin_insertdate_timeFormat:"%H:%M:%S",browsers:"msie,gecko,safari,opera",theme_advanced_buttons1:"bold, italic, underline, |, 	                           bullist, numlist, |, 	                           outdent, indent, |, 	                           spellchecker, search, replace, |, 	                           link, unlink, print, fullscreen",theme_advanced_buttons2:"",theme_advanced_buttons3:"",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",theme_advanced_statusbar_location:"bottom",theme_advanced_resizing:true,spellchecker_rpc_url:"/javascripts/tiny_mce/plugins/spellchecker/rpc.php",spellchecker_languages:"+English=en"});var requiredMajorVersion=9;var requiredMinorVersion=0;var requiredRevision=45;var Fisma={};$P=new PHP_JS();String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};var readyFunc=function(){var g=YAHOO.util.Selector.query(".date");for(var b=0;b<g.length;b++){YAHOO.util.Event.on(g[b].getAttribute("id")+"_show","click",callCalendar,g[b].getAttribute("id"))}var a=function(){if(document.getElementById("remediationSearchAging")){var k=document.getElementById("remediationSearchAging").value.trim()}else{return}var h=document.getElementById("created_date_begin");var j=document.getElementById("created_date_end");if(k=="0"){h.disabled=false;j.disabled=false;document.getElementById("show1").disabled=false;document.getElementById("show2").disabled=false}else{h.disabled=true;j.disabled=true;h.value="";j.value="";document.getElementById("show1").disabled=true;document.getElementById("show2").disabled=true}};YAHOO.util.Event.on("remediationSearchAging","change",a);a();var f=function(){if(document.getElementById("created_date_begin")&&document.getElementById("created_date_end")){var j=document.getElementById("created_date_begin").value.trim();var h=document.getElementById("created_date_end").value.trim()}else{return}if(j!=""||h!=""){document.getElementById("remediationSearchAging").disabled=true}else{document.getElementById("remediationSearchAging").disabled=false}};YAHOO.util.Event.on("created_date_begin","change",f);YAHOO.util.Event.on("created_date_end","change",f);f();var d=function(){if(document.getElementById("encrypt")){var j=document.getElementById("encrypt")}else{return}var h=j.value.trim();if(h=="sha256"){j.style.display=""}else{j.style.display="none"}};YAHOO.util.Event.on("encrypt","change",d);d();YAHOO.util.Event.on("function_screen","change",search_function);search_function();YAHOO.util.Event.on("add_function","click",function(){var h=new YAHOO.util.Selector.query("#availableFunctions option");for(var j=0;j<h.length;j++){if(h[j].selected==true){document.getElementById("existFunctions").appendChild(h[j])}}return false});YAHOO.util.Event.on("remove_function","click",function(){var h=YAHOO.util.Selector.query("#existFunctions option");for(var j=0;j<h.length;j++){if(h[j].selected==true){document.getElementById("availableFunctions").appendChild(h[j])}}return false});YAHOO.util.Event.on(YAHOO.util.Selector.query("form[name=assign_right]"),"submit",function(){var h=YAHOO.util.Selector.query("#existFunctions option");for(var j=0;j<h.length;j++){h[j].selected=true}});YAHOO.util.Event.on("searchAsset","click",searchAsset);YAHOO.util.Event.on("search_product","click",searchProduct);YAHOO.util.Event.on(YAHOO.util.Selector.query(".confirm"),"click",function(){var h="DELETING CONFIRMATION!";if(confirm(h)==true){return true}return false});asset_detail();getProdId()};function search_function(){var f=YAHOO.util.Selector.query("select[name=function_screen]");if(f==""){return}var k=name="";var d=YAHOO.util.Selector.query("select[name=function_screen] option");for(var g=0;g<d.length;g++){if(d[g].selected==true){name=d[g].text}}if(""!=name){k+="/screen_name/"+name}var b=YAHOO.util.Selector.query("#existFunctions option");var j="";for(var g=0;g<b.length;g++){if(g==0){j+=b[g].value}else{j+=","+b[g].value}}var a=document.getElementById("function_screen").getAttribute("url")+"/do/availableFunctions"+k+"/existFunctions/"+j;var h=YAHOO.util.Connect.asyncRequest("GET",a,{success:function(l){document.getElementById("availableFunctions").parentNode.innerHTML='<select style="width: 250px;" name="availableFunctions" id="availableFunctions" size="20" multiple="">'+l.responseText+"</select>"},failure:handleFailure})}var handleFailure=function(a){alert("error")};function getProdId(){var a=document.getElementById("productId");YAHOO.util.Event.on(a,"change",function(){document.getElementById("productId").value=a.value})}var searchProduct=function(){var d=document.getElementById("search_product");var b=d.getAttribute("url");var a=YAHOO.util.Selector.query("input.product");for(var f=0;f<a.length;f++){if(a[f].value!=undefined&&a[f].value!=""){b+="/"+a[f].name+"/"+a[f].value}}YAHOO.util.Connect.asyncRequest("GET",b,{success:function(g){document.getElementById("productId").parentNode.innerHTML=g.responseText;document.getElementById("productId").style.width="400px";getProdId()},failure:handleFailure})};var searchAsset=function(){var b=new YAHOO.util.Element("orgSystemId");if(b.get("id")==undefined){return}var g=b.get("value");var h="";if(0!=parseInt(g)){h+="/system_id/"+g}var f=YAHOO.util.Selector.query("input.assets");for(var d=0;d<f.length;d++){if(f[d].value!=undefined&&f[d].value!=""){h+="/"+f[d].name+"/"+f[d].value}}var a=document.getElementById("orgSystemId").getAttribute("url")+h;YAHOO.util.Connect.asyncRequest("GET",a,{success:function(l){document.getElementById("assetId").options.length=0;var j=YAHOO.lang.JSON.parse(l.responseText);j=j.table.records;for(var k=0;k<j.length;k++){document.getElementById("assetId").options.add(new Option(j[k].name,j[k].id))}},failure:handleFailure})};function asset_detail(){YAHOO.util.Event.on("assetId","change",function(){var a=this.getAttribute("url")+this.value;YAHOO.util.Connect.asyncRequest("GET",a,{success:function(b){document.getElementById("asset_info").innerHTML=b.responseText},failure:handleFailure})})}function message(d,a){d=$P.stripslashes(d);if(document.getElementById("msgbar")){var b=document.getElementById("msgbar")}else{return}if(b.innerHTML){b.innerHTML=b.innerHTML+d}else{b.innerHTML=d}b.style.fontWeight="bold";if(a=="warning"){b.style.color="red"}else{b.style.color="green";b.style.borderColor="green";b.style.backgroundColor="lightgreen"}b.style.display="block"}function toggleSearchOptions(b){var a=document.getElementById("advanced_searchbox");if(a.style.display=="none"){a.style.display="";b.value="Basic Search"}else{a.style.display="none";b.value="Advanced Search"}}function showJustification(){if(document.getElementById("ecd_justification")){document.getElementById("ecd_justification").style.display=""}}function addBookmark(f,d){if(window.sidebar){window.sidebar.addPanel(d.title,d.href,"")}else{if(window.opera){var b=document.createElement("A");b.rel="sidebar";b.target="_search";b.title=d.title;b.href=d.href;b.click()}else{if(document.all){window.external.AddFavorite(d.href,d.title)}else{alert("Your browser does not support automatic bookmarks. Please try to bookmark this page manually instead.")}}}}function highlight(d,b){if(""==b){return}b.sort();b.reverse();for(var a in b){highlightWord(d,b[a])}}function highlightWord(d,a){if(d&&d.hasChildNodes){var b;for(b=0;b<d.childNodes.length;b++){highlightWord(d.childNodes[b],a)}}if(d&&d.nodeType==3){tempNodeVal=d.nodeValue.toLowerCase();tempWordVal=a.toLowerCase();if(tempNodeVal.indexOf(tempWordVal)!=-1){pn=d.parentNode;if(pn.className!="highlight"){nv=d.nodeValue;ni=tempNodeVal.indexOf(tempWordVal);before=document.createTextNode(nv.substr(0,ni));docWordVal=nv.substr(ni,a.length);after=document.createTextNode(nv.substr(ni+a.length));hiwordtext=document.createTextNode(docWordVal);hiword=document.createElement("span");hiword.className="highlight";hiword.appendChild(hiwordtext);pn.insertBefore(before,d);pn.insertBefore(hiword,d);pn.insertBefore(after,d);pn.removeChild(d)}}}}function removeHighlight(b){if(b.hasChildNodes){var a;for(a=0;a<b.childNodes.length;a++){removeHighlight(b.childNodes[a])}}if(b.nodeType==3){pn=b.parentNode;if(pn.className=="highlight"){prevSib=pn.previousSibling;nextSib=pn.nextSibling;nextSib.nodeValue=prevSib.nodeValue+b.nodeValue+nextSib.nodeValue;prevSib.nodeValue="";b.nodeValue=""}}}function switchYear(f){if(!isFinite(f)){f=0}var g=document.getElementById("gen_shortcut");var d=g.getAttribute("year");d=Number(d)+Number(f);g.setAttribute("year",d);var a=g.getAttribute("url")+d+"/";var b=YAHOO.util.Selector.query("#gen_shortcut span:nth-child(1)");b[0].innerHTML=d;b[0].parentNode.setAttribute("href",a);b[1].parentNode.setAttribute("href",a+"q/1/");b[2].parentNode.setAttribute("href",a+"q/2/");b[3].parentNode.setAttribute("href",a+"q/3/");b[4].parentNode.setAttribute("href",a+"q/4/")}function form_confirm(h,g){var k=false;elements=YAHOO.util.Selector.query("[name*='finding']");for(var b=0;b<elements.length;b++){var j=elements[b].tagName.toUpperCase();if(j=="INPUT"){var a=elements[b].type;if(a=="text"||a=="password"){var d=elements[b].getAttribute("_value");if(typeof(d)=="undefined"){d=""}if(d!=elements[b].value){}}if(a=="checkbox"||a=="radio"){var d=elements[b].checked?"on":"off";if(d!=elements[b].getAttribute("_value")){k=true}}}else{if(j=="SELECT"){var d=elements[b].getAttribute("_value");if(typeof(d)=="undefined"){d=""}if(d!=elements[b].options[elements[b].selectedIndex].value){k=true}}else{if(j=="TEXTAREA"){var d=elements[b].getAttribute("_value");if(typeof(d)=="undefined"){d=""}var f=elements[b].value?elements[b].value:elements[b].innerHTML;if(d!=f){k=true}}}}}if(k){if(confirm('WARNING: You have unsaved changes on the page. If you continue, these changes will be lost. If you want to save your changes, click "Cancel" now and then click "Save Changes".')){return true}else{return false}}if(confirm("WARNING: You are about to "+g+'. This action cannot be undone. Please click "Ok" to confirm your action or click "Cancel" to stop.')){return true}return false}function dump(a){var b=""+a;for(i in a){if("function"!=typeof(a[i])){b+=i+" : "+a[i]+"\n"}}alert(b)}var e=YAHOO.util.Event;e.onDOMReady(readyFunc);function callCalendar(a,b){showCalendar(b,b+"_show")}function showCalendar(g,d){var m=YAHOO.util.Event,j=YAHOO.util.Dom,k,h;var l=j.get(d);var k;var h;if(!k){function f(){j.get(g).value="";a()}function a(){k.hide()}k=new YAHOO.widget.Dialog("container",{visible:false,context:[g,"tl","bl"],draggable:true,close:true});k.setHeader("Pick A Date");k.setBody('<div id="cal"></div><div class="clear"></div>');k.render(document.body);dialogEl=document.getElementById("container");dialogEl.style.padding="0px";k.showEvent.subscribe(function(){if(YAHOO.env.ua.ie){k.fireEvent("changeContent")}})}if(!h){h=new YAHOO.widget.Calendar("cal",{iframe:false,hide_blank_weeks:true});h.render();h.selectEvent.subscribe(function(){if(h.getSelectedDates().length>0){var o=h.getSelectedDates()[0];var n=(o.getDate()<10)?"0"+o.getDate():o.getDate();var q=(o.getMonth()+1<10)?"0"+(o.getMonth()+1):(o.getMonth()+1);var p=o.getFullYear();j.get(g).value=p+"-"+q+"-"+n}else{j.get(g).value=""}k.hide();if("finding[currentEcd]"==j.get(g).name){validateEcd()}});h.renderEvent.subscribe(function(){k.fireEvent("changeContent")})}var b=h.getSelectedDates();if(b.length>0){h.cfg.setProperty("pagedate",b[0]);h.render()}k.show()}function updateTimeField(b){var d=document.getElementById(b);var k=document.getElementById(b+"Hour");var l=document.getElementById(b+"Minute");var a=document.getElementById(b+"Ampm");var h=k.value;var g=l.value;var j=a.value;if("PM"==j){h=parseInt(h)+12}h=$P.str_pad(h,2,"0","STR_PAD_LEFT");g=$P.str_pad(g,2,"0","STR_PAD_LEFT");var f=h+":"+g+":00";d.value=f}YAHOO.namespace("fisma.CheckboxTree");YAHOO.fisma.CheckboxTree.rootNode;YAHOO.fisma.CheckboxTree.handleClick=function(l,d){if(d.altKey){return}var j=l.parentNode;var m=j.nextSibling.childNodes[0];if(m.getAttribute("nestedLevel")>l.getAttribute("nestedLevel")){var a=l.getAttribute("nestedlevel");var f=new Array();var n=true;var b=j.nextSibling;var k=b.childNodes[0];while(k.getAttribute("nestedLevel")>a){if(!k.checked){n=false}f.push(k);if(b.nextSibling){b=b.nextSibling;k=b.childNodes[0]}else{break}}if(n){l.checked=false}else{l.checked=true}for(var g in f){var h=f[g];if(n){h.checked=false}else{h.checked=true}}}};function setupEditFields(){var a=YAHOO.util.Selector.query(".editable");YAHOO.util.Event.on(a,"click",function(g){removeHighlight(document);var l=this.getAttribute("target");YAHOO.util.Dom.removeClass(this,"editable");this.removeAttribute("target");if(l){var m=document.getElementById(l);var b=m.getAttribute("name");var n=m.getAttribute("type");var d=m.getAttribute("href");var j=m.className;var k=m.offsetWidth;var q=m.offsetHeight;var f=m.innerText?m.innerText:m.textContent;var r=m.innerHTML;if(n=="text"){m.outerHTML='<input length="50" name="'+b+'" id="'+l+'" class="'+j+'" type="text" />';textEl=document.getElementById(l);textEl.setAttribute("value",f.trim());if(k<200){k=200}textEl.style.width=(k-10)+"px";if(j=="date"){var m=document.getElementById(l);m.onfocus=function(){showCalendar(l,l+"_show")};calendarIcon=document.createElement("img");calendarIcon.id=l+"_show";calendarIcon.src="/images/calendar.gif";calendarIcon.alt="Calendar";m.parentNode.appendChild(calendarIcon);YAHOO.util.Event.on(l+"_show","click",function(){showCalendar(l,l+"_show")})}}else{if(n=="textarea"){var s=m.getAttribute("rows");var h=m.getAttribute("cols");m.outerHTML='<textarea id="'+b+'" rows="'+s+'" cols="'+h+'" name="'+b+'"></textarea>';var p=document.getElementById(b);p.value=r;p.style.width=k+"px";p.style.height=q+"px";tinyMCE.execCommand("mceAddControl",true,b)}else{YAHOO.util.Connect.asyncRequest("GET",d+"value/"+f.trim(),{success:function(t){if(n=="select"){m.outerHTML='<select name="'+b+'">'+t.responseText+"</select>"}},failure:function(t){alert("Failed to load the specified panel.")}},null)}}}})}function validateEcd(){var g=document.getElementById("expectedCompletionDate");var d=g.value;var f=new Date();var a=f.getFullYear();var b=f.getMonth();b=b+1;if(b<10){b="0"+b}var h=f.getDate();if(h<10){h="0"+h}if(d.replace(/\-/g,"")<=parseInt(""+a+""+b+""+h)){alert("Warning: You entered an ECD date in the past.")}}if(window.HTMLElement){HTMLElement.prototype.__defineSetter__("outerHTML",function(b){var a=this.ownerDocument.createRange();a.setStartBefore(this);var d=a.createContextualFragment(b);this.parentNode.replaceChild(d,this);return b});HTMLElement.prototype.__defineGetter__("outerHTML",function(){var a;var b=this.attributes;var f="<"+this.tagName.toLowerCase();for(var d=0;d<b.length;d++){a=b[d];if(a.specified){f+=" "+a.name+'="'+a.value+'"'}}if(!this.canHaveChildren){return f+">"}return f+">"+this.innerHTML+"</"+this.tagName.toLowerCase()+">"});HTMLElement.prototype.__defineGetter__("canHaveChildren",function(){switch(this.tagName.toLowerCase()){case"area":case"base":case"basefont":case"col":case"frame":case"hr":case"img":case"br":case"input":case"isindex":case"link":case"meta":case"param":return false}return true})}var helpPanels=new Array();function showHelp(b,d){if(helpPanels[d]){helpPanels[d].show()}else{var a=new YAHOO.widget.Panel("helpPanel",{width:"400px"});a.setHeader("Help");a.setBody("Loading...");a.render(document.body);a.center();a.show();YAHOO.util.Connect.asyncRequest("GET","/help/help/module/"+d,{success:function(f){f.argument.setBody(f.responseText);f.argument.center()},failure:function(f){alert("Failed to load the help module.")},argument:a},null);helpPanels[d]=a}}function selectAllUnsafe(){var a=YAHOO.util.Dom.getElementsBy(function(b){return(b.tagName=="INPUT"&&b.type=="checkbox")});for(i in a){a[i].checked="checked"}}function selectAll(){alert("Not implemented")}function selectNoneUnsafe(){var a=YAHOO.util.Dom.getElementsBy(function(b){return(b.tagName=="INPUT"&&b.type=="checkbox")});for(i in a){a[i].checked=""}}function selectNone(){alert("Not implemented")}function elDump(a){props="";for(prop in a){props+=prop+" : "+a[prop]+"\n"}alert(props)}function delok(b){var a="Are you sure that you want to delete this "+b+"?";if(confirm(a)==true){return true}return false}function GeneratePassword(){var a=document.getElementById("generate_password");YAHOO.util.Connect.asyncRequest("GET","/user/generate-password/format/html",{success:function(b){document.getElementById("password").value=b.responseText;document.getElementById("confirmPassword").value=b.responseText},failure:function(b){alert("Failed to generate password: "+b.statusText)}},null);return false}var check_account=function(){var b=document.getElementById("username").value;b=encodeURIComponent(b);var a="/user/check-account/format/json/account/"+b;YAHOO.util.Connect.asyncRequest("GET",a,{success:function(f){var d=YAHOO.lang.JSON.parse(f.responseText);message(d.msg,d.type)},failure:function(d){alert("Failed to generate password: "+d.statusText)}},null);return false};var isIE=(navigator.appVersion.indexOf("MSIE")!=-1)?true:false;var isWin=(navigator.appVersion.toLowerCase().indexOf("win")!=-1)?true:false;var isOpera=(navigator.userAgent.indexOf("Opera")!=-1)?true:false;function ControlVersion(){var a;var b;var d;try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");a=b.GetVariable("$version")}catch(d){}if(!a){try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");a="WIN 6,0,21,0";b.AllowScriptAccess="always";a=b.GetVariable("$version")}catch(d){}}if(!a){try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");a=b.GetVariable("$version")}catch(d){}}if(!a){try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");a="WIN 3,0,18,0"}catch(d){}}if(!a){try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");a="WIN 2,0,0,11"}catch(d){a=-1}}return a}function GetSwfVer(){var j=-1;if(navigator.plugins!=null&&navigator.plugins.length>0){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var h=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"";var a=navigator.plugins["Shockwave Flash"+h].description;var g=a.split(" ");var d=g[2].split(".");var k=d[0];var b=d[1];var f=g[3];if(f==""){f=g[4]}if(f[0]=="d"){f=f.substring(1)}else{if(f[0]=="r"){f=f.substring(1);if(f.indexOf("d")>0){f=f.substring(0,f.indexOf("d"))}}}var j=k+"."+b+"."+f}}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.6")!=-1){j=4}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.5")!=-1){j=3}else{if(navigator.userAgent.toLowerCase().indexOf("webtv")!=-1){j=2}else{if(isIE&&isWin&&!isOpera){j=ControlVersion()}}}}}return j}function DetectFlashVer(h,f,d){versionStr=GetSwfVer();if(versionStr==-1){return false}else{if(versionStr!=0){if(isIE&&isWin&&!isOpera){tempArray=versionStr.split(" ");tempString=tempArray[1];versionArray=tempString.split(",")}else{versionArray=versionStr.split(".")}var g=versionArray[0];var a=versionArray[1];var b=versionArray[2];if(g>parseFloat(h)){return true}else{if(g==parseFloat(h)){if(a>parseFloat(f)){return true}else{if(a==parseFloat(f)){if(b>=parseFloat(d)){return true}}}}}return false}}}function AC_AddExtension(b,a){if(b.indexOf("?")!=-1){return b.replace(/\?/,a+"?")}else{return b+a}}function AC_Generateobj(g,f,a){var d="";if(isIE&&isWin&&!isOpera){d+="<object ";for(var b in g){d+=b+'="'+g[b]+'" '}d+=">";for(var b in f){d+='<param name="'+b+'" value="'+f[b]+'" /> '}d+="</object>"}else{d+="<embed ";for(var b in a){d+=b+'="'+a[b]+'" '}d+="> </embed>"}return d}function AC_FL_RunContent(){var a=AC_GetArgs(arguments,".swf","movie","clsid:d27cdb6e-ae6d-11cf-96b8-444553540000","application/x-shockwave-flash");return AC_Generateobj(a.objAttrs,a.params,a.embedAttrs)}function AC_SW_RunContent(){var a=AC_GetArgs(arguments,".dcr","src","clsid:166B1BCA-3F9C-11CF-8075-444553540000",null);return AC_Generateobj(a.objAttrs,a.params,a.embedAttrs)}function AC_GetArgs(b,g,j,f,k){var a=new Object();a.embedAttrs=new Object();a.params=new Object();a.objAttrs=new Object();for(var d=0;d<b.length;d=d+2){var h=b[d].toLowerCase();switch(h){case"classid":break;case"pluginspage":a.embedAttrs[b[d]]=b[d+1];break;case"src":case"movie":b[d+1]=AC_AddExtension(b[d+1],g);a.embedAttrs.src=b[d+1];a.params[j]=b[d+1];break;case"onafterupdate":case"onbeforeupdate":case"onblur":case"oncellchange":case"onclick":case"ondblclick":case"ondrag":case"ondragend":case"ondragenter":case"ondragleave":case"ondragover":case"ondrop":case"onfinish":case"onfocus":case"onhelp":case"onmousedown":case"onmouseup":case"onmouseover":case"onmousemove":case"onmouseout":case"onkeypress":case"onkeydown":case"onkeyup":case"onload":case"onlosecapture":case"onpropertychange":case"onreadystatechange":case"onrowsdelete":case"onrowenter":case"onrowexit":case"onrowsinserted":case"onstart":case"onscroll":case"onbeforeeditfocus":case"onactivate":case"onbeforedeactivate":case"ondeactivate":case"type":case"codebase":case"id":a.objAttrs[b[d]]=b[d+1];break;case"width":case"height":case"align":case"vspace":case"hspace":case"class":case"title":case"accesskey":case"name":case"tabindex":a.embedAttrs[b[d]]=a.objAttrs[b[d]]=b[d+1];break;default:a.embedAttrs[b[d]]=a.params[b[d]]=b[d+1]}}a.objAttrs.classid=f;if(k){a.embedAttrs.type=k}return a}Fisma.AttachArtifacts={sampleInterval:1000,apcId:null,yuiProgressBar:null,pollingTimeoutId:null,lastAsyncRequest:null,pollingEnabled:false,config:null,yuiPanel:null,showPanel:function(h,f){Fisma.AttachArtifacts.config=f;var g=new YAHOO.widget.Panel("panel",{modal:true,close:true});g.setHeader("Upload Artifact");g.setBody("Loading...");g.render(document.body);g.center();g.show();g.hideEvent.subscribe(function(){Fisma.AttachArtifacts.cancelPanel.call(Fisma.AttachArtifacts)});Fisma.AttachArtifacts.yuiPanel=g;var j="/artifact/upload-form";if(f.form){j+="/form/"+encodeURIComponent(f.form)}YAHOO.util.Connect.asyncRequest("GET",j,{success:function(a){a.argument.setBody(a.responseText);a.argument.center()},failure:function(a){a.argument.setBody("The content for this panel could not be loaded.");a.argument.center()},argument:g},null)},trackUploadProgress:function(){var m=document.getElementById("fileUpload");if(""==m.value){alert("Please select a file.");return false}var l=document.getElementById("uploadButton");l.disabled=true;var n=this;var p=document.getElementById("progress_key");if(p){this.apcId=p.value;var k=document.getElementById("progressBarContainer");var r=parseInt(YAHOO.util.Dom.getStyle(k,"width"));var o=parseInt(YAHOO.util.Dom.getStyle(k,"height"));YAHOO.util.Dom.removeClass(k,"attachArtifactsProgressBar");while(k.hasChildNodes()){k.removeChild(k.firstChild)}var j=new YAHOO.widget.ProgressBar();j.set("width",r);j.set("height",o);j.set("ariaTextTemplate","Upload is {value}% complete");j.set("anim",true);var q=j.get("anim");q.duration=2;q.method=YAHOO.util.Easing.easeNone;j.render("progressBarContainer");YAHOO.util.Dom.addClass(k,"attachArtifactsProgressBar");this.yuiProgressBar=j;this.pollingEnabled=true;setTimeout(function(){n.getProgress.call(n)},this.sampleInterval)}document.getElementById("progressBarContainer").style.display="block";document.getElementById("progressTextContainer").style.display="block";setTimeout(function(){n.postForm.call(n)},0);return false},postForm:function(){var f=this;var d="/"+encodeURIComponent(this.config.server.controller)+"/"+encodeURIComponent(this.config.server.action)+"/id/"+encodeURIComponent(this.config.id)+"/format/json";YAHOO.util.Connect.setForm("uploadArtifactForm",true);YAHOO.util.Connect.asyncRequest("POST",d,{upload:function(a){f.handleUploadComplete.call(f,a)},failure:function(a){alert("Document upload failed.")}},null)},getProgress:function(){var b=this;if(this.pollingEnabled){this.lastAsyncRequest=YAHOO.util.Connect.asyncRequest("GET","/artifact/upload-progress/format/json/id/"+this.apcId,{success:function(n){try{var o=YAHOO.lang.JSON.parse(n.responseText)}catch(l){if(l instanceof SyntaxError){o=new Object();o.progress=false}else{throw l}}if(!o.progress){b.yuiProgressBar.destroy();b.yuiProgressBar=null;b.pollingEnabled=false;var j=document.getElementById("progressBarContainer");YAHOO.util.Dom.addClass(j,"attachArtifactsProgressBar");var a=document.createElement("img");a.src="/images/loading_bar.gif";j.appendChild(a);b.pollingTimeoutId=null;return}var m=Math.round((o.progress.current/o.progress.total)*100);b.yuiProgressBar.set("value",m);var k=document.getElementById("progressTextContainer").firstChild;k.nodeValue=m+"%";b.pollingTimeoutId=setTimeout(function(){b.getProgress.call(b)},b.sampleInterval)}},null)}},handleUploadComplete:function(o){try{var p=YAHOO.lang.JSON.parse(o.responseText)}catch(m){if(m instanceof SyntaxError){p=new Object();p.success=false;p.message="Invalid response from server."}else{throw m}}this.pollingEnabled=false;clearTimeout(this.pollingTimeoutId);YAHOO.util.Connect.abort(this.lastAsyncRequest);if(this.yuiProgressBar){this.yuiProgressBar.get("anim").duration=0.5;this.yuiProgressBar.set("value",100)}var l=document.getElementById("progressTextContainer").firstChild;l.nodeValue="Verifying file.";if(!p.success){alert("Upload Failed: "+p.message);l.nodeValue="Uploading...";document.getElementById("progressBarContainer").style.display="none";document.getElementById("progressTextContainer").style.display="none";var j=document.getElementById("uploadButton");j.disabled=false;return}var n=Fisma[this.config.callback.object];if(typeof n!="Undefined"){var k=n[this.config.callback.method];if(typeof k=="function"){k.call(n,this.yuiPanel)}}},cancelPanel:function(){if(this.pollingEnabled){this.pollingEnabled=false;clearTimeout(this.pollingTimeoutId)}if(this.lastAsyncRequest){YAHOO.util.Connect.abort(this.lastAsyncRequest)}}};Fisma.AttachArtifacts={sampleInterval:1000,apcId:null,yuiProgressBar:null,pollingTimeoutId:null,lastAsyncRequest:null,pollingEnabled:false,config:null,yuiPanel:null,showPanel:function(f,b){Fisma.AttachArtifacts.config=b;var a=new YAHOO.widget.Panel("panel",{modal:true,close:true});a.setHeader("Upload Artifact");a.setBody("Loading...");a.render(document.body);a.center();a.show();a.hideEvent.subscribe(function(){Fisma.AttachArtifacts.cancelPanel.call(Fisma.AttachArtifacts)});Fisma.AttachArtifacts.yuiPanel=a;var d="/artifact/upload-form";if(b.form){d+="/form/"+encodeURIComponent(b.form)}YAHOO.util.Connect.asyncRequest("GET",d,{success:function(g){g.argument.setBody(g.responseText);g.argument.center()},failure:function(g){g.argument.setBody("The content for this panel could not be loaded.");g.argument.center()},argument:a},null)},trackUploadProgress:function(){var h=document.getElementById("fileUpload");if(""==h.value){alert("Please select a file.");return false}var j=document.getElementById("uploadButton");j.disabled=true;var g=this;var d=document.getElementById("progress_key");if(d){this.apcId=d.value;var k=document.getElementById("progressBarContainer");var a=parseInt(YAHOO.util.Dom.getStyle(k,"width"));var f=parseInt(YAHOO.util.Dom.getStyle(k,"height"));YAHOO.util.Dom.removeClass(k,"attachArtifactsProgressBar");while(k.hasChildNodes()){k.removeChild(k.firstChild)}var l=new YAHOO.widget.ProgressBar();l.set("width",a);l.set("height",f);l.set("ariaTextTemplate","Upload is {value}% complete");l.set("anim",true);var b=l.get("anim");b.duration=2;b.method=YAHOO.util.Easing.easeNone;l.render("progressBarContainer");YAHOO.util.Dom.addClass(k,"attachArtifactsProgressBar");this.yuiProgressBar=l;this.pollingEnabled=true;setTimeout(function(){g.getProgress.call(g)},this.sampleInterval)}document.getElementById("progressBarContainer").style.display="block";document.getElementById("progressTextContainer").style.display="block";setTimeout(function(){g.postForm.call(g)},0);return false},postForm:function(){var a=this;var b="/"+encodeURIComponent(this.config.server.controller)+"/"+encodeURIComponent(this.config.server.action)+"/id/"+encodeURIComponent(this.config.id)+"/format/json";YAHOO.util.Connect.setForm("uploadArtifactForm",true);YAHOO.util.Connect.asyncRequest("POST",b,{upload:function(d){a.handleUploadComplete.call(a,d)},failure:function(d){alert("Document upload failed.")}},null)},getProgress:function(){var a=this;if(this.pollingEnabled){this.lastAsyncRequest=YAHOO.util.Connect.asyncRequest("GET","/artifact/upload-progress/format/json/id/"+this.apcId,{success:function(f){try{var d=YAHOO.lang.JSON.parse(f.responseText)}catch(h){if(h instanceof SyntaxError){d=new Object();d.progress=false}else{throw h}}if(!d.progress){a.yuiProgressBar.destroy();a.yuiProgressBar=null;a.pollingEnabled=false;var k=document.getElementById("progressBarContainer");YAHOO.util.Dom.addClass(k,"attachArtifactsProgressBar");var b=document.createElement("img");b.src="/images/loading_bar.gif";k.appendChild(b);a.pollingTimeoutId=null;return}var g=Math.round((d.progress.current/d.progress.total)*100);a.yuiProgressBar.set("value",g);var j=document.getElementById("progressTextContainer").firstChild;j.nodeValue=g+"%";a.pollingTimeoutId=setTimeout(function(){a.getProgress.call(a)},a.sampleInterval)}},null)}},handleUploadComplete:function(f){try{var d=YAHOO.lang.JSON.parse(f.responseText)}catch(h){if(h instanceof SyntaxError){d=new Object();d.success=false;d.message="Invalid response from server."}else{throw h}}this.pollingEnabled=false;clearTimeout(this.pollingTimeoutId);YAHOO.util.Connect.abort(this.lastAsyncRequest);if(this.yuiProgressBar){this.yuiProgressBar.get("anim").duration=0.5;this.yuiProgressBar.set("value",100)}var j=document.getElementById("progressTextContainer").firstChild;j.nodeValue="Verifying file.";if(!d.success){alert("Upload Failed: "+d.message);j.nodeValue="Uploading...";document.getElementById("progressBarContainer").style.display="none";document.getElementById("progressTextContainer").style.display="none";var b=document.getElementById("uploadButton");b.disabled=false;return}var g=Fisma[this.config.callback.object];if(typeof g!="Undefined"){var a=g[this.config.callback.method];if(typeof a=="function"){a.call(g,this.yuiPanel)}}},cancelPanel:function(){if(this.pollingEnabled){this.pollingEnabled=false;clearTimeout(this.pollingTimeoutId)}if(this.lastAsyncRequest){YAHOO.util.Connect.abort(this.lastAsyncRequest)}}};Fisma.AutoComplete=function(){return{init:function(g,h,j){var k=new YAHOO.widget.DS_XHR(j.xhr,j.schema);k.responseType=YAHOO.widget.DS_XHR.TYPE_JSON;k.maxCacheEntries=500;k.queryMatchContains=true;var f=new YAHOO.widget.AutoComplete(j.fieldId,j.containerId,k);f.maxResultsDisplayed=20;f.forceSelection=true;f.generateRequest=function(a){return j.queryPrepend+a};f.formatResult=function(d,a,l){var b=(l)?l:"";b=PHP_JS().htmlspecialchars(b);return b};f.itemSelectEvent.subscribe(Fisma.AutoComplete.subscribe,{hiddenFieldId:j.hiddenFieldId})},subscribe:function(g,d,f){document.getElementById(f.hiddenFieldId).value=d[2][1]["id"]}}}();Fisma.AutoComplete=function(){return{requestCount:0,resultsPopulated:false,init:function(b,h,g){var f=new YAHOO.widget.DS_XHR(g.xhr,g.schema);f.responseType=YAHOO.widget.DS_XHR.TYPE_JSON;f.maxCacheEntries=500;f.queryMatchContains=true;var d=new YAHOO.widget.AutoComplete(g.fieldId,g.containerId,f);d.maxResultsDisplayed=20;d.forceSelection=true;var a=document.getElementById(g.containerId+"Spinner");d.dataRequestEvent.subscribe(function(){a.style.visibility="visible";Fisma.AutoComplete.requestCount++});d.dataReturnEvent.subscribe(function(){Fisma.AutoComplete.requestCount--;if(0==Fisma.AutoComplete.requestCount){a.style.visibility="hidden"}});d.getInputEl().onclick=function(){if(Fisma.AutoComplete.resultsPopulated){d.expandContainer()}};d.containerPopulateEvent.subscribe(function(){Fisma.AutoComplete.resultsPopulated=true});d.generateRequest=function(j){return g.queryPrepend+j};d.formatResult=function(k,m,j){var l=(j)?j:"";l=PHP_JS().htmlspecialchars(l);return l};d.itemSelectEvent.subscribe(Fisma.AutoComplete.subscribe,{hiddenFieldId:g.hiddenFieldId,callback:g.callback})},subscribe:function(g,f,d){document.getElementById(d.hiddenFieldId).value=f[2][1]["id"];try{var b=Fisma.Util.getObjectFromName(d.callback);if("function"==typeof b){b()}}catch(a){}}}}();Fisma.Blinker=function(g,j,f,h){this.interval=g;this.cycles=j;this.cyclesRemaining=j;this.onFunction=f;this.offFunction=h;this.state=0};Fisma.Blinker.prototype.start=function(){this.cycle()};Fisma.Blinker.prototype.cycle=function(){var b=this;if(1===this.state){this.offFunction()}else{this.onFunction()}this.state=1-this.state;this.cyclesRemaining--;if(this.cyclesRemaining>0){setTimeout(function(){b.cycle.call(b)},this.interval)}};Fisma.Blinker=function(a,d,b,f){this.interval=a;this.cycles=d;this.cyclesRemaining=d;this.onFunction=b;this.offFunction=f;this.state=0};Fisma.Blinker.prototype.start=function(){this.cycle()};Fisma.Blinker.prototype.cycle=function(){var a=this;if(1===this.state){this.offFunction()}else{this.onFunction()}this.state=1-this.state;this.cyclesRemaining--;if(this.cyclesRemaining>0){setTimeout(function(){a.cycle.call(a)},this.interval)}};Fisma.Commentable={asyncRequest:null,config:null,yuiPanel:null,showPanel:function(g,d){Fisma.Commentable.config=d;var f=new YAHOO.widget.Panel("panel",{modal:true,close:true});f.setHeader("Add Comment");f.setBody("Loading...");f.render(document.body);f.center();f.show();f.hideEvent.subscribe(function(){Fisma.Commentable.closePanel.call(Fisma.Commentable)});Fisma.Commentable.yuiPanel=f;YAHOO.util.Connect.asyncRequest("GET","/comment/form",{success:function(a){a.argument.setBody(a.responseText);a.argument.center()},failure:function(a){a.argument.setBody("The content for this panel could not be loaded.");a.argument.center()},argument:f},null);return false},postComment:function(){var b="/comment/add/id/"+encodeURIComponent(Fisma.Commentable.config.id)+"/type/"+encodeURIComponent(Fisma.Commentable.config.type)+"/format/json";YAHOO.util.Connect.setForm("addCommentForm");Fisma.Commentable.asyncRequest=YAHOO.util.Connect.asyncRequest("POST",b,{success:function(a){Fisma.Commentable.commentCallback.call(Fisma.Commentable,a)},failure:function(a){alert("Document upload failed.")}},null);return false},commentCallback:function(m){var n;try{var h=YAHOO.lang.JSON.parse(m.responseText);n=h.response}catch(k){if(k instanceof SyntaxError){n=new Object();n.success=false;n.message="Invalid response from server."}else{throw k}}if(!n.success){alert("Error: "+n.message);return}var l=Fisma[this.config.callback.object];if(typeof l!="Undefined"){var j=l[this.config.callback.method];if(typeof j=="function"){j.call(l,n.comment,this.yuiPanel)}}},closePanel:function(){if(this.asyncRequest){YAHOO.util.Connect.abort(this.asyncRequest)}}};Fisma.Commentable={asyncRequest:null,config:null,yuiPanel:null,showPanel:function(d,b){Fisma.Commentable.config=b;var a=new YAHOO.widget.Panel("panel",{modal:true,close:true});a.setHeader("Add Comment");a.setBody("Loading...");a.render(document.body);a.center();a.show();a.hideEvent.subscribe(function(){Fisma.Commentable.closePanel.call(Fisma.Commentable)});Fisma.Commentable.yuiPanel=a;YAHOO.util.Connect.asyncRequest("GET","/comment/form",{success:function(f){f.argument.setBody(f.responseText);f.argument.center()},failure:function(f){f.argument.setBody("The content for this panel could not be loaded.");f.argument.center()},argument:a},null);return false},postComment:function(){var a="/comment/add/id/"+encodeURIComponent(Fisma.Commentable.config.id)+"/type/"+encodeURIComponent(Fisma.Commentable.config.type)+"/format/json";YAHOO.util.Connect.setForm("addCommentForm");Fisma.Commentable.asyncRequest=YAHOO.util.Connect.asyncRequest("POST",a,{success:function(b){Fisma.Commentable.commentCallback.call(Fisma.Commentable,b)},failure:function(b){alert("Document upload failed.")}},null);return false},commentCallback:function(f){var d;try{var b=YAHOO.lang.JSON.parse(f.responseText);d=b.response}catch(h){if(h instanceof SyntaxError){d=new Object();d.success=false;d.message="Invalid response from server."}else{throw h}}if(!d.success){alert("Error: "+d.message);return}var g=Fisma[this.config.callback.object];if(typeof g!="Undefined"){var a=g[this.config.callback.method];if(typeof a=="function"){a.call(g,d.comment,this.yuiPanel)}}},closePanel:function(){if(this.asyncRequest){YAHOO.util.Connect.abort(this.asyncRequest)}}};Fisma.Email=function(){return{panelElement:null,showRecipientDialog:function(){if(Fisma.Email.panelElement!=null&&Fisma.Email.panelElement instanceof YAHOO.widget.Panel){Fisma.Email.panelElement.removeMask();Fisma.Email.panelElement.destroy();Fisma.Email.panelElement=null}var m=document.createElement("div");var j=document.createElement("p");var g=document.createTextNode("* Target E-mail Address:");j.appendChild(g);m.appendChild(j);var l=document.createElement("input");l.id="testEmailRecipient";l.name="recipient";m.appendChild(l);var k=document.createElement("div");k.style.height="10px";m.appendChild(k);var h=document.createElement("input");h.type="button";h.id="dialogRecipientSendBtn";h.style.marginLeft="10px";h.value="Send";m.appendChild(h);Fisma.Email.panelElement=Fisma.HtmlPanel.showPanel("Test E-mail Configuration",m.innerHTML);document.getElementById("dialogRecipientSendBtn").onclick=Fisma.Email.sendTestEmail},sendTestEmail:function(){if(document.getElementById("testEmailRecipient").value==""){alert("Recipient is required.");document.getElementById("testEmailRecipient").focus();return false}var d=document.getElementById("testEmailRecipient").value;var f=document.getElementById("email_config");f.elements.recipient.value=d;YAHOO.util.Connect.setForm(f);YAHOO.util.Connect.asyncRequest("POST","/config/test-email-config/format/json",{success:function(a){var b=YAHOO.lang.JSON.parse(a.responseText);message(b.msg,b.type)},failure:function(a){alert("Failed to send mail: "+a.statusText)}},null);if(Fisma.Email.panelElement!=null&&Fisma.Email.panelElement instanceof YAHOO.widget.Panel){Fisma.Email.panelElement.removeMask();Fisma.Email.panelElement.destroy();Fisma.Email.panelElement=null}}}}();Fisma.Email=function(){return{panelElement:null,showRecipientDialog:function(){if(Fisma.Email.panelElement!=null&&Fisma.Email.panelElement instanceof YAHOO.widget.Panel){Fisma.Email.panelElement.removeMask();Fisma.Email.panelElement.destroy();Fisma.Email.panelElement=null}var d=document.createElement("div");var h=document.createElement("p");var b=document.createTextNode("* Target E-mail Address:");h.appendChild(b);d.appendChild(h);var f=document.createElement("input");f.id="testEmailRecipient";f.name="recipient";d.appendChild(f);var g=document.createElement("div");g.style.height="10px";d.appendChild(g);var a=document.createElement("input");a.type="button";a.id="dialogRecipientSendBtn";a.style.marginLeft="10px";a.value="Send";d.appendChild(a);Fisma.Email.panelElement=Fisma.HtmlPanel.showPanel("Test E-mail Configuration",d.innerHTML);document.getElementById("dialogRecipientSendBtn").onclick=Fisma.Email.sendTestEmail},sendTestEmail:function(){if(document.getElementById("testEmailRecipient").value==""){alert("Recipient is required.");document.getElementById("testEmailRecipient").focus();return false}var b=document.getElementById("testEmailRecipient").value;var a=document.getElementById("email_config");a.elements.recipient.value=b;YAHOO.util.Connect.setForm(a);YAHOO.util.Connect.asyncRequest("POST","/config/test-email-config/format/json",{success:function(f){var d=YAHOO.lang.JSON.parse(f.responseText);message(d.msg,d.type)},failure:function(d){alert("Failed to send mail: "+d.statusText)}},null);if(Fisma.Email.panelElement!=null&&Fisma.Email.panelElement instanceof YAHOO.widget.Panel){Fisma.Email.panelElement.removeMask();Fisma.Email.panelElement.destroy();Fisma.Email.panelElement=null}}}}();Fisma.Finding={commentTable:null,commentCallback:function(j,g){var l=this;var m={timestamp:j.createdTs,username:j.username,comment:j.comment};this.commentTable.addRow(m);this.commentTable.sortColumn(this.commentTable.getColumn(0),YAHOO.widget.DataTable.CLASS_DESC);var h=new Fisma.Blinker(100,6,function(){l.commentTable.highlightRow(0)},function(){l.commentTable.unhighlightRow(0)});h.start();var k=document.getElementById("findingCommentsCount").firstChild;k.nodeValue++;g.hide();g.destroy()},editEcdJustification:function(){var f=document.getElementById("currentChangeDescription");f.style.display="none";var g=f.firstChild.nodeValue;var d=document.createElement("input");d.type="text";d.value=g;d.name="finding[ecdChangeDescription]";f.parentNode.appendChild(d)}};Fisma.Finding={commentTable:null,commentCallback:function(h,b){var f=this;var d={timestamp:h.createdTs,username:h.username,comment:h.comment};this.commentTable.addRow(d);this.commentTable.sortColumn(this.commentTable.getColumn(0),YAHOO.widget.DataTable.CLASS_DESC);var a=new Fisma.Blinker(100,6,function(){f.commentTable.highlightRow(0)},function(){f.commentTable.unhighlightRow(0)});a.start();var g=document.getElementById("findingCommentsCount").firstChild;g.nodeValue++;b.hide();b.destroy()},editEcdJustification:function(){var a=document.getElementById("currentChangeDescription");a.style.display="none";var d=a.firstChild.nodeValue;var b=document.createElement("input");b.type="text";b.value=d;b.name="finding[ecdChangeDescription]";a.parentNode.appendChild(b)},showSecurityControlSearch:function(){var b=document.getElementById("securityControlSearchButton");b.style.display="none";var a=document.getElementById("findingSecurityControlSearch");a.style.display="block"},handleSecurityControlSelection:function(){var a=document.getElementById("securityControlContainer");a.innerHTML='<img src="/images/loading_bar.gif">';var d=document.getElementById("finding[securityControlId]");var b=escape(d.value);YAHOO.util.Connect.asyncRequest("GET","/security-control-catalog/single-control/id/"+b,{success:function(f){a.innerHTML=f.responseText},failure:function(f){alert("Unable to load security control definition.")}})}};Fisma.FindingSummary=function(){return{treeRoot:null,filterType:null,filterSource:null,defaultDisplayLevel:2,render:function(F,E,u){if(u){this.treeRoot=E}var y=document.getElementById(F);for(var H in E){var C=E[H];var L=y.insertRow(y.rows.length);L.id=C.nickname+"_ontime";var I=y.insertRow(y.rows.length);I.id=C.nickname+"_overdue";var K=L.insertCell(0);C.expanded=(C.level<this.defaultDisplayLevel-1);var z=C.expanded?C.single_ontime:C.all_ontime;var D=C.expanded?C.single_overdue:C.all_overdue;C.hasOverdue=this.hasOverdue(D);var x=document.createElement("img");x.className="control";x.id=C.nickname+"Img";var G=document.createElement("a");G.appendChild(x);var A=C.children.length>0;if(A){G.nickname=C.nickname;G.findingSummary=this;G.onclick=function(){this.findingSummary.toggleNode(this.nickname);return false};x.src="/images/"+(C.expanded?"minus.png":"plus.png")}else{x.src="/images/leaf_node.png"}var J=document.createElement("div");J.className="treeTable"+C.level+(A?" link":"");J.appendChild(G);var v=document.createElement("img");v.className="icon";v.src="/images/"+C.orgType+".png";G.appendChild(v);G.appendChild(document.createTextNode(C.label));G.appendChild(document.createElement("br"));G.appendChild(document.createTextNode(C.orgTypeLabel));K.appendChild(J);var B=1;for(var w in z){count=z[w];cell=L.insertCell(B++);if(w=="CLOSED"||w=="TOTAL"){cell.className="noDueDate"}else{cell.className="onTime"}this.updateCellCount(cell,count,C.id,w,"ontime",C.expanded)}for(var w in D){count=D[w];cell=I.insertCell(I.childNodes.length);cell.className="overdue";this.updateCellCount(cell,count,C.id,w,"overdue",C.expanded)}L.style.display="none";I.style.display="none";if(C.level<this.defaultDisplayLevel){L.style.display="";if(C.hasOverdue){L.childNodes[0].rowSpan="2";L.childNodes[L.childNodes.length-2].rowSpan="2";L.childNodes[L.childNodes.length-1].rowSpan="2";I.style.display=""}}if(C.children.length>0){this.render(F,C.children)}}},toggleNode:function(b){node=this.findNode(b,this.treeRoot);if(node.expanded){this.collapseNode(node,true);this.hideSubtree(node.children)}else{this.expandNode(node);this.showSubtree(node.children,false)}},expandNode:function(l,h){l.ontime=l.single_ontime;l.overdue=l.single_overdue;l.hasOverdue=this.hasOverdue(l.overdue);var j=document.getElementById(l.nickname+"_ontime");var n=1;for(c in l.ontime){count=l.ontime[c];this.updateCellCount(j.childNodes[n],count,l.id,c,"ontime",true);n++}var m=document.getElementById(l.nickname+"_overdue");if(l.hasOverdue){var n=0;for(c in l.overdue){count=l.overdue[c];this.updateCellCount(m.childNodes[n],count,l.id,c,"overdue",true);n++}}else{j.childNodes[0].rowSpan="1";j.childNodes[j.childNodes.length-2].rowSpan="1";j.childNodes[j.childNodes.length-1].rowSpan="1";m.style.display="none"}if(l.children.length>0){document.getElementById(l.nickname+"Img").src="/images/minus.png"}l.expanded=true;if(h&&l.children.length>0){this.showSubtree(l.children,false);for(var k in l.children){this.expandNode(l.children[k],true)}}},collapseNode:function(j,g){j.ontime=j.all_ontime;j.overdue=j.all_overdue;j.hasOverdue=this.hasOverdue(j.overdue);var h=document.getElementById(j.nickname+"_ontime");var l=1;for(c in j.ontime){count=j.ontime[c];this.updateCellCount(h.childNodes[l],count,j.id,c,"ontime",false);l++}var k=document.getElementById(j.nickname+"_overdue");if(g&&j.hasOverdue){h.childNodes[0].rowSpan="2";h.childNodes[h.childNodes.length-2].rowSpan="2";h.childNodes[h.childNodes.length-1].rowSpan="2";k.style.display="";var l=0;for(c in j.all_overdue){count=j.all_overdue[c];this.updateCellCount(k.childNodes[l],count,j.id,c,"overdue",false);l++}}if(j.children.length>0){this.hideSubtree(j.children)}document.getElementById(j.nickname+"Img").src="/images/plus.png";j.expanded=false},hideSubtree:function(b){for(nodeId in b){node=b[nodeId];ontimeRow=document.getElementById(node.nickname+"_ontime");ontimeRow.style.display="none";overdueRow=document.getElementById(node.nickname+"_overdue");overdueRow.style.display="none";if(node.children.length>0){this.collapseNode(node,false);this.hideSubtree(node.children)}}},showSubtree:function(d,f){for(nodeId in d){node=d[nodeId];if(f&&node.children.length>0){this.expandNode(node);this.showSubtree(node.children,true)}ontimeRow=document.getElementById(node.nickname+"_ontime");ontimeRow.style.display="";overdueRow=document.getElementById(node.nickname+"_overdue");if(node.hasOverdue){ontimeRow.childNodes[0].rowSpan="2";ontimeRow.childNodes[ontimeRow.childNodes.length-2].rowSpan="2";ontimeRow.childNodes[ontimeRow.childNodes.length-1].rowSpan="2";overdueRow.style.display=""}}},collapseAll:function(){for(nodeId in this.treeRoot){node=this.treeRoot[nodeId];this.collapseNode(node,true);this.hideSubtree(node.children)}},expandAll:function(){for(nodeId in this.treeRoot){node=this.treeRoot[nodeId];this.expandNode(node,true)}},findNode:function(h,f){for(var j in f){node=f[j];if(node.nickname==h){return node}else{if(node.children.length>0){var g=this.findNode(h,node.children);if(g!=false){return g}}}}return false},hasOverdue:function(d){for(var f in d){if(d[f]>0){return true}}return false},updateCellCount:function(k,m,p,j,l,o){if(!k.hasChildNodes()){if(m>0){var n=document.createElement("a");n.href=this.makeLink(p,j,l,o);n.appendChild(document.createTextNode(m));k.appendChild(n)}else{k.appendChild(document.createTextNode("-"))}}else{if(k.firstChild.hasChildNodes()){if(m>0){k.firstChild.firstChild.nodeValue=m;k.firstChild.href=this.makeLink(p,j,l,o)}else{k.removeChild(k.firstChild);k.appendChild(document.createTextNode("-"))}}else{if(m>0){k.removeChild(k.firstChild);var n=document.createElement("a");n.href=this.makeLink(p,j,l,o);n.appendChild(document.createTextNode(m));k.appendChild(n)}else{k.firstChild.nodeValue="-"}}}},makeLink:function(o,n,k,l){var p="";if(!(n=="CLOSED"||n=="TOTAL")){var p="/ontime/"+k}var m="";if(n!=""){m="/status/"+escape(n)}var s="";if(!YAHOO.lang.isNull(this.filterType)&&this.filterType!=""){s="/type/"+this.filterType}var r="";if(!YAHOO.lang.isNull(this.filterSource)&&this.filterSource!=""){r="/sourceId/"+this.filterSource}var q="/panel/remediation/sub/search"+p+m+"/responsibleOrganizationId/"+o+"/expanded/"+l+s+r;return q},exportTable:function(d){var f="/remediation/summary-data/format/"+d+this.listExpandedNodes(this.treeRoot,"");document.location=f},listExpandedNodes:function(f,g){for(var h in f){var j=f[h];if(j.expanded){g+="/e/"+j.id;g=this.listExpandedNodes(j.children,g)}else{g+="/c/"+j.id}}return g}}};Fisma.FindingSummary=function(){return{treeRoot:null,filterType:null,filterSource:null,defaultDisplayLevel:2,render:function(j,k,u){if(u){this.treeRoot=k}var q=document.getElementById(j);for(var g in k){var m=k[g];var a=q.insertRow(q.rows.length);a.id=m.nickname+"_ontime";var f=q.insertRow(q.rows.length);f.id=m.nickname+"_overdue";var b=a.insertCell(0);m.expanded=(m.level<this.defaultDisplayLevel-1);var p=m.expanded?m.single_ontime:m.all_ontime;var l=m.expanded?m.single_overdue:m.all_overdue;m.hasOverdue=this.hasOverdue(l);var r=document.createElement("img");r.className="control";r.id=m.nickname+"Img";var h=document.createElement("a");h.appendChild(r);var o=m.children.length>0;if(o){h.nickname=m.nickname;h.findingSummary=this;h.onclick=function(){this.findingSummary.toggleNode(this.nickname);return false};r.src="/images/"+(m.expanded?"minus.png":"plus.png")}else{r.src="/images/leaf_node.png"}var d=document.createElement("div");d.className="treeTable"+m.level+(o?" link":"");d.appendChild(h);var t=document.createElement("img");t.className="icon";t.src="/images/"+m.orgType+".png";h.appendChild(t);h.appendChild(document.createTextNode(m.label));h.appendChild(document.createElement("br"));h.appendChild(document.createTextNode(m.orgTypeLabel));b.appendChild(d);var n=1;for(var s in p){count=p[s];cell=a.insertCell(n++);if(s=="CLOSED"||s=="TOTAL"){cell.className="noDueDate"}else{cell.className="onTime"}this.updateCellCount(cell,count,m.id,s,"ontime",m.expanded)}for(var s in l){count=l[s];cell=f.insertCell(f.childNodes.length);cell.className="overdue";this.updateCellCount(cell,count,m.id,s,"overdue",m.expanded)}a.style.display="none";f.style.display="none";if(m.level<this.defaultDisplayLevel){a.style.display="";if(m.hasOverdue){a.childNodes[0].rowSpan="2";a.childNodes[a.childNodes.length-2].rowSpan="2";a.childNodes[a.childNodes.length-1].rowSpan="2";f.style.display=""}}if(m.children.length>0){this.render(j,m.children)}}},toggleNode:function(a){node=this.findNode(a,this.treeRoot);if(node.expanded){this.collapseNode(node,true);this.hideSubtree(node.children)}else{this.expandNode(node);this.showSubtree(node.children,false)}},expandNode:function(g,b){g.ontime=g.single_ontime;g.overdue=g.single_overdue;g.hasOverdue=this.hasOverdue(g.overdue);var a=document.getElementById(g.nickname+"_ontime");var d=1;for(c in g.ontime){count=g.ontime[c];this.updateCellCount(a.childNodes[d],count,g.id,c,"ontime",true);d++}var f=document.getElementById(g.nickname+"_overdue");if(g.hasOverdue){var d=0;for(c in g.overdue){count=g.overdue[c];this.updateCellCount(f.childNodes[d],count,g.id,c,"overdue",true);d++}}else{a.childNodes[0].rowSpan="1";a.childNodes[a.childNodes.length-2].rowSpan="1";a.childNodes[a.childNodes.length-1].rowSpan="1";f.style.display="none"}if(g.children.length>0){document.getElementById(g.nickname+"Img").src="/images/minus.png"}g.expanded=true;if(b&&g.children.length>0){this.showSubtree(g.children,false);for(var h in g.children){this.expandNode(g.children[h],true)}}},collapseNode:function(g,b){g.ontime=g.all_ontime;g.overdue=g.all_overdue;g.hasOverdue=this.hasOverdue(g.overdue);var a=document.getElementById(g.nickname+"_ontime");var d=1;for(c in g.ontime){count=g.ontime[c];this.updateCellCount(a.childNodes[d],count,g.id,c,"ontime",false);d++}var f=document.getElementById(g.nickname+"_overdue");if(b&&g.hasOverdue){a.childNodes[0].rowSpan="2";a.childNodes[a.childNodes.length-2].rowSpan="2";a.childNodes[a.childNodes.length-1].rowSpan="2";f.style.display="";var d=0;for(c in g.all_overdue){count=g.all_overdue[c];this.updateCellCount(f.childNodes[d],count,g.id,c,"overdue",false);d++}}if(g.children.length>0){this.hideSubtree(g.children)}document.getElementById(g.nickname+"Img").src="/images/plus.png";g.expanded=false},hideSubtree:function(a){for(nodeId in a){node=a[nodeId];ontimeRow=document.getElementById(node.nickname+"_ontime");ontimeRow.style.display="none";overdueRow=document.getElementById(node.nickname+"_overdue");overdueRow.style.display="none";if(node.children.length>0){this.collapseNode(node,false);this.hideSubtree(node.children)}}},showSubtree:function(b,a){for(nodeId in b){node=b[nodeId];if(a&&node.children.length>0){this.expandNode(node);this.showSubtree(node.children,true)}ontimeRow=document.getElementById(node.nickname+"_ontime");ontimeRow.style.display="";overdueRow=document.getElementById(node.nickname+"_overdue");if(node.hasOverdue){ontimeRow.childNodes[0].rowSpan="2";ontimeRow.childNodes[ontimeRow.childNodes.length-2].rowSpan="2";ontimeRow.childNodes[ontimeRow.childNodes.length-1].rowSpan="2";overdueRow.style.display=""}}},collapseAll:function(){for(nodeId in this.treeRoot){node=this.treeRoot[nodeId];this.collapseNode(node,true);this.hideSubtree(node.children)}},expandAll:function(){for(nodeId in this.treeRoot){node=this.treeRoot[nodeId];this.expandNode(node,true)}},findNode:function(f,b){for(var d in b){node=b[d];if(node.nickname==f){return node}else{if(node.children.length>0){var a=this.findNode(f,node.children);if(a!=false){return a}}}}return false},hasOverdue:function(b){for(var a in b){if(b[a]>0){return true}}return false},updateCellCount:function(a,h,d,b,j,f){if(!a.hasChildNodes()){if(h>0){var g=document.createElement("a");g.href=this.makeLink(d,b,j,f);g.appendChild(document.createTextNode(h));a.appendChild(g)}else{a.appendChild(document.createTextNode("-"))}}else{if(a.firstChild.hasChildNodes()){if(h>0){a.firstChild.firstChild.nodeValue=h;a.firstChild.href=this.makeLink(d,b,j,f)}else{a.removeChild(a.firstChild);a.appendChild(document.createTextNode("-"))}}else{if(h>0){a.removeChild(a.firstChild);var g=document.createElement("a");g.href=this.makeLink(d,b,j,f);g.appendChild(document.createTextNode(h));a.appendChild(g)}else{a.firstChild.nodeValue="-"}}}},makeLink:function(g,h,l,k){var f="";if(!(h=="CLOSED"||h=="TOTAL")){var f="/ontime/"+l}var j="";if(h!=""){j="/status/"+escape(h)}var a="";if(!YAHOO.lang.isNull(this.filterType)&&this.filterType!=""){a="/type/"+this.filterType}var b="";if(!YAHOO.lang.isNull(this.filterSource)&&this.filterSource!=""){b="/sourceId/"+this.filterSource}var d="/panel/remediation/sub/search"+f+j+"/responsibleOrganizationId/"+g+"/expanded/"+k+a+b;return d},exportTable:function(b){var a="/remediation/summary-data/format/"+b+this.listExpandedNodes(this.treeRoot,"");document.location=a},listExpandedNodes:function(b,a){for(var f in b){var d=b[f];if(d.expanded){a+="/e/"+d.id;a=this.listExpandedNodes(d.children,a)}else{a+="/c/"+d.id}}return a}}};Fisma.HtmlPanel=function(){return{showPanel:function(h,k,f,j){if(typeof(f)=="undefined"||f==null){f="panel"}if(typeof(j)=="undefined"||j==null){j={width:"540px",modal:true}}var g=new YAHOO.widget.Panel(f,j);g.setHeader(h);g.setBody("Loading...");g.render(document.body);g.center();g.show();if(k!=""){g.setBody(k);g.center()}return g}}}();Fisma.HtmlPanel=function(){return{showPanel:function(g,d,b,f){if(typeof(b)=="undefined"||b==null){b="panel"}if(typeof(f)=="undefined"||f==null){f={width:"540px",modal:true}}var a=new YAHOO.widget.Panel(b,f);a.setHeader(g);a.setBody("Loading...");a.render(document.body);a.center();a.show();if(d!=""){a.setBody(d);a.center()}return a}}}();Fisma.Incident={commentTable:null,attachArtifactCallback:function(b){window.location.href=window.location.href},commentCallback:function(j,g){var l=this;var m={timestamp:j.createdTs,username:j.username,comment:j.comment};this.commentTable.addRow(m);this.commentTable.sortColumn(this.commentTable.getColumn(0),YAHOO.widget.DataTable.CLASS_DESC);var h=new Fisma.Blinker(100,6,function(){l.commentTable.highlightRow(0)},function(){l.commentTable.unhighlightRow(0)});h.start();var k=document.getElementById("incidentCommentsCount").firstChild;k.nodeValue++;g.hide();g.destroy()}};Fisma.Incident={commentTable:null,attachArtifactCallback:function(a){window.location.href=window.location.href},commentCallback:function(h,b){var f=this;var d={timestamp:h.createdTs,username:h.username,comment:h.comment};this.commentTable.addRow(d);this.commentTable.sortColumn(this.commentTable.getColumn(0),YAHOO.widget.DataTable.CLASS_DESC);var a=new Fisma.Blinker(100,6,function(){f.commentTable.highlightRow(0)},function(){f.commentTable.unhighlightRow(0)});a.start();var g=document.getElementById("incidentCommentsCount").firstChild;g.nodeValue++;b.hide();b.destroy()}};Fisma.Module={handleSwitchButtonStateChange:function(f){f.setBusy(true);var d=f.state?"true":"false";var g="/config/set-module/id/"+f.payload.id+"/enabled/"+d+"/format/json/";YAHOO.util.Connect.asyncRequest("GET",g,{success:Fisma.Module.handleAsyncResponse,failure:Fisma.Module.handleAsyncResponse,argument:f},null)},handleAsyncResponse:function(f){try{var j=YAHOO.lang.JSON.parse(f.responseText)}catch(h){if(h instanceof SyntaxError){j=new Object();j.success=false;j.message="Invalid response from server."}else{throw h}}if(!j.success){alert("Error: Not able to change module status. Reason: "+j.message)}var g=f.argument;g.setBusy(false)}};Fisma.Module={handleSwitchButtonStateChange:function(a){a.setBusy(true);var b=a.state?"true":"false";var d="/config/set-module/id/"+a.payload.id+"/enabled/"+b+"/format/json/";YAHOO.util.Connect.asyncRequest("GET",d,{success:Fisma.Module.handleAsyncResponse,failure:Fisma.Module.handleAsyncResponse,argument:a},null)},handleAsyncResponse:function(b){try{var d=YAHOO.lang.JSON.parse(b.responseText)}catch(f){if(f instanceof SyntaxError){d=new Object();d.success=false;d.message="Invalid response from server."}else{throw f}}if(!d.success){alert("Error: Not able to change module status. Reason: "+d.message)}var a=b.argument;a.setBusy(false)}};function upload_evidence(){if(!form_confirm(document.finding_detail,"Upload Evidence")){return false}Fisma.UrlPanel.showPanel("Upload Evidence","/remediation/upload-form",upload_evidence_form_init);return false}function upload_evidence_form_init(){document.finding_detail_upload_evidence.action=document.finding_detail.action}function ev_approve(l){if(!form_confirm(document.finding_detail,"approve the evidence package")){return false}var m=document.createElement("div");var k=document.createElement("p");k.appendChild(document.createTextNode("Comments (OPTIONAL):"));m.appendChild(k);var g=document.createElement("textarea");g.rows=5;g.cols=60;g.id="dialog_comment";g.name="comment";m.appendChild(g);var j=document.createElement("div");j.style.height="20px";m.appendChild(j);var h=document.createElement("input");h.type="button";h.id="dialog_continue";h.value="Continue";m.appendChild(h);Fisma.HtmlPanel.showPanel("Evidence Approval",m.innerHTML);document.getElementById("dialog_continue").onclick=function(){var b=l;if(document.all){var a=document.getElementById("dialog_comment").innerHTML}else{var a=document.getElementById("dialog_comment").value}b.elements.comment.value=a;b.elements.decision.value="APPROVED";var d=document.createElement("input");d.type="hidden";d.name="submit_ea";d.value="APPROVED";b.appendChild(d);b.submit()}}function ev_deny(l){if(!form_confirm(document.finding_detail,"deny the evidence package")){return false}var m=document.createElement("div");var k=document.createElement("p");k.appendChild(document.createTextNode("Comments:"));m.appendChild(k);var g=document.createElement("textarea");g.rows=5;g.cols=60;g.id="dialog_comment";g.name="comment";m.appendChild(g);var j=document.createElement("div");j.style.height="20px";m.appendChild(j);var h=document.createElement("input");h.type="button";h.id="dialog_continue";h.value="Continue";m.appendChild(h);Fisma.HtmlPanel.showPanel("Evidence Denial",m.innerHTML);document.getElementById("dialog_continue").onclick=function(){var b=l;if(document.all){var a=document.getElementById("dialog_comment").innerHTML}else{var a=document.getElementById("dialog_comment").value}if(a.match(/^\s*$/)){alert("Comments are required in order to deny.");return}b.elements.comment.value=a;b.elements.decision.value="DENIED";var d=document.createElement("input");d.type="hidden";d.name="submit_ea";d.value="DENIED";b.appendChild(d);b.submit()}}function ms_approve(n){if(!form_confirm(document.finding_detail,"approve the mitigation strategy")){return false}var o=document.createElement("div");var m=document.createElement("p");var l=document.createTextNode("Comments (OPTIONAL):");m.appendChild(l);o.appendChild(m);var j=document.createElement("textarea");j.id="dialog_comment";j.name="comment";j.rows=5;j.cols=60;o.appendChild(j);var k=document.createElement("div");k.style.height="20px";o.appendChild(k);var h=document.createElement("input");h.type="button";h.id="dialog_continue";h.value="Continue";o.appendChild(h);Fisma.HtmlPanel.showPanel("Mitigation Strategy Approval",o.innerHTML);document.getElementById("dialog_continue").onclick=function(){var b=n;if(document.all){var a=document.getElementById("dialog_comment").innerHTML}else{var a=document.getElementById("dialog_comment").value}b.elements.comment.value=a;b.elements.decision.value="APPROVED";var d=document.createElement("input");d.type="hidden";d.name="submit_msa";d.value="APPROVED";b.appendChild(d);b.submit()}}function ms_deny(n){if(!form_confirm(document.finding_detail,"deny the mitigation strategy")){return false}var o=document.createElement("div");var m=document.createElement("p");var l=document.createTextNode("Comments:");m.appendChild(l);o.appendChild(m);var j=document.createElement("textarea");j.id="dialog_comment";j.name="comment";j.rows=5;j.cols=60;o.appendChild(j);var k=document.createElement("div");k.style.height="20px";o.appendChild(k);var h=document.createElement("input");h.type="button";h.id="dialog_continue";h.value="Continue";o.appendChild(h);Fisma.HtmlPanel.showPanel("Mitigation Strategy Denial",o.innerHTML);document.getElementById("dialog_continue").onclick=function(){var b=n;if(document.all){var a=document.getElementById("dialog_comment").innerHTML}else{var a=document.getElementById("dialog_comment").value}if(a.match(/^\s*$/)){alert("Comments are required in order to submit.");return}b.elements.comment.value=a;b.elements.decision.value="DENIED";var d=document.createElement("input");d.type="hidden";d.name="submit_msa";d.value="DENIED";b.appendChild(d);b.submit()}}function upload_evidence(){if(!form_confirm(document.finding_detail,"Upload Evidence")){return false}Fisma.UrlPanel.showPanel("Upload Evidence","/remediation/upload-form",upload_evidence_form_init);return false}function upload_evidence_form_init(){document.finding_detail_upload_evidence.action=document.finding_detail.action}function ev_approve(f){if(!form_confirm(document.finding_detail,"approve the evidence package")){return false}var d=document.createElement("div");var g=document.createElement("p");g.appendChild(document.createTextNode("Comments (OPTIONAL):"));d.appendChild(g);var b=document.createElement("textarea");b.rows=5;b.cols=60;b.id="dialog_comment";b.name="comment";d.appendChild(b);var h=document.createElement("div");h.style.height="20px";d.appendChild(h);var a=document.createElement("input");a.type="button";a.id="dialog_continue";a.value="Continue";d.appendChild(a);Fisma.HtmlPanel.showPanel("Evidence Approval",d.innerHTML);document.getElementById("dialog_continue").onclick=function(){var k=f;if(document.all){var l=document.getElementById("dialog_comment").innerHTML}else{var l=document.getElementById("dialog_comment").value}k.elements.comment.value=l;k.elements.decision.value="APPROVED";var j=document.createElement("input");j.type="hidden";j.name="submit_ea";j.value="APPROVED";k.appendChild(j);k.submit()}}function ev_deny(f){if(!form_confirm(document.finding_detail,"deny the evidence package")){return false}var d=document.createElement("div");var g=document.createElement("p");g.appendChild(document.createTextNode("Comments:"));d.appendChild(g);var b=document.createElement("textarea");b.rows=5;b.cols=60;b.id="dialog_comment";b.name="comment";d.appendChild(b);var h=document.createElement("div");h.style.height="20px";d.appendChild(h);var a=document.createElement("input");a.type="button";a.id="dialog_continue";a.value="Continue";d.appendChild(a);Fisma.HtmlPanel.showPanel("Evidence Denial",d.innerHTML);document.getElementById("dialog_continue").onclick=function(){var k=f;if(document.all){var l=document.getElementById("dialog_comment").innerHTML}else{var l=document.getElementById("dialog_comment").value}if(l.match(/^\s*$/)){alert("Comments are required in order to deny.");return}k.elements.comment.value=l;k.elements.decision.value="DENIED";var j=document.createElement("input");j.type="hidden";j.name="submit_ea";j.value="DENIED";k.appendChild(j);k.submit()}}function ms_approve(f){if(!form_confirm(document.finding_detail,"approve the mitigation strategy")){return false}var d=document.createElement("div");var g=document.createElement("p");var h=document.createTextNode("Comments (OPTIONAL):");g.appendChild(h);d.appendChild(g);var a=document.createElement("textarea");a.id="dialog_comment";a.name="comment";a.rows=5;a.cols=60;d.appendChild(a);var j=document.createElement("div");j.style.height="20px";d.appendChild(j);var b=document.createElement("input");b.type="button";b.id="dialog_continue";b.value="Continue";d.appendChild(b);Fisma.HtmlPanel.showPanel("Mitigation Strategy Approval",d.innerHTML);document.getElementById("dialog_continue").onclick=function(){var l=f;if(document.all){var m=document.getElementById("dialog_comment").innerHTML}else{var m=document.getElementById("dialog_comment").value}l.elements.comment.value=m;l.elements.decision.value="APPROVED";var k=document.createElement("input");k.type="hidden";k.name="submit_msa";k.value="APPROVED";l.appendChild(k);l.submit()}}function ms_deny(f){if(!form_confirm(document.finding_detail,"deny the mitigation strategy")){return false}var d=document.createElement("div");var g=document.createElement("p");var h=document.createTextNode("Comments:");g.appendChild(h);d.appendChild(g);var a=document.createElement("textarea");a.id="dialog_comment";a.name="comment";a.rows=5;a.cols=60;d.appendChild(a);var j=document.createElement("div");j.style.height="20px";d.appendChild(j);var b=document.createElement("input");b.type="button";b.id="dialog_continue";b.value="Continue";d.appendChild(b);Fisma.HtmlPanel.showPanel("Mitigation Strategy Denial",d.innerHTML);document.getElementById("dialog_continue").onclick=function(){var l=f;if(document.all){var m=document.getElementById("dialog_comment").innerHTML}else{var m=document.getElementById("dialog_comment").value}if(m.match(/^\s*$/)){alert("Comments are required in order to submit.");return}l.elements.comment.value=m;l.elements.decision.value="DENIED";var k=document.createElement("input");k.type="hidden";k.name="submit_msa";k.value="DENIED";l.appendChild(k);l.submit()}}Fisma.SwitchButton=function(f,g,h,j){var k=this;if(f.nodeType&&f.nodeType==document.ELEMENT_NODE){this.element=f}else{if("string"==typeof f){this.element=document.getElementById(f);if(!this.element){throw'Invalid element name "'+name+'"'}}else{throw"Invalid element for switch button constructor"}}this.createDomElements();this.state=g;this.payload=j;if(!this.state){this.element.style.backgroundPosition="-54px 100%"}this.element.onclick=function(){k.toggleSwitch.call(k)};if(""!=h){callbackObj=Fisma.Util.getObjectFromName(h);if("function"==typeof callbackObj){this.callback=callbackObj}else{throw"Specified callback is not a function: "+h}}};Fisma.SwitchButton.prototype={createDomElements:function(){YAHOO.util.Dom.addClass(this.element,"switchButton");var g=document.createElement("span");YAHOO.util.Dom.addClass(g,"border");this.element.appendChild(g);var d=document.createElement("span");YAHOO.util.Dom.addClass(d,"spinner");var f=document.createElement("img");f.src="/images/spinners/small.gif";d.appendChild(f);this.element.appendChild(d);this.spinner=d;this.proxyElement=document.createElement("div");this.proxyElement.style.display="none";document.body.appendChild(this.proxyElement)},toggleSwitch:function(){var d=this;var f;if(this.state){f={left:{from:0,to:-54,unit:"px"}};this.state=false}else{f={left:{from:-54,to:0,unit:"px"}};this.state=true}var g=new YAHOO.util.Anim(this.proxyElement,f,0.1,YAHOO.util.Easing.easeOut);g.onTween.subscribe(function(){d.element.style.backgroundPosition=d.proxyElement.style.left+" 100%"});g.animate();if(this.callback){this.callback(this)}},setBusy:function(b){if(b){this.spinner.style.visibility="visible"}else{this.spinner.style.visibility="hidden"}}};Fisma.SwitchButton=function(b,a,g,f){var d=this;if(b.nodeType&&b.nodeType==document.ELEMENT_NODE){this.element=b}else{if("string"==typeof b){this.element=document.getElementById(b);if(!this.element){throw'Invalid element name "'+name+'"'}}else{throw"Invalid element for switch button constructor"}}this.createDomElements();this.state=a;this.payload=f;if(!this.state){this.element.style.backgroundPosition="-54px 100%"}this.element.onclick=function(){d.toggleSwitch.call(d)};if(""!=g){callbackObj=Fisma.Util.getObjectFromName(g);if("function"==typeof callbackObj){this.callback=callbackObj}else{throw"Specified callback is not a function: "+g}}};Fisma.SwitchButton.prototype={createDomElements:function(){YAHOO.util.Dom.addClass(this.element,"switchButton");var d=document.createElement("span");YAHOO.util.Dom.addClass(d,"border");this.element.appendChild(d);var b=document.createElement("span");YAHOO.util.Dom.addClass(b,"spinner");var a=document.createElement("img");a.src="/images/spinners/small.gif";b.appendChild(a);this.element.appendChild(b);this.spinner=b;this.proxyElement=document.createElement("div");this.proxyElement.style.display="none";document.body.appendChild(this.proxyElement)},toggleSwitch:function(){var b=this;var a;if(this.state){a={left:{from:0,to:-54,unit:"px"}};this.state=false}else{a={left:{from:-54,to:0,unit:"px"}};this.state=true}var d=new YAHOO.util.Anim(this.proxyElement,a,0.1,YAHOO.util.Easing.easeOut);d.onTween.subscribe(function(){b.element.style.backgroundPosition=b.proxyElement.style.left+" 100%"});d.animate();if(this.callback){this.callback(this)}},setBusy:function(a){if(a){this.spinner.style.visibility="visible"}else{this.spinner.style.visibility="hidden"}}};Fisma.System={uploadDocumentCallback:function(b){window.location.href=window.location.href}};Fisma.System={uploadDocumentCallback:function(a){window.location.href=window.location.href}};Fisma.TabView={};Fisma.TabView={};Fisma.TabView.Roles=function(){return{init:function(d,f,g){YAHOO.util.Event.addListener("role","change",function(a){YAHOO.util.Dom.batch(YAHOO.util.Dom.getChildren("role"),function(n){var o=Fisma.tabView;var p=o.get("tabs");if(n.selected){var m=0;for(var q in p){if(p[q].get("id")==n.value){m=1;break}}if(!m){for(var q in d){if(d[q]["id"]==n.value){var r=d[q]["nickname"];break}}var b=new YAHOO.widget.Tab({id:n.value,label:r,dataSrc:"/user/get-organization-subform/user/"+f+"/role/"+n.value+"/readOnly/"+g,cacheData:true,active:true});b.subscribe("dataLoadedChange",Fisma.prepareTab);o.addTab(b)}}else{for(var q in p){if(p[q].get("id")==n.value){o.removeTab(p[q])}}}})})}}}();Fisma.TabView.Roles=function(){return{init:function(b,a,d){YAHOO.util.Event.addListener("role","change",function(f){YAHOO.util.Dom.batch(YAHOO.util.Dom.getChildren("role"),function(l){var k=Fisma.tabView;var j=k.get("tabs");if(l.selected){var m=0;for(var h in j){if(j[h].get("id")==l.value){m=1;break}}if(!m){for(var h in b){if(b[h]["id"]==l.value){var g=b[h]["nickname"];break}}var n=new YAHOO.widget.Tab({id:l.value,label:g,dataSrc:"/user/get-organization-subform/user/"+a+"/role/"+l.value+"/readOnly/"+d,cacheData:true,active:true});n.subscribe("dataLoadedChange",Fisma.prepareTab);k.addTab(n)}}else{for(var h in j){if(j[h].get("id")==l.value){k.removeTab(j[h])}}}})})}}}();Fisma.TableFormat={greenColor:"lightgreen",yellowColor:"yellow",redColor:"pink",green:function(b){b.style.backgroundColor=Fisma.TableFormat.greenColor},yellow:function(b){b.style.backgroundColor=Fisma.TableFormat.yellowColor},red:function(b){b.style.backgroundColor=Fisma.TableFormat.redColor},securityAuthorization:function(f,g,j,h){f.innerHTML=h;dateParts=h.split("-");if(3==dateParts.length){authorizedDate=new Date(dateParts[0],dateParts[1],dateParts[2]);greenDate=new Date();greenDate.setMonth(greenDate.getMonth()-30);yellowDate=new Date();yellowDate.setMonth(yellowDate.getMonth()-36);if(authorizedDate>=greenDate){Fisma.TableFormat.green(f.parentNode)}else{if(authorizedDate>=yellowDate){Fisma.TableFormat.yellow(f.parentNode)}else{Fisma.TableFormat.red(f.parentNode)}}}},selfAssessment:function(f,g,j,h){f.innerHTML=h;dateParts=h.split("-");if(3==dateParts.length){assessmentDate=new Date(dateParts[0],dateParts[1],dateParts[2]);greenDate=new Date();greenDate.setMonth(greenDate.getMonth()-8);yellowDate=new Date();yellowDate.setMonth(yellowDate.getMonth()-12);if(assessmentDate>=greenDate){Fisma.TableFormat.green(f.parentNode)}else{if(assessmentDate>=yellowDate){Fisma.TableFormat.yellow(f.parentNode)}else{Fisma.TableFormat.red(f.parentNode)}}}},contingencyPlanTest:function(f,g,j,h){Fisma.TableFormat.selfAssessment(f,g,j,h)},yesNo:function(f,g,j,h){f.innerHTML=h;if("YES"==h){Fisma.TableFormat.green(f.parentNode)}else{if("NO"==h){Fisma.TableFormat.red(f.parentNode)}}},editControl:function(l,m,k,j){var h=document.createElement("img");h.src="/images/edit.png";var g=document.createElement("a");g.href=j;g.appendChild(h);l.appendChild(g)},deleteControl:function(l,m,k,j){var h=document.createElement("img");h.src="/images/del.png";var g=document.createElement("a");g.href=j;g.appendChild(h);l.appendChild(g)}};Fisma.TableFormat={greenColor:"lightgreen",yellowColor:"yellow",redColor:"pink",green:function(a){a.style.backgroundColor=Fisma.TableFormat.greenColor},yellow:function(a){a.style.backgroundColor=Fisma.TableFormat.yellowColor},red:function(a){a.style.backgroundColor=Fisma.TableFormat.redColor},securityAuthorization:function(b,a,d,f){b.innerHTML=f;dateParts=f.split("-");if(3==dateParts.length){authorizedDate=new Date(dateParts[0],dateParts[1],dateParts[2]);greenDate=new Date();greenDate.setMonth(greenDate.getMonth()-30);yellowDate=new Date();yellowDate.setMonth(yellowDate.getMonth()-36);if(authorizedDate>=greenDate){Fisma.TableFormat.green(b.parentNode)}else{if(authorizedDate>=yellowDate){Fisma.TableFormat.yellow(b.parentNode)}else{Fisma.TableFormat.red(b.parentNode)}}}},selfAssessment:function(b,a,d,f){b.innerHTML=f;dateParts=f.split("-");if(3==dateParts.length){assessmentDate=new Date(dateParts[0],dateParts[1],dateParts[2]);greenDate=new Date();greenDate.setMonth(greenDate.getMonth()-8);yellowDate=new Date();yellowDate.setMonth(yellowDate.getMonth()-12);if(assessmentDate>=greenDate){Fisma.TableFormat.green(b.parentNode)}else{if(assessmentDate>=yellowDate){Fisma.TableFormat.yellow(b.parentNode)}else{Fisma.TableFormat.red(b.parentNode)}}}},contingencyPlanTest:function(b,a,d,f){Fisma.TableFormat.selfAssessment(b,a,d,f)},yesNo:function(b,a,d,f){b.innerHTML=f;if("YES"==f){Fisma.TableFormat.green(b.parentNode)}else{if("NO"==f){Fisma.TableFormat.red(b.parentNode)}}},editControl:function(f,d,g,h){var a=document.createElement("img");a.src="/images/edit.png";var b=document.createElement("a");b.href=h;b.appendChild(a);f.appendChild(b)},deleteControl:function(f,d,g,h){var a=document.createElement("img");a.src="/images/del.png";var b=document.createElement("a");b.href=h;b.appendChild(a);f.appendChild(b)}};Fisma.UrlPanel=function(){return{showPanel:function(k,g,j,m,l){if(typeof(m)=="undefined"||m==null){m="panel"}if(typeof(l)=="undefined"||l==null){l={width:"540px",modal:true}}var h=new YAHOO.widget.Panel(m,l);h.setHeader(k);h.setBody("Loading...");h.render(document.body);h.center();h.show();if(g!=""){YAHOO.util.Connect.asyncRequest("GET",g,{success:function(a){a.argument.setBody(a.responseText);a.argument.center();if(typeof(j)=="function"){j()}},failure:function(a){alert("Failed to load the specified panel.")},argument:h},null)}return h}}}();Fisma.UrlPanel=function(){return{showPanel:function(g,b,h,d,f){if(typeof(d)=="undefined"||d==null){d="panel"}if(typeof(f)=="undefined"||f==null){f={width:"540px",modal:true}}var a=new YAHOO.widget.Panel(d,f);a.setHeader(g);a.setBody("Loading...");a.render(document.body);a.center();a.show();if(b!=""){YAHOO.util.Connect.asyncRequest("GET",b,{success:function(j){j.argument.setBody(j.responseText);j.argument.center();if(typeof(h)=="function"){h()}},failure:function(j){alert("Failed to load the specified panel.")},argument:a},null)}return a}}}();Fisma.Util={getObjectFromName:function(g){var d=g.split(".");var f=window;for(piece in d){f=f[d[piece]];if(f==undefined){throw"Specified object does not exist: "+g}}return f}};Fisma.Util={getObjectFromName:function(d){var b=d.split(".");var a=window;for(piece in b){a=a[b[piece]];if(a==undefined){throw"Specified object does not exist: "+d}}return a}};
\ No newline at end of file
Index: public/stylesheets/combined-min.css
===================================================================
--- public/stylesheets/combined-min.css	(revision 3558)
+++ public/stylesheets/combined-min.css	(working copy)
@@ -32,7 +32,7 @@
 table.keyValues td{padding:5px;vertical-align:middle;}
 table.keyValues td:first-child{font-weight:bold;text-align:right;}
 table.keyValues th{text-align:center;font-weight:bold;font-style:normal;padding:5px;}
-div.toolbar{margin-bottom:10px;}
+div.buttonBar{margin-bottom:10px;}
 .editable{background:url(/images/edit.png) no-repeat top right;padding-right:20px;margin-right:10px;cursor:pointer;}
 div.approval{background-color:#efefef;border:1px solid #cecece;padding:3px;margin-bottom:10px;}
 div.approvalHeader{background-color:#cecece;border:1px solid #cecece;padding:3px 8px;}
Index: public/stylesheets/AutoComplete.css
===================================================================
--- public/stylesheets/AutoComplete.css	(revision 0)
+++ public/stylesheets/AutoComplete.css	(revision 0)
@@ -0,0 +1,19 @@
+/*
+ * Override some YUI styles which don't make sense for our layouts.
+ *
+ * Notice these styles are marked ! important so that they will override YUI's
+ * autocomplete.css styles.
+ */
+
+.yui-ac-input {
+    position: static ! important;
+    width: 90% ! important;
+}
+
+div.yui-ac img.spinner {
+	display: inline;
+	visibility: hidden;
+    position: relative;
+    top: 4px;
+    left: 2px;
+}
Index: public/stylesheets/combined.css
===================================================================
--- public/stylesheets/combined.css	(revision 3558)
+++ public/stylesheets/combined.css	(working copy)
@@ -246,8 +246,7 @@
     padding: 5px;
 }
 
-/* A container for holding a row of buttons */
-div.toolbar {
+div.buttonBar {
     margin-bottom: 10px;
 }
 
Index: public/stylesheets/Toolbar-min.css
===================================================================
--- public/stylesheets/Toolbar-min.css	(revision 0)
+++ public/stylesheets/Toolbar-min.css	(revision 0)
@@ -0,0 +1 @@
+div.toolbar{font-weight:bold;background-color:#ebebeb;margin:10px auto;border:1px solid #cecece;padding:5px 10px;text-align:right;}
\ No newline at end of file
Index: public/stylesheets/Finding-min.css
===================================================================
--- public/stylesheets/Finding-min.css	(revision 0)
+++ public/stylesheets/Finding-min.css	(revision 0)
@@ -0,0 +1 @@
+div#findingSecurityControlSearch{display:none;background-color:white;border:1px solid #d3d3d3;padding:10px;margin-top:10px;}
\ No newline at end of file
Index: public/stylesheets/Toolbar.css
===================================================================
--- public/stylesheets/Toolbar.css	(revision 0)
+++ public/stylesheets/Toolbar.css	(revision 0)
@@ -0,0 +1,14 @@
+/*
+ * This file contains styles for toolbars displayed in OpenFISMA.
+ *
+ * A toolbar is a short form that is laid out horiztonally to minimize the vertical screenspace required to render it.
+ */
+
+div.toolbar {
+    font-weight: bold;
+    background-color: #ebebeb;
+    margin: 10px auto;
+    border: 1px solid #cecece;
+    padding: 5px 10px;
+    text-align: right;
+}
Index: public/stylesheets/main-min.css
===================================================================
--- public/stylesheets/main-min.css	(revision 3558)
+++ public/stylesheets/main-min.css	(working copy)
@@ -32,7 +32,7 @@
 table.keyValues td{padding:5px;vertical-align:middle;}
 table.keyValues td:first-child{font-weight:bold;text-align:right;}
 table.keyValues th{text-align:center;font-weight:bold;font-style:normal;padding:5px;}
-div.toolbar{margin-bottom:10px;}
+div.buttonBar{margin-bottom:10px;}
 .editable{background:url(/images/edit.png) no-repeat top right;padding-right:20px;margin-right:10px;cursor:pointer;}
 div.approval{background-color:#efefef;border:1px solid #cecece;padding:3px;margin-bottom:10px;}
 div.approvalHeader{background-color:#cecece;border:1px solid #cecece;padding:3px 8px;}
Index: public/stylesheets/Finding.css
===================================================================
--- public/stylesheets/Finding.css	(revision 0)
+++ public/stylesheets/Finding.css	(revision 0)
@@ -0,0 +1,8 @@
+/* The security control search box is initially hidden */
+div#findingSecurityControlSearch {
+    display: none;
+    background-color: white;
+    border: 1px solid #d3d3d3;
+    padding: 10px;
+    margin-top: 10px;
+}
Index: public/stylesheets/AutoComplete-min.css
===================================================================
--- public/stylesheets/AutoComplete-min.css	(revision 0)
+++ public/stylesheets/AutoComplete-min.css	(revision 0)
@@ -0,0 +1,2 @@
+.yui-ac-input{position:static!important;width:90%!important;}
+div.yui-ac img.spinner{display:inline;visibility:hidden;position:relative;top:4px;left:2px;}
\ No newline at end of file
Index: public/stylesheets/main.css
===================================================================
--- public/stylesheets/main.css	(revision 3558)
+++ public/stylesheets/main.css	(working copy)
@@ -246,8 +246,7 @@
     padding: 5px;
 }
 
-/* A container for holding a row of buttons */
-div.toolbar {
+div.buttonBar {
     margin-bottom: 10px;
 }
 
